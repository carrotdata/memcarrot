/*! For license information please see module.js.LICENSE.txt */
define(["@emotion/css","@grafana/data","@grafana/runtime","@grafana/ui","lodash","react","react-dom","react-redux","react-router-dom","redux","rxjs"],((e,t,n,r,i,a,o,s,l,c,u)=>(()=>{var d,p,f={308:(e,t,n)=>{"use strict";let r;n.d(t,{Ay:()=>A,R1:()=>E,hW:()=>T}),e=n.hmd(e);const i=new Array(128).fill(void 0);function a(e){return i[e]}i.push(void 0,null,!0,!1);let o=i.length;function s(e){const t=a(e);return function(e){e<132||(i[e]=o,o=e)}(e),t}function l(e){o===i.length&&i.push(i.length+1);const t=o;return o=i[t],i[t]=e,t}const c="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};"undefined"!=typeof TextDecoder&&c.decode();let u=null;function d(){return null!==u&&0!==u.byteLength||(u=new Uint8Array(r.memory.buffer)),u}function p(e,t){return e>>>=0,c.decode(d().subarray(e,e+t))}let f=0;const h="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},g="function"==typeof h.encodeInto?function(e,t){return h.encodeInto(e,t)}:function(e,t){const n=h.encode(e);return t.set(n),{read:e.length,written:n.length}};function m(e,t,n){if(void 0===n){const n=h.encode(e),r=t(n.length,1)>>>0;return d().subarray(r,r+n.length).set(n),f=n.length,r}let r=e.length,i=t(r,1)>>>0;const a=d();let o=0;for(;o<r;o++){const t=e.charCodeAt(o);if(t>127)break;a[i+o]=t}if(o!==r){0!==o&&(e=e.slice(o)),i=n(i,r,r=o+3*e.length,1)>>>0;const t=d().subarray(i+o,i+r);o+=g(e,t).written,i=n(i,r,o,1)>>>0}return f=o,i}function b(e){return null==e}let v=null;function y(){return null!==v&&0!==v.byteLength||(v=new Int32Array(r.memory.buffer)),v}let O=null;let w=null;function S(e){const t=typeof e;if("number"==t||"boolean"==t||null==e)return`${e}`;if("string"==t)return`"${e}"`;if("symbol"==t){const t=e.description;return null==t?"Symbol":`Symbol(${t})`}if("function"==t){const t=e.name;return"string"==typeof t&&t.length>0?`Function(${t})`:"Function"}if(Array.isArray(e)){const t=e.length;let n="[";t>0&&(n+=S(e[0]));for(let r=1;r<t;r++)n+=", "+S(e[r]);return n+="]",n}const n=/\[object ([^\]]+)\]/.exec(toString.call(e));let r;if(!(n.length>1))return toString.call(e);if(r=n[1],"Object"==r)try{return"Object("+JSON.stringify(e)+")"}catch(e){return"Object"}return e instanceof Error?`${e.name}: ${e.message}\n${e.stack}`:r}let x=null;function _(e,t){try{return e.apply(this,t)}catch(e){r.__wbindgen_exn_store(l(e))}}"undefined"==typeof FinalizationRegistry||new FinalizationRegistry((e=>r.__wbg_autoets_free(e>>>0)));const P="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>r.__wbg_changepointdetector_free(e>>>0)));class E{static __wrap(e){e>>>=0;const t=Object.create(E.prototype);return t.__wbg_ptr=e,P.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,P.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_changepointdetector_free(e)}static normalGamma(e){try{const i=r.__wbindgen_add_to_stack_pointer(-16);r.changepointdetector_normalGamma(i,b(e)?0:l(e));var t=y()[i/4+0],n=y()[i/4+1];if(y()[i/4+2])throw s(n);return E.__wrap(t)}finally{r.__wbindgen_add_to_stack_pointer(16)}}static defaultArgpcp(e){try{const i=r.__wbindgen_add_to_stack_pointer(-16);r.changepointdetector_defaultArgpcp(i,b(e)?0:l(e));var t=y()[i/4+0],n=y()[i/4+1];if(y()[i/4+2])throw s(n);return E.__wrap(t)}finally{r.__wbindgen_add_to_stack_pointer(16)}}detectChangepoints(e){return s(r.changepointdetector_detectChangepoints(this.__wbg_ptr,l(e)))}}const C="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>r.__wbg_loadedoutlierdetector_free(e>>>0)));class k{static __wrap(e){e>>>=0;const t=Object.create(k.prototype);return t.__wbg_ptr=e,C.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,C.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_loadedoutlierdetector_free(e)}detect(){try{const n=r.__wbindgen_add_to_stack_pointer(-16);r.loadedoutlierdetector_detect(n,this.__wbg_ptr);var e=y()[n/4+0],t=y()[n/4+1];if(y()[n/4+2])throw s(t);return s(e)}finally{r.__wbindgen_add_to_stack_pointer(16)}}updateDetector(e){try{const n=r.__wbindgen_add_to_stack_pointer(-16);r.loadedoutlierdetector_updateDetector(n,this.__wbg_ptr,l(e));var t=y()[n/4+0];if(y()[n/4+1])throw s(t)}finally{r.__wbindgen_add_to_stack_pointer(16)}}}"undefined"==typeof FinalizationRegistry||new FinalizationRegistry((e=>r.__wbg_mstl_free(e>>>0)));const D="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>r.__wbg_outlierdetector_free(e>>>0)));class T{static __wrap(e){e>>>=0;const t=Object.create(T.prototype);return t.__wbg_ptr=e,D.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,D.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_outlierdetector_free(e)}static dbscan(e){try{const i=r.__wbindgen_add_to_stack_pointer(-16);r.outlierdetector_dbscan(i,l(e));var t=y()[i/4+0],n=y()[i/4+1];if(y()[i/4+2])throw s(n);return T.__wrap(t)}finally{r.__wbindgen_add_to_stack_pointer(16)}}static mad(e){try{const i=r.__wbindgen_add_to_stack_pointer(-16);r.outlierdetector_mad(i,l(e));var t=y()[i/4+0],n=y()[i/4+1];if(y()[i/4+2])throw s(n);return T.__wrap(t)}finally{r.__wbindgen_add_to_stack_pointer(16)}}detect(e,t){try{const a=r.__wbindgen_add_to_stack_pointer(-16);r.outlierdetector_detect(a,this.__wbg_ptr,l(e),t);var n=y()[a/4+0],i=y()[a/4+1];if(y()[a/4+2])throw s(i);return s(n)}finally{r.__wbindgen_add_to_stack_pointer(16)}}preprocess(e,t){try{const a=r.__wbindgen_add_to_stack_pointer(-16);r.outlierdetector_preprocess(a,this.__wbg_ptr,l(e),t);var n=y()[a/4+0],i=y()[a/4+1];if(y()[a/4+2])throw s(i);return k.__wrap(n)}finally{r.__wbindgen_add_to_stack_pointer(16)}}}function R(){const t={wbg:{}};return t.wbg.__wbindgen_object_drop_ref=function(e){s(e)},t.wbg.__wbindgen_object_clone_ref=function(e){return l(a(e))},t.wbg.__wbindgen_error_new=function(e,t){return l(new Error(p(e,t)))},t.wbg.__wbindgen_string_get=function(e,t){const n=a(t),i="string"==typeof n?n:void 0;var o=b(i)?0:m(i,r.__wbindgen_malloc,r.__wbindgen_realloc),s=f;y()[e/4+1]=s,y()[e/4+0]=o},t.wbg.__wbindgen_is_bigint=function(e){return"bigint"==typeof a(e)},t.wbg.__wbindgen_bigint_from_u64=function(e){return l(BigInt.asUintN(64,e))},t.wbg.__wbindgen_jsval_eq=function(e,t){return a(e)===a(t)},t.wbg.__wbindgen_boolean_get=function(e){const t=a(e);return"boolean"==typeof t?t?1:0:2},t.wbg.__wbindgen_is_string=function(e){return"string"==typeof a(e)},t.wbg.__wbindgen_number_get=function(e,t){const n=a(t),i="number"==typeof n?n:void 0;(null!==O&&0!==O.byteLength||(O=new Float64Array(r.memory.buffer)),O)[e/8+1]=b(i)?0:i,y()[e/4+0]=!b(i)},t.wbg.__wbindgen_is_object=function(e){const t=a(e);return"object"==typeof t&&null!==t},t.wbg.__wbindgen_is_undefined=function(e){return void 0===a(e)},t.wbg.__wbindgen_in=function(e,t){return a(e)in a(t)},t.wbg.__wbindgen_string_new=function(e,t){return l(p(e,t))},t.wbg.__wbg_new_abda76e883ba8a5f=function(){return l(new Error)},t.wbg.__wbg_stack_658279fe44541cf6=function(e,t){const n=m(a(t).stack,r.__wbindgen_malloc,r.__wbindgen_realloc),i=f;y()[e/4+1]=i,y()[e/4+0]=n},t.wbg.__wbg_error_f851667af71bcfc6=function(e,t){let n,i;try{n=e,i=t,console.error(p(e,t))}finally{r.__wbindgen_free(n,i,1)}},t.wbg.__wbg_crypto_1d1f22824a6a080c=function(e){return l(a(e).crypto)},t.wbg.__wbg_process_4a72847cc503995b=function(e){return l(a(e).process)},t.wbg.__wbg_versions_f686565e586dd935=function(e){return l(a(e).versions)},t.wbg.__wbg_node_104a2ff8d6ea03a2=function(e){return l(a(e).node)},t.wbg.__wbg_require_cca90b1a94a0255b=function(){return _((function(){return l(e.require)}),arguments)},t.wbg.__wbindgen_is_function=function(e){return"function"==typeof a(e)},t.wbg.__wbg_msCrypto_eb05e62b530a1508=function(e){return l(a(e).msCrypto)},t.wbg.__wbg_randomFillSync_5c9c955aa56b6049=function(){return _((function(e,t){a(e).randomFillSync(s(t))}),arguments)},t.wbg.__wbg_getRandomValues_3aa56aa6edec874c=function(){return _((function(e,t){a(e).getRandomValues(a(t))}),arguments)},t.wbg.__wbindgen_number_new=function(e){return l(e)},t.wbg.__wbindgen_jsval_loose_eq=function(e,t){return a(e)==a(t)},t.wbg.__wbindgen_as_number=function(e){return+a(e)},t.wbg.__wbg_String_b9412f8799faab3e=function(e,t){const n=m(String(a(t)),r.__wbindgen_malloc,r.__wbindgen_realloc),i=f;y()[e/4+1]=i,y()[e/4+0]=n},t.wbg.__wbg_getwithrefkey_edc2c8960f0f1191=function(e,t){return l(a(e)[a(t)])},t.wbg.__wbg_set_f975102236d3c502=function(e,t,n){a(e)[s(t)]=s(n)},t.wbg.__wbg_get_bd8e338fbd5f5cc8=function(e,t){return l(a(e)[t>>>0])},t.wbg.__wbg_length_cd7af8117672b8b8=function(e){return a(e).length},t.wbg.__wbg_new_16b304a2cfa7ff4a=function(){return l(new Array)},t.wbg.__wbg_newnoargs_e258087cd0daa0ea=function(e,t){return l(new Function(p(e,t)))},t.wbg.__wbg_call_27c0f87801dedf93=function(){return _((function(e,t){return l(a(e).call(a(t)))}),arguments)},t.wbg.__wbg_new_72fb9a18b5ae2624=function(){return l(new Object)},t.wbg.__wbg_self_ce0dbfc45cf2f5be=function(){return _((function(){return l(self.self)}),arguments)},t.wbg.__wbg_window_c6fb939a7f436783=function(){return _((function(){return l(window.window)}),arguments)},t.wbg.__wbg_globalThis_d1e6af4856ba331b=function(){return _((function(){return l(globalThis.globalThis)}),arguments)},t.wbg.__wbg_global_207b558942527489=function(){return _((function(){return l(n.g.global)}),arguments)},t.wbg.__wbg_set_d4638f722068f043=function(e,t,n){a(e)[t>>>0]=s(n)},t.wbg.__wbg_instanceof_ArrayBuffer_836825be07d4c9d2=function(e){let t;try{t=a(e)instanceof ArrayBuffer}catch(e){t=!1}return t},t.wbg.__wbg_call_b3ca7c6051f9bec1=function(){return _((function(e,t,n){return l(a(e).call(a(t),a(n)))}),arguments)},t.wbg.__wbg_isSafeInteger_f7b04ef02296c4d2=function(e){return Number.isSafeInteger(a(e))},t.wbg.__wbg_entries_95cc2c823b285a09=function(e){return l(Object.entries(a(e)))},t.wbg.__wbg_buffer_12d079cc21e14bdb=function(e){return l(a(e).buffer)},t.wbg.__wbg_newwithbyteoffsetandlength_aa4a17c33a06e5cb=function(e,t,n){return l(new Uint8Array(a(e),t>>>0,n>>>0))},t.wbg.__wbg_new_63b92bc8671ed464=function(e){return l(new Uint8Array(a(e)))},t.wbg.__wbg_set_a47bac70306a19a7=function(e,t,n){a(e).set(a(t),n>>>0)},t.wbg.__wbg_length_c20a40f15020d68a=function(e){return a(e).length},t.wbg.__wbg_new_5e4931c0e7b0d773=function(e){return l(new Float64Array(a(e)))},t.wbg.__wbg_set_cb4cf3c3a46bcdd2=function(e,t,n){a(e).set(a(t),n>>>0)},t.wbg.__wbg_length_0382220548385255=function(e){return a(e).length},t.wbg.__wbg_instanceof_Uint8Array_2b3bbecd033d19f6=function(e){let t;try{t=a(e)instanceof Uint8Array}catch(e){t=!1}return t},t.wbg.__wbg_newwithlength_e9b4878cebadb3d3=function(e){return l(new Uint8Array(e>>>0))},t.wbg.__wbg_subarray_a1f73cd4b5b42fe1=function(e,t,n){return l(a(e).subarray(t>>>0,n>>>0))},t.wbg.__wbindgen_bigint_get_as_i64=function(e,t){const n=a(t),i="bigint"==typeof n?n:void 0;(null!==w&&0!==w.byteLength||(w=new BigInt64Array(r.memory.buffer)),w)[e/8+1]=b(i)?BigInt(0):i,y()[e/4+0]=!b(i)},t.wbg.__wbindgen_debug_string=function(e,t){const n=m(S(a(t)),r.__wbindgen_malloc,r.__wbindgen_realloc),i=f;y()[e/4+1]=i,y()[e/4+0]=n},t.wbg.__wbindgen_throw=function(e,t){throw new Error(p(e,t))},t.wbg.__wbindgen_memory=function(){return l(r.memory)},t}async function I(e){if(void 0!==r)return r;void 0===e&&(e=new URL(n(294),n.b));const t=R();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:i,module:a}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return function(e,t){return r=e.exports,I.__wbindgen_wasm_module=t,w=null,O=null,v=null,x=null,u=null,r.__wbindgen_start(),r}(i,a)}const A=I},567:(e,t,n)=>{var r;!function(){"use strict";var i=!("undefined"==typeof window||!window.document||!window.document.createElement),a={canUseDOM:i,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:i&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:i&&!!window.screen};void 0===(r=function(){return a}.call(t,n,t,e))||(e.exports=r)}()},486:(e,t,n)=>{"use strict";var r=n(271),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function l(e){return r.isMemo(e)?o:s[e.$$typeof]||i}s[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[r.Memo]=o;var c=Object.defineProperty,u=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,p=Object.getOwnPropertyDescriptor,f=Object.getPrototypeOf,h=Object.prototype;e.exports=function e(t,n,r){if("string"!=typeof n){if(h){var i=f(n);i&&i!==h&&e(t,i,r)}var o=u(n);d&&(o=o.concat(d(n)));for(var s=l(t),g=l(n),m=0;m<o.length;++m){var b=o[m];if(!(a[b]||r&&r[b]||g&&g[b]||s&&s[b])){var v=p(n,b);try{c(t,b,v)}catch(e){}}}}return t}},842:(e,t,n)=>{e=n.nmd(e);var r="__lodash_hash_undefined__",i=1,a=2,o=9007199254740991,s="[object Arguments]",l="[object Array]",c="[object AsyncFunction]",u="[object Boolean]",d="[object Date]",p="[object Error]",f="[object Function]",h="[object GeneratorFunction]",g="[object Map]",m="[object Number]",b="[object Null]",v="[object Object]",y="[object Promise]",O="[object Proxy]",w="[object RegExp]",S="[object Set]",x="[object String]",_="[object Undefined]",P="[object WeakMap]",E="[object ArrayBuffer]",C="[object DataView]",k=/^\[object .+?Constructor\]$/,D=/^(?:0|[1-9]\d*)$/,T={};T["[object Float32Array]"]=T["[object Float64Array]"]=T["[object Int8Array]"]=T["[object Int16Array]"]=T["[object Int32Array]"]=T["[object Uint8Array]"]=T["[object Uint8ClampedArray]"]=T["[object Uint16Array]"]=T["[object Uint32Array]"]=!0,T[s]=T[l]=T[E]=T[u]=T[C]=T[d]=T[p]=T[f]=T[g]=T[m]=T[v]=T[w]=T[S]=T[x]=T[P]=!1;var R="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,I="object"==typeof self&&self&&self.Object===Object&&self,A=R||I||Function("return this")(),j=t&&!t.nodeType&&t,L=j&&e&&!e.nodeType&&e,$=L&&L.exports===j,F=$&&R.process,N=function(){try{return F&&F.binding&&F.binding("util")}catch(e){}}(),M=N&&N.isTypedArray;function V(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function B(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function z(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var W,Q,U,q=Array.prototype,H=Function.prototype,G=Object.prototype,X=A["__core-js_shared__"],Y=H.toString,Z=G.hasOwnProperty,K=(W=/[^.]+$/.exec(X&&X.keys&&X.keys.IE_PROTO||""))?"Symbol(src)_1."+W:"",J=G.toString,ee=RegExp("^"+Y.call(Z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),te=$?A.Buffer:void 0,ne=A.Symbol,re=A.Uint8Array,ie=G.propertyIsEnumerable,ae=q.splice,oe=ne?ne.toStringTag:void 0,se=Object.getOwnPropertySymbols,le=te?te.isBuffer:void 0,ce=(Q=Object.keys,U=Object,function(e){return Q(U(e))}),ue=Le(A,"DataView"),de=Le(A,"Map"),pe=Le(A,"Promise"),fe=Le(A,"Set"),he=Le(A,"WeakMap"),ge=Le(Object,"create"),me=Me(ue),be=Me(de),ve=Me(pe),ye=Me(fe),Oe=Me(he),we=ne?ne.prototype:void 0,Se=we?we.valueOf:void 0;function xe(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function _e(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Pe(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Ee(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Pe;++t<n;)this.add(e[t])}function Ce(e){var t=this.__data__=new _e(e);this.size=t.size}function ke(e,t){for(var n=e.length;n--;)if(Ve(e[n][0],t))return n;return-1}function De(e){return null==e?void 0===e?_:b:oe&&oe in Object(e)?function(e){var t=Z.call(e,oe),n=e[oe];try{e[oe]=void 0;var r=!0}catch(e){}var i=J.call(e);return r&&(t?e[oe]=n:delete e[oe]),i}(e):function(e){return J.call(e)}(e)}function Te(e){return He(e)&&De(e)==s}function Re(e,t,n,r,o){return e===t||(null==e||null==t||!He(e)&&!He(t)?e!=e&&t!=t:function(e,t,n,r,o,c){var f=ze(e),h=ze(t),b=f?l:Fe(e),y=h?l:Fe(t),O=(b=b==s?v:b)==v,_=(y=y==s?v:y)==v,P=b==y;if(P&&We(e)){if(!We(t))return!1;f=!0,O=!1}if(P&&!O)return c||(c=new Ce),f||Ge(e)?Ie(e,t,n,r,o,c):function(e,t,n,r,o,s,l){switch(n){case C:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case E:return!(e.byteLength!=t.byteLength||!s(new re(e),new re(t)));case u:case d:case m:return Ve(+e,+t);case p:return e.name==t.name&&e.message==t.message;case w:case x:return e==t+"";case g:var c=B;case S:var f=r&i;if(c||(c=z),e.size!=t.size&&!f)return!1;var h=l.get(e);if(h)return h==t;r|=a,l.set(e,t);var b=Ie(c(e),c(t),r,o,s,l);return l.delete(e),b;case"[object Symbol]":if(Se)return Se.call(e)==Se.call(t)}return!1}(e,t,b,n,r,o,c);if(!(n&i)){var k=O&&Z.call(e,"__wrapped__"),D=_&&Z.call(t,"__wrapped__");if(k||D){var T=k?e.value():e,R=D?t.value():t;return c||(c=new Ce),o(T,R,n,r,c)}}return!!P&&(c||(c=new Ce),function(e,t,n,r,a,o){var s=n&i,l=Ae(e),c=l.length;if(c!=Ae(t).length&&!s)return!1;for(var u=c;u--;){var d=l[u];if(!(s?d in t:Z.call(t,d)))return!1}var p=o.get(e);if(p&&o.get(t))return p==t;var f=!0;o.set(e,t),o.set(t,e);for(var h=s;++u<c;){var g=e[d=l[u]],m=t[d];if(r)var b=s?r(m,g,d,t,e,o):r(g,m,d,e,t,o);if(!(void 0===b?g===m||a(g,m,n,r,o):b)){f=!1;break}h||(h="constructor"==d)}if(f&&!h){var v=e.constructor,y=t.constructor;v==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof y&&y instanceof y||(f=!1)}return o.delete(e),o.delete(t),f}(e,t,n,r,o,c))}(e,t,n,r,Re,o))}function Ie(e,t,n,r,o,s){var l=n&i,c=e.length,u=t.length;if(c!=u&&!(l&&u>c))return!1;var d=s.get(e);if(d&&s.get(t))return d==t;var p=-1,f=!0,h=n&a?new Ee:void 0;for(s.set(e,t),s.set(t,e);++p<c;){var g=e[p],m=t[p];if(r)var b=l?r(m,g,p,t,e,s):r(g,m,p,e,t,s);if(void 0!==b){if(b)continue;f=!1;break}if(h){if(!V(t,(function(e,t){if(i=t,!h.has(i)&&(g===e||o(g,e,n,r,s)))return h.push(t);var i}))){f=!1;break}}else if(g!==m&&!o(g,m,n,r,s)){f=!1;break}}return s.delete(e),s.delete(t),f}function Ae(e){return function(e,t,n){var r=t(e);return ze(e)?r:function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}(r,n(e))}(e,Xe,$e)}function je(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function Le(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!qe(e)||function(e){return!!K&&K in e}(e))&&(Qe(e)?ee:k).test(Me(e))}(n)?n:void 0}xe.prototype.clear=function(){this.__data__=ge?ge(null):{},this.size=0},xe.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},xe.prototype.get=function(e){var t=this.__data__;if(ge){var n=t[e];return n===r?void 0:n}return Z.call(t,e)?t[e]:void 0},xe.prototype.has=function(e){var t=this.__data__;return ge?void 0!==t[e]:Z.call(t,e)},xe.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ge&&void 0===t?r:t,this},_e.prototype.clear=function(){this.__data__=[],this.size=0},_e.prototype.delete=function(e){var t=this.__data__,n=ke(t,e);return!(n<0||(n==t.length-1?t.pop():ae.call(t,n,1),--this.size,0))},_e.prototype.get=function(e){var t=this.__data__,n=ke(t,e);return n<0?void 0:t[n][1]},_e.prototype.has=function(e){return ke(this.__data__,e)>-1},_e.prototype.set=function(e,t){var n=this.__data__,r=ke(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Pe.prototype.clear=function(){this.size=0,this.__data__={hash:new xe,map:new(de||_e),string:new xe}},Pe.prototype.delete=function(e){var t=je(this,e).delete(e);return this.size-=t?1:0,t},Pe.prototype.get=function(e){return je(this,e).get(e)},Pe.prototype.has=function(e){return je(this,e).has(e)},Pe.prototype.set=function(e,t){var n=je(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Ee.prototype.add=Ee.prototype.push=function(e){return this.__data__.set(e,r),this},Ee.prototype.has=function(e){return this.__data__.has(e)},Ce.prototype.clear=function(){this.__data__=new _e,this.size=0},Ce.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Ce.prototype.get=function(e){return this.__data__.get(e)},Ce.prototype.has=function(e){return this.__data__.has(e)},Ce.prototype.set=function(e,t){var n=this.__data__;if(n instanceof _e){var r=n.__data__;if(!de||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Pe(r)}return n.set(e,t),this.size=n.size,this};var $e=se?function(e){return null==e?[]:(e=Object(e),function(t,n){for(var r=-1,i=null==t?0:t.length,a=0,o=[];++r<i;){var s=t[r];l=s,ie.call(e,l)&&(o[a++]=s)}var l;return o}(se(e)))}:function(){return[]},Fe=De;function Ne(e,t){return!!(t=null==t?o:t)&&("number"==typeof e||D.test(e))&&e>-1&&e%1==0&&e<t}function Me(e){if(null!=e){try{return Y.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Ve(e,t){return e===t||e!=e&&t!=t}(ue&&Fe(new ue(new ArrayBuffer(1)))!=C||de&&Fe(new de)!=g||pe&&Fe(pe.resolve())!=y||fe&&Fe(new fe)!=S||he&&Fe(new he)!=P)&&(Fe=function(e){var t=De(e),n=t==v?e.constructor:void 0,r=n?Me(n):"";if(r)switch(r){case me:return C;case be:return g;case ve:return y;case ye:return S;case Oe:return P}return t});var Be=Te(function(){return arguments}())?Te:function(e){return He(e)&&Z.call(e,"callee")&&!ie.call(e,"callee")},ze=Array.isArray,We=le||function(){return!1};function Qe(e){if(!qe(e))return!1;var t=De(e);return t==f||t==h||t==c||t==O}function Ue(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=o}function qe(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function He(e){return null!=e&&"object"==typeof e}var Ge=M?function(e){return function(t){return e(t)}}(M):function(e){return He(e)&&Ue(e.length)&&!!T[De(e)]};function Xe(e){return null!=(t=e)&&Ue(t.length)&&!Qe(t)?function(e,t){var n=ze(e),r=!n&&Be(e),i=!n&&!r&&We(e),a=!n&&!r&&!i&&Ge(e),o=n||r||i||a,s=o?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],l=s.length;for(var c in e)!t&&!Z.call(e,c)||o&&("length"==c||i&&("offset"==c||"parent"==c)||a&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Ne(c,l))||s.push(c);return s}(e):function(e){if(n=(t=e)&&t.constructor,t!==("function"==typeof n&&n.prototype||G))return ce(e);var t,n,r=[];for(var i in Object(e))Z.call(e,i)&&"constructor"!=i&&r.push(i);return r}(e);var t}e.exports=function(e,t){return Re(e,t)}},362:(e,t,n)=>{"use strict";var r=n(441);function i(){}function a(){}a.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,a,o){if(o!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:i};return n.PropTypes=n,n}},688:(e,t,n)=>{e.exports=n(362)()},441:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},111:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DraggableCore",{enumerable:!0,get:function(){return u.default}}),t.default=void 0;var r=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=f(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}(n(959)),i=p(n(688)),a=p(n(398)),o=p(n(262)),s=n(837),l=n(402),c=n(732),u=p(n(60)),d=p(n(988));function p(e){return e&&e.__esModule?e:{default:e}}function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}function h(){return h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},h.apply(this,arguments)}function g(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class m extends r.Component{static getDerivedStateFromProps(e,t){let{position:n}=e,{prevPropsPosition:r}=t;return!n||r&&n.x===r.x&&n.y===r.y?null:((0,d.default)("Draggable: getDerivedStateFromProps %j",{position:n,prevPropsPosition:r}),{x:n.x,y:n.y,prevPropsPosition:{...n}})}constructor(e){super(e),g(this,"onDragStart",((e,t)=>{if((0,d.default)("Draggable: onDragStart: %j",t),!1===this.props.onStart(e,(0,l.createDraggableData)(this,t)))return!1;this.setState({dragging:!0,dragged:!0})})),g(this,"onDrag",((e,t)=>{if(!this.state.dragging)return!1;(0,d.default)("Draggable: onDrag: %j",t);const n=(0,l.createDraggableData)(this,t),r={x:n.x,y:n.y,slackX:0,slackY:0};if(this.props.bounds){const{x:e,y:t}=r;r.x+=this.state.slackX,r.y+=this.state.slackY;const[i,a]=(0,l.getBoundPosition)(this,r.x,r.y);r.x=i,r.y=a,r.slackX=this.state.slackX+(e-r.x),r.slackY=this.state.slackY+(t-r.y),n.x=r.x,n.y=r.y,n.deltaX=r.x-this.state.x,n.deltaY=r.y-this.state.y}if(!1===this.props.onDrag(e,n))return!1;this.setState(r)})),g(this,"onDragStop",((e,t)=>{if(!this.state.dragging)return!1;if(!1===this.props.onStop(e,(0,l.createDraggableData)(this,t)))return!1;(0,d.default)("Draggable: onDragStop: %j",t);const n={dragging:!1,slackX:0,slackY:0};if(Boolean(this.props.position)){const{x:e,y:t}=this.props.position;n.x=e,n.y=t}this.setState(n)})),this.state={dragging:!1,dragged:!1,x:e.position?e.position.x:e.defaultPosition.x,y:e.position?e.position.y:e.defaultPosition.y,prevPropsPosition:{...e.position},slackX:0,slackY:0,isElementSVG:!1},!e.position||e.onDrag||e.onStop||console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){void 0!==window.SVGElement&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.setState({dragging:!1})}findDOMNode(){var e,t;return null!==(e=null===(t=this.props)||void 0===t||null===(t=t.nodeRef)||void 0===t?void 0:t.current)&&void 0!==e?e:a.default.findDOMNode(this)}render(){const{axis:e,bounds:t,children:n,defaultPosition:i,defaultClassName:a,defaultClassNameDragging:c,defaultClassNameDragged:d,position:p,positionOffset:f,scale:g,...m}=this.props;let b={},v=null;const y=!Boolean(p)||this.state.dragging,O=p||i,w={x:(0,l.canDragX)(this)&&y?this.state.x:O.x,y:(0,l.canDragY)(this)&&y?this.state.y:O.y};this.state.isElementSVG?v=(0,s.createSVGTransform)(w,f):b=(0,s.createCSSTransform)(w,f);const S=(0,o.default)(n.props.className||"",a,{[c]:this.state.dragging,[d]:this.state.dragged});return r.createElement(u.default,h({},m,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),r.cloneElement(r.Children.only(n),{className:S,style:{...n.props.style,...b},transform:v}))}}t.default=m,g(m,"displayName","Draggable"),g(m,"propTypes",{...u.default.propTypes,axis:i.default.oneOf(["both","x","y","none"]),bounds:i.default.oneOfType([i.default.shape({left:i.default.number,right:i.default.number,top:i.default.number,bottom:i.default.number}),i.default.string,i.default.oneOf([!1])]),defaultClassName:i.default.string,defaultClassNameDragging:i.default.string,defaultClassNameDragged:i.default.string,defaultPosition:i.default.shape({x:i.default.number,y:i.default.number}),positionOffset:i.default.shape({x:i.default.oneOfType([i.default.number,i.default.string]),y:i.default.oneOfType([i.default.number,i.default.string])}),position:i.default.shape({x:i.default.number,y:i.default.number}),className:c.dontSetMe,style:c.dontSetMe,transform:c.dontSetMe}),g(m,"defaultProps",{...u.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})},60:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}(n(959)),i=u(n(688)),a=u(n(398)),o=n(837),s=n(402),l=n(732),c=u(n(988));function u(e){return e&&e.__esModule?e:{default:e}}function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}function p(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const f={start:"touchstart",move:"touchmove",stop:"touchend"},h={start:"mousedown",move:"mousemove",stop:"mouseup"};let g=h;class m extends r.Component{constructor(){super(...arguments),p(this,"dragging",!1),p(this,"lastX",NaN),p(this,"lastY",NaN),p(this,"touchIdentifier",null),p(this,"mounted",!1),p(this,"handleDragStart",(e=>{if(this.props.onMouseDown(e),!this.props.allowAnyClick&&"number"==typeof e.button&&0!==e.button)return!1;const t=this.findDOMNode();if(!t||!t.ownerDocument||!t.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:n}=t;if(this.props.disabled||!(e.target instanceof n.defaultView.Node)||this.props.handle&&!(0,o.matchesSelectorAndParentsTo)(e.target,this.props.handle,t)||this.props.cancel&&(0,o.matchesSelectorAndParentsTo)(e.target,this.props.cancel,t))return;"touchstart"===e.type&&e.preventDefault();const r=(0,o.getTouchIdentifier)(e);this.touchIdentifier=r;const i=(0,s.getControlPosition)(e,r,this);if(null==i)return;const{x:a,y:l}=i,u=(0,s.createCoreData)(this,a,l);(0,c.default)("DraggableCore: handleDragStart: %j",u),(0,c.default)("calling",this.props.onStart),!1!==this.props.onStart(e,u)&&!1!==this.mounted&&(this.props.enableUserSelectHack&&(0,o.addUserSelectStyles)(n),this.dragging=!0,this.lastX=a,this.lastY=l,(0,o.addEvent)(n,g.move,this.handleDrag),(0,o.addEvent)(n,g.stop,this.handleDragStop))})),p(this,"handleDrag",(e=>{const t=(0,s.getControlPosition)(e,this.touchIdentifier,this);if(null==t)return;let{x:n,y:r}=t;if(Array.isArray(this.props.grid)){let e=n-this.lastX,t=r-this.lastY;if([e,t]=(0,s.snapToGrid)(this.props.grid,e,t),!e&&!t)return;n=this.lastX+e,r=this.lastY+t}const i=(0,s.createCoreData)(this,n,r);if((0,c.default)("DraggableCore: handleDrag: %j",i),!1!==this.props.onDrag(e,i)&&!1!==this.mounted)this.lastX=n,this.lastY=r;else try{this.handleDragStop(new MouseEvent("mouseup"))}catch(e){const t=document.createEvent("MouseEvents");t.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(t)}})),p(this,"handleDragStop",(e=>{if(!this.dragging)return;const t=(0,s.getControlPosition)(e,this.touchIdentifier,this);if(null==t)return;let{x:n,y:r}=t;if(Array.isArray(this.props.grid)){let e=n-this.lastX||0,t=r-this.lastY||0;[e,t]=(0,s.snapToGrid)(this.props.grid,e,t),n=this.lastX+e,r=this.lastY+t}const i=(0,s.createCoreData)(this,n,r);if(!1===this.props.onStop(e,i)||!1===this.mounted)return!1;const a=this.findDOMNode();a&&this.props.enableUserSelectHack&&(0,o.removeUserSelectStyles)(a.ownerDocument),(0,c.default)("DraggableCore: handleDragStop: %j",i),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,a&&((0,c.default)("DraggableCore: Removing handlers"),(0,o.removeEvent)(a.ownerDocument,g.move,this.handleDrag),(0,o.removeEvent)(a.ownerDocument,g.stop,this.handleDragStop))})),p(this,"onMouseDown",(e=>(g=h,this.handleDragStart(e)))),p(this,"onMouseUp",(e=>(g=h,this.handleDragStop(e)))),p(this,"onTouchStart",(e=>(g=f,this.handleDragStart(e)))),p(this,"onTouchEnd",(e=>(g=f,this.handleDragStop(e))))}componentDidMount(){this.mounted=!0;const e=this.findDOMNode();e&&(0,o.addEvent)(e,f.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const e=this.findDOMNode();if(e){const{ownerDocument:t}=e;(0,o.removeEvent)(t,h.move,this.handleDrag),(0,o.removeEvent)(t,f.move,this.handleDrag),(0,o.removeEvent)(t,h.stop,this.handleDragStop),(0,o.removeEvent)(t,f.stop,this.handleDragStop),(0,o.removeEvent)(e,f.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,o.removeUserSelectStyles)(t)}}findDOMNode(){var e,t;return null!==(e=this.props)&&void 0!==e&&e.nodeRef?null===(t=this.props)||void 0===t||null===(t=t.nodeRef)||void 0===t?void 0:t.current:a.default.findDOMNode(this)}render(){return r.cloneElement(r.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}}t.default=m,p(m,"displayName","DraggableCore"),p(m,"propTypes",{allowAnyClick:i.default.bool,children:i.default.node.isRequired,disabled:i.default.bool,enableUserSelectHack:i.default.bool,offsetParent:function(e,t){if(e[t]&&1!==e[t].nodeType)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:i.default.arrayOf(i.default.number),handle:i.default.string,cancel:i.default.string,nodeRef:i.default.object,onStart:i.default.func,onDrag:i.default.func,onStop:i.default.func,onMouseDown:i.default.func,scale:i.default.number,className:l.dontSetMe,style:l.dontSetMe,transform:l.dontSetMe}),p(m,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1})},230:(e,t,n)=>{"use strict";const{default:r,DraggableCore:i}=n(111);e.exports=r,e.exports.default=r,e.exports.DraggableCore=i},837:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addClassName=c,t.addEvent=function(e,t,n,r){if(!e)return;const i={capture:!0,...r};e.addEventListener?e.addEventListener(t,n,i):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n},t.addUserSelectStyles=function(e){if(!e)return;let t=e.getElementById("react-draggable-style-el");t||(t=e.createElement("style"),t.type="text/css",t.id="react-draggable-style-el",t.innerHTML=".react-draggable-transparent-selection *::-moz-selection {all: inherit;}\n",t.innerHTML+=".react-draggable-transparent-selection *::selection {all: inherit;}\n",e.getElementsByTagName("head")[0].appendChild(t)),e.body&&c(e.body,"react-draggable-transparent-selection")},t.createCSSTransform=function(e,t){const n=l(e,t,"px");return{[(0,i.browserPrefixToKey)("transform",i.default)]:n}},t.createSVGTransform=function(e,t){return l(e,t,"")},t.getTouch=function(e,t){return e.targetTouches&&(0,r.findInArray)(e.targetTouches,(e=>t===e.identifier))||e.changedTouches&&(0,r.findInArray)(e.changedTouches,(e=>t===e.identifier))},t.getTouchIdentifier=function(e){return e.targetTouches&&e.targetTouches[0]?e.targetTouches[0].identifier:e.changedTouches&&e.changedTouches[0]?e.changedTouches[0].identifier:void 0},t.getTranslation=l,t.innerHeight=function(e){let t=e.clientHeight;const n=e.ownerDocument.defaultView.getComputedStyle(e);return t-=(0,r.int)(n.paddingTop),t-=(0,r.int)(n.paddingBottom),t},t.innerWidth=function(e){let t=e.clientWidth;const n=e.ownerDocument.defaultView.getComputedStyle(e);return t-=(0,r.int)(n.paddingLeft),t-=(0,r.int)(n.paddingRight),t},t.matchesSelector=s,t.matchesSelectorAndParentsTo=function(e,t,n){let r=e;do{if(s(r,t))return!0;if(r===n)return!1;r=r.parentNode}while(r);return!1},t.offsetXYFromParent=function(e,t,n){const r=t===t.ownerDocument.body?{left:0,top:0}:t.getBoundingClientRect();return{x:(e.clientX+t.scrollLeft-r.left)/n,y:(e.clientY+t.scrollTop-r.top)/n}},t.outerHeight=function(e){let t=e.clientHeight;const n=e.ownerDocument.defaultView.getComputedStyle(e);return t+=(0,r.int)(n.borderTopWidth),t+=(0,r.int)(n.borderBottomWidth),t},t.outerWidth=function(e){let t=e.clientWidth;const n=e.ownerDocument.defaultView.getComputedStyle(e);return t+=(0,r.int)(n.borderLeftWidth),t+=(0,r.int)(n.borderRightWidth),t},t.removeClassName=u,t.removeEvent=function(e,t,n,r){if(!e)return;const i={capture:!0,...r};e.removeEventListener?e.removeEventListener(t,n,i):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null},t.removeUserSelectStyles=function(e){if(e)try{if(e.body&&u(e.body,"react-draggable-transparent-selection"),e.selection)e.selection.empty();else{const t=(e.defaultView||window).getSelection();t&&"Caret"!==t.type&&t.removeAllRanges()}}catch(e){}};var r=n(732),i=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(n(350));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}let o="";function s(e,t){return o||(o=(0,r.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],(function(t){return(0,r.isFunction)(e[t])}))),!!(0,r.isFunction)(e[o])&&e[o](t)}function l(e,t,n){let{x:r,y:i}=e,a="translate(".concat(r).concat(n,",").concat(i).concat(n,")");if(t){const e="".concat("string"==typeof t.x?t.x:t.x+n),r="".concat("string"==typeof t.y?t.y:t.y+n);a="translate(".concat(e,", ").concat(r,")")+a}return a}function c(e,t){e.classList?e.classList.add(t):e.className.match(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)")))||(e.className+=" ".concat(t))}function u(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)"),"g"),"")}},350:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.browserPrefixToKey=i,t.browserPrefixToStyle=function(e,t){return t?"-".concat(t.toLowerCase(),"-").concat(e):e},t.default=void 0,t.getPrefix=r;const n=["Moz","Webkit","O","ms"];function r(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"transform";if("undefined"==typeof window)return"";const r=null===(e=window.document)||void 0===e||null===(e=e.documentElement)||void 0===e?void 0:e.style;if(!r)return"";if(t in r)return"";for(let e=0;e<n.length;e++)if(i(t,n[e])in r)return n[e];return""}function i(e,t){return t?"".concat(t).concat(function(e){let t="",n=!0;for(let r=0;r<e.length;r++)n?(t+=e[r].toUpperCase(),n=!1):"-"===e[r]?n=!0:t+=e[r];return t}(e)):e}t.default=r()},988:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){}},402:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canDragX=function(e){return"both"===e.props.axis||"x"===e.props.axis},t.canDragY=function(e){return"both"===e.props.axis||"y"===e.props.axis},t.createCoreData=function(e,t,n){const i=!(0,r.isNum)(e.lastX),o=a(e);return i?{node:o,deltaX:0,deltaY:0,lastX:t,lastY:n,x:t,y:n}:{node:o,deltaX:t-e.lastX,deltaY:n-e.lastY,lastX:e.lastX,lastY:e.lastY,x:t,y:n}},t.createDraggableData=function(e,t){const n=e.props.scale;return{node:t.node,x:e.state.x+t.deltaX/n,y:e.state.y+t.deltaY/n,deltaX:t.deltaX/n,deltaY:t.deltaY/n,lastX:e.state.x,lastY:e.state.y}},t.getBoundPosition=function(e,t,n){if(!e.props.bounds)return[t,n];let{bounds:o}=e.props;o="string"==typeof o?o:function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}}(o);const s=a(e);if("string"==typeof o){const{ownerDocument:e}=s,t=e.defaultView;let n;if(n="parent"===o?s.parentNode:e.querySelector(o),!(n instanceof t.HTMLElement))throw new Error('Bounds selector "'+o+'" could not find an element.');const a=n,l=t.getComputedStyle(s),c=t.getComputedStyle(a);o={left:-s.offsetLeft+(0,r.int)(c.paddingLeft)+(0,r.int)(l.marginLeft),top:-s.offsetTop+(0,r.int)(c.paddingTop)+(0,r.int)(l.marginTop),right:(0,i.innerWidth)(a)-(0,i.outerWidth)(s)-s.offsetLeft+(0,r.int)(c.paddingRight)-(0,r.int)(l.marginRight),bottom:(0,i.innerHeight)(a)-(0,i.outerHeight)(s)-s.offsetTop+(0,r.int)(c.paddingBottom)-(0,r.int)(l.marginBottom)}}return(0,r.isNum)(o.right)&&(t=Math.min(t,o.right)),(0,r.isNum)(o.bottom)&&(n=Math.min(n,o.bottom)),(0,r.isNum)(o.left)&&(t=Math.max(t,o.left)),(0,r.isNum)(o.top)&&(n=Math.max(n,o.top)),[t,n]},t.getControlPosition=function(e,t,n){const r="number"==typeof t?(0,i.getTouch)(e,t):null;if("number"==typeof t&&!r)return null;const o=a(n),s=n.props.offsetParent||o.offsetParent||o.ownerDocument.body;return(0,i.offsetXYFromParent)(r||e,s,n.props.scale)},t.snapToGrid=function(e,t,n){return[Math.round(t/e[0])*e[0],Math.round(n/e[1])*e[1]]};var r=n(732),i=n(837);function a(e){const t=e.findDOMNode();if(!t)throw new Error("<DraggableCore>: Unmounted during event!");return t}},732:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dontSetMe=function(e,t,n){if(e[t])return new Error("Invalid prop ".concat(t," passed to ").concat(n," - do not set this, set it on the child."))},t.findInArray=function(e,t){for(let n=0,r=e.length;n<r;n++)if(t.apply(t,[e[n],n,e]))return e[n]},t.int=function(e){return parseInt(e,10)},t.isFunction=function(e){return"function"==typeof e||"[object Function]"===Object.prototype.toString.call(e)},t.isNum=function(e){return"number"==typeof e&&!isNaN(e)}},262:(e,t,n)=>{"use strict";function r(e){var t,n,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=r(e[t]))&&(i&&(i+=" "),i+=n);else for(t in e)e[t]&&(i&&(i+=" "),i+=t);return i}function i(){for(var e,t,n=0,i="";n<arguments.length;)(e=arguments[n++])&&(t=r(e))&&(i&&(i+=" "),i+=t);return i}n.r(t),n.d(t,{clsx:()=>i,default:()=>a});const a=i},100:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=p(n(959)),a=p(n(688)),o=n(230),s=n(936),l=n(414),c=n(906),u=n(222),d=p(n(256));function p(e){return e&&e.__esModule?e:{default:e}}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t){return m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},m(e,t)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(f,e);var t,n,a,u,p=(a=f,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=v(a);if(u){var n=v(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return b(e)}(this,e)});function f(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return y(b(e=p.call.apply(p,[this].concat(n))),"state",{resizing:null,dragging:null,className:""}),y(b(e),"elementRef",i.default.createRef()),y(b(e),"onDragStart",(function(t,n){var r=n.node,i=e.props,a=i.onDragStart,o=i.transformScale;if(a){var s={top:0,left:0},l=r.offsetParent;if(l){var u=l.getBoundingClientRect(),d=r.getBoundingClientRect(),p=d.left/o,f=u.left/o,h=d.top/o,g=u.top/o;s.left=p-f+l.scrollLeft,s.top=h-g+l.scrollTop,e.setState({dragging:s});var m=(0,c.calcXY)(e.getPositionParams(),s.top,s.left,e.props.w,e.props.h),v=m.x,y=m.y;return a.call(b(e),e.props.i,v,y,{e:t,node:r,newPosition:s})}}})),y(b(e),"onDrag",(function(t,n){var r=n.node,i=n.deltaX,a=n.deltaY,o=e.props.onDrag;if(o){if(!e.state.dragging)throw new Error("onDrag called before onDragStart.");var s=e.state.dragging.top+a,l=e.state.dragging.left+i,u=e.props,d=u.isBounded,p=u.i,f=u.w,h=u.h,g=u.containerWidth,m=e.getPositionParams();if(d){var v=r.offsetParent;if(v){var y=e.props,O=y.margin,w=y.rowHeight,S=v.clientHeight-(0,c.calcGridItemWHPx)(h,w,O[1]);s=(0,c.clamp)(s,0,S);var x=(0,c.calcGridColWidth)(m),_=g-(0,c.calcGridItemWHPx)(f,x,O[0]);l=(0,c.clamp)(l,0,_)}}var P={top:s,left:l};e.setState({dragging:P});var E=(0,c.calcXY)(m,s,l,f,h),C=E.x,k=E.y;return o.call(b(e),p,C,k,{e:t,node:r,newPosition:P})}})),y(b(e),"onDragStop",(function(t,n){var r=n.node,i=e.props.onDragStop;if(i){if(!e.state.dragging)throw new Error("onDragEnd called before onDragStart.");var a=e.props,o=a.w,s=a.h,l=a.i,u=e.state.dragging,d=u.left,p=u.top,f={top:p,left:d};e.setState({dragging:null});var h=(0,c.calcXY)(e.getPositionParams(),p,d,o,s),g=h.x,m=h.y;return i.call(b(e),l,g,m,{e:t,node:r,newPosition:f})}})),y(b(e),"onResizeStop",(function(t,n){e.onResizeHandler(t,n,"onResizeStop")})),y(b(e),"onResizeStart",(function(t,n){e.onResizeHandler(t,n,"onResizeStart")})),y(b(e),"onResize",(function(t,n){e.onResizeHandler(t,n,"onResize")})),e}return t=f,n=[{key:"shouldComponentUpdate",value:function(e,t){if(this.props.children!==e.children)return!0;if(this.props.droppingPosition!==e.droppingPosition)return!0;var n=(0,c.calcGridItemPosition)(this.getPositionParams(this.props),this.props.x,this.props.y,this.props.w,this.props.h,this.state),r=(0,c.calcGridItemPosition)(this.getPositionParams(e),e.x,e.y,e.w,e.h,t);return!(0,l.fastPositionEqual)(n,r)||this.props.useCSSTransforms!==e.useCSSTransforms}},{key:"componentDidMount",value:function(){this.moveDroppingItem({})}},{key:"componentDidUpdate",value:function(e){this.moveDroppingItem(e)}},{key:"moveDroppingItem",value:function(e){var t=this.props.droppingPosition;if(t){var n=this.elementRef.current;if(n){var r=e.droppingPosition||{left:0,top:0},i=this.state.dragging,a=i&&t.left!==r.left||t.top!==r.top;if(i){if(a){var o=t.left-i.left,s=t.top-i.top;this.onDrag(t.e,{node:n,deltaX:o,deltaY:s})}}else this.onDragStart(t.e,{node:n,deltaX:t.left,deltaY:t.top})}}}},{key:"getPositionParams",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;return{cols:e.cols,containerPadding:e.containerPadding,containerWidth:e.containerWidth,margin:e.margin,maxRows:e.maxRows,rowHeight:e.rowHeight}}},{key:"createStyle",value:function(e){var t,n=this.props,r=n.usePercentages,i=n.containerWidth;return n.useCSSTransforms?t=(0,l.setTransform)(e):(t=(0,l.setTopLeft)(e),r&&(t.left=(0,l.perc)(e.left/i),t.width=(0,l.perc)(e.width/i))),t}},{key:"mixinDraggable",value:function(e,t){return i.default.createElement(o.DraggableCore,{disabled:!t,onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop,handle:this.props.handle,cancel:".react-resizable-handle"+(this.props.cancel?","+this.props.cancel:""),scale:this.props.transformScale,nodeRef:this.elementRef},e)}},{key:"mixinResizable",value:function(e,t,n){var r=this.props,a=r.cols,o=r.x,l=r.minW,u=r.minH,d=r.maxW,p=r.maxH,f=r.transformScale,h=r.resizeHandles,g=r.resizeHandle,m=this.getPositionParams(),b=(0,c.calcGridItemPosition)(m,0,0,a-o,0).width,v=(0,c.calcGridItemPosition)(m,0,0,l,u),y=(0,c.calcGridItemPosition)(m,0,0,d,p),O=[v.width,v.height],w=[Math.min(y.width,b),Math.min(y.height,1/0)];return i.default.createElement(s.Resizable,{draggableOpts:{disabled:!n},className:n?void 0:"react-resizable-hide",width:t.width,height:t.height,minConstraints:O,maxConstraints:w,onResizeStop:this.onResizeStop,onResizeStart:this.onResizeStart,onResize:this.onResize,transformScale:f,resizeHandles:h,handle:g},e)}},{key:"onResizeHandler",value:function(e,t,n){var r=t.node,i=t.size,a=this.props[n];if(a){var o=this.props,s=o.cols,l=o.x,u=o.y,d=o.i,p=o.maxH,f=o.minH,h=this.props,g=h.minW,m=h.maxW,b=(0,c.calcWH)(this.getPositionParams(),i.width,i.height,l,u),v=b.w,y=b.h;g=Math.max(g,1),m=Math.min(m,s-l),v=(0,c.clamp)(v,g,m),y=(0,c.clamp)(y,f,p),this.setState({resizing:"onResizeStop"===n?null:i}),a.call(this,d,v,y,{e,node:r,size:i})}}},{key:"render",value:function(){var e=this.props,t=e.x,n=e.y,r=e.w,a=e.h,o=e.isDraggable,s=e.isResizable,l=e.droppingPosition,u=e.useCSSTransforms,p=(0,c.calcGridItemPosition)(this.getPositionParams(),t,n,r,a,this.state),f=i.default.Children.only(this.props.children),g=i.default.cloneElement(f,{ref:this.elementRef,className:(0,d.default)("react-grid-item",f.props.className,this.props.className,{static:this.props.static,resizing:Boolean(this.state.resizing),"react-draggable":o,"react-draggable-dragging":Boolean(this.state.dragging),dropping:Boolean(l),cssTransforms:u}),style:h(h(h({},this.props.style),f.props.style),this.createStyle(p))});return g=this.mixinResizable(g,p,s),this.mixinDraggable(g,o)}}],n&&g(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(i.default.Component);t.default=O,y(O,"propTypes",{children:a.default.element,cols:a.default.number.isRequired,containerWidth:a.default.number.isRequired,rowHeight:a.default.number.isRequired,margin:a.default.array.isRequired,maxRows:a.default.number.isRequired,containerPadding:a.default.array.isRequired,x:a.default.number.isRequired,y:a.default.number.isRequired,w:a.default.number.isRequired,h:a.default.number.isRequired,minW:function(e,t){var n=e[t];return"number"!=typeof n?new Error("minWidth not Number"):n>e.w||n>e.maxW?new Error("minWidth larger than item width/maxWidth"):void 0},maxW:function(e,t){var n=e[t];return"number"!=typeof n?new Error("maxWidth not Number"):n<e.w||n<e.minW?new Error("maxWidth smaller than item width/minWidth"):void 0},minH:function(e,t){var n=e[t];return"number"!=typeof n?new Error("minHeight not Number"):n>e.h||n>e.maxH?new Error("minHeight larger than item height/maxHeight"):void 0},maxH:function(e,t){var n=e[t];return"number"!=typeof n?new Error("maxHeight not Number"):n<e.h||n<e.minH?new Error("maxHeight smaller than item height/minHeight"):void 0},i:a.default.string.isRequired,resizeHandles:u.resizeHandleAxesType,resizeHandle:u.resizeHandleType,onDragStop:a.default.func,onDragStart:a.default.func,onDrag:a.default.func,onResizeStop:a.default.func,onResizeStart:a.default.func,onResize:a.default.func,isDraggable:a.default.bool.isRequired,isResizable:a.default.bool.isRequired,isBounded:a.default.bool.isRequired,static:a.default.bool,useCSSTransforms:a.default.bool.isRequired,transformScale:a.default.number,className:a.default.string,handle:a.default.string,cancel:a.default.string,droppingPosition:a.default.shape({e:a.default.object.isRequired,left:a.default.number.isRequired,top:a.default.number.isRequired})}),y(O,"defaultProps",{className:"",cancel:"",handle:"",minH:1,minW:1,maxH:1/0,maxW:1/0,transformScale:1})},482:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=p(t);if(n&&n.has(e))return n.get(e);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=e[o]}return i.default=e,n&&n.set(e,i),i}(n(959)),a=d(n(842)),o=d(n(256)),s=n(414),l=n(906),c=d(n(100)),u=d(n(222));function d(e){return e&&e.__esModule?e:{default:e}}function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(p=function(e){return e?n:t})(e)}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t){return v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},v(e,t)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e){return O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},O(e)}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S="react-grid-layout",x=!1;try{x=/firefox/i.test(navigator.userAgent)}catch(e){}var _=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(_,e);var t,n,u,d,p,f=(d=_,p=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=O(d);if(p){var n=O(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return y(e)}(this,e)});function _(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,_);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return w(y(e=f.call.apply(f,[this].concat(n))),"state",{activeDrag:null,layout:(0,s.synchronizeLayoutWithChildren)(e.props.layout,e.props.children,e.props.cols,(0,s.compactType)(e.props),e.props.allowOverlap),mounted:!1,oldDragItem:null,oldLayout:null,oldResizeItem:null,droppingDOMNode:null,children:[]}),w(y(e),"dragEnterCounter",0),w(y(e),"onDragStart",(function(t,n,r,i){var a=i.e,o=i.node,l=e.state.layout,c=(0,s.getLayoutItem)(l,t);if(c)return e.setState({oldDragItem:(0,s.cloneLayoutItem)(c),oldLayout:l}),e.props.onDragStart(l,c,c,null,a,o)})),w(y(e),"onDrag",(function(t,n,r,i){var a=i.e,o=i.node,l=e.state.oldDragItem,c=e.state.layout,u=e.props,d=u.cols,p=u.allowOverlap,f=u.preventCollision,h=(0,s.getLayoutItem)(c,t);if(h){var g={w:h.w,h:h.h,x:h.x,y:h.y,placeholder:!0,i:t};c=(0,s.moveElement)(c,h,n,r,!0,f,(0,s.compactType)(e.props),d,p),e.props.onDrag(c,l,h,g,a,o),e.setState({layout:p?c:(0,s.compact)(c,(0,s.compactType)(e.props),d),activeDrag:g})}})),w(y(e),"onDragStop",(function(t,n,r,i){var a=i.e,o=i.node;if(e.state.activeDrag){var l=e.state.oldDragItem,c=e.state.layout,u=e.props,d=u.cols,p=u.preventCollision,f=u.allowOverlap,h=(0,s.getLayoutItem)(c,t);if(h){c=(0,s.moveElement)(c,h,n,r,!0,p,(0,s.compactType)(e.props),d,f),e.props.onDragStop(c,l,h,null,a,o);var g=f?c:(0,s.compact)(c,(0,s.compactType)(e.props),d),m=e.state.oldLayout;e.setState({activeDrag:null,layout:g,oldDragItem:null,oldLayout:null}),e.onLayoutMaybeChanged(g,m)}}})),w(y(e),"onResizeStart",(function(t,n,r,i){var a=i.e,o=i.node,l=e.state.layout,c=(0,s.getLayoutItem)(l,t);c&&(e.setState({oldResizeItem:(0,s.cloneLayoutItem)(c),oldLayout:e.state.layout}),e.props.onResizeStart(l,c,c,null,a,o))})),w(y(e),"onResize",(function(t,n,r,i){var a=i.e,o=i.node,l=e.state,c=l.layout,u=l.oldResizeItem,d=e.props,p=d.cols,f=d.preventCollision,m=d.allowOverlap,b=(0,s.withLayoutItem)(c,t,(function(e){var t;if(f&&!m){var i=(0,s.getAllCollisions)(c,h(h({},e),{},{w:n,h:r})).filter((function(t){return t.i!==e.i}));if(t=i.length>0){var a=1/0,o=1/0;i.forEach((function(t){t.x>e.x&&(a=Math.min(a,t.x)),t.y>e.y&&(o=Math.min(o,t.y))})),Number.isFinite(a)&&(e.w=a-e.x),Number.isFinite(o)&&(e.h=o-e.y)}}return t||(e.w=n,e.h=r),e})),v=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(e){s=!0,i=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}}(e,t)||g(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(b,2),y=v[0],O=v[1];if(O){var w={w:O.w,h:O.h,x:O.x,y:O.y,static:!0,i:t};e.props.onResize(y,u,O,w,a,o),e.setState({layout:m?y:(0,s.compact)(y,(0,s.compactType)(e.props),p),activeDrag:w})}})),w(y(e),"onResizeStop",(function(t,n,r,i){var a=i.e,o=i.node,l=e.state,c=l.layout,u=l.oldResizeItem,d=e.props,p=d.cols,f=d.allowOverlap,h=(0,s.getLayoutItem)(c,t);e.props.onResizeStop(c,u,h,null,a,o);var g=f?c:(0,s.compact)(c,(0,s.compactType)(e.props),p),m=e.state.oldLayout;e.setState({activeDrag:null,layout:g,oldResizeItem:null,oldLayout:null}),e.onLayoutMaybeChanged(g,m)})),w(y(e),"onDragOver",(function(t){var n;if(t.preventDefault(),t.stopPropagation(),x&&(null===(n=t.nativeEvent.target)||void 0===n||!n.classList.contains(S)))return!1;var r=e.props,a=r.droppingItem,o=r.onDropDragOver,s=r.margin,c=r.cols,u=r.rowHeight,d=r.maxRows,p=r.width,f=r.containerPadding,b=r.transformScale,v=null==o?void 0:o(t);if(!1===v)return e.state.droppingDOMNode&&e.removeDroppingPlaceholder(),!1;var y,O=h(h({},a),v),w=e.state.layout,_=t.nativeEvent,P=_.layerX,E=_.layerY,C={left:P/b,top:E/b,e:t};if(e.state.droppingDOMNode){if(e.state.droppingPosition){var k=e.state.droppingPosition,D=k.left,T=k.top;(D!=P||T!=E)&&e.setState({droppingPosition:C})}}else{var R={cols:c,margin:s,maxRows:d,rowHeight:u,containerWidth:p,containerPadding:f||s},I=(0,l.calcXY)(R,E,P,O.w,O.h);e.setState({droppingDOMNode:i.createElement("div",{key:O.i}),droppingPosition:C,layout:[].concat((y=w,function(e){if(Array.isArray(e))return m(e)}(y)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(y)||g(y)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[h(h({},O),{},{x:I.x,y:I.y,static:!1,isDraggable:!0})])})}})),w(y(e),"removeDroppingPlaceholder",(function(){var t=e.props,n=t.droppingItem,r=t.cols,i=e.state.layout,a=(0,s.compact)(i.filter((function(e){return e.i!==n.i})),(0,s.compactType)(e.props),r);e.setState({layout:a,droppingDOMNode:null,activeDrag:null,droppingPosition:void 0})})),w(y(e),"onDragLeave",(function(t){t.preventDefault(),t.stopPropagation(),e.dragEnterCounter--,0===e.dragEnterCounter&&e.removeDroppingPlaceholder()})),w(y(e),"onDragEnter",(function(t){t.preventDefault(),t.stopPropagation(),e.dragEnterCounter++})),w(y(e),"onDrop",(function(t){t.preventDefault(),t.stopPropagation();var n=e.props.droppingItem,r=e.state.layout,i=r.find((function(e){return e.i===n.i}));e.dragEnterCounter=0,e.removeDroppingPlaceholder(),e.props.onDrop(r,i,t)})),e}return t=_,u=[{key:"getDerivedStateFromProps",value:function(e,t){var n;return t.activeDrag?null:((0,a.default)(e.layout,t.propsLayout)&&e.compactType===t.compactType?(0,s.childrenEqual)(e.children,t.children)||(n=t.layout):n=e.layout,n?{layout:(0,s.synchronizeLayoutWithChildren)(n,e.children,e.cols,(0,s.compactType)(e),e.allowOverlap),compactType:e.compactType,children:e.children,propsLayout:e.layout}:null)}}],(n=[{key:"componentDidMount",value:function(){this.setState({mounted:!0}),this.onLayoutMaybeChanged(this.state.layout,this.props.layout)}},{key:"shouldComponentUpdate",value:function(e,t){return this.props.children!==e.children||!(0,s.fastRGLPropsEqual)(this.props,e,a.default)||this.state.activeDrag!==t.activeDrag||this.state.mounted!==t.mounted||this.state.droppingPosition!==t.droppingPosition}},{key:"componentDidUpdate",value:function(e,t){if(!this.state.activeDrag){var n=this.state.layout,r=t.layout;this.onLayoutMaybeChanged(n,r)}}},{key:"containerHeight",value:function(){if(this.props.autoSize){var e=(0,s.bottom)(this.state.layout),t=this.props.containerPadding?this.props.containerPadding[1]:this.props.margin[1];return e*this.props.rowHeight+(e-1)*this.props.margin[1]+2*t+"px"}}},{key:"onLayoutMaybeChanged",value:function(e,t){t||(t=this.state.layout),(0,a.default)(t,e)||this.props.onLayoutChange(e)}},{key:"placeholder",value:function(){var e=this.state.activeDrag;if(!e)return null;var t=this.props,n=t.width,r=t.cols,a=t.margin,o=t.containerPadding,s=t.rowHeight,l=t.maxRows,u=t.useCSSTransforms,d=t.transformScale;return i.createElement(c.default,{w:e.w,h:e.h,x:e.x,y:e.y,i:e.i,className:"react-grid-placeholder",containerWidth:n,cols:r,margin:a,containerPadding:o||a,maxRows:l,rowHeight:s,isDraggable:!1,isResizable:!1,isBounded:!1,useCSSTransforms:u,transformScale:d},i.createElement("div",null))}},{key:"processGridItem",value:function(e,t){if(e&&e.key){var n=(0,s.getLayoutItem)(this.state.layout,String(e.key));if(!n)return null;var r=this.props,a=r.width,o=r.cols,l=r.margin,u=r.containerPadding,d=r.rowHeight,p=r.maxRows,f=r.isDraggable,h=r.isResizable,g=r.isBounded,m=r.useCSSTransforms,b=r.transformScale,v=r.draggableCancel,y=r.draggableHandle,O=r.resizeHandles,w=r.resizeHandle,S=this.state,x=S.mounted,_=S.droppingPosition,P="boolean"==typeof n.isDraggable?n.isDraggable:!n.static&&f,E="boolean"==typeof n.isResizable?n.isResizable:!n.static&&h,C=n.resizeHandles||O,k=P&&g&&!1!==n.isBounded;return i.createElement(c.default,{containerWidth:a,cols:o,margin:l,containerPadding:u||l,maxRows:p,rowHeight:d,cancel:v,handle:y,onDragStop:this.onDragStop,onDragStart:this.onDragStart,onDrag:this.onDrag,onResizeStart:this.onResizeStart,onResize:this.onResize,onResizeStop:this.onResizeStop,isDraggable:P,isResizable:E,isBounded:k,useCSSTransforms:m&&x,usePercentages:!x,transformScale:b,w:n.w,h:n.h,x:n.x,y:n.y,i:n.i,minH:n.minH,minW:n.minW,maxH:n.maxH,maxW:n.maxW,static:n.static,droppingPosition:t?_:void 0,resizeHandles:C,resizeHandle:w},e)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.style,a=t.isDroppable,l=t.innerRef,c=(0,o.default)(S,n),u=h({height:this.containerHeight()},r);return i.createElement("div",{ref:l,className:c,style:u,onDrop:a?this.onDrop:s.noop,onDragLeave:a?this.onDragLeave:s.noop,onDragEnter:a?this.onDragEnter:s.noop,onDragOver:a?this.onDragOver:s.noop},i.Children.map(this.props.children,(function(t){return e.processGridItem(t)})),a&&this.state.droppingDOMNode&&this.processGridItem(this.state.droppingDOMNode,!0),this.placeholder())}}])&&b(t.prototype,n),u&&b(t,u),Object.defineProperty(t,"prototype",{writable:!1}),_}(i.Component);t.default=_,w(_,"displayName","ReactGridLayout"),w(_,"propTypes",u.default),w(_,"defaultProps",{autoSize:!0,cols:12,className:"",style:{},draggableHandle:"",draggableCancel:"",containerPadding:null,rowHeight:150,maxRows:1/0,layout:[],margin:[10,10],isBounded:!1,isDraggable:!0,isResizable:!0,allowOverlap:!1,isDroppable:!1,useCSSTransforms:!0,transformScale:1,verticalCompact:!0,compactType:"vertical",preventCollision:!1,droppingItem:{i:"__dropping-elem__",h:1,w:1},resizeHandles:["se"],onLayoutChange:s.noop,onDragStart:s.noop,onDrag:s.noop,onDragStop:s.noop,onResizeStart:s.noop,onResize:s.noop,onResizeStop:s.noop,onDrop:s.noop,onDropDragOver:s.noop})},222:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resizeHandleType=t.resizeHandleAxesType=t.default=void 0;var r=a(n(688)),i=a(n(959));function a(e){return e&&e.__esModule?e:{default:e}}var o=r.default.arrayOf(r.default.oneOf(["s","w","e","n","sw","nw","se","ne"]));t.resizeHandleAxesType=o;var s=r.default.oneOfType([r.default.node,r.default.func]);t.resizeHandleType=s;var l={className:r.default.string,style:r.default.object,width:r.default.number,autoSize:r.default.bool,cols:r.default.number,draggableCancel:r.default.string,draggableHandle:r.default.string,verticalCompact:function(e){e.verticalCompact},compactType:r.default.oneOf(["vertical","horizontal"]),layout:function(e){var t=e.layout;void 0!==t&&n(414).validateLayout(t,"layout")},margin:r.default.arrayOf(r.default.number),containerPadding:r.default.arrayOf(r.default.number),rowHeight:r.default.number,maxRows:r.default.number,isBounded:r.default.bool,isDraggable:r.default.bool,isResizable:r.default.bool,allowOverlap:r.default.bool,preventCollision:r.default.bool,useCSSTransforms:r.default.bool,transformScale:r.default.number,isDroppable:r.default.bool,resizeHandles:o,resizeHandle:s,onLayoutChange:r.default.func,onDragStart:r.default.func,onDrag:r.default.func,onDragStop:r.default.func,onResizeStart:r.default.func,onResize:r.default.func,onResizeStop:r.default.func,onDrop:r.default.func,droppingItem:r.default.shape({i:r.default.string.isRequired,w:r.default.number.isRequired,h:r.default.number.isRequired}),children:function(e,t){var n=e[t],r={};i.default.Children.forEach(n,(function(e){if(null!=(null==e?void 0:e.key)){if(r[e.key])throw new Error('Duplicate child key "'+e.key+'" found! This will cause problems in ReactGridLayout.');r[e.key]=!0}}))},innerRef:r.default.any};t.default=l},636:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}t.default=void 0;var i=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=p(t);if(n&&n.has(e))return n.get(e);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=e[o]}return i.default=e,n&&n.set(e,i),i}(n(959)),a=d(n(688)),o=d(n(842)),s=n(414),l=n(544),c=d(n(482)),u=["breakpoint","breakpoints","cols","layouts","margin","containerPadding","onBreakpointChange","onLayoutChange","onWidthChange"];function d(e){return e&&e.__esModule?e:{default:e}}function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(p=function(e){return e?n:t})(e)}function f(){return f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f.apply(this,arguments)}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e,t){return b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},b(e,t)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=function(e){return Object.prototype.toString.call(e)};function S(e,t){return null==e?null:Array.isArray(e)?e:e[t]}var x=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(w,e);var t,n,a,d,p,h=(d=w,p=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=y(d);if(p){var n=y(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return v(e)}(this,e)});function w(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,w);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return O(v(e=h.call.apply(h,[this].concat(n))),"state",e.generateInitialState()),O(v(e),"onLayoutChange",(function(t){e.props.onLayoutChange(t,g(g({},e.props.layouts),{},O({},e.state.breakpoint,t)))})),e}return t=w,a=[{key:"getDerivedStateFromProps",value:function(e,t){if(!(0,o.default)(e.layouts,t.layouts)){var n=t.breakpoint,r=t.cols;return{layout:(0,l.findOrGenerateResponsiveLayout)(e.layouts,e.breakpoints,n,n,r,e.compactType),layouts:e.layouts}}return null}}],(n=[{key:"generateInitialState",value:function(){var e=this.props,t=e.width,n=e.breakpoints,r=e.layouts,i=e.cols,a=(0,l.getBreakpointFromWidth)(n,t),o=(0,l.getColsFromBreakpoint)(a,i),s=!1===this.props.verticalCompact?null:this.props.compactType;return{layout:(0,l.findOrGenerateResponsiveLayout)(r,n,a,a,o,s),breakpoint:a,cols:o}}},{key:"componentDidUpdate",value:function(e){this.props.width==e.width&&this.props.breakpoint===e.breakpoint&&(0,o.default)(this.props.breakpoints,e.breakpoints)&&(0,o.default)(this.props.cols,e.cols)||this.onWidthChange(e)}},{key:"onWidthChange",value:function(e){var t=this.props,n=t.breakpoints,r=t.cols,i=t.layouts,a=t.compactType,o=this.props.breakpoint||(0,l.getBreakpointFromWidth)(this.props.breakpoints,this.props.width),c=this.state.breakpoint,u=(0,l.getColsFromBreakpoint)(o,r),d=g({},i);if(c!==o||e.breakpoints!==n||e.cols!==r){c in d||(d[c]=(0,s.cloneLayout)(this.state.layout));var p=(0,l.findOrGenerateResponsiveLayout)(d,n,o,c,u,a);p=(0,s.synchronizeLayoutWithChildren)(p,this.props.children,u,a,this.props.allowOverlap),d[o]=p,this.props.onLayoutChange(p,d),this.props.onBreakpointChange(o,u),this.setState({breakpoint:o,layout:p,cols:u})}var f=S(this.props.margin,o),h=S(this.props.containerPadding,o);this.props.onWidthChange(this.props.width,f,u,h)}},{key:"render",value:function(){var e=this.props,t=(e.breakpoint,e.breakpoints,e.cols,e.layouts,e.margin),n=e.containerPadding,r=(e.onBreakpointChange,e.onLayoutChange,e.onWidthChange,function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,u));return i.createElement(c.default,f({},r,{margin:S(t,this.state.breakpoint),containerPadding:S(n,this.state.breakpoint),onLayoutChange:this.onLayoutChange,layout:this.state.layout,cols:this.state.cols}))}}])&&m(t.prototype,n),a&&m(t,a),Object.defineProperty(t,"prototype",{writable:!1}),w}(i.Component);t.default=x,O(x,"propTypes",{breakpoint:a.default.string,breakpoints:a.default.object,allowOverlap:a.default.bool,cols:a.default.object,margin:a.default.oneOfType([a.default.array,a.default.object]),containerPadding:a.default.oneOfType([a.default.array,a.default.object]),layouts:function(e,t){if("[object Object]"!==w(e[t]))throw new Error("Layout property must be an object. Received: "+w(e[t]));Object.keys(e[t]).forEach((function(t){if(!(t in e.breakpoints))throw new Error("Each key in layouts must align with a key in breakpoints.");(0,s.validateLayout)(e.layouts[t],"layouts."+t)}))},width:a.default.number.isRequired,onBreakpointChange:a.default.func,onLayoutChange:a.default.func,onWidthChange:a.default.func}),O(x,"defaultProps",{breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:10,sm:6,xs:4,xxs:2},containerPadding:{lg:null,md:null,sm:null,xs:null,xxs:null},layouts:{},margin:[10,10],allowOverlap:!1,onBreakpointChange:s.noop,onLayoutChange:s.noop,onWidthChange:s.noop})},906:(e,t)=>{"use strict";function n(e){var t=e.margin,n=e.containerPadding,r=e.containerWidth,i=e.cols;return(r-t[0]*(i-1)-2*n[0])/i}function r(e,t,n){return Number.isFinite(e)?Math.round(t*e+Math.max(0,e-1)*n):e}function i(e,t,n){return Math.max(Math.min(e,n),t)}Object.defineProperty(t,"__esModule",{value:!0}),t.calcGridColWidth=n,t.calcGridItemPosition=function(e,t,i,a,o,s){var l=e.margin,c=e.containerPadding,u=e.rowHeight,d=n(e),p={};return s&&s.resizing?(p.width=Math.round(s.resizing.width),p.height=Math.round(s.resizing.height)):(p.width=r(a,d,l[0]),p.height=r(o,u,l[1])),s&&s.dragging?(p.top=Math.round(s.dragging.top),p.left=Math.round(s.dragging.left)):(p.top=Math.round((u+l[1])*i+c[1]),p.left=Math.round((d+l[0])*t+c[0])),p},t.calcGridItemWHPx=r,t.calcWH=function(e,t,r,a,o){var s=e.margin,l=e.maxRows,c=e.cols,u=e.rowHeight,d=n(e),p=Math.round((t+s[0])/(d+s[0])),f=Math.round((r+s[1])/(u+s[1]));return{w:p=i(p,0,c-a),h:f=i(f,0,l-o)}},t.calcXY=function(e,t,r,a,o){var s=e.margin,l=e.cols,c=e.rowHeight,u=e.maxRows,d=n(e),p=Math.round((r-s[0])/(d+s[0])),f=Math.round((t-s[1])/(c+s[1]));return{x:p=i(p,0,l-a),y:f=i(f,0,u-o)}},t.clamp=i},805:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}t.default=function(e){var t;return t=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(v,t);var n,a,l,c,b=(n=v,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(n);if(a){var i=h(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}(this,e)});function v(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return g(f(e=b.call.apply(b,[this].concat(n))),"state",{width:1280}),g(f(e),"elementRef",i.createRef()),g(f(e),"mounted",!1),g(f(e),"onWindowResize",(function(){if(e.mounted){var t=e.elementRef.current;t instanceof HTMLElement&&t.offsetWidth&&e.setState({width:t.offsetWidth})}})),e}return l=v,(c=[{key:"componentDidMount",value:function(){this.mounted=!0,window.addEventListener("resize",this.onWindowResize),this.onWindowResize()}},{key:"componentWillUnmount",value:function(){this.mounted=!1,window.removeEventListener("resize",this.onWindowResize)}},{key:"render",value:function(){var t=this.props,n=t.measureBeforeMount,r=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(t,s);return n&&!this.mounted?i.createElement("div",{className:(0,o.default)(this.props.className,m),style:this.props.style,ref:this.elementRef}):i.createElement(e,u({innerRef:this.elementRef},r,this.state))}}])&&d(l.prototype,c),Object.defineProperty(l,"prototype",{writable:!1}),v}(i.Component),g(t,"defaultProps",{measureBeforeMount:!1}),g(t,"propTypes",{measureBeforeMount:a.default.bool}),t};var i=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=e[o]}return i.default=e,n&&n.set(e,i),i}(n(959)),a=l(n(688)),o=l(n(256)),s=["measureBeforeMount"];function l(e){return e&&e.__esModule?e:{default:e}}function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}function u(){return u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m="react-grid-layout"},434:e=>{e.exports=function(e,t,n){return e===t||e.className===t.className&&n(e.style,t.style)&&e.width===t.width&&e.autoSize===t.autoSize&&e.cols===t.cols&&e.draggableCancel===t.draggableCancel&&e.draggableHandle===t.draggableHandle&&n(e.verticalCompact,t.verticalCompact)&&n(e.compactType,t.compactType)&&n(e.layout,t.layout)&&n(e.margin,t.margin)&&n(e.containerPadding,t.containerPadding)&&e.rowHeight===t.rowHeight&&e.maxRows===t.maxRows&&e.isBounded===t.isBounded&&e.isDraggable===t.isDraggable&&e.isResizable===t.isResizable&&e.allowOverlap===t.allowOverlap&&e.preventCollision===t.preventCollision&&e.useCSSTransforms===t.useCSSTransforms&&e.transformScale===t.transformScale&&e.isDroppable===t.isDroppable&&n(e.resizeHandles,t.resizeHandles)&&n(e.resizeHandle,t.resizeHandle)&&e.onLayoutChange===t.onLayoutChange&&e.onDragStart===t.onDragStart&&e.onDrag===t.onDrag&&e.onDragStop===t.onDragStop&&e.onResizeStart===t.onResizeStart&&e.onResize===t.onResize&&e.onResizeStop===t.onResizeStop&&e.onDrop===t.onDrop&&n(e.droppingItem,t.droppingItem)&&n(e.innerRef,t.innerRef)}},544:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findOrGenerateResponsiveLayout=function(e,t,n,a,o,s){if(e[n])return(0,r.cloneLayout)(e[n]);for(var l=e[a],c=i(t),u=c.slice(c.indexOf(n)),d=0,p=u.length;d<p;d++){var f=u[d];if(e[f]){l=e[f];break}}return l=(0,r.cloneLayout)(l||[]),(0,r.compact)((0,r.correctBounds)(l,{cols:o}),s,o)},t.getBreakpointFromWidth=function(e,t){for(var n=i(e),r=n[0],a=1,o=n.length;a<o;a++){var s=n[a];t>e[s]&&(r=s)}return r},t.getColsFromBreakpoint=function(e,t){if(!t[e])throw new Error("ResponsiveReactGridLayout: `cols` entry for breakpoint "+e+" is missing!");return t[e]},t.sortBreakpoints=i;var r=n(414);function i(e){return Object.keys(e).sort((function(t,n){return e[t]-e[n]}))}},414:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bottom=d,t.childrenEqual=function(e,t){return(0,r.default)(i.default.Children.map(e,(function(e){return null==e?void 0:e.key})),i.default.Children.map(t,(function(e){return null==e?void 0:e.key})))},t.cloneLayout=p,t.cloneLayoutItem=h,t.collides=m,t.compact=b,t.compactItem=O,t.compactType=function(e){var t=e||{},n=t.verticalCompact,r=t.compactType;return!1===n?null:r},t.correctBounds=w,t.fastPositionEqual=function(e,t){return e.left===t.left&&e.top===t.top&&e.width===t.width&&e.height===t.height},t.fastRGLPropsEqual=void 0,t.getAllCollisions=_,t.getFirstCollision=x,t.getLayoutItem=S,t.getStatics=P,t.modifyLayout=f,t.moveElement=E,t.moveElementAwayFromCollision=C,t.noop=void 0,t.perc=function(e){return 100*e+"%"},t.setTopLeft=function(e){var t=e.top,n=e.left,r=e.width,i=e.height;return{top:"".concat(t,"px"),left:"".concat(n,"px"),width:"".concat(r,"px"),height:"".concat(i,"px"),position:"absolute"}},t.setTransform=function(e){var t=e.top,n=e.left,r=e.width,i=e.height,a="translate(".concat(n,"px,").concat(t,"px)");return{transform:a,WebkitTransform:a,MozTransform:a,msTransform:a,OTransform:a,width:"".concat(r,"px"),height:"".concat(i,"px"),position:"absolute"}},t.sortLayoutItems=k,t.sortLayoutItemsByColRow=T,t.sortLayoutItemsByRowCol=D,t.synchronizeLayoutWithChildren=function(e,t,n,r,a){e=e||[];var o=[];i.default.Children.forEach(t,(function(t){if(null!=(null==t?void 0:t.key)){var n=S(e,String(t.key));if(n)o.push(h(n));else{!c&&t.props._grid&&console.warn("`_grid` properties on children have been deprecated as of React 15.2. Please use `data-grid` or add your properties directly to the `layout`.");var r=t.props["data-grid"]||t.props._grid;r?(c||R([r],"ReactGridLayout.children"),o.push(h(s(s({},r),{},{i:t.key})))):o.push(h({w:1,h:1,x:0,y:d(o),i:String(t.key)}))}}}));var l=w(o,{cols:n});return a?l:b(l,r,n)},t.validateLayout=R,t.withLayoutItem=function(e,t,n){var r=S(e,t);return r?[e=f(e,r=n(h(r))),r]:[e,null]};var r=a(n(842)),i=a(n(959));function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=!0,u=!1;function d(e){for(var t,n=0,r=0,i=e.length;r<i;r++)(t=e[r].y+e[r].h)>n&&(n=t);return n}function p(e){for(var t=Array(e.length),n=0,r=e.length;n<r;n++)t[n]=h(e[n]);return t}function f(e,t){for(var n=Array(e.length),r=0,i=e.length;r<i;r++)t.i===e[r].i?n[r]=t:n[r]=e[r];return n}function h(e){return{w:e.w,h:e.h,x:e.x,y:e.y,i:e.i,minW:e.minW,maxW:e.maxW,minH:e.minH,maxH:e.maxH,moved:Boolean(e.moved),static:Boolean(e.static),isDraggable:e.isDraggable,isResizable:e.isResizable,resizeHandles:e.resizeHandles,isBounded:e.isBounded}}var g=n(434);function m(e,t){return!(e.i===t.i||e.x+e.w<=t.x||e.x>=t.x+t.w||e.y+e.h<=t.y||e.y>=t.y+t.h)}function b(e,t,n){for(var r=P(e),i=k(e,t),a=Array(e.length),o=0,s=i.length;o<s;o++){var l=h(i[o]);l.static||(l=O(r,l,t,n,i),r.push(l)),a[e.indexOf(i[o])]=l,l.moved=!1}return a}t.fastRGLPropsEqual=g;var v={x:"w",y:"h"};function y(e,t,n,r){var i=v[r];t[r]+=1;for(var a=e.map((function(e){return e.i})).indexOf(t.i)+1;a<e.length;a++){var o=e[a];if(!o.static){if(o.y>t.y+t.h)break;m(t,o)&&y(e,o,n+t[i],r)}}t[r]=n}function O(e,t,n,r,i){var a,o="horizontal"===n;if("vertical"===n)for(t.y=Math.min(d(e),t.y);t.y>0&&!x(e,t);)t.y--;else if(o)for(;t.x>0&&!x(e,t);)t.x--;for(;a=x(e,t);)o?y(i,t,a.x+a.w,"x"):y(i,t,a.y+a.h,"y"),o&&t.x+t.w>r&&(t.x=r-t.w,t.y++);return t.y=Math.max(t.y,0),t.x=Math.max(t.x,0),t}function w(e,t){for(var n=P(e),r=0,i=e.length;r<i;r++){var a=e[r];if(a.x+a.w>t.cols&&(a.x=t.cols-a.w),a.x<0&&(a.x=0,a.w=t.cols),a.static)for(;x(n,a);)a.y++;else n.push(a)}return e}function S(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n].i===t)return e[n]}function x(e,t){for(var n=0,r=e.length;n<r;n++)if(m(e[n],t))return e[n]}function _(e,t){return e.filter((function(e){return m(e,t)}))}function P(e){return e.filter((function(e){return e.static}))}function E(e,t,n,r,i,a,o,s,l){if(t.static&&!0!==t.isDraggable)return e;if(t.y===r&&t.x===n)return e;I("Moving element ".concat(t.i," to [").concat(String(n),",").concat(String(r),"] from [").concat(t.x,",").concat(t.y,"]"));var c=t.x,u=t.y;"number"==typeof n&&(t.x=n),"number"==typeof r&&(t.y=r),t.moved=!0;var d=k(e,o);("vertical"===o&&"number"==typeof r?u>=r:"horizontal"===o&&"number"==typeof n&&c>=n)&&(d=d.reverse());var f=_(d,t),h=f.length>0;if(h&&l)return p(e);if(h&&a)return I("Collision prevented on ".concat(t.i,", reverting.")),t.x=c,t.y=u,t.moved=!1,e;for(var g=0,m=f.length;g<m;g++){var b=f[g];I("Resolving collision between ".concat(t.i," at [").concat(t.x,",").concat(t.y,"] and ").concat(b.i," at [").concat(b.x,",").concat(b.y,"]")),b.moved||(e=b.static?C(e,b,t,i,o,s):C(e,t,b,i,o,s))}return e}function C(e,t,n,r,i,a){var o="horizontal"===i,s="horizontal"!==i,l=t.static;if(r){r=!1;var c={x:o?Math.max(t.x-n.w,0):n.x,y:s?Math.max(t.y-n.h,0):n.y,w:n.w,h:n.h,i:"-1"};if(!x(e,c))return I("Doing reverse collision on ".concat(n.i," up to [").concat(c.x,",").concat(c.y,"].")),E(e,n,o?c.x:void 0,s?c.y:void 0,r,l,i,a)}return E(e,n,o?n.x+1:void 0,s?n.y+1:void 0,r,l,i,a)}function k(e,t){return"horizontal"===t?T(e):"vertical"===t?D(e):e}function D(e){return e.slice(0).sort((function(e,t){return e.y>t.y||e.y===t.y&&e.x>t.x?1:e.y===t.y&&e.x===t.x?0:-1}))}function T(e){return e.slice(0).sort((function(e,t){return e.x>t.x||e.x===t.x&&e.y>t.y?1:-1}))}function R(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Layout",n=["x","y","w","h"];if(!Array.isArray(e))throw new Error(t+" must be an array!");for(var r=0,i=e.length;r<i;r++)for(var a=e[r],o=0;o<n.length;o++)if("number"!=typeof a[n[o]])throw new Error("ReactGridLayout: "+t+"["+r+"]."+n[o]+" must be a number!")}function I(){var e;u&&(e=console).log.apply(e,arguments)}t.noop=function(){}},548:(e,t,n)=>{e.exports=n(482).default,e.exports.utils=n(414),e.exports.Responsive=n(636).default,e.exports.Responsive.utils=n(544),e.exports.WidthProvider=n(805).default},256:(e,t,n)=>{"use strict";function r(e){var t,n,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=r(e[t]))&&(i&&(i+=" "),i+=n);else for(t in e)e[t]&&(i&&(i+=" "),i+=t);return i}function i(){for(var e,t,n=0,i="";n<arguments.length;)(e=arguments[n++])&&(t=r(e))&&(i&&(i+=" "),i+=t);return i}n.r(t),n.d(t,{clsx:()=>i,default:()=>a});const a=i},299:(e,t)=>{"use strict";var n="function"==typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,a=n?Symbol.for("react.fragment"):60107,o=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,l=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,u=n?Symbol.for("react.async_mode"):60111,d=n?Symbol.for("react.concurrent_mode"):60111,p=n?Symbol.for("react.forward_ref"):60112,f=n?Symbol.for("react.suspense"):60113,h=n?Symbol.for("react.suspense_list"):60120,g=n?Symbol.for("react.memo"):60115,m=n?Symbol.for("react.lazy"):60116,b=n?Symbol.for("react.block"):60121,v=n?Symbol.for("react.fundamental"):60117,y=n?Symbol.for("react.responder"):60118,O=n?Symbol.for("react.scope"):60119;function w(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case u:case d:case a:case s:case o:case f:return e;default:switch(e=e&&e.$$typeof){case c:case p:case m:case g:case l:return e;default:return t}}case i:return t}}}function S(e){return w(e)===d}t.AsyncMode=u,t.ConcurrentMode=d,t.ContextConsumer=c,t.ContextProvider=l,t.Element=r,t.ForwardRef=p,t.Fragment=a,t.Lazy=m,t.Memo=g,t.Portal=i,t.Profiler=s,t.StrictMode=o,t.Suspense=f,t.isAsyncMode=function(e){return S(e)||w(e)===u},t.isConcurrentMode=S,t.isContextConsumer=function(e){return w(e)===c},t.isContextProvider=function(e){return w(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return w(e)===p},t.isFragment=function(e){return w(e)===a},t.isLazy=function(e){return w(e)===m},t.isMemo=function(e){return w(e)===g},t.isPortal=function(e){return w(e)===i},t.isProfiler=function(e){return w(e)===s},t.isStrictMode=function(e){return w(e)===o},t.isSuspense=function(e){return w(e)===f},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===a||e===d||e===s||e===o||e===f||e===h||"object"==typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===g||e.$$typeof===l||e.$$typeof===c||e.$$typeof===p||e.$$typeof===v||e.$$typeof===y||e.$$typeof===O||e.$$typeof===b)},t.typeOf=w},271:(e,t,n)=>{"use strict";e.exports=n(299)},794:(e,t,n)=>{"use strict";t.__esModule=!0,t.default=void 0;var r=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}(n(959)),i=n(230),a=n(954),o=n(333),s=["children","className","draggableOpts","width","height","handle","handleSize","lockAspectRatio","axis","minConstraints","maxConstraints","onResize","onResizeStop","onResizeStart","resizeHandles","transformScale"];function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}var h=function(e){var t,n;function o(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this).handleRefs={},t.lastHandleRect=null,t.slack=null,t}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,f(t,n);var l=o.prototype;return l.componentWillUnmount=function(){this.resetData()},l.resetData=function(){this.lastHandleRect=this.slack=null},l.runConstraints=function(e,t){var n=this.props,r=n.minConstraints,i=n.maxConstraints,a=n.lockAspectRatio;if(!r&&!i&&!a)return[e,t];if(a){var o=this.props.width/this.props.height,s=e-this.props.width,l=t-this.props.height;Math.abs(s)>Math.abs(l*o)?t=e/o:e=t*o}var c=e,u=t,d=this.slack||[0,0],p=d[0],f=d[1];return e+=p,t+=f,r&&(e=Math.max(r[0],e),t=Math.max(r[1],t)),i&&(e=Math.min(i[0],e),t=Math.min(i[1],t)),this.slack=[p+(c-e),f+(u-t)],[e,t]},l.resizeHandler=function(e,t){var n=this;return function(r,i){var a=i.node,o=i.deltaX,s=i.deltaY;"onResizeStart"===e&&n.resetData();var l=("both"===n.props.axis||"x"===n.props.axis)&&"n"!==t&&"s"!==t,c=("both"===n.props.axis||"y"===n.props.axis)&&"e"!==t&&"w"!==t;if(l||c){var u=t[0],d=t[t.length-1],p=a.getBoundingClientRect();null!=n.lastHandleRect&&("w"===d&&(o+=p.left-n.lastHandleRect.left),"n"===u&&(s+=p.top-n.lastHandleRect.top)),n.lastHandleRect=p,"w"===d&&(o=-o),"n"===u&&(s=-s);var f=n.props.width+(l?o/n.props.transformScale:0),h=n.props.height+(c?s/n.props.transformScale:0),g=n.runConstraints(f,h);f=g[0],h=g[1];var m=f!==n.props.width||h!==n.props.height,b="function"==typeof n.props[e]?n.props[e]:null;b&&!("onResize"===e&&!m)&&(null==r.persist||r.persist(),b(r,{node:a,size:{width:f,height:h},handle:t})),"onResizeStop"===e&&n.resetData()}}},l.renderResizeHandle=function(e,t){var n=this.props.handle;if(!n)return r.createElement("span",{className:"react-resizable-handle react-resizable-handle-"+e,ref:t});if("function"==typeof n)return n(e,t);var i=d({ref:t},"string"==typeof n.type?{}:{handleAxis:e});return r.cloneElement(n,i)},l.render=function(){var e=this,t=this.props,n=t.children,o=t.className,l=t.draggableOpts,u=(t.width,t.height,t.handle,t.handleSize,t.lockAspectRatio,t.axis,t.minConstraints,t.maxConstraints,t.onResize,t.onResizeStop,t.onResizeStart,t.resizeHandles),p=(t.transformScale,function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(t,s));return(0,a.cloneElement)(n,d(d({},p),{},{className:(o?o+" ":"")+"react-resizable",children:[].concat(n.props.children,u.map((function(t){var n,a=null!=(n=e.handleRefs[t])?n:e.handleRefs[t]=r.createRef();return r.createElement(i.DraggableCore,c({},l,{nodeRef:a,key:"resizableHandle-"+t,onStop:e.resizeHandler("onResizeStop",t),onStart:e.resizeHandler("onResizeStart",t),onDrag:e.resizeHandler("onResize",t)}),e.renderResizeHandle(t,a))})))}))},o}(r.Component);t.default=h,h.propTypes=o.resizableProps,h.defaultProps={axis:"both",handleSize:[20,20],lockAspectRatio:!1,minConstraints:[20,20],maxConstraints:[1/0,1/0],resizeHandles:["se"],transformScale:1}},609:(e,t,n)=>{"use strict";t.default=void 0;var r=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}(n(959)),i=l(n(688)),a=l(n(794)),o=n(333),s=["handle","handleSize","onResize","onResizeStart","onResizeStop","draggableOpts","minConstraints","maxConstraints","lockAspectRatio","axis","width","height","resizeHandles","style","transformScale"];function l(e){return e&&e.__esModule?e:{default:e}}function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}var g=function(e){var t,n;function i(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this).state={width:t.props.width,height:t.props.height,propsWidth:t.props.width,propsHeight:t.props.height},t.onResize=function(e,n){var r=n.size;t.props.onResize?(null==e.persist||e.persist(),t.setState(r,(function(){return t.props.onResize&&t.props.onResize(e,n)}))):t.setState(r)},t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,h(t,n),i.getDerivedStateFromProps=function(e,t){return t.propsWidth!==e.width||t.propsHeight!==e.height?{width:e.width,height:e.height,propsWidth:e.width,propsHeight:e.height}:null},i.prototype.render=function(){var e=this.props,t=e.handle,n=e.handleSize,i=(e.onResize,e.onResizeStart),o=e.onResizeStop,l=e.draggableOpts,c=e.minConstraints,d=e.maxConstraints,f=e.lockAspectRatio,h=e.axis,g=(e.width,e.height,e.resizeHandles),m=e.style,b=e.transformScale,v=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,s);return r.createElement(a.default,{axis:h,draggableOpts:l,handle:t,handleSize:n,height:this.state.height,lockAspectRatio:f,maxConstraints:d,minConstraints:c,onResizeStart:i,onResize:this.onResize,onResizeStop:o,resizeHandles:g,transformScale:b,width:this.state.width},r.createElement("div",u({},v,{style:p(p({},m),{},{width:this.state.width+"px",height:this.state.height+"px"})})))},i}(r.Component);t.default=g,g.propTypes=p(p({},o.resizableProps),{},{children:i.default.element})},333:(e,t,n)=>{"use strict";t.__esModule=!0,t.resizableProps=void 0;var r,i=(r=n(688))&&r.__esModule?r:{default:r};n(230);var a={axis:i.default.oneOf(["both","x","y","none"]),className:i.default.string,children:i.default.element.isRequired,draggableOpts:i.default.shape({allowAnyClick:i.default.bool,cancel:i.default.string,children:i.default.node,disabled:i.default.bool,enableUserSelectHack:i.default.bool,offsetParent:i.default.node,grid:i.default.arrayOf(i.default.number),handle:i.default.string,nodeRef:i.default.object,onStart:i.default.func,onDrag:i.default.func,onStop:i.default.func,onMouseDown:i.default.func,scale:i.default.number}),height:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,a=t[0];return"both"===a.axis||"y"===a.axis?(r=i.default.number).isRequired.apply(r,t):i.default.number.apply(i.default,t)},handle:i.default.oneOfType([i.default.node,i.default.func]),handleSize:i.default.arrayOf(i.default.number),lockAspectRatio:i.default.bool,maxConstraints:i.default.arrayOf(i.default.number),minConstraints:i.default.arrayOf(i.default.number),onResizeStop:i.default.func,onResizeStart:i.default.func,onResize:i.default.func,resizeHandles:i.default.arrayOf(i.default.oneOf(["s","w","e","n","sw","nw","se","ne"])),transformScale:i.default.number,width:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,a=t[0];return"both"===a.axis||"x"===a.axis?(r=i.default.number).isRequired.apply(r,t):i.default.number.apply(i.default,t)}};t.resizableProps=a},954:(e,t,n)=>{"use strict";t.__esModule=!0,t.cloneElement=function(e,t){return t.style&&e.props.style&&(t.style=o(o({},e.props.style),t.style)),t.className&&e.props.className&&(t.className=e.props.className+" "+t.className),i.default.cloneElement(e,t)};var r,i=(r=n(959))&&r.__esModule?r:{default:r};function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},936:(e,t,n)=>{"use strict";e.exports=function(){throw new Error("Don't instantiate Resizable directly! Use require('react-resizable').Resizable")},e.exports.Resizable=n(794).default,e.exports.ResizableBox=n(609).default},367:function(e,t,n){var r;r=function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([function(e,t){var n,r,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var l,c=[],u=!1,d=-1;function p(){u&&l&&(u=!1,l.length?c=l.concat(c):d=-1,c.length&&f())}function f(){if(!u){var e=s(p);u=!0;for(var t=c.length;t;){for(l=c,c=[];++d<t;)l&&l[d].run();d=-1,t=c.length}l=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new h(e,t)),1!==c.length||u||s(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){"use strict";function r(e){return function(){return e}}var i=function(){};i.thatReturns=r,i.thatReturnsFalse=r(!1),i.thatReturnsTrue=r(!0),i.thatReturnsNull=r(null),i.thatReturnsThis=function(){return this},i.thatReturnsArgument=function(e){return e},e.exports=i},function(e,t,n){"use strict";(function(t){var n=function(e){};"production"!==t.env.NODE_ENV&&(n=function(e){if(void 0===e)throw new Error("invariant requires an error message argument")}),e.exports=function(e,t,r,i,a,o,s,l){if(n(t),!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[r,i,a,o,s,l],d=0;(c=new Error(t.replace(/%s/g,(function(){return u[d++]})))).name="Invariant Violation"}throw c.framesToPop=1,c}}}).call(t,n(0))},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(t,n){t.exports=e},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=((r=n(4))&&r.__esModule?r:{default:r}).default.createContext({registerPane:function(){},unregisterPane:function(){}});t.default=i,e.exports=t.default},function(e,t,n){"use strict";(function(t){var r,i=n(1);"production"!==t.env.NODE_ENV&&(r=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=0,a="Warning: "+e.replace(/%s/g,(function(){return n[i++]}));"undefined"!=typeof console&&console.error(a);try{throw new Error(a)}catch(e){}},i=function(e,t){if(void 0===t)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(0!==t.indexOf("Failed Composite propType: ")&&!e){for(var n=arguments.length,i=Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a];r.apply(void 0,[t].concat(i))}}),e.exports=i}).call(t,n(0))},function(e,t,n){(function(t){if("production"!==t.env.NODE_ENV){var r="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;e.exports=n(13)((function(e){return"object"==typeof e&&null!==e&&e.$$typeof===r}),!0)}else e.exports=n(12)()}).call(t,n(0))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(4),a=l(i),o=l(n(7)),s=l(n(5));function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var u=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,a=Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r=c(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.panes={},r.registerPane=function(e,t){t.forEach((function(t){r.panes[t]||(r.panes[t]=[]),r.findPane(e,t)||(r.panes[t].length>0&&r.syncScrollPosition(r.panes[t][0],e),r.panes[t].push(e))})),r.addEvents(e,t)},r.unregisterPane=function(e,t){t.forEach((function(t){r.findPane(e,t)&&(r.removeEvents(e),r.panes[t].splice(r.panes[t].indexOf(e),1))}))},r.addEvents=function(e,t){e.onscroll=r.handlePaneScroll.bind(r,e,t)},r.removeEvents=function(e){e.onscroll=null},r.findPane=function(e,t){return!!r.panes[t]&&r.panes[t].find((function(t){return t===e}))},r.handlePaneScroll=function(e,t){r.props.enabled&&window.requestAnimationFrame((function(){r.syncScrollPositions(e,t)}))},r.syncScrollPositions=function(e,t){t.forEach((function(n){r.panes[n].forEach((function(i){e!==i&&(r.removeEvents(i,n),r.syncScrollPosition(e,i),window.requestAnimationFrame((function(){r.addEvents(i,t)})))}))})),r.props.onSync&&r.props.onSync(e)},c(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"getContextValue",value:function(){return{registerPane:this.registerPane,unregisterPane:this.unregisterPane}}},{key:"syncScrollPosition",value:function(e,t){var n=e.scrollTop,r=e.scrollHeight,i=e.clientHeight,a=e.scrollLeft,o=e.scrollWidth,s=e.clientWidth,l=r-i,c=o-s,u=this.props,d=u.proportional,p=u.vertical,f=u.horizontal,h=t.scrollHeight-i,g=t.scrollWidth-s;p&&l>0&&(t.scrollTop=d?h*n/l:n),f&&c>0&&(t.scrollLeft=d?g*a/c:a)}},{key:"render",value:function(){return a.default.createElement(s.default.Provider,{value:this.getContextValue()},a.default.Children.only(this.props.children))}}]),t}(i.Component);u.propTypes={onSync:o.default.func,children:o.default.element.isRequired,proportional:o.default.bool,vertical:o.default.bool,horizontal:o.default.bool,enabled:o.default.bool},u.defaultProps={proportional:!0,vertical:!0,horizontal:!0,enabled:!0},t.default=u,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(4),a=s(n(7)),o=s(n(5));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toArray=function(e){return[].concat(e)},n.updateNode=function(){n.props.attachTo?n.node=n.props.attachTo.current:n.node=n.childRef.current},n.childRef=e.innerRef?e.innerRef:(0,i.createRef)(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){this.props.enabled&&(this.updateNode(),this.node&&this.context.registerPane(this.node,this.toArray(this.props.group)))}},{key:"componentDidUpdate",value:function(e){this.props.attachTo!==e.attachTo&&(this.node&&this.context.unregisterPane(this.node,this.toArray(e.group)),this.updateNode(),this.node&&this.context.registerPane(this.node,this.toArray(e.group))),this.node&&this.props.enabled!==e.enabled&&(this.props.enabled?this.context.registerPane(this.node,this.toArray(e.group)):this.context.unregisterPane(this.node,this.toArray(e.group))),this.node&&this.props.enabled&&this.props.group!==e.group&&(this.context.unregisterPane(this.node,this.toArray(e.group)),this.context.registerPane(this.node,this.toArray(this.props.group)))}},{key:"componentWillUnmount",value:function(){this.node&&this.props.enabled&&this.context.unregisterPane(this.node,this.toArray(this.props.group))}},{key:"render",value:function(){return this.props.attachTo?this.props.children:(0,i.cloneElement)(i.Children.only(this.props.children),{ref:this.childRef})}}]),t}(i.Component);l.contextType=o.default,l.propTypes={children:a.default.node.isRequired,attachTo:a.default.oneOfType([a.default.func,a.default.shape({current:a.default.any})]),group:a.default.oneOfType([a.default.string,a.default.arrayOf(a.default.string)]),enabled:a.default.bool,innerRef:a.default.oneOfType([a.default.func,a.default.shape({current:a.default.any})])},l.defaultProps={group:"default",enabled:!0},t.default=l,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8);Object.defineProperty(t,"ScrollSync",{enumerable:!0,get:function(){return a(r).default}});var i=n(9);function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"ScrollSyncPane",{enumerable:!0,get:function(){return a(i).default}})},function(e,t,n){"use strict";(function(t){if("production"!==t.env.NODE_ENV)var r=n(2),i=n(6),a=n(3),o={};e.exports=function(e,n,s,l,c){if("production"!==t.env.NODE_ENV)for(var u in e)if(e.hasOwnProperty(u)){var d;try{r("function"==typeof e[u],"%s: %s type `%s` is invalid; it must be a function, usually from React.PropTypes.",l||"React class",s,u),d=e[u](n,u,l,s,null,a)}catch(e){d=e}if(i(!d||d instanceof Error,"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",l||"React class",s,u,typeof d),d instanceof Error&&!(d.message in o)){o[d.message]=!0;var p=c?c():"";i(!1,"Failed %s type: %s%s",s,d.message,null!=p?p:"")}}}}).call(t,n(0))},function(e,t,n){"use strict";var r=n(1),i=n(2),a=n(3);e.exports=function(){function e(e,t,n,r,o,s){s!==a&&i(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t};return n.checkPropTypes=r,n.PropTypes=n,n}},function(e,t,n){"use strict";(function(t){var r=n(1),i=n(2),a=n(6),o=n(3),s=n(11);e.exports=function(e,n){var l="function"==typeof Symbol&&Symbol.iterator,c="<<anonymous>>",u={array:f("array"),bool:f("boolean"),func:f("function"),number:f("number"),object:f("object"),string:f("string"),symbol:f("symbol"),any:p(r.thatReturnsNull),arrayOf:function(e){return p((function(t,n,r,i,a){if("function"!=typeof e)return new d("Property `"+a+"` of component `"+r+"` has invalid PropType notation inside arrayOf.");var s=t[n];if(!Array.isArray(s))return new d("Invalid "+i+" `"+a+"` of type `"+g(s)+"` supplied to `"+r+"`, expected an array.");for(var l=0;l<s.length;l++){var c=e(s,l,r,i,a+"["+l+"]",o);if(c instanceof Error)return c}return null}))},element:p((function(t,n,r,i,a){var o=t[n];return e(o)?null:new d("Invalid "+i+" `"+a+"` of type `"+g(o)+"` supplied to `"+r+"`, expected a single ReactElement.")})),instanceOf:function(e){return p((function(t,n,r,i,a){if(!(t[n]instanceof e)){var o=e.name||c;return new d("Invalid "+i+" `"+a+"` of type `"+((s=t[n]).constructor&&s.constructor.name?s.constructor.name:c)+"` supplied to `"+r+"`, expected instance of `"+o+"`.")}var s;return null}))},node:p((function(e,t,n,r,i){return h(e[t])?null:new d("Invalid "+r+" `"+i+"` supplied to `"+n+"`, expected a ReactNode.")})),objectOf:function(e){return p((function(t,n,r,i,a){if("function"!=typeof e)return new d("Property `"+a+"` of component `"+r+"` has invalid PropType notation inside objectOf.");var s=t[n],l=g(s);if("object"!==l)return new d("Invalid "+i+" `"+a+"` of type `"+l+"` supplied to `"+r+"`, expected an object.");for(var c in s)if(s.hasOwnProperty(c)){var u=e(s,c,r,i,a+"."+c,o);if(u instanceof Error)return u}return null}))},oneOf:function(e){return Array.isArray(e)?p((function(t,n,r,i,a){for(var o=t[n],s=0;s<e.length;s++)if(l=o,c=e[s],l===c?0!==l||1/l==1/c:l!=l&&c!=c)return null;var l,c;return new d("Invalid "+i+" `"+a+"` of value `"+o+"` supplied to `"+r+"`, expected one of "+JSON.stringify(e)+".")})):("production"!==t.env.NODE_ENV&&a(!1,"Invalid argument supplied to oneOf, expected an instance of array."),r.thatReturnsNull)},oneOfType:function(e){if(!Array.isArray(e))return"production"!==t.env.NODE_ENV&&a(!1,"Invalid argument supplied to oneOfType, expected an instance of array."),r.thatReturnsNull;for(var n=0;n<e.length;n++){var i=e[n];if("function"!=typeof i)return a(!1,"Invalid argument supplid to oneOfType. Expected an array of check functions, but received %s at index %s.",b(i),n),r.thatReturnsNull}return p((function(t,n,r,i,a){for(var s=0;s<e.length;s++)if(null==(0,e[s])(t,n,r,i,a,o))return null;return new d("Invalid "+i+" `"+a+"` supplied to `"+r+"`.")}))},shape:function(e){return p((function(t,n,r,i,a){var s=t[n],l=g(s);if("object"!==l)return new d("Invalid "+i+" `"+a+"` of type `"+l+"` supplied to `"+r+"`, expected `object`.");for(var c in e){var u=e[c];if(u){var p=u(s,c,r,i,a+"."+c,o);if(p)return p}}return null}))}};function d(e){this.message=e,this.stack=""}function p(e){if("production"!==t.env.NODE_ENV)var r={},s=0;function l(l,u,p,f,h,g,m){if(f=f||c,g=g||p,m!==o)if(n)i(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");else if("production"!==t.env.NODE_ENV&&"undefined"!=typeof console){var b=f+":"+p;!r[b]&&s<3&&(a(!1,"You are manually calling a React.PropTypes validation function for the `%s` prop on `%s`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details.",g,f),r[b]=!0,s++)}return null==u[p]?l?null===u[p]?new d("The "+h+" `"+g+"` is marked as required in `"+f+"`, but its value is `null`."):new d("The "+h+" `"+g+"` is marked as required in `"+f+"`, but its value is `undefined`."):null:e(u,p,f,h,g)}var u=l.bind(null,!1);return u.isRequired=l.bind(null,!0),u}function f(e){return p((function(t,n,r,i,a,o){var s=t[n];return g(s)!==e?new d("Invalid "+i+" `"+a+"` of type `"+m(s)+"` supplied to `"+r+"`, expected `"+e+"`."):null}))}function h(t){switch(typeof t){case"number":case"string":case"undefined":return!0;case"boolean":return!t;case"object":if(Array.isArray(t))return t.every(h);if(null===t||e(t))return!0;var n=function(e){var t=e&&(l&&e[l]||e["@@iterator"]);if("function"==typeof t)return t}(t);if(!n)return!1;var r,i=n.call(t);if(n!==t.entries){for(;!(r=i.next()).done;)if(!h(r.value))return!1}else for(;!(r=i.next()).done;){var a=r.value;if(a&&!h(a[1]))return!1}return!0;default:return!1}}function g(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":function(e,t){return"symbol"===e||"Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol}(t,e)?"symbol":t}function m(e){if(null==e)return""+e;var t=g(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function b(e){var t=m(e);switch(t){case"array":case"object":return"an "+t;case"boolean":case"date":case"regexp":return"a "+t;default:return t}}return d.prototype=Error.prototype,u.checkPropTypes=s,u.PropTypes=u,u}}).call(t,n(0))}])},e.exports=r(n(959))},294:(e,t,n)=>{"use strict";e.exports=n.p+"1c9bce46ffcb079ff752.wasm"},89:t=>{"use strict";t.exports=e},781:e=>{"use strict";e.exports=t},531:e=>{"use strict";e.exports=n},7:e=>{"use strict";e.exports=r},241:e=>{"use strict";e.exports=i},959:e=>{"use strict";e.exports=a},398:e=>{"use strict";e.exports=o},200:e=>{"use strict";e.exports=s},806:e=>{"use strict";e.exports=l},694:e=>{"use strict";e.exports=c},269:e=>{"use strict";e.exports=u}},h={};function g(e){var t=h[e];if(void 0!==t)return t.exports;var n=h[e]={id:e,loaded:!1,exports:{}};return f[e].call(n.exports,n,n.exports,g),n.loaded=!0,n.exports}g.m=f,g.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return g.d(t,{a:t}),t},p=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,g.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var n=Object.create(null);g.r(n);var r={};d=d||[null,p({}),p([]),p(p)];for(var i=2&t&&e;"object"==typeof i&&!~d.indexOf(i);i=p(i))Object.getOwnPropertyNames(i).forEach((t=>r[t]=()=>e[t]));return r.default=()=>e,g.d(n,r),n},g.d=(e,t)=>{for(var n in t)g.o(t,n)&&!g.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},g.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),g.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),g.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),g.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},g.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),g.p="public/plugins/grafana-lokiexplore-app/",g.b=document.baseURI||self.location.href;var m={};return(()=>{"use strict";g.r(m),g.d(m,{plugin:()=>KT});var e=g(781),t=g(959),n=g.t(t,2),r=g.n(t),i=g(806),a=g(531),o=Object.defineProperty,s=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,u=(e,t,n)=>t in e?o(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,d=(e,t)=>{for(var n in t||(t={}))l.call(t,n)&&u(e,n,t[n]);if(s)for(var n of s(t))c.call(t,n)&&u(e,n,t[n]);return e};function p(t,n){const r=d({},a.locationService.getSearchObject());if(n)for(const e of Object.keys(r))n.includes(e)||delete r[e];return e.urlUtil.renderUrl(e.locationUtil.assureBaseUrl(t),r)}function f(e,t){return r().createElement(e.Component,{model:e,routeProps:t})}Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;const h=new Map;var b=g(269);const v={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let y;const O=new Uint8Array(16);function w(){if(!y&&(y="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!y))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return y(O)}const S=[];for(let e=0;e<256;++e)S.push((e+256).toString(16).slice(1));const x=function(e,t,n){if(v.randomUUID&&!t&&!e)return v.randomUUID();const r=(e=e||{}).random||(e.rng||w)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return function(e,t=0){return S[e[t+0]]+S[e[t+1]]+S[e[t+2]]+S[e[t+3]]+"-"+S[e[t+4]]+S[e[t+5]]+"-"+S[e[t+6]]+S[e[t+7]]+"-"+S[e[t+8]]+S[e[t+9]]+"-"+S[e[t+10]]+S[e[t+11]]+S[e[t+12]]+S[e[t+13]]+S[e[t+14]]+S[e[t+15]]}(r)};var _=Object.defineProperty,P=Object.defineProperties,E=Object.getOwnPropertyDescriptors,C=Object.getOwnPropertySymbols,k=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable,T=(e,t,n)=>t in e?_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const R=r().memo((function(e){var n,i=e,{model:a}=i,o=((e,t)=>{var n={};for(var r in e)k.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&C)for(var r of C(e))t.indexOf(r)<0&&D.call(e,r)&&(n[r]=e[r]);return n})(i,["model"]);const s=null!=(n=a.constructor.Component)?n:I,[l,c]=(0,t.useState)(0);return(0,t.useEffect)((()=>{const e=a.activate();return c((e=>e+1)),e}),[a]),a.isActive?r().createElement(s,(u=((e,t)=>{for(var n in t||(t={}))k.call(t,n)&&T(e,n,t[n]);if(C)for(var n of C(t))D.call(t,n)&&T(e,n,t[n]);return e})({},o),P(u,E({model:a})))):null;var u}));function I(e){return null}class A extends e.BusEventWithPayload{}A.type="scene-object-state-change";class j extends e.BusEventWithPayload{}j.type="scene-object-user-action";var L,$=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};class F{constructor(e){var t,n;((e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,void 0)})(this,L),n=e,$(this,t=L,"write to private field"),t.set(this,n)}resolve(){return $(this,e=L,"read from private field"),e.get(this);var e}}L=new WeakMap;var N=Object.defineProperty,M=Object.getOwnPropertySymbols,V=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable,z=(e,t,n)=>t in e?N(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,W=(e,t)=>{for(var n in t||(t={}))V.call(t,n)&&z(e,n,t[n]);if(M)for(var n of M(t))B.call(t,n)&&z(e,n,t[n]);return e};class Q{constructor(t){this._isActive=!1,this._activationHandlers=[],this._deactivationHandlers=new Map,this._subs=new b.Subscription,this._refCount=0,t.key||(t.key=x()),this._events=new e.EventBusSrv,this._state=Object.freeze(t),this._setParent(this._state)}get state(){return this._state}get isActive(){return this._isActive}get parent(){return this._parent}get variableDependency(){return this._variableDependency}get urlSync(){return this._urlSync}get Component(){return R}_setParent(e){q(e,(e=>{e._parent&&e._parent!==this&&console.warn("SceneObject already has a parent set that is different from the new parent. You cannot share the same SceneObject instance in multiple scenes or in multiple different places of the same scene graph. Use SceneObject.clone() to duplicate a SceneObject or store a state key reference and use sceneGraph.findObject to locate it.",e,this),e._parent=this}))}clearParent(){this._parent=void 0}subscribeToState(e){return this._events.subscribe(A,(t=>{t.payload.changedObject===this&&e(t.payload.newState,t.payload.prevState)}))}subscribeToEvent(e,t){return this._events.subscribe(e,t)}setState(e){const t=this._state,n=W(W({},this._state),e);this._state=Object.freeze(n),this._setParent(e),this._handleActivationOfChangedStateProps(t,n),this.publishEvent(new A({prevState:t,newState:n,partialUpdate:e,changedObject:this}),!0)}_handleActivationOfChangedStateProps(e,t){this.isActive&&(e.$behaviors!==t.$behaviors&&this._handleChangedBehaviors(e.$behaviors,t.$behaviors),e.$data!==t.$data&&this._handleChangedStateActivation(e.$data,t.$data),e.$variables!==t.$variables&&this._handleChangedStateActivation(e.$variables,t.$variables),e.$timeRange!==t.$timeRange&&this._handleChangedStateActivation(e.$timeRange,t.$timeRange))}_handleChangedStateActivation(e,t){if(e){const t=this._deactivationHandlers.get(e);t&&(t(),this._deactivationHandlers.delete(e))}t&&this._deactivationHandlers.set(t,t.activate())}_handleChangedBehaviors(e,t){if(e)for(const n of e)if(!t||!t.includes(n)){const e=this._deactivationHandlers.get(n);e&&(e(),this._deactivationHandlers.delete(n))}if(t)for(const n of t)e&&e.includes(n)||this._activateBehavior(n)}publishEvent(e,t){this._events.publish(e),t&&this.parent&&this.parent.publishEvent(e,t)}getRoot(){return this._parent?this._parent.getRoot():this}_internalActivate(){this._isActive=!0;const{$data:e,$variables:t,$timeRange:n,$behaviors:r}=this.state;if(this._activationHandlers.forEach((e=>{const t=e();t&&this._deactivationHandlers.set(t,t)})),n&&!n.isActive&&this._deactivationHandlers.set(n,n.activate()),t&&!t.isActive&&this._deactivationHandlers.set(t,t.activate()),e&&!e.isActive&&this._deactivationHandlers.set(e,e.activate()),r)for(const e of r)this._activateBehavior(e)}_activateBehavior(e){if(e instanceof Q)this._deactivationHandlers.set(e,e.activate());else if("function"==typeof e){const t=e(this);t&&this._deactivationHandlers.set(e,t)}}activate(){this.isActive||this._internalActivate(),this._refCount++;let e=!1;return()=>{if(this._refCount--,e)throw new Error("SceneObject cancelation handler returned by activate() called a second time");e=!0,0===this._refCount&&this._internalDeactivate()}}_internalDeactivate(){this._isActive=!1;for(let e of this._deactivationHandlers.values())e();this._deactivationHandlers.clear(),this._events.removeAllListeners(),this._subs.unsubscribe(),this._subs=new b.Subscription}useState(){return U(this)}forceRender(){this.setState({})}clone(e){return function(e,t){const n=J(e.state,t);return new e.constructor(n)}(this,e)}addActivationHandler(e){this._activationHandlers.push(e)}forEachChild(e){q(this.state,e)}getRef(){return this._ref||(this._ref=new F(this)),this._ref}}function U(e,n){var r;const[i,a]=(0,t.useState)(e.state),o=e.state,s=null!=(r=null==n?void 0:n.shouldActivateOrKeepAlive)&&r;return(0,t.useEffect)((()=>{let t;s&&(t=e.activate());const n=e.subscribeToState((e=>{a(e)}));return e.state!==o&&a(e.state),()=>{n.unsubscribe(),t&&t()}}),[e,s]),e.state}function q(e,t){for(const n of Object.values(e))if(n instanceof Q&&t(n),Array.isArray(n))for(const e of n)e instanceof Q&&t(e)}var H=Object.defineProperty,G=Object.getOwnPropertySymbols,X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable,Z=(e,t,n)=>t in e?H(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,K=(e,t)=>{for(var n in t||(t={}))X.call(t,n)&&Z(e,n,t[n]);if(G)for(var n of G(t))Y.call(t,n)&&Z(e,n,t[n]);return e};function J(e,t){const n=K({},e);for(const e in n){const t=n[e];if(t instanceof Q&&(n[e]=t.clone()),t instanceof F)throw new Error("Cannot clone a SceneObject with a SceneObjectRef in state");if(Array.isArray(t)){const r=[];for(const e of t)e instanceof Q?r.push(e.clone()):r.push(e);n[e]=r}}return Object.assign(n,t),n}function ee(e,t){let n,r=e;for(;r&&!n;)n=t(r),r=r.parent;return n}class te extends e.DataSourceApi{constructor(t,n){super({name:"RuntimeDataSource-"+t,uid:n,type:t,id:1,readOnly:!0,jsonData:{},access:"direct",meta:{id:t,name:"RuntimeDataSource-"+t,type:e.PluginType.datasource,info:{author:{name:""},description:"",links:[],logos:{large:"",small:""},screenshots:[],updated:"",version:""},module:"",baseUrl:""}})}testDatasource(){return Promise.resolve({})}}const ne=new Map;var re=g(241),ie=g.n(re);function ae(e,t){const n=t.state.$variables;if(!n)return t.parent?ae(e,t.parent):null;return n.getByName(e)||(t.parent?ae(e,t.parent):null)}var oe=(e=>(e.Auto="auto",e.BasicGauge="basic",e.ColorBackground="color-background",e.ColorBackgroundSolid="color-background-solid",e.ColorText="color-text",e.Custom="custom",e.DataLinks="data-links",e.Gauge="gauge",e.GradientGauge="gradient-gauge",e.Image="image",e.JSONView="json-view",e.LcdGauge="lcd-gauge",e.Sparkline="sparkline",e))(oe||{}),se=(e=>(e.Auto="auto",e.Lg="lg",e.Md="md",e.Sm="sm",e))(se||{}),le=(e=>(e.CSV="csv",e.Date="date",e.Distributed="distributed",e.DoubleQuote="doublequote",e.Glob="glob",e.HTML="html",e.JSON="json",e.Lucene="lucene",e.PercentEncode="percentencode",e.Pipe="pipe",e.QueryParam="queryparam",e.Raw="raw",e.Regex="regex",e.SQLString="sqlstring",e.SingleQuote="singlequote",e.Text="text",e.UriEncode="uriencode",e))(le||{});oe.Auto;var ce=(e=>(e.NotStarted="NotStarted",e.Loading="Loading",e.Streaming="Streaming",e.Done="Done",e.Error="Error",e))(ce||{}),ue=Object.defineProperty,de=Object.getOwnPropertySymbols,pe=Object.prototype.hasOwnProperty,fe=Object.prototype.propertyIsEnumerable,he=(e,t,n)=>t in e?ue(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class ge extends Q{constructor(e){super(((e,t)=>{for(var n in t||(t={}))pe.call(t,n)&&he(e,n,t[n]);if(de)for(var n of de(t))fe.call(t,n)&&he(e,n,t[n]);return e})({data:me},e))}getResultsStream(){const e={origin:this,data:this.state.data};return(0,b.of)(e)}}const me={state:ce.Done,series:[],timeRange:(0,e.getDefaultTimeRange)()};class be{constructor(e,t){this._sceneObject=e,this._nextChangeShouldAddHistoryStep=!1,this._keys=t.keys}getKeys(){return"function"==typeof this._keys?this._keys():this._keys}getUrlState(){return this._sceneObject.getUrlState()}updateFromUrl(e){this._sceneObject.updateFromUrl(e)}performBrowserHistoryAction(e){this._nextChangeShouldAddHistoryStep=!0,e(),this._nextChangeShouldAddHistoryStep=!1}shouldCreateHistoryStep(e){return this._nextChangeShouldAddHistoryStep}}const ve=/^\d+[yYmMsSwWhHdD]$/;function ye(t){if("string"!=typeof t)return null;if(-1!==t.indexOf("now"))return t;if(ve.test(t))return t;if(8===t.length){const n=(0,e.toUtc)(t,"YYYYMMDD");if(n.isValid())return n.toISOString()}else if(15===t.length){const n=(0,e.toUtc)(t,"YYYYMMDDTHHmmss");if(n.isValid())return n.toISOString()}else if(24===t.length)return(0,e.toUtc)(t).toISOString();const n=parseInt(t,10);return isNaN(n)?null:(0,e.toUtc)(n).toISOString()}function Oe(t,n,r,i,a){const o=a&&"now"===n;return{from:e.dateMath.parse(t,!1,r,i),to:e.dateMath.parse(o?"now-"+a:n,!0,r,i),raw:{from:t,to:n}}}var we=Object.defineProperty,Se=Object.getOwnPropertySymbols,xe=Object.prototype.hasOwnProperty,_e=Object.prototype.propertyIsEnumerable,Pe=(e,t,n)=>t in e?we(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Ee extends Q{constructor(t={}){var n,r,i;const o=null!=(n=t.from)?n:"now-6h",s=null!=(r=t.to)?r:"now",l=t.timeZone;super(((e,t)=>{for(var n in t||(t={}))xe.call(t,n)&&Pe(e,n,t[n]);if(Se)for(var n of Se(t))_e.call(t,n)&&Pe(e,n,t[n]);return e})({from:o,to:s,timeZone:l,value:Oe(o,s,l||(0,e.getTimeZone)(),t.fiscalYearStartMonth,t.UNSAFE_nowDelay),refreshOnActivate:null!=(i=t.refreshOnActivate)?i:{percent:10}},t)),this._urlSync=new be(this,{keys:["from","to","timezone","time","time.window"]}),this.onTimeRangeChange=e=>{const t={},n={};"string"==typeof e.raw.from?(t.from=e.raw.from,n.from=e.raw.from):(t.from=e.raw.from.toISOString(),n.from=e.raw.from.toISOString(!0)),"string"==typeof e.raw.to?(t.to=e.raw.to,n.to=e.raw.to):(t.to=e.raw.to.toISOString(),n.to=e.raw.to.toISOString(!0)),t.value=Oe(n.from,n.to,this.getTimeZone(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay),t.from===this.state.from&&t.to===this.state.to||this._urlSync.performBrowserHistoryAction((()=>{this.setState(t)}))},this.onTimeZoneChange=e=>{this._urlSync.performBrowserHistoryAction((()=>{this.setState({timeZone:e})}))},this.onRefresh=()=>{this.setState({value:Oe(this.state.from,this.state.to,this.getTimeZone(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay)}),this.publishEvent(new a.RefreshEvent,!0)},this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){if(!this.state.timeZone){const e=this.getTimeZoneSource();e!==this&&this._subs.add(e.subscribeToState(((t,n)=>{void 0!==t.timeZone&&t.timeZone!==n.timeZone&&this.setState({value:Oe(this.state.from,this.state.to,e.getTimeZone(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay)})})))}return this.state.weekStart&&(0,e.setWeekStart)(this.state.weekStart),e.rangeUtil.isRelativeTimeRange(this.state.value.raw)&&this.refreshIfStale(),()=>{this.state.weekStart&&(0,e.setWeekStart)(a.config.bootData.user.weekStart)}}refreshIfStale(){var e,t,n,r;let i;void 0!==(null==(t=null==(e=this.state)?void 0:e.refreshOnActivate)?void 0:t.percent)&&(i=this.calculatePercentOfInterval(this.state.refreshOnActivate.percent)),void 0!==(null==(r=null==(n=this.state)?void 0:n.refreshOnActivate)?void 0:r.afterMs)&&(i=Math.min(this.state.refreshOnActivate.afterMs,null!=i?i:1/0)),void 0!==i&&this.refreshRange(i)}getTimeZoneSource(){if(!this.parent||!this.parent.parent)return this;return ee(this.parent.parent,(e=>{if(e.state.$timeRange&&e.state.$timeRange.state.timeZone)return e.state.$timeRange}))||this}refreshRange(t){var n;const r=Oe(this.state.from,this.state.to,null!=(n=this.state.timeZone)?n:(0,e.getTimeZone)(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay);r.to.diff(this.state.value.to,"milliseconds")>=t&&this.setState({value:r})}calculatePercentOfInterval(e){const t=this.state.value.to.diff(this.state.value.from,"milliseconds");return Math.ceil(t/e)}getTimeZone(){if(this.state.timeZone)return this.state.timeZone;const t=this.getTimeZoneSource();return t!==this?t.state.timeZone:(0,e.getTimeZone)()}getUrlState(){const e=a.locationService.getSearchObject(),t={from:this.state.from,to:this.state.to};return this.state.timeZone&&(t.timezone=this.state.timeZone),e.time&&e["time.window"]&&(t.time=null,t["time.window"]=null),t}updateFromUrl(t){var n,r,i;const a={};let o=ye(t.from),s=ye(t.to);if(t.time&&t["time.window"]){const n=function(t,n){const r=isNaN(Date.parse(t))?parseInt(t,10):Date.parse(t);let i;return i=n.match(/^\d+$/)&&parseInt(n,10)?parseInt(n,10):e.rangeUtil.intervalToMs(n),{from:(0,e.toUtc)(r-i/2).toISOString(),to:(0,e.toUtc)(r+i/2).toISOString()}}(Array.isArray(t.time)?t.time[0]:t.time,Array.isArray(t["time.window"])?t["time.window"][0]:t["time.window"]);o=n.from,s=n.to}(o||s)&&(o&&(a.from=o),s&&(a.to=s),"string"==typeof t.timezone&&(a.timeZone=""!==t.timezone?t.timezone:void 0),a.value=Oe(null!=(n=a.from)?n:this.state.from,null!=(r=a.to)?r:this.state.to,null!=(i=a.timeZone)?i:this.getTimeZone(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay),this.setState(a))}}const Ce=new ge,ke=new Ee,De=new class extends Q{constructor(){super({variables:[]})}getByName(e){}isVariableLoadingOrWaitingToUpdate(e){return!1}};function Te(e){var t;return null!=(t=ee(e,(e=>e.state.$timeRange)))?t:ke}class Re extends e.BusEventWithPayload{}function Ie(e){return"object"==typeof e&&"formatter"in e}Re.type="scene-variable-changed-value";let Ae,je={};function Le(e){return je[e]||(je[e]=(0,re.property)(e))}class $e{constructor(e,t){this.state={name:e,value:t,type:"scopedvar"}}getValue(e){let{value:t}=this.state,n=t.value;return n=e?Le(e)(t.value):t.value,"string"===n||"number"===n||"boolean"===n?n:String(n)}getValueText(){const{value:e}=this.state;return null!=e.text?String(e.text):String(e)}}const Fe=new e.Registry((()=>{const t=[{id:le.Lucene,name:"Lucene",description:"Values are lucene escaped and multi-valued variables generate an OR expression",formatter:e=>"string"==typeof e?Ne(e):Array.isArray(e)?0===e.length?"__empty__":"("+(0,re.map)(e,(e=>'"'+Ne(e)+'"')).join(" OR ")+")":Ne(`${e}`)},{id:le.Raw,name:"raw",description:"Keep value as is",formatter:e=>String(e)},{id:le.Regex,name:"Regex",description:"Values are regex escaped and multi-valued variables generate a (<value>|<value>) expression",formatter:t=>{if("string"==typeof t)return(0,e.escapeRegex)(t);if(Array.isArray(t)){const n=t.map((t=>"string"==typeof t?(0,e.escapeRegex)(t):(0,e.escapeRegex)(String(t))));return 1===n.length?n[0]:"("+n.join("|")+")"}return(0,e.escapeRegex)(`${t}`)}},{id:le.Pipe,name:"Pipe",description:"Values are separated by | character",formatter:e=>"string"==typeof e?e:Array.isArray(e)?e.join("|"):`${e}`},{id:le.Distributed,name:"Distributed",description:"Multiple values are formatted like variable=value",formatter:(e,t,n)=>"string"==typeof e?e:Array.isArray(e)?(e=(0,re.map)(e,((e,t)=>0!==t?n.state.name+"="+e:e)),e.join(",")):`${e}`},{id:le.CSV,name:"Csv",description:"Comma-separated values",formatter:e=>"string"==typeof e?e:(0,re.isArray)(e)?e.join(","):String(e)},{id:le.HTML,name:"HTML",description:"HTML escaping of values",formatter:t=>"string"==typeof t?e.textUtil.escapeHtml(t):(0,re.isArray)(t)?e.textUtil.escapeHtml(t.join(", ")):e.textUtil.escapeHtml(String(t))},{id:le.JSON,name:"JSON",description:"JSON stringify value",formatter:e=>"string"==typeof e?e:JSON.stringify(e)},{id:le.PercentEncode,name:"Percent encode",description:"Useful for URL escaping values",formatter:e=>(0,re.isArray)(e)?Me("{"+e.join(",")+"}"):Me(e)},{id:le.SingleQuote,name:"Single quote",description:"Single quoted values",formatter:e=>{const t=new RegExp("'","g");if((0,re.isArray)(e))return(0,re.map)(e,(e=>`'${(0,re.replace)(e,t,"\\'")}'`)).join(",");let n="string"==typeof e?e:String(e);return`'${(0,re.replace)(n,t,"\\'")}'`}},{id:le.DoubleQuote,name:"Double quote",description:"Double quoted values",formatter:e=>{const t=new RegExp('"',"g");if((0,re.isArray)(e))return(0,re.map)(e,(e=>`"${(0,re.replace)(e,t,'\\"')}"`)).join(",");let n="string"==typeof e?e:String(e);return`"${(0,re.replace)(n,t,'\\"')}"`}},{id:le.SQLString,name:"SQL string",description:"SQL string quoting and commas for use in IN statements and other scenarios",formatter:Qe},{id:le.Date,name:"Date",description:"Format date in different ways",formatter:(t,n)=>{var r;let i=NaN;if("number"==typeof t?i=t:"string"==typeof t&&(i=parseInt(t,10)),isNaN(i))return"NaN";const a=null!=(r=n[0])?r:"iso";switch(a){case"ms":return String(t);case"seconds":return`${Math.round(i/1e3)}`;case"iso":return(0,e.dateTime)(i).toISOString();default:return(n||[]).length>1?(0,e.dateTime)(i).format(n.join(":")):(0,e.dateTime)(i).format(a)}}},{id:le.Glob,name:"Glob",description:"Format multi-valued variables using glob syntax, example {value1,value2}",formatter:e=>(0,re.isArray)(e)&&e.length>1?"{"+e.join(",")+"}":String(e)},{id:le.Text,name:"Text",description:"Format variables in their text representation. Example in multi-variable scenario A + B + C.",formatter:(e,t,n)=>n.getValueText?n.getValueText():String(e)},{id:le.QueryParam,name:"Query parameter",description:"Format variables as URL parameters. Example in multi-variable scenario A + B + C => var-foo=A&var-foo=B&var-foo=C.",formatter:(e,t,n)=>Array.isArray(e)?e.map((e=>ze(n.state.name,e))).join("&"):ze(n.state.name,e)},{id:le.UriEncode,name:"Percent encode as URI",description:"Useful for URL escaping values, taking into URI syntax characters",formatter:e=>(0,re.isArray)(e)?Ve("{"+e.join(",")+"}"):Ve(e)}];return t}));function Ne(e){return!1===isNaN(+e)?e:e.replace(/([\!\*\+\-\=<>\s\&\|\(\)\[\]\{\}\^\~\?\:\\/"])/g,"\\$1")}function Me(e){return"object"==typeof e&&(e=String(e)),Be(encodeURIComponent(e))}const Ve=e=>Be(encodeURI(String(e))),Be=e=>e.replace(/[!'()*]/g,(e=>"%"+e.charCodeAt(0).toString(16).toUpperCase()));function ze(e,t){return`var-${e}=${Me(t)}`}const We={"'":"''",'"':'\\"'};function Qe(e){const t=new RegExp("'|\"","g");if((0,re.isArray)(e))return(0,re.map)(e,(e=>`'${(0,re.replace)(e,t,(e=>{var t;return null!=(t=We[e])?t:""}))}'`)).join(",");let n="string"==typeof e?e:String(e);return`'${(0,re.replace)(n,t,(e=>{var t;return null!=(t=We[e])?t:""}))}'`}const Ue="All",qe="$__all",He="$__auto",Ge=/\$(\w+)|\[\[(\w+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g;class Xe{constructor(e){this._value=e}formatter(){return this._value}}class Ye{constructor(e,t){this.state={name:e,type:"time_macro"},this._sceneObject=t}getValue(){const e=Te(this._sceneObject);return"__from"===this.state.name?e.state.value.from.valueOf():e.state.value.to.valueOf()}getValueText(){const t=Te(this._sceneObject);return"__from"===this.state.name?(0,e.dateTimeFormat)(t.state.value.from,{timeZone:t.getTimeZone()}):(0,e.dateTimeFormat)(t.state.value.to,{timeZone:t.getTimeZone()})}}class Ze{constructor(e,t,n){this.state={name:e,type:"time_macro",match:n},this._sceneObject=t}getValue(){var e;const t=xl(this._sceneObject);if(t){const n=null==(e=t.state.data)?void 0:e.request;return n?"__interval_ms"===this.state.name?n.intervalMs:n.interval:this.state.match}return this.state.match}}function Ke(e,t={}){if(e.state.$variables)for(const n of e.state.$variables.state.variables)n.state.skipUrlSync||t[n.state.name]||(t[n.state.name]=n);return e.parent&&Ke(e.parent,t),t}var Je=Object.defineProperty,et=Object.defineProperties,tt=Object.getOwnPropertyDescriptors,nt=Object.getOwnPropertySymbols,rt=Object.prototype.hasOwnProperty,it=Object.prototype.propertyIsEnumerable,at=(e,t,n)=>t in e?Je(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const ot=(0,e.getDisplayProcessor)();class st{constructor(e){this._urlQueryParams=e}formatter(e){if(!e)return this._urlQueryParams;const t=e.split(":");if("exclude"===t[0]&&t.length>1){const e=new URLSearchParams(this._urlQueryParams);for(const n of t[1].split(","))e.delete(n);return`?${e}`}if("include"===t[0]&&t.length>1){const e=new URLSearchParams(this._urlQueryParams),n=t[1].split(",");for(const t of e.keys())n.includes(t)||e.delete(t);return`?${e}`}return this._urlQueryParams}}const lt=new Map([[e.DataLinkBuiltInVars.includeVars,class{constructor(e,t){this.state={name:e,type:"url_variable"},this._sceneObject=t}getValue(){const e=Ke(this._sceneObject),t=Fe.get(le.QueryParam),n=[];for(const r of Object.keys(e)){const i=e[r],a=i.getValue();a&&(Ie(a)?n.push(a.formatter(le.QueryParam)):n.push(t.formatter(a,[],i)))}return new Xe(n.join("&"))}getValueText(){return""}}],[e.DataLinkBuiltInVars.keepTime,class{constructor(e,t){this.state={name:e,type:"url_variable"},this._sceneObject=t}getValue(){var t;const n=null==(t=Te(this._sceneObject).urlSync)?void 0:t.getUrlState();return new Xe(e.urlUtil.toUrlParams(n))}getValueText(){return""}}],["__value",class{constructor(e,t,n,r){this._match=n,this._scopedVars=r,this.state={name:e,type:"__value"}}getValue(t){var n,r;const i=null==(n=this._scopedVars)?void 0:n.__dataContext;if(!i)return this._match;const{frame:a,rowIndex:o,field:s,calculatedValue:l}=i.value;if(l)switch(t){case"numeric":case"raw":return l.numeric;case"time":return"";default:return(0,e.formattedValueToString)(l)}if(null==o)return this._match;if("time"===t){const t=a.fields.find((t=>t.type===e.FieldType.time));return t?t.values.get(o):void 0}if(!s)return this._match;const c=s.values.get(o);if("raw"===t)return c;const u=(null!=(r=s.display)?r:ot)(c);return"numeric"===t?u.numeric:(0,e.formattedValueToString)(u)}getValueText(){return""}}],["__data",class{constructor(e,t,n,r){this._match=n,this._scopedVars=r,this.state={name:e,type:"__data"}}getValue(t){var n,r;const i=null==(n=this._scopedVars)?void 0:n.__dataContext;if(!i||!t)return this._match;const{frame:a,rowIndex:o}=i.value;if(void 0===o||void 0===t)return this._match;const s={name:a.name,refId:a.refId,fields:(0,e.getFieldDisplayValuesProxy)({frame:a,rowIndex:o})};return null!=(r=Le(t)(s))?r:""}getValueText(){return""}}],["__series",class{constructor(e,t,n,r){this._match=n,this._scopedVars=r,this.state={name:e,type:"__series"}}getValue(t){var n;const r=null==(n=this._scopedVars)?void 0:n.__dataContext;if(!r||!t)return this._match;if("name"!==t)return this._match;const{frame:i,frameIndex:a}=r.value;return(0,e.getFrameDisplayName)(i,a)}getValueText(){return""}}],["__field",class{constructor(e,t,n,r){this._match=n,this._scopedVars=r,this.state={name:e,type:"__field"}}getValue(t){var n,r;const i=null==(n=this._scopedVars)?void 0:n.__dataContext;if(!i||!t)return this._match;if(void 0===t||""===t)return this._match;const{frame:a,field:o,data:s}=i.value,l=function(t,n,r){return new Proxy({},{get:(i,a)=>{return"name"===a?t.name:"displayName"===a?(0,e.getFieldDisplayName)(t,n,r):"labels"===a||"formattedLabels"===a?t.labels?(o=((e,t)=>{for(var n in t||(t={}))rt.call(t,n)&&at(e,n,t[n]);if(nt)for(var n of nt(t))it.call(t,n)&&at(e,n,t[n]);return e})({},t.labels),s={__values:Object.values(t.labels).sort().join(", "),toString:()=>(0,e.formatLabels)(t.labels,"",!0)},et(o,tt(s))):"":void 0;var o,s}})}(o,a,s);return null!=(r=Le(t)(l))?r:""}getValueText(){return""}}],["__url",class{constructor(e,t){this.state={name:e,type:"url_macro"}}getValue(e){var t;const n=a.locationService.getLocation(),r=null!=(t=a.config.appSubUrl)?t:"";switch(null!=e?e:""){case"params":return new st(n.search);case"path":return r+n.pathname;default:return r+n.pathname+n.search}}getValueText(){return""}}],["__from",Ye],["__to",Ye],["__timezone",class{constructor(e,t){this.state={name:e,type:"time_macro"},this._sceneObject=t}getValue(){const e=Te(this._sceneObject).getTimeZone();return"browser"===e?Intl.DateTimeFormat().resolvedOptions().timeZone:e}getValueText(){return this.getValue()}}],["__user",class{constructor(e,t){this.state={name:e,type:"user_macro"}}getValue(e){const t=a.config.bootData.user;switch(e){case"login":return t.login;case"email":return t.email;default:return String(t.id)}}getValueText(){return""}}],["__org",class{constructor(e,t){this.state={name:e,type:"org_macro"}}getValue(e){const t=a.config.bootData.user;return"name"===e?t.orgName:String(t.orgId)}getValueText(){return""}}],["__interval",Ze],["__interval_ms",Ze]]);function ct(e,t,n,r,i){return t&&"string"==typeof t?(Ge.lastIndex=0,t.replace(Ge,((t,a,o,s,l,c,u)=>{const d=a||o||l,p=s||u||r,f=function(e,t,n,r){if(n&&n.hasOwnProperty(e)){const t=n[e];if(t)return function(e,t){return Ae?(Ae.state.name=e,Ae.state.value=t):Ae=new $e(e,t),Ae}(e,t)}const i=ae(e,r);if(i)return i;const a=lt.get(e);return a?new a(e,r,t,n):null}(d,t,n,e);if(!f)return i&&i.push({match:t,variableName:d,fieldPath:c,format:p,value:t,found:!1}),t;const h=function(e,t,n,r){if(null==n)return"";if(Ie(n))return ct(e,n.formatter(r));if(Array.isArray(n)||"object"!=typeof n||(n=`${n}`),"function"==typeof r)return r(n,{name:t.state.name,type:t.state.type,multi:t.state.isMulti,includeAll:t.state.includeAll});let i=[];r?(i=r.split(":"),i.length>1?(r=i[0],i=i.slice(1)):i=[]):r=le.Glob;let a=Fe.getIfExists(r);return a||(console.error(`Variable format ${r} not found. Using glob format as fallback.`),a=Fe.get(le.Glob)),a.formatter(n,i,t)}(e,f,f.getValue(c),p);return i&&i.push({match:t,variableName:d,fieldPath:c,format:p,value:h,found:h!==t}),h}))):null!=t?t:""}function ut(e){return void 0!==e.useState}function dt(e){return"enrichDataRequest"in e}function pt(e){return"isDataLayer"in e}function ft(e,t,...n){let r=!1;"undefined"!=typeof window&&(r="true"===localStorage.getItem("grafana.debug.scenes")),r&&console.log(`${e}: `,t,...n)}async function ht(e,t){if(null==e?void 0:e.uid){const t=ne.get(e.uid);if(t)return t}return e&&e.query?e:await(0,a.getDataSourceSrv)().get(e,t)}new WeakMap;class gt{constructor(){this._values=new Map}recordCurrentDependencyValuesForSceneObject(e){if(this.clearValues(),e.variableDependency)for(const t of e.variableDependency.getNames()){const n=kl.lookupVariable(t,e);n&&this._values.set(n.state.name,n.getValue())}}cloneAndRecordCurrentValuesForSceneObject(e){const t=new gt;return t.recordCurrentDependencyValuesForSceneObject(e),t}clearValues(){this._values.clear()}hasValues(){return!!this._values}recordCurrentValue(e){this._values.set(e.state.name,e.getValue())}hasRecordedValue(e){return this._values.has(e.state.name)}hasValueChanged(e){return!(!this._values.has(e.state.name)||Ms(this._values.get(e.state.name),e.getValue()))}hasDependenciesChanged(e){if(!this._values)return!1;if(!e.variableDependency)return!1;for(const t of e.variableDependency.getNames()){const n=kl.lookupVariable(t,e);if(!n)continue;const r=n.state.name;if(n&&this._values.has(r)&&!Ms(this._values.get(r),n.getValue()))return!0}return!1}}function mt(e){return"object"==typeof e&&"getExtraQueries"in e}var bt=Object.defineProperty,vt=Object.defineProperties,yt=Object.getOwnPropertyDescriptors,Ot=Object.getOwnPropertySymbols,wt=Object.prototype.hasOwnProperty,St=Object.prototype.propertyIsEnumerable,xt=(e,t,n)=>t in e?bt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const _t=(e,t)=>(0,b.of)(t);var Pt=Object.defineProperty,Et=Object.defineProperties,Ct=Object.getOwnPropertyDescriptors,kt=Object.getOwnPropertySymbols,Dt=Object.prototype.hasOwnProperty,Tt=Object.prototype.propertyIsEnumerable,Rt=(e,t,n)=>t in e?Pt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,It=(e,t)=>{for(var n in t||(t={}))Dt.call(t,n)&&Rt(e,n,t[n]);if(kt)for(var n of kt(t))Tt.call(t,n)&&Rt(e,n,t[n]);return e},At=(e,t)=>Et(e,Ct(t));function jt(e){const t=e.getRoot();return dt(t)?t.enrichDataRequest(e):null}let Lt,$t=new Set;function Ft(e){return t=>{const n=kl.getQueryController(e.origin);return n?new b.Observable((r=>{e.cancel||(e.cancel=()=>r.complete()),n.queryStarted(e);let i=!1;const a=t.subscribe({next:t=>{i||t.state===ce.Loading||(i=!0,n.queryCompleted(e)),r.next(t)},error:e=>r.error(e),complete:()=>{r.complete()}});return()=>{a.unsubscribe(),i||n.queryCompleted(e)}})):t}}const Nt=new Set;function Mt(e,t){e.setState(t)}class Vt extends Q{constructor(){super(...arguments),this._urlSync=new Bt(this)}validateAndUpdate(){return this.getValueOptions({}).pipe((0,b.map)((e=>(this.updateValueGivenNewOptions(e),{}))))}onCancel(){this.setStateHelper({loading:!1});const e=this.parent;null==e||e.cancel(this)}updateValueGivenNewOptions(e){const{value:t,text:n,options:r}=this.state,i=this.getStateUpdateGivenNewOptions(e,t,n);this.interceptStateUpdateAfterValidation(i),this.setStateHelper(i),(i.value!==t||i.text!==n||this.hasAllValue()&&!(0,re.isEqual)(e,r))&&this.publishEvent(new Re(this),!0)}getStateUpdateGivenNewOptions(e,t,n){const r={options:e,loading:!1,value:t,text:n};if(0===e.length)return this.state.defaultToAll||this.state.includeAll?(r.value=qe,r.text=Ue):this.state.isMulti?(r.value=[],r.text=[]):(r.value="",r.text=""),r;if(this.hasAllValue())return this.state.includeAll||(r.value=e[0].value,r.text=e[0].label,this.state.isMulti&&(r.value=[r.value],r.text=[r.text])),r;if(this.state.isMulti){const i=(Array.isArray(t)?t:[t]).filter((t=>e.find((e=>e.value===t)))),a=i.map((t=>e.find((e=>e.value===t)).label));if(0===i.length){const t=this.getDefaultMultiState(e);r.value=t.value,r.text=t.text}else(0,re.isEqual)(i,t)||(r.value=i),(0,re.isEqual)(a,n)||(r.text=a);return r}let i=function(e,t,n){let r;for(const i of n){if(i.value===e)return i;i.label===t&&(r=i)}return r}(t,n,e);return i?(r.text=i.label,r.value=i.value):this.state.defaultToAll?(r.value=qe,r.text=Ue):(r.value=e[0].value,r.text=e[0].label),r}interceptStateUpdateAfterValidation(e){const t=e.value===qe&&this.state.text===Ue;this.skipNextValidation&&e.value!==this.state.value&&e.text!==this.state.text&&!t&&(e.value=this.state.value,e.text=this.state.text),this.skipNextValidation=!1}getValue(){return this.hasAllValue()?this.state.allValue?new zt(this.state.allValue,this):this.state.options.map((e=>e.value)):this.state.value}getValueText(){return this.hasAllValue()?Ue:Array.isArray(this.state.text)?this.state.text.join(" + "):String(this.state.text)}hasAllValue(){const e=this.state.value;return e===qe||Array.isArray(e)&&e[0]===qe}getDefaultMultiState(e){return this.state.defaultToAll?{value:[qe],text:[Ue]}:e.length>0?{value:[e[0].value],text:[e[0].label]}:{value:[],text:[]}}changeValueTo(e,t){if(e!==this.state.value||t!==this.state.text){if(t||(t=Array.isArray(e)?e.map((e=>this.findLabelTextForValue(e))):this.findLabelTextForValue(e)),Array.isArray(e)){if(0===e.length){const n=this.getDefaultMultiState(this.state.options);e=n.value,t=n.text}e[e.length-1]===qe?(e=[qe],t=[Ue]):e[0]===qe&&e.length>1&&(e.shift(),Array.isArray(t)&&t.shift())}(0,re.isEqual)(e,this.state.value)&&(0,re.isEqual)(t,this.state.text)||(this.setStateHelper({value:e,text:t,loading:!1}),this.publishEvent(new Re(this),!0))}}findLabelTextForValue(e){if(e===qe)return Ue;const t=this.state.options.find((t=>t.value===e));if(t)return t.label;const n=this.state.options.find((t=>t.label===e));return n?n.label:e}setStateHelper(e){Mt(this,e)}getOptionsForSelect(){let e=this.state.options;return this.state.includeAll&&(e=[{value:qe,label:Ue},...e]),Array.isArray(this.state.value)||e.find((e=>e.value===this.state.value))||(e=[{value:this.state.value,label:String(this.state.text)},...e]),e}refreshOptions(){this.getValueOptions({}).subscribe((e=>{this.updateValueGivenNewOptions(e)}))}}class Bt{constructor(e){this._sceneObject=e}getKey(){return`var-${this._sceneObject.state.name}`}getKeys(){return this._sceneObject.state.skipUrlSync?[]:[this.getKey()]}getUrlState(){if(this._sceneObject.state.skipUrlSync)return{};let e=null,t=this._sceneObject.state.value;return e=Array.isArray(t)?t.map(String):this._sceneObject.state.isMulti?[String(t)]:String(t),{[this.getKey()]:e}}updateFromUrl(e){let t=e[this.getKey()];null!=t&&(this._sceneObject.state.includeAll&&(t=function(e){return(0,re.isArray)(e)&&e[0]===Ue?[qe]:e===Ue?qe:e}(t)),this._sceneObject.state.allValue&&this._sceneObject.state.allValue===t&&(t=qe),this._sceneObject.isActive||(this._sceneObject.skipNextValidation=!0),this._sceneObject.changeValueTo(t))}}class zt{constructor(e,t){this._value=e,this._variable=t}formatter(e){return e===le.Text?Ue:e===le.PercentEncode?Fe.get(le.PercentEncode).formatter(this._value,[],this._variable):e===le.QueryParam?Fe.get(le.QueryParam).formatter(Ue,[],this._variable):this._value}}var Wt=g(7);const Qt={RadioButton:{container:"data-testid radio-button"},Breadcrumbs:{breadcrumb:e=>`data-testid ${e} breadcrumb`},TimePicker:{openButton:"data-testid TimePicker Open Button",overlayContent:"data-testid TimePicker Overlay Content",fromField:"data-testid Time Range from field",toField:"data-testid Time Range to field",applyTimeRange:"data-testid TimePicker submit button",copyTimeRange:"data-testid TimePicker copy button",pasteTimeRange:"data-testid TimePicker paste button",calendar:{label:"data-testid Time Range calendar",openButton:"data-testid Open time range calendar",closeButton:"data-testid Close time range Calendar"},absoluteTimeRangeTitle:"data-testid-absolute-time-range-narrow"},DataSourcePermissions:{form:()=>'form[name="addPermission"]',roleType:"Role to add new permission to",rolePicker:"Built-in role picker",permissionLevel:"Permission Level"},DateTimePicker:{input:"data-testid date-time-input"},DataSource:{TestData:{QueryTab:{scenarioSelectContainer:"Test Data Query scenario select container",scenarioSelect:"Test Data Query scenario select",max:"TestData max",min:"TestData min",noise:"TestData noise",seriesCount:"TestData series count",spread:"TestData spread",startValue:"TestData start value",drop:"TestData drop values"}},DataSourceHttpSettings:{urlInput:"data-testid Datasource HTTP settings url"},Jaeger:{traceIDInput:"Trace ID"},Prometheus:{configPage:{connectionSettings:"Data source connection URL",manageAlerts:"prometheus-alerts-manager",scrapeInterval:"data-testid scrape interval",queryTimeout:"data-testid query timeout",defaultEditor:"data-testid default editor",disableMetricLookup:"disable-metric-lookup",prometheusType:"data-testid prometheus type",prometheusVersion:"data-testid prometheus version",cacheLevel:"data-testid cache level",incrementalQuerying:"prometheus-incremental-querying",queryOverlapWindow:"data-testid query overlap window",disableRecordingRules:"disable-recording-rules",customQueryParameters:"data-testid custom query parameters",httpMethod:"data-testid http method",exemplarsAddButton:"data-testid Add exemplar config button",internalLinkSwitch:"data-testid Internal link switch"},queryEditor:{explain:"data-testid prometheus explain switch wrapper",editorToggle:"data-testid QueryEditorModeToggle",options:"data-testid prometheus options",legend:"data-testid prometheus legend wrapper",format:"data-testid prometheus format",step:"prometheus-step",type:"data-testid prometheus type",exemplars:"prometheus-exemplars",builder:{metricSelect:"data-testid metric select",hints:"data-testid prometheus hints",metricsExplorer:"data-testid metrics explorer",queryAdvisor:"data-testid query advisor"},code:{queryField:"data-testid prometheus query field",metricsBrowser:{openButton:"data-testid open metrics browser",selectMetric:"data-testid select a metric",metricList:"data-testid metric list",labelNamesFilter:"data-testid label names filter",labelValuesFilter:"data-testid label values filter",useQuery:"data-testid use query",useAsRateQuery:"data-testid use as rate query",validateSelector:"data-testid validate selector",clear:"data-testid clear"}}},exemplarMarker:"data-testid Exemplar marker",variableQueryEditor:{queryType:"data-testid query type",labelnames:{metricRegex:"data-testid label names metric regex"},labelValues:{labelSelect:"data-testid label values label select"},metricNames:{metricRegex:"data-testid metric names metric regex"},varQueryResult:"data-testid variable query result",seriesQuery:"data-testid prometheus series query",classicQuery:"data-testid prometheus classic query"},annotations:{minStep:"prometheus-annotation-min-step",title:"data-testid prometheus annotation title",tags:"data-testid prometheus annotation tags",text:"data-testid prometheus annotation text",seriesValueAsTimestamp:"data-testid prometheus annotation series value as timestamp"}}},Menu:{MenuComponent:e=>`${e} menu`,MenuGroup:e=>`${e} menu group`,MenuItem:e=>`${e} menu item`,SubMenu:{container:"data-testid SubMenu container",icon:"data-testid SubMenu icon"}},Panels:{Panel:{title:e=>`data-testid Panel header ${e}`,headerItems:e=>`data-testid Panel header item ${e}`,menuItems:e=>`data-testid Panel menu item ${e}`,menu:e=>`data-testid Panel menu ${e}`,containerByTitle:e=>`${e} panel`,headerCornerInfo:e=>`Panel header ${e}`,status:e=>`data-testid Panel status ${e}`,loadingBar:()=>"Panel loading bar",HoverWidget:{container:"data-testid hover-header-container",dragIcon:"data-testid drag-icon"},PanelDataErrorMessage:"data-testid Panel data error message"},Visualization:{Graph:{container:"Graph container",VisualizationTab:{legendSection:"Legend section"},Legend:{legendItemAlias:e=>`gpl alias ${e}`,showLegendSwitch:"gpl show legend"},xAxis:{labels:()=>"div.flot-x-axis > div.flot-tick-label"}},BarGauge:{value:"Bar gauge value",valueV2:"data-testid Bar gauge value"},PieChart:{svgSlice:"data testid Pie Chart Slice"},Text:{container:()=>".markdown-html"},Table:{header:"table header",footer:"table-footer",body:"data-testid table body"}}},VizLegend:{seriesName:e=>`data-testid VizLegend series ${e}`},Drawer:{General:{title:e=>`Drawer title ${e}`,expand:"Drawer expand",contract:"Drawer contract",close:"data-testid Drawer close",rcContentWrapper:()=>".rc-drawer-content-wrapper",subtitle:"data-testid drawer subtitle"},DashboardSaveDrawer:{saveButton:"data-testid Save dashboard drawer button",saveAsButton:"data-testid Save as dashboard drawer button",saveAsTitleInput:"Save dashboard title field"}},PanelEditor:{General:{content:"Panel editor content"},OptionsPane:{content:"Panel editor option pane content",select:"Panel editor option pane select",fieldLabel:e=>`${e} field property editor`,fieldInput:e=>`data-testid Panel editor option pane field input ${e}`},DataPane:{content:"Panel editor data pane content"},applyButton:"data-testid Apply changes and go back to dashboard",toggleVizPicker:"data-testid toggle-viz-picker",toggleVizOptions:"data-testid toggle-viz-options",toggleTableView:"toggle-table-view",showZoomField:"Map controls Show zoom control field property editor",showAttributionField:"Map controls Show attribution field property editor",showScaleField:"Map controls Show scale field property editor",showMeasureField:"Map controls Show measure tools field property editor",showDebugField:"Map controls Show debug field property editor",measureButton:"show measure tools"},PanelInspector:{Data:{content:"Panel inspector Data content"},Stats:{content:"Panel inspector Stats content"},Json:{content:"Panel inspector Json content"},Query:{content:"Panel inspector Query content",refreshButton:"Panel inspector Query refresh button",jsonObjectKeys:()=>".json-formatter-key"}},Tab:{title:e=>`Tab ${e}`,active:()=>'[class*="-activeTabStyle"]'},RefreshPicker:{runButton:"RefreshPicker run button",intervalButton:"RefreshPicker interval button",runButtonV2:"data-testid RefreshPicker run button",intervalButtonV2:"data-testid RefreshPicker interval button"},QueryTab:{content:"Query editor tab content",queryInspectorButton:"Query inspector button",queryHistoryButton:"data-testid query-history-button",addQuery:"data-testid query-tab-add-query",queryGroupTopSection:"data-testid query group top section",addExpression:"data-testid query-tab-add-expression"},QueryHistory:{queryText:"Query text"},QueryEditorRows:{rows:"Query editor row"},QueryEditorRow:{actionButton:e=>`data-testid ${e}`,title:e=>`Query editor row title ${e}`,container:e=>`Query editor row ${e}`},AlertTab:{content:"data-testid Alert editor tab content"},AlertRules:{groupToggle:"data-testid group-collapse-toggle",toggle:"data-testid collapse-toggle",expandedContent:"data-testid expanded-content"},Alert:{alert:e=>`Alert ${e}`,alertV2:e=>`data-testid Alert ${e}`},TransformTab:{content:"data-testid Transform editor tab content",newTransform:e=>`data-testid New transform ${e}`,transformationEditor:e=>`data-testid Transformation editor ${e}`,transformationEditorDebugger:e=>`data-testid Transformation editor debugger ${e}`},Transforms:{card:e=>`data-testid New transform ${e}`,disableTransformationButton:"data-testid Disable transformation button",Reduce:{modeLabel:"data-testid Transform mode label",calculationsLabel:"data-testid Transform calculations label"},SpatialOperations:{actionLabel:"root Action field property editor",locationLabel:"root Location Mode field property editor",location:{autoOption:"Auto location option",coords:{option:"Coords location option",latitudeFieldLabel:"root Latitude field field property editor",longitudeFieldLabel:"root Longitude field field property editor"},geohash:{option:"Geohash location option",geohashFieldLabel:"root Geohash field field property editor"},lookup:{option:"Lookup location option",lookupFieldLabel:"root Lookup field field property editor",gazetteerFieldLabel:"root Gazetteer field property editor"}}},searchInput:"data-testid search transformations",noTransformationsMessage:"data-testid no transformations message",addTransformationButton:"data-testid add transformation button",removeAllTransformationsButton:"data-testid remove all transformations button"},NavBar:{Configuration:{button:"Configuration"},Toggle:{button:"data-testid Toggle menu"},Reporting:{button:"Reporting"}},NavMenu:{Menu:"data-testid navigation mega-menu",item:"data-testid Nav menu item"},NavToolbar:{container:"data-testid Nav toolbar",shareDashboard:"data-testid Share dashboard",markAsFavorite:"data-testid Mark as favorite",editDashboard:{editButton:"data-testid Edit dashboard button",saveButton:"data-testid Save dashboard button",exitButton:"data-testid Exit edit mode button",settingsButton:"data-testid Dashboard settings",addRowButton:"data-testid Add row button",addLibraryPanelButton:"data-testid Add a panel from the panel library button",addVisualizationButton:"data-testid Add new visualization menu item",pastePanelButton:"data-testid Paste panel button",discardChangesButton:"data-testid Discard changes button",discardLibraryPanelButton:"data-testid Discard library panel button",unlinkLibraryPanelButton:"data-testid Unlink library panel button",saveLibraryPanelButton:"data-testid Save library panel button",backToDashboardButton:"data-testid Back to dashboard button"}},PageToolbar:{container:()=>".page-toolbar",item:e=>`${e}`,itemButton:e=>`data-testid ${e}`},QueryEditorToolbarItem:{button:e=>`QueryEditor toolbar item button ${e}`},BackButton:{backArrow:"data-testid Go Back"},OptionsGroup:{group:e=>e?`Options group ${e}`:"Options group",toggle:e=>e?`Options group ${e} toggle`:"Options group toggle"},PluginVisualization:{item:e=>`Plugin visualization item ${e}`,current:()=>'[class*="-currentVisualizationItem"]'},Select:{option:"Select option",input:()=>'input[id*="time-options-input"]',singleValue:()=>'div[class*="-singleValue"]'},FieldConfigEditor:{content:"Field config editor content"},OverridesConfigEditor:{content:"Field overrides editor content"},FolderPicker:{container:"Folder picker select container",containerV2:"data-testid Folder picker select container",input:"data-testid folder-picker-input"},ReadonlyFolderPicker:{container:"data-testid Readonly folder picker select container"},DataSourcePicker:{container:"data-testid Data source picker select container",input:()=>'input[id="data-source-picker"]',inputV2:"data-testid Select a data source",dataSourceList:"data-testid Data source list dropdown",advancedModal:{dataSourceList:"data-testid Data source list",builtInDataSourceList:"data-testid Built in data source list"}},TimeZonePicker:{container:"Time zone picker select container",containerV2:"data-testid Time zone picker select container",changeTimeSettingsButton:"data-testid Time zone picker Change time settings button"},WeekStartPicker:{container:"Choose starting day of the week",containerV2:"data-testid Choose starting day of the week",placeholder:"Choose starting day of the week"},TraceViewer:{spanBar:"data-testid SpanBar--wrapper"},QueryField:{container:"data-testid Query field"},QueryBuilder:{queryPatterns:"data-testid Query patterns",labelSelect:"data-testid Select label",valueSelect:"data-testid Select value",matchOperatorSelect:"data-testid Select match operator"},ValuePicker:{button:e=>`data-testid Value picker button ${e}`,select:e=>`data-testid Value picker select ${e}`},Search:{section:"Search section",sectionV2:"data-testid Search section",items:"Search items",itemsV2:"data-testid Search items",cards:"data-testid Search cards",collapseFolder:e=>`data-testid Collapse folder ${e}`,expandFolder:e=>`data-testid Expand folder ${e}`,dashboardItem:e=>`${Qt.Search.dashboardItems} ${e}`,dashboardCard:e=>`data-testid Search card ${e}`,folderHeader:e=>`data-testid Folder header ${e}`,folderContent:e=>`data-testid Folder content ${e}`,dashboardItems:"data-testid Dashboard search item"},DashboardLinks:{container:"data-testid Dashboard link container",dropDown:"data-testid Dashboard link dropdown",link:"data-testid Dashboard link"},LoadingIndicator:{icon:"data-testid Loading indicator"},CallToActionCard:{button:e=>`Call to action button ${e}`,buttonV2:e=>`data-testid Call to action button ${e}`},DataLinksContextMenu:{singleLink:"data-testid Data link"},CodeEditor:{container:"data-testid Code editor container"},DashboardImportPage:{textarea:"data-testid-import-dashboard-textarea",submit:"data-testid-load-dashboard"},ImportDashboardForm:{name:"data-testid-import-dashboard-title",submit:"data-testid-import-dashboard-submit"},PanelAlertTabContent:{content:"data-testid Unified alert editor tab content"},VisualizationPreview:{card:e=>`data-testid suggestion-${e}`},ColorSwatch:{name:"data-testid-colorswatch"},DashboardRow:{title:e=>`data-testid dashboard-row-title-${e}`},UserProfile:{profileSaveButton:"data-testid-user-profile-save",preferencesSaveButton:"data-testid-shared-prefs-save",orgsTable:"data-testid-user-orgs-table",sessionsTable:"data-testid-user-sessions-table",extensionPointTabs:"data-testid-extension-point-tabs",extensionPointTab:e=>`data-testid-extension-point-tab-${e}`},FileUpload:{inputField:"data-testid-file-upload-input-field",fileNameSpan:"data-testid-file-upload-file-name"},DebugOverlay:{wrapper:"debug-overlay"},OrgRolePicker:{input:"Role"},AnalyticsToolbarButton:{button:"Dashboard insights"},Variables:{variableOption:"data-testid variable-option"},Annotations:{annotationsTypeInput:"annotations-type-input",annotationsChoosePanelInput:"choose-panels-input",editor:{testButton:"data-testid annotations-test-button",resultContainer:"data-testid annotations-query-result-container"}},Tooltip:{container:"data-testid tooltip"},ReturnToPrevious:{buttonGroup:"data-testid dismissable button group",backButton:"data-testid back",dismissButton:"data-testid dismiss"},SQLQueryEditor:{selectColumn:"data-testid select-column",selectAggregation:"data-testid select-aggregation",selectAlias:"data-testid select-alias",filterConjunction:"data-testid filter-conjunction",filterField:"data-testid filter-field",filterOperator:"data-testid filter-operator",headerTableSelector:"data-testid header-table-selector",headerFilterSwitch:"data-testid header-filter-switch",headerGroupSwitch:"data-testid header-group-switch",headerOrderSwitch:"data-testid header-order-switch",headerPreviewSwitch:"data-testid header-preview-switch"}},Ut={Login:{url:"/login",username:"data-testid Username input field",password:"data-testid Password input field",submit:"data-testid Login button",skip:"data-testid Skip change password button"},Home:{url:"/"},DataSource:{name:"data-testid Data source settings page name input field",delete:"Data source settings page Delete button",readOnly:"data-testid Data source settings page read only message",saveAndTest:"data-testid Data source settings page Save and Test button",alert:"data-testid Data source settings page Alert"},DataSources:{url:"/datasources",dataSources:e=>`Data source list item ${e}`},EditDataSource:{url:e=>`/datasources/edit/${e}`,settings:"Datasource settings page basic settings"},AddDataSource:{url:"/datasources/new",dataSourcePlugins:e=>`Data source plugin item ${e}`,dataSourcePluginsV2:e=>`Add new data source ${e}`},ConfirmModal:{delete:"data-testid Confirm Modal Danger Button"},AddDashboard:{url:"/dashboard/new",itemButton:e=>`data-testid ${e}`,addNewPanel:"Add new panel",addNewRow:"Add new row",addNewPanelLibrary:"Add new panel from panel library"},Dashboard:{url:e=>`/d/${e}`,DashNav:{nav:"Dashboard navigation",navV2:"data-testid Dashboard navigation",publicDashboardTag:"data-testid public dashboard tag",shareButton:"data-testid share-button",scrollContainer:"data-testid Dashboard canvas scroll container",playlistControls:{prev:"data-testid playlist previous dashboard button",stop:"data-testid playlist stop dashboard button",next:"data-testid playlist next dashboard button"}},SubMenu:{submenu:"Dashboard submenu",submenuItem:"data-testid template variable",submenuItemLabels:e=>`data-testid Dashboard template variables submenu Label ${e}`,submenuItemValueDropDownValueLinkTexts:e=>`data-testid Dashboard template variables Variable Value DropDown value link text ${e}`,submenuItemValueDropDownDropDown:"Variable options",submenuItemValueDropDownOptionTexts:e=>`data-testid Dashboard template variables Variable Value DropDown option text ${e}`,Annotations:{annotationsWrapper:"data-testid annotation-wrapper",annotationLabel:e=>`data-testid Dashboard annotations submenu Label ${e}`,annotationToggle:e=>`data-testid Dashboard annotations submenu Toggle ${e}`}},Settings:{Actions:{close:"data-testid dashboard-settings-close"},General:{deleteDashBoard:"Dashboard settings page delete dashboard button",sectionItems:e=>`Dashboard settings section item ${e}`,saveDashBoard:"Dashboard settings aside actions Save button",saveAsDashBoard:"Dashboard settings aside actions Save As button",timezone:"Time zone picker select container",title:"Tab General"},Annotations:{List:{addAnnotationCTA:Qt.CallToActionCard.button("Add annotation query"),addAnnotationCTAV2:Qt.CallToActionCard.buttonV2("Add annotation query"),annotations:"data-testid list-annotations"},Settings:{name:"Annotations settings name input"},NewAnnotation:{panelFilterSelect:"data-testid annotations-panel-filter",showInLabel:"show-in-label",previewInDashboard:"data-testid annotations-preview",delete:"data-testid annotations-delete",apply:"data-testid annotations-apply",enable:"data-testid annotation-enable",hide:"data-testid annotation-hide"}},Variables:{List:{addVariableCTA:Qt.CallToActionCard.button("Add variable"),addVariableCTAV2:Qt.CallToActionCard.buttonV2("Add variable"),newButton:"Variable editor New variable button",table:"Variable editor Table",tableRowNameFields:e=>`Variable editor Table Name field ${e}`,tableRowDefinitionFields:e=>`Variable editor Table Definition field ${e}`,tableRowArrowUpButtons:e=>`Variable editor Table ArrowUp button ${e}`,tableRowArrowDownButtons:e=>`Variable editor Table ArrowDown button ${e}`,tableRowDuplicateButtons:e=>`Variable editor Table Duplicate button ${e}`,tableRowRemoveButtons:e=>`Variable editor Table Remove button ${e}`},Edit:{General:{headerLink:"Variable editor Header link",modeLabelNew:"Variable editor Header mode New",modeLabelEdit:"Variable editor Header mode Edit",generalNameInput:"Variable editor Form Name field",generalNameInputV2:"data-testid Variable editor Form Name field",generalTypeSelect:"Variable editor Form Type select",generalTypeSelectV2:"data-testid Variable editor Form Type select",generalLabelInput:"Variable editor Form Label field",generalLabelInputV2:"data-testid Variable editor Form Label field",generalHideSelect:"Variable editor Form Hide select",generalHideSelectV2:"data-testid Variable editor Form Hide select",selectionOptionsMultiSwitch:"data-testid Variable editor Form Multi switch",selectionOptionsIncludeAllSwitch:"data-testid Variable editor Form IncludeAll switch",selectionOptionsCustomAllInput:"data-testid Variable editor Form IncludeAll field",previewOfValuesOption:"data-testid Variable editor Preview of Values option",submitButton:"data-testid Variable editor Run Query button",applyButton:"data-testid Variable editor Apply button"},QueryVariable:{queryOptionsDataSourceSelect:Qt.DataSourcePicker.inputV2,queryOptionsRefreshSelect:"Variable editor Form Query Refresh select",queryOptionsRefreshSelectV2:"data-testid Variable editor Form Query Refresh select",queryOptionsRegExInput:"Variable editor Form Query RegEx field",queryOptionsRegExInputV2:"data-testid Variable editor Form Query RegEx field",queryOptionsSortSelect:"Variable editor Form Query Sort select",queryOptionsSortSelectV2:"data-testid Variable editor Form Query Sort select",queryOptionsQueryInput:"data-testid Variable editor Form Default Variable Query Editor textarea",valueGroupsTagsEnabledSwitch:"Variable editor Form Query UseTags switch",valueGroupsTagsTagsQueryInput:"Variable editor Form Query TagsQuery field",valueGroupsTagsTagsValuesQueryInput:"Variable editor Form Query TagsValuesQuery field"},ConstantVariable:{constantOptionsQueryInput:"Variable editor Form Constant Query field",constantOptionsQueryInputV2:"data-testid Variable editor Form Constant Query field"},DatasourceVariable:{datasourceSelect:"data-testid datasource variable datasource type"},TextBoxVariable:{textBoxOptionsQueryInput:"Variable editor Form TextBox Query field",textBoxOptionsQueryInputV2:"data-testid Variable editor Form TextBox Query field"},CustomVariable:{customValueInput:"data-testid custom-variable-input"},IntervalVariable:{intervalsValueInput:"data-testid interval variable intervals input",autoEnabledCheckbox:"data-testid interval variable auto value checkbox",stepCountIntervalSelect:"data-testid interval variable step count input",minIntervalInput:"data-testid interval variable mininum interval input"},GroupByVariable:{dataSourceSelect:Qt.DataSourcePicker.inputV2,infoText:"data-testid group by variable info text",modeToggle:"data-testid group by variable mode toggle"},AdHocFiltersVariable:{datasourceSelect:Qt.DataSourcePicker.inputV2,infoText:"data-testid ad-hoc filters variable info text",modeToggle:"data-testid ad-hoc filters variable mode toggle"}}}},Annotations:{marker:"data-testid annotation-marker"},Rows:{Repeated:{ConfigSection:{warningMessage:"data-testid Repeated rows warning message"}}}},Dashboards:{url:"/dashboards",dashboards:e=>`Dashboard search item ${e}`},SaveDashboardAsModal:{newName:"Save dashboard title field",save:"Save dashboard button"},SaveDashboardModal:{save:"Dashboard settings Save Dashboard Modal Save button",saveVariables:"Dashboard settings Save Dashboard Modal Save variables checkbox",saveTimerange:"Dashboard settings Save Dashboard Modal Save timerange checkbox",saveRefresh:"Dashboard settings Save Dashboard Modal Save refresh checkbox"},SharePanelModal:{linkToRenderedImage:"Link to rendered image"},ShareDashboardModal:{PublicDashboard:{Tab:"Tab Public dashboard",WillBePublicCheckbox:"data-testid public dashboard will be public checkbox",LimitedDSCheckbox:"data-testid public dashboard limited datasources checkbox",CostIncreaseCheckbox:"data-testid public dashboard cost may increase checkbox",PauseSwitch:"data-testid public dashboard pause switch",EnableAnnotationsSwitch:"data-testid public dashboard on off switch for annotations",CreateButton:"data-testid public dashboard create button",DeleteButton:"data-testid public dashboard delete button",CopyUrlInput:"data-testid public dashboard copy url input",CopyUrlButton:"data-testid public dashboard copy url button",SettingsDropdown:"data-testid public dashboard settings dropdown",TemplateVariablesWarningAlert:"data-testid public dashboard disabled template variables alert",UnsupportedDataSourcesWarningAlert:"data-testid public dashboard unsupported data sources alert",NoUpsertPermissionsWarningAlert:"data-testid public dashboard no upsert permissions alert",EnableTimeRangeSwitch:"data-testid public dashboard on off switch for time range",EmailSharingConfiguration:{Container:"data-testid email sharing config container",ShareType:"data-testid public dashboard share type",EmailSharingInput:"data-testid public dashboard email sharing input",EmailSharingInviteButton:"data-testid public dashboard email sharing invite button",EmailSharingList:"data-testid public dashboard email sharing list",DeleteEmail:"data-testid public dashboard delete email button",ReshareLink:"data-testid public dashboard reshare link button"}},PublicDashboardScene:{Tab:"Tab Public Dashboard"}},PublicDashboard:{page:"public-dashboard-page",NotAvailable:{container:"public-dashboard-not-available",title:"public-dashboard-title",pausedDescription:"public-dashboard-paused-description"},footer:"public-dashboard-footer"},PublicDashboardScene:{loadingPage:"public-dashboard-scene-loading-page",page:"public-dashboard-scene-page",controls:"public-dashboard-controls"},RequestViewAccess:{form:"request-view-access-form",recipientInput:"request-view-access-recipient-input",submitButton:"request-view-access-submit-button"},PublicDashboardConfirmAccess:{submitButton:"data-testid confirm-access-submit-button"},Explore:{url:"/explore",General:{container:"data-testid Explore",graph:"Explore Graph",table:"Explore Table",scrollView:"data-testid explorer scroll view"}},SoloPanel:{url:e=>`/d-solo/${e}`},PluginsList:{page:"Plugins list page",list:"Plugins list",listItem:"Plugins list item",signatureErrorNotice:"data-testid Unsigned plugins notice"},PluginPage:{page:"Plugin page",signatureInfo:"data-testid Plugin signature info",disabledInfo:"data-testid Plugin disabled info"},PlaylistForm:{name:"Playlist name",interval:"Playlist interval",itemDelete:"data-testid playlist-form-delete-item"},BrowseDashboards:{table:{body:"data-testid browse-dashboards-table",row:e=>`data-testid browse dashboards row ${e}`,checkbox:e=>`data-testid ${e} checkbox`},NewFolderForm:{form:"data-testid new folder form",nameInput:"data-testid new-folder-name-input",createButton:"data-testid new-folder-create-button"}},Search:{url:"/?search=openn",FolderView:{url:"/?search=open&layout=folders"}},PublicDashboards:{ListItem:{linkButton:"public-dashboard-link-button",configButton:"public-dashboard-configuration-button",trashcanButton:"public-dashboard-remove-button",pauseSwitch:"data-testid public dashboard pause switch"}},UserListPage:{tabs:{allUsers:"data-testid all-users-tab",orgUsers:"data-testid org-users-tab",anonUserDevices:"data-testid anon-user-devices-tab",publicDashboardsUsers:"data-testid public-dashboards-users-tab",users:"data-testid users-tab"},org:{url:"/org/users"},admin:{url:"/admin/users"},publicDashboards:{container:"data-testid public-dashboards-users-list"},UserListAdminPage:{container:"data-testid user-list-admin-page"},UsersListPage:{container:"data-testid users-list-page"},UserAnonListPage:{container:"data-testid user-anon-list-page"},UsersListPublicDashboardsPage:{container:"data-testid users-list-public-dashboards-page",DashboardsListModal:{listItem:e=>`data-testid dashboards-list-item-${e}`}}},ProfilePage:{url:"/profile"}},qt={pages:Ut,components:Qt};var Ht=g(89);const Gt=new Intl.Collator("en",{numeric:!0,sensitivity:"base"}).compare,Xt=1/0,Yt=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),Zt="eexxaacctt",Kt=(e,t,n)=>e.replace("A-Z",t).replace("a-z",n),Jt={unicode:!1,alpha:null,interSplit:"[^A-Za-z\\d']+",intraSplit:"[a-z][A-Z]",intraBound:"[A-Za-z]\\d|\\d[A-Za-z]|[a-z][A-Z]",interLft:0,interRgt:0,interChars:".",interIns:Xt,intraChars:"[a-z\\d']",intraIns:null,intraContr:"'[a-z]{1,2}\\b",intraMode:0,intraSlice:[1,Xt],intraSub:null,intraTrn:null,intraDel:null,intraFilt:(e,t,n)=>!0,sort:(e,t,n)=>{let{idx:r,chars:i,terms:a,interLft2:o,interLft1:s,start:l,intraIns:c,interIns:u}=e;return r.map(((e,t)=>t)).sort(((e,n)=>i[n]-i[e]||c[e]-c[n]||a[n]+o[n]+.5*s[n]-(a[e]+o[e]+.5*s[e])||u[e]-u[n]||l[e]-l[n]||Gt(t[r[e]],t[r[n]])))}},en=(e,t)=>0==t?"":1==t?e+"??":t==Xt?e+"*?":e+`{0,${t}}?`,tn="(?:\\b|_)";function nn(e){e=Object.assign({},Jt,e);let{unicode:t,interLft:n,interRgt:r,intraMode:i,intraSlice:a,intraIns:o,intraSub:s,intraTrn:l,intraDel:c,intraContr:u,intraSplit:d,interSplit:p,intraBound:f,intraChars:h}=e;o??=i,s??=i,l??=i,c??=i;let g=e.letters??e.alpha;if(null!=g){let e=g.toLocaleUpperCase(),t=g.toLocaleLowerCase();p=Kt(p,e,t),d=Kt(d,e,t),f=Kt(f,e,t),h=Kt(h,e,t),u=Kt(u,e,t)}let m=t?"u":"";const b='".+?"',v=new RegExp(b,"gi"+m),y=new RegExp(`(?:\\s+|^)-(?:${h}+|${b})`,"gi"+m);let{intraRules:O}=e;null==O&&(O=e=>{let t=Jt.intraSlice,n=0,r=0,i=0,u=0;if(/[^\d]/.test(e)){let d=e.length;d<=4?d>=3&&(i=Math.min(l,1),4==d&&(n=Math.min(o,1))):(t=a,n=o,r=s,i=l,u=c)}return{intraSlice:t,intraIns:n,intraSub:r,intraTrn:i,intraDel:u}});let w=!!d,S=new RegExp(d,"g"+m),x=new RegExp(p,"g"+m),_=new RegExp("^"+p+"|"+p+"$","g"+m),P=new RegExp(u,"gi"+m);const E=e=>{let t=[];e=(e=e.replace(v,(e=>(t.push(e),Zt)))).replace(_,"").toLocaleLowerCase(),w&&(e=e.replace(S,(e=>e[0]+" "+e[1])));let n=0;return e.split(x).filter((e=>""!=e)).map((e=>e===Zt?t[n++]:e))},C=/[^\d]+|\d+/g,k=(t,a=0,s=!1)=>{let l=E(t);if(0==l.length)return[];let c,u=Array(l.length).fill("");if(l=l.map(((e,t)=>e.replace(P,(e=>(u[t]=e,""))))),1==i)c=l.map(((e,t)=>{if('"'===e[0])return Yt(e.slice(1,-1));let n="";for(let r of e.matchAll(C)){let e=r[0],{intraSlice:i,intraIns:a,intraSub:o,intraTrn:s,intraDel:l}=O(e);if(a+o+s+l==0)n+=e+u[t];else{let[r,c]=i,d=e.slice(0,r),p=e.slice(c),f=e.slice(r,c);1==a&&1==d.length&&d!=f[0]&&(d+="(?!"+d+")");let g=f.length,m=[e];if(o)for(let e=0;e<g;e++)m.push(d+f.slice(0,e)+h+f.slice(e+1)+p);if(s)for(let e=0;e<g-1;e++)f[e]!=f[e+1]&&m.push(d+f.slice(0,e)+f[e+1]+f[e]+f.slice(e+2)+p);if(l)for(let e=0;e<g;e++)m.push(d+f.slice(0,e+1)+"?"+f.slice(e+1)+p);if(a){let e=en(h,1);for(let t=0;t<g;t++)m.push(d+f.slice(0,t)+e+f.slice(t)+p)}n+="(?:"+m.join("|")+")"+u[t]}}return n}));else{let e=en(h,o);2==a&&o>0&&(e=")("+e+")("),c=l.map(((t,n)=>'"'===t[0]?Yt(t.slice(1,-1)):t.split("").map(((e,t,n)=>(1==o&&0==t&&n.length>1&&e!=n[t+1]&&(e+="(?!"+e+")"),e))).join(e)+u[n]))}let d=2==n?tn:"",p=2==r?tn:"",f=p+en(e.interChars,e.interIns)+d;return a>0?s?c=d+"("+c.join(")"+p+"|"+d+"(")+")"+p:(c="("+c.join(")("+f+")(")+")",c="(.??"+d+")"+c+"("+p+".*)"):(c=c.join(f),c=d+c+p),[new RegExp(c,"i"+m),l,u]},D=(e,t,n)=>{let[r]=k(t);if(null==r)return null;let i=[];if(null!=n)for(let t=0;t<n.length;t++){let a=n[t];r.test(e[a])&&i.push(a)}else for(let t=0;t<e.length;t++)r.test(e[t])&&i.push(t);return i};let T=!!f,R=new RegExp(p,m),I=new RegExp(f,m);const A=(t,i,a)=>{let[o,s,l]=k(a,1),[c]=k(a,2),u=s.length,d=t.length,p=Array(d).fill(0),f={idx:Array(d),start:p.slice(),chars:p.slice(),terms:p.slice(),interIns:p.slice(),intraIns:p.slice(),interLft2:p.slice(),interRgt2:p.slice(),interLft1:p.slice(),interRgt1:p.slice(),ranges:Array(d)},h=1==n||1==r,g=0;for(let a=0;a<t.length;a++){let d=i[t[a]],p=d.match(o),b=p.index+p[1].length,v=b,y=!1,O=0,w=0,S=0,x=0,_=0,P=0,E=0,C=0,k=[];for(let t=0,i=2;t<u;t++,i+=2){let a=p[i].toLocaleLowerCase(),o=s[t],c='"'==o[0]?o.slice(1,-1):o+l[t],f=c.length,g=a.length,D=a==c;if(!D&&p[i+1].length>=f){let e=p[i+1].toLocaleLowerCase().indexOf(c);e>-1&&(k.push(v,g,e,f),v+=j(p,i,e,f),a=c,g=f,D=!0,0==t&&(b=v))}if(h||D){let e=v-1,o=v+g,s=!1,l=!1;if(-1==e||R.test(d[e]))D&&O++,s=!0;else{if(2==n){y=!0;break}if(T&&I.test(d[e]+d[e+1]))D&&w++,s=!0;else if(1==n){let e=p[i+1],n=v+g;if(e.length>=f){let r,o=0,l=!1,u=new RegExp(c,"ig"+m);for(;r=u.exec(e);){o=r.index;let e=n+o,t=e-1;if(-1==t||R.test(d[t])){O++,l=!0;break}if(I.test(d[t]+d[e])){w++,l=!0;break}}l&&(s=!0,k.push(v,g,o,f),v+=j(p,i,o,f),a=c,g=f,D=!0,0==t&&(b=v))}if(!s){y=!0;break}}}if(o==d.length||R.test(d[o]))D&&S++,l=!0;else{if(2==r){y=!0;break}if(T&&I.test(d[o-1]+d[o]))D&&x++,l=!0;else if(1==r){y=!0;break}}D&&(_+=f,s&&l&&P++)}if(g>f&&(C+=g-f),t>0&&(E+=p[i-1].length),!e.intraFilt(c,a,v)){y=!0;break}t<u-1&&(v+=g+p[i+1].length)}if(!y){f.idx[g]=t[a],f.interLft2[g]=O,f.interLft1[g]=w,f.interRgt2[g]=S,f.interRgt1[g]=x,f.chars[g]=_,f.terms[g]=P,f.interIns[g]=E,f.intraIns[g]=C,f.start[g]=b;let e=d.match(c),n=e.index+e[1].length,r=k.length,i=r>0?0:1/0,o=r-4;for(let t=2;t<e.length;){let r=e[t].length;if(i<=o&&k[i]==n){let r=k[i+1],a=k[i+2],o=k[i+3],s=t,l="";for(let t=0;t<r;s++)l+=e[s],t+=e[s].length;e.splice(t,s-t,l),n+=j(e,t,a,o),i+=4}else n+=r,t++}n=e.index+e[1].length;let s=f.ranges[g]=[],l=n,u=n;for(let t=2;t<e.length;t++){let r=e[t].length;n+=r,t%2==0?u=n:r>0&&(s.push(l,u),l=u=n)}u>l&&s.push(l,u),g++}}if(g<t.length)for(let e in f)f[e]=f[e].slice(0,g);return f},j=(e,t,n,r)=>{let i=e[t]+e[t+1].slice(0,n);return e[t-1]+=i,e[t]=e[t+1].slice(n,n+r),e[t+1]=e[t+1].slice(n+r),i.length};return{search:(...t)=>{let n=((t,n,r,i=1e3,a)=>{r=r?!0===r?5:r:0;let o=null,s=null,l=[];n=n.replace(y,(e=>{let t=e.trim().slice(1);return'"'===t[0]&&(t=Yt(t.slice(1,-1))),l.push(t),""}));let c,u=E(n);if(l.length>0){if(c=new RegExp(l.join("|"),"i"+m),0==u.length){let e=[];for(let n=0;n<t.length;n++)c.test(t[n])||e.push(n);return[e,null,null]}}else if(0==u.length)return[null,null,null];if(r>0){let e=E(n);if(e.length>1){let n=e.slice().sort(((e,t)=>t.length-e.length));for(let e=0;e<n.length;e++){if(0==a?.length)return[[],null,null];a=D(t,n[e],a)}if(e.length>r)return[a,null,null];o=an(e).map((e=>e.join(" "))),s=[];let i=new Set;for(let e=0;e<o.length;e++)if(i.size<a.length){let n=a.filter((e=>!i.has(e))),r=D(t,o[e],n);for(let e=0;e<r.length;e++)i.add(r[e]);s.push(r)}else s.push([])}}null==o&&(o=[n],s=[a?.length>0?a:D(t,n)]);let d=null,p=null;if(l.length>0&&(s=s.map((e=>e.filter((e=>!c.test(t[e])))))),s.reduce(((e,t)=>e+t.length),0)<=i){d={},p=[];for(let n=0;n<s.length;n++){let r=s[n];if(null==r||0==r.length)continue;let i=o[n],a=A(r,t,i),l=e.sort(a,t,i);if(n>0)for(let e=0;e<l.length;e++)l[e]+=p.length;for(let e in a)d[e]=(d[e]??[]).concat(a[e]);p=p.concat(l)}}return[[].concat(...s),d,p]})(...t);return n},split:E,filter:D,info:A,sort:e.sort}}const rn=(()=>{let e={A:"",a:"",E:"",e:"",I:"",i:"",O:"",o:"",U:"",u:"",C:"",c:"",L:"",l:"",N:"",n:"",S:"",s:"",Z:"",z:""},t=new Map,n="";for(let r in e)e[r].split("").forEach((e=>{n+=e,t.set(e,r)}));let r=new RegExp(`[${n}]`,"g"),i=e=>t.get(e);return e=>{if("string"==typeof e)return e.replace(r,i);let t=Array(e.length);for(let n=0;n<e.length;n++)t[n]=e[n].replace(r,i);return t}})();function an(e){let t,n,r=(e=e.slice()).length,i=[e.slice()],a=new Array(r).fill(0),o=1;for(;o<r;)a[o]<o?(t=o%2&&a[o],n=e[o],e[o]=e[t],e[t]=n,++a[o],o=1,i.push(e.slice())):(a[o]=0,++o);return i}const on=(e,t)=>t?`<mark>${e}</mark>`:e,sn=(e,t)=>e+t;function ln(e,t){const n=new nn;let r=e;const i=[],a=1e4;return t&&(r=[{value:qe,label:Ue},...r]),e=>{if(""===e)return r.length>a?r.slice(0,a):r;if(0===i.length)for(let e=0;e<r.length;e++)i.push(r[e].label);const t=n.filter(i,e),o=[];if(t){for(let e=0;e<t.length;e++)if(o.push(r[t[e]]),o.length>a)return o;return o}return r.length>a?r.slice(0,a):r}}nn.latinize=rn,nn.permute=e=>{let t=an([...Array(e.length).keys()]).sort(((e,t)=>{for(let n=0;n<e.length;n++)if(e[n]!=t[n])return e[n]-t[n];return 0}));return t.map((t=>t.map((t=>e[t]))))},nn.highlight=function(e,t,n=on,r="",i=sn){r=i(r,n(e.substring(0,t[0]),!1))??r;for(let a=0;a<t.length;a+=2){let o=t[a],s=t[a+1];r=i(r,n(e.substring(o,s),!0))??r,a<t.length-3&&(r=i(r,n(e.substring(t[a+1],t[a+2]),!1))??r)}return i(r,n(e.substring(t[t.length-1]),!1))??r};var cn=Object.defineProperty,un=Object.defineProperties,dn=Object.getOwnPropertyDescriptors,pn=Object.getOwnPropertySymbols,fn=Object.prototype.hasOwnProperty,hn=Object.prototype.propertyIsEnumerable,gn=(e,t,n)=>t in e?cn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const mn=()=>!0,bn=e=>"$__all"!==e.value,vn=(e,t)=>e.length===t.filter(bn).length?Wt.ToggleAllState.allSelected:0===e.length||1===e.length&&e[0]&&"$__all"===e[0].value?Wt.ToggleAllState.noneSelected:Wt.ToggleAllState.indeterminate;function yn({model:e}){const{value:n,text:i,key:a,options:o,includeAll:s,isReadOnly:l}=e.useState(),[c,u]=(0,t.useState)(""),[d,p]=(0,t.useState)(!1),f=function(e,t){return{value:e,label:null!=t?t:String(e)}}(n,String(i)),h=(0,t.useMemo)((()=>ln(o,s)),[o,s])(c);return r().createElement(Wt.Select,{id:a,isValidNewOption:e=>e.trim().length>0,placeholder:"Select value",width:"auto",disabled:l,value:f,inputValue:c,allowCustomValue:!0,virtualized:!0,filterOption:mn,tabSelectsValue:!1,onInputChange:(t,{action:n})=>"input-change"===n?(u(t),e.onSearchChange&&e.onSearchChange(t),t):t,onOpenMenu:()=>{d&&u(String(i))},onCloseMenu:()=>{u("")},options:h,"data-testid":qt.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${n}`),onChange:t=>{e.changeValueTo(t.value,t.label),d!==t.__isNew__&&p(t.__isNew__)}})}function On({model:e}){const{value:n,options:i,key:a,maxVisibleValues:o,noValueOnClear:s,includeAll:l,isReadOnly:c}=e.useState(),u=(0,t.useMemo)((()=>(0,re.isArray)(n)?n:[n]),[n]),[d,p]=(0,t.useState)(u),[f,h]=(0,t.useState)(""),g=(0,t.useMemo)((()=>ln(i,l)),[i,l]);(0,t.useEffect)((()=>{p(u)}),[u]);const m=i.length>0?"Select value":"",b=g(f);return r().createElement(Wt.MultiSelect,{id:a,placeholder:m,width:"auto",inputValue:f,disabled:c,value:d,noMultiValueWrap:!0,maxVisibleValues:null!=o?o:5,tabSelectsValue:!1,virtualized:!0,allowCustomValue:!0,toggleAllOptions:{enabled:!0,optionsFilter:bn,determineToggleAllState:vn},options:b,closeMenuOnSelect:!1,components:{Option:wn},isClearable:!0,hideSelectedOptions:!1,onInputChange:(t,{action:n})=>"input-change"===n?(h(t),e.onSearchChange&&e.onSearchChange(t),t):"input-blur"===n?(h(""),""):f,onBlur:()=>{e.changeValueTo(d)},filterOption:mn,"data-testid":qt.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${d}`),onChange:(t,n)=>{"clear"===n.action&&s&&e.changeValueTo([]),p(t.map((e=>e.value)))}})}const wn=({children:e,data:t,innerProps:n,innerRef:i,isFocused:a,isSelected:o,indeterminate:s,renderOptionLabel:l})=>{var c;const u=((e,t)=>{var n={};for(var r in e)fn.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&pn)for(var r of pn(e))t.indexOf(r)<0&&hn.call(e,r)&&(n[r]=e[r]);return n})(n,["onMouseMove","onMouseOver"]),d=(0,Wt.useTheme2)(),p=(0,Wt.getSelectStyles)(d),f=(0,Wt.useStyles2)(Sn);return r().createElement("div",(h=((e,t)=>{for(var n in t||(t={}))fn.call(t,n)&&gn(e,n,t[n]);if(pn)for(var n of pn(t))hn.call(t,n)&&gn(e,n,t[n]);return e})({ref:i,className:(0,Ht.cx)(p.option,a&&p.optionFocused)},u),g={"data-testid":"data-testid Select option",title:t.title},un(h,dn(g))),r().createElement("div",{className:f.checkbox},r().createElement(Wt.Checkbox,{indeterminate:s,value:o})),r().createElement("div",{className:p.optionBody,"data-testid":qt.pages.Dashboard.SubMenu.submenuItemValueDropDownOptionTexts(null!=(c=t.label)?c:String(t.value))},r().createElement("span",null,e)));var h,g};wn.displayName="SelectMenuOptions";const Sn=e=>({checkbox:(0,Ht.css)({marginRight:e.spacing(2)})});function xn(e){return e.state.isMulti?r().createElement(On,{model:e}):r().createElement(yn,{model:e})}class _n{constructor(e){this._sceneObject=e}getKey(){return`var-${this._sceneObject.state.name}`}getKeys(){return this._sceneObject.state.skipUrlSync?[]:[this.getKey()]}getUrlState(){return this._sceneObject.state.skipUrlSync?{}:{[this.getKey()]:(e=this._sceneObject.state.value,t=this._sceneObject.state.text,e=Array.isArray(e)?e:[e],t=Array.isArray(t)?t:[t],e.map(((e,n)=>{if(null==e)return"";e=String(e);let r=t[n];return r=null==r?e:String(r),Xs(e,r)})))};var e,t}updateFromUrl(e){let t=e[this.getKey()];if(null!=t){this._sceneObject.isActive||(this._sceneObject.skipNextValidation=!0);const{values:e,texts:r}=(n=t,(n=Array.isArray(n)?n:[n]).reduce(((e,t)=>{const[n,r]=(null!=t?t:"").split(",");return e.values.push(Gs(n)),e.texts.push(Gs(null!=r?r:n)),e}),{values:[],texts:[]}));this._sceneObject.changeValueTo(e,r)}var n}}function Pn(e){const t=e.getRoot();return"enrichFiltersRequest"in t?t.enrichFiltersRequest(e):null}var En,Cn=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};class kn{constructor(e){((e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,void 0)})(this,En),this.text="__sceneObject",this.valueOf=()=>{return Cn(this,e=En,"read from private field"),e.get(this);var e},((e,t,n,r)=>{Cn(e,t,"write to private field"),t.set(e,n)})(this,En,e)}toString(){}get value(){return this}}function Dn(e){return function(e){const t=e.match(/^(\d+)\.(\d+)\.(\d+)/);if(!t)return!1;const n=parseInt(t[1],10),r=parseInt(t[2],10),i=parseInt(t[3],10);return 11===n?0===r&&i>=4||1===r&&i>=2||r>1:10===n?4===r&&i>=8||r>=5:n>11}(a.config.buildInfo.version)?new kn(e):{value:e,text:"__sceneObject"}}En=new WeakMap;var Tn=Object.defineProperty,Rn=Object.defineProperties,In=Object.getOwnPropertyDescriptors,An=Object.getOwnPropertySymbols,jn=Object.prototype.hasOwnProperty,Ln=Object.prototype.propertyIsEnumerable,$n=(e,t,n)=>t in e?Tn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Fn=(e,t)=>{for(var n in t||(t={}))jn.call(t,n)&&$n(e,n,t[n]);if(An)for(var n of An(t))Ln.call(t,n)&&$n(e,n,t[n]);return e};class Nn extends Vt{constructor(e){var t;super((t=Fn({isMulti:!0,name:"",value:[],text:[],options:[],datasource:null,baseFilters:[],applyMode:"auto",layout:"horizontal",type:"groupby"},e),Rn(t,In({noValueOnClear:!0})))),this.isLazy=!0,this._urlSync=new _n(this),this._getKeys=async e=>{var t,n,r;const i=await(null==(n=(t=this.state).getTagKeysProvider)?void 0:n.call(t,this,null));if(i&&i.replace)return i.values;if(this.state.defaultOptions)return this.state.defaultOptions.concat(Ys(null!=(r=null==i?void 0:i.values)?r:[]));if(!e.getTagKeys)return[];const a=Us(this),o=this.state.baseFilters||[],s=kl.getTimeRange(this).state.value,l=await e.getTagKeys(Fn({filters:o,queries:a,timeRange:s},Pn(this)));Zs(l)&&this.setState({error:l.error.message});let c=Ys(l);i&&(c=c.concat(Ys(i.values)));const u=this.state.tagKeyRegexFilter;return u&&(c=c.filter((e=>e.text.match(u)))),c},this.addActivationHandler((()=>(Nt.add(this),()=>Nt.delete(this))))}validateAndUpdate(){return this.getValueOptions({}).pipe((0,b.map)((e=>(this._updateValueGivenNewOptions(e),{}))))}_updateValueGivenNewOptions(e){const{value:t,text:n}=this.state,r={options:e,loading:!1,value:null!=t?t:[],text:null!=n?n:[]};this.setState(r)}getValueOptions(e){return this.state.defaultOptions?(0,b.of)(this.state.defaultOptions.map((e=>({label:e.text,value:String(e.value),group:e.group})))):(this.setState({loading:!0,error:null}),(0,b.from)(ht(this.state.datasource,{__sceneObject:Dn(this)})).pipe((0,b.mergeMap)((e=>(0,b.from)(this._getKeys(e)).pipe((0,b.tap)((e=>{Zs(e)&&this.setState({error:e.error.message})})),(0,b.map)((e=>Ys(e))),(0,b.take)(1),(0,b.mergeMap)((e=>{const t=e.map((e=>({label:e.text,value:e.value?String(e.value):e.text,group:e.group})));return(0,b.of)(t)})))))))}getDefaultMultiState(e){return{value:[],text:[]}}}Nn.Component=function({model:e}){const{value:n,text:i,key:a,maxVisibleValues:o,noValueOnClear:s,options:l,includeAll:c}=e.useState(),u=(0,t.useMemo)((()=>{const e=(0,re.isArray)(n)?n:[n],t=(0,re.isArray)(i)?i:[i];return e.map(((e,n)=>{var r;return{value:e,label:String(null!=(r=t[n])?r:e)}}))}),[n,i]),[d,p]=(0,t.useState)(!1),[f,h]=(0,t.useState)(!1),[g,m]=(0,t.useState)(""),[v,y]=(0,t.useState)(u),O=(0,t.useMemo)((()=>ln(l,c)),[l,c]);(0,t.useEffect)((()=>{y(u)}),[u]);const w=(0,t.useMemo)((()=>Ks(O(g).map(Vn))),[O,g]);return r().createElement(Wt.MultiSelect,{"data-testid":`GroupBySelect-${a}`,id:a,placeholder:"Select value",width:"auto",inputValue:g,value:v,noMultiValueWrap:!0,maxVisibleValues:null!=o?o:5,tabSelectsValue:!1,virtualized:!0,options:w,filterOption:Mn,closeMenuOnSelect:!1,isOpen:f,isClearable:!0,hideSelectedOptions:!1,isLoading:d,components:{Option:wn},onInputChange:(t,{action:n})=>"input-change"===n?(m(t),e.onSearchChange&&e.onSearchChange(t),t):"input-blur"===n?(m(""),""):g,onBlur:()=>{e.changeValueTo(v.map((e=>e.value)),v.map((e=>e.label)))},onChange:(t,n)=>{"clear"===n.action&&s&&e.changeValueTo([]),y(t)},onOpenMenu:async()=>{p(!0),await(0,b.lastValueFrom)(e.validateAndUpdate()),p(!1),h(!0)},onCloseMenu:()=>{h(!1)}})};const Mn=()=>!0;function Vn(e){const{label:t,value:n,group:r}=e,i={label:t,value:n};return r&&(i.group=r),i}function Bn(e){return r().createElement(Wt.Tooltip,{content:"Cancel query"},r().createElement(Wt.Icon,{className:"spin-clockwise",name:"sync",size:"xs",role:"button",onMouseDown:t=>{e.onCancel(t)}}))}function zn(e){const t=(0,Wt.useStyles2)(Wn),n=(0,Wt.useTheme2)(),i="vertical"===e.layout,a=Boolean(e.isLoading)?r().createElement("div",{style:{marginLeft:n.spacing(1),marginTop:"-1px"},"aria-label":qt.components.LoadingIndicator.icon},r().createElement(Bn,{onCancel:t=>{var n;t.preventDefault(),t.stopPropagation(),null==(n=e.onCancel)||n.call(e)}})):null;let o=null;e.error&&(o=r().createElement(Wt.Tooltip,{content:e.error,placement:"bottom"},r().createElement(Wt.Icon,{className:t.errorIcon,name:"exclamation-triangle"})));let s=null;e.description&&(s=r().createElement(Wt.Tooltip,{content:e.description,placement:i?"top":"bottom"},r().createElement(Wt.Icon,{className:t.normalIcon,name:"info-circle"})));const l="string"==typeof e.label?qt.pages.Dashboard.SubMenu.submenuItemLabels(e.label):"";let c;return c=i?r().createElement("label",{className:t.verticalLabel,"data-testid":l,htmlFor:e.htmlFor},e.label,s,o,e.icon&&r().createElement(Wt.Icon,{name:e.icon,className:t.normalIcon}),a,e.onRemove&&r().createElement(Wt.IconButton,{variant:"secondary",size:"xs",name:"times",onClick:e.onRemove,tooltip:"Remove"})):r().createElement("label",{className:t.horizontalLabel,"data-testid":l,htmlFor:e.htmlFor},o,e.icon&&r().createElement(Wt.Icon,{name:e.icon,className:t.normalIcon}),e.label,s,a),c}const Wn=e=>({horizontalLabel:(0,Ht.css)({background:e.isDark?e.colors.background.primary:e.colors.background.secondary,display:"flex",alignItems:"center",padding:e.spacing(0,1),fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.bodySmall.fontSize,height:e.spacing(e.components.height.md),lineHeight:e.spacing(e.components.height.md),borderRadius:e.shape.borderRadius(1),border:`1px solid ${e.components.input.borderColor}`,position:"relative",right:-1,whiteSpace:"nowrap",gap:e.spacing(.5)}),verticalLabel:(0,Ht.css)({display:"flex",alignItems:"center",fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.bodySmall.fontSize,lineHeight:e.typography.bodySmall.lineHeight,whiteSpace:"nowrap",marginBottom:e.spacing(.5),gap:e.spacing(1)}),errorIcon:(0,Ht.css)({color:e.colors.error.text}),normalIcon:(0,Ht.css)({color:e.colors.text.secondary})});var Qn=Object.defineProperty,Un=Object.getOwnPropertySymbols,qn=Object.prototype.hasOwnProperty,Hn=Object.prototype.propertyIsEnumerable,Gn=(e,t,n)=>t in e?Qn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Xn=(e,t)=>{for(var n in t||(t={}))qn.call(t,n)&&Gn(e,n,t[n]);if(Un)for(var n of Un(t))Hn.call(t,n)&&Gn(e,n,t[n]);return e};function Yn(e,t){return""!==e?{value:e,label:t||e}:null}const Zn=()=>!0;function Kn({filter:e,model:n}){var i,a,o;const s=(0,Wt.useStyles2)(Jn),[l,c]=(0,t.useState)([]),[u,d]=(0,t.useState)([]),[p,f]=(0,t.useState)(!1),[h,g]=(0,t.useState)(!1),[m,b]=(0,t.useState)(!1),[v,y]=(0,t.useState)(!1),[O,w]=(0,t.useState)(!1),[S,x]=(0,t.useState)(""),[_,P]=(0,t.useState)(!1),[E,C]=(0,t.useState)(e.values?e.values.map(((t,n)=>{var r;return Yn(t,null==(r=e.valueLabels)?void 0:r[n])})):[]),k=xs(e.operator),D=Yn(e.key,e.keyLabel),T=Yn(e.value,null==(i=e.valueLabels)?void 0:i[0]),R=(0,t.useMemo)((()=>function(e){const t=new nn,n=[],r=1e4;return i=>{var a;if(""===i)return e.length>r?e.slice(0,r):e;if(0===n.length)for(let t=0;t<e.length;t++)n.push(null!=(a=e[t].label)?a:String(e[t].value));const o=t.filter(n,i),s=[];if(o){for(let t=0;t<o.length;t++)if(s.push(e[o[t]]),s.length>r)return s;return s}return e.length>r?e.slice(0,r):e}}(u)),[u]),I=(0,t.useMemo)((()=>Ks(R(S))),[R,S]),A={isMulti:!0,value:E,components:{Option:wn},hideSelectedOptions:!1,closeMenuOnSelect:!1,openMenuOnFocus:!1,onChange:e=>{C(e),e.some((e=>e.__isNew__))&&x("")},onBlur:()=>{var t,r;n._updateFilter(e,{value:null!=(r=null==(t=E[0])?void 0:t.value)?r:"",values:E.map((e=>e.value)),valueLabels:E.map((e=>e.label))})}},j=r().createElement(Wt.Select,Xn({virtualized:!0,allowCustomValue:!0,isValidNewOption:e=>e.trim().length>0,allowCreateWhileLoading:!0,formatCreateLabel:e=>`Use custom value: ${e}`,disabled:n.state.readOnly,className:(0,Ht.cx)(s.value,v?s.widthWhenOpen:void 0),width:"auto",value:T,filterOption:Zn,placeholder:"Select value",options:I,inputValue:S,onInputChange:(e,{action:t})=>("input-change"===t&&x(e),e),onChange:t=>{n._updateFilter(e,{value:t.value,valueLabels:t.label?[t.label]:[t.value]}),_!==t.__isNew__&&P(t.__isNew__)},isOpen:v&&!h,isLoading:h,openMenuOnFocus:!0,onOpenMenu:async()=>{var t;g(!0),y(!0);const r=await n._getValuesFor(e);g(!1),d(r),_&&x(null!=(t=null==T?void 0:T.label)?t:"")},onCloseMenu:()=>{y(!1),x("")}},k&&A)),L=r().createElement(Wt.Select,{key:h?"loading":"loaded",disabled:n.state.readOnly,className:(0,Ht.cx)(s.key,m?s.widthWhenOpen:void 0),width:"auto",allowCustomValue:!0,value:D,placeholder:"Select label",options:Ks(l),onChange:t=>{n._updateFilter(e,{key:t.value,keyLabel:t.label,value:"",valueLabels:[""],values:void 0}),C([])},autoFocus:""===e.key,isOpen:m&&!p,isLoading:p,onOpenMenu:async()=>{b(!0),f(!0);const t=await n._getKeys(e.key);f(!1),c(t)},onCloseMenu:()=>{b(!1)},onBlur:()=>{""===e.key&&n._removeFilter(e)},openMenuOnFocus:!0}),$=r().createElement(Wt.Select,{className:(0,Ht.cx)(s.operator,{[s.widthWhenOpen]:O}),value:e.operator,disabled:n.state.readOnly,options:n._getOperators(),onChange:t=>{var r,i;const a=e.operator,o=t.value,s={operator:o};xs(a)&&!xs(o)?(s.value="",s.valueLabels=[""],s.values=void 0,C([])):!xs(a)&&xs(o)&&e.value&&(s.values=[e.value],C([{value:e.value,label:null!=(i=null==(r=e.valueLabels)?void 0:r[0])?i:e.value}])),n._updateFilter(e,s)},onOpenMenu:()=>{w(!0)},onCloseMenu:()=>{w(!1)}});if("vertical"===n.state.layout){if(e.key){const t=r().createElement(zn,{layout:"vertical",label:null!=(a=e.key)?a:"",onRemove:()=>n._removeFilter(e)});return r().createElement(Wt.Field,{label:t,"data-testid":`AdHocFilter-${e.key}`,className:s.field},r().createElement("div",{className:s.wrapper},$,j))}return r().createElement(Wt.Field,{label:"Select label","data-testid":`AdHocFilter-${e.key}`,className:s.field},L)}return r().createElement("div",{className:s.wrapper,"data-testid":`AdHocFilter-${e.key}`},L,$,j,r().createElement(Wt.Button,{variant:"secondary","aria-label":"Remove filter",title:"Remove filter",className:s.removeButton,icon:"times","data-testid":`AdHocFilter-remove-${null!=(o=e.key)?o:""}`,onClick:()=>n._removeFilter(e)}))}const Jn=e=>({field:(0,Ht.css)({marginBottom:0}),wrapper:(0,Ht.css)({display:"flex","> *":{"&:not(:first-child)":{marginLeft:-1},"&:first-child":{borderTopRightRadius:0,borderBottomRightRadius:0},"&:last-child":{borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:first-child):not(:last-child)":{borderRadius:0},position:"relative",zIndex:0,"&:hover":{zIndex:1},"&:focus-within":{zIndex:2}}}),widthWhenOpen:(0,Ht.css)({minWidth:e.spacing(16)}),value:(0,Ht.css)({flexBasis:"content",flexShrink:1,minWidth:"90px"}),key:(0,Ht.css)({flexBasis:"content",minWidth:"90px",flexShrink:1}),operator:(0,Ht.css)({flexShrink:0,flexBasis:"content"}),removeButton:(0,Ht.css)({paddingLeft:e.spacing(1.5),paddingRight:e.spacing(1.5),borderLeft:"none",width:e.spacing(3),marginRight:e.spacing(1),boxSizing:"border-box",position:"relative",left:"1px"})});function er({model:e,addFilterButtonText:t}){const{_wip:n}=e.useState();return n?r().createElement(Kn,{filter:n,model:e}):r().createElement(Wt.Button,{variant:"secondary",icon:"plus",title:"Add filter","aria-label":"Add filter","data-testid":"AdHocFilter-add",onClick:()=>e._addWip()},t)}class tr{constructor(e){this._variable=e}getKey(){return`var-${this._variable.state.name}`}getKeys(){return[this.getKey()]}getUrlState(){const e=this._variable.state.filters;if(0===e.length)return{[this.getKey()]:[""]};const t=e.filter(Ss).map((e=>function(e){var t;const n=[Xs(e.key,e.keyLabel),e.operator];return xs(e.operator)?e.values.forEach(((t,r)=>{var i;n.push(Xs(t,null==(i=e.valueLabels)?void 0:i[r]))})):n.push(Xs(e.value,null==(t=e.valueLabels)?void 0:t[0])),n}(e).map(qs).join("|")));return{[this.getKey()]:t}}updateFromUrl(e){const t=e[this.getKey()];if(null==t)return;const n=function(e){if(Array.isArray(e))return e.map(nr).filter(rr);const t=nr(e);return null===t?[]:[t]}(t);this._variable.setState({filters:n})}}function nr(e){if("string"!=typeof e||0===e.length)return null;const[t,n,r,i,...a]=e.split("|").reduce(((e,t)=>{const[n,r]=t.split(",");return e.push(n,null!=r?r:n),e}),[]).map(Gs);return{key:t,keyLabel:n,operator:r,value:a[0],values:xs(r)?a.filter(((e,t)=>t%2==0)):void 0,valueLabels:a.filter(((e,t)=>t%2==1)),condition:""}}function rr(e){return null!==e&&"string"==typeof e.key&&"string"==typeof e.value}function ir(e){return sr(e)?(e.nodeName||"").toLowerCase():"#document"}function ar(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function or(e){var t;return null==(t=(sr(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function sr(e){return e instanceof Node||e instanceof ar(e).Node}function lr(e){return e instanceof Element||e instanceof ar(e).Element}function cr(e){return e instanceof HTMLElement||e instanceof ar(e).HTMLElement}function ur(e){return"undefined"!=typeof ShadowRoot&&(e instanceof ShadowRoot||e instanceof ar(e).ShadowRoot)}function dr(e){const{overflow:t,overflowX:n,overflowY:r,display:i}=mr(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(i)}function pr(e){return["table","td","th"].includes(ir(e))}function fr(e){const t=hr(),n=mr(e);return"none"!==n.transform||"none"!==n.perspective||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||["transform","perspective","filter"].some((e=>(n.willChange||"").includes(e)))||["paint","layout","strict","content"].some((e=>(n.contain||"").includes(e)))}function hr(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function gr(e){return["html","body","#document"].includes(ir(e))}function mr(e){return ar(e).getComputedStyle(e)}function br(e){return lr(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function vr(e){if("html"===ir(e))return e;const t=e.assignedSlot||e.parentNode||ur(e)&&e.host||or(e);return ur(t)?t.host:t}function yr(e){const t=vr(e);return gr(t)?e.ownerDocument?e.ownerDocument.body:e.body:cr(t)&&dr(t)?t:yr(t)}function Or(e,t,n){var r;void 0===t&&(t=[]),void 0===n&&(n=!0);const i=yr(e),a=i===(null==(r=e.ownerDocument)?void 0:r.body),o=ar(i);return a?t.concat(o,o.visualViewport||[],dr(i)?i:[],o.frameElement&&n?Or(o.frameElement):[]):t.concat(i,Or(i,[],n))}function wr(e){let t=e.activeElement;for(;null!=(null==(n=t)||null==(n=n.shadowRoot)?void 0:n.activeElement);){var n;t=t.shadowRoot.activeElement}return t}function Sr(e,t){if(!e||!t)return!1;const n=null==t.getRootNode?void 0:t.getRootNode();if(e.contains(t))return!0;if(n&&ur(n)){let n=t;for(;n;){if(e===n)return!0;n=n.parentNode||n.host}}return!1}function xr(){const e=navigator.userAgentData;return null!=e&&e.platform?e.platform:navigator.platform}function _r(){const e=navigator.userAgentData;return e&&Array.isArray(e.brands)?e.brands.map((e=>{let{brand:t,version:n}=e;return t+"/"+n})).join(" "):navigator.userAgent}function Pr(e){return!(0!==e.mozInputSource||!e.isTrusted)||(kr()&&e.pointerType?"click"===e.type&&1===e.buttons:0===e.detail&&!e.pointerType)}function Er(e){return!_r().includes("jsdom/")&&(!kr()&&0===e.width&&0===e.height||kr()&&1===e.width&&1===e.height&&0===e.pressure&&0===e.detail&&"mouse"===e.pointerType||e.width<1&&e.height<1&&0===e.pressure&&0===e.detail&&"touch"===e.pointerType)}function Cr(){return/apple/i.test(navigator.vendor)}function kr(){const e=/android/i;return e.test(xr())||e.test(_r())}function Dr(e){return(null==e?void 0:e.ownerDocument)||document}function Tr(e,t){if(null==t)return!1;if("composedPath"in e)return e.composedPath().includes(t);const n=e;return null!=n.target&&t.contains(n.target)}function Rr(e){return"composedPath"in e?e.composedPath()[0]:e.target}const Ir="input:not([type='hidden']):not([disabled]),[contenteditable]:not([contenteditable='false']),textarea:not([disabled])";function Ar(e){e.preventDefault(),e.stopPropagation()}function jr(e){return!!e&&"combobox"===e.getAttribute("role")&&function(e){return cr(e)&&e.matches(Ir)}(e)}const Lr=Math.min,$r=Math.max,Fr=Math.round,Nr=Math.floor,Mr=e=>({x:e,y:e}),Vr={left:"right",right:"left",bottom:"top",top:"bottom"},Br={start:"end",end:"start"};function zr(e,t){return"function"==typeof e?e(t):e}function Wr(e){return e.split("-")[0]}function Qr(e){return e.split("-")[1]}function Ur(e){return"y"===e?"height":"width"}function qr(e){return["top","bottom"].includes(Wr(e))?"y":"x"}function Hr(e){return"x"===qr(e)?"y":"x"}function Gr(e){return e.replace(/start|end/g,(e=>Br[e]))}function Xr(e){return e.replace(/left|right|bottom|top/g,(e=>Vr[e]))}function Yr(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}function Zr(e,t,n){let{reference:r,floating:i}=e;const a=qr(t),o=Hr(t),s=Ur(o),l=Wr(t),c="y"===a,u=r.x+r.width/2-i.width/2,d=r.y+r.height/2-i.height/2,p=r[s]/2-i[s]/2;let f;switch(l){case"top":f={x:u,y:r.y-i.height};break;case"bottom":f={x:u,y:r.y+r.height};break;case"right":f={x:r.x+r.width,y:d};break;case"left":f={x:r.x-i.width,y:d};break;default:f={x:r.x,y:r.y}}switch(Qr(t)){case"start":f[o]-=p*(n&&c?-1:1);break;case"end":f[o]+=p*(n&&c?-1:1)}return f}async function Kr(e,t){var n;void 0===t&&(t={});const{x:r,y:i,platform:a,rects:o,elements:s,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:p=!1,padding:f=0}=zr(t,e),h=function(e){return"number"!=typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}(f),g=s[p?"floating"===d?"reference":"floating":d],m=Yr(await a.getClippingRect({element:null==(n=await(null==a.isElement?void 0:a.isElement(g)))||n?g:g.contextElement||await(null==a.getDocumentElement?void 0:a.getDocumentElement(s.floating)),boundary:c,rootBoundary:u,strategy:l})),b="floating"===d?{...o.floating,x:r,y:i}:o.reference,v=await(null==a.getOffsetParent?void 0:a.getOffsetParent(s.floating)),y=await(null==a.isElement?void 0:a.isElement(v))&&await(null==a.getScale?void 0:a.getScale(v))||{x:1,y:1},O=Yr(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:b,offsetParent:v,strategy:l}):b);return{top:(m.top-O.top+h.top)/y.y,bottom:(O.bottom-m.bottom+h.bottom)/y.y,left:(m.left-O.left+h.left)/y.x,right:(O.right-m.right+h.right)/y.x}}function Jr(e){const t=mr(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const i=cr(e),a=i?e.offsetWidth:n,o=i?e.offsetHeight:r,s=Fr(n)!==a||Fr(r)!==o;return s&&(n=a,r=o),{width:n,height:r,$:s}}function ei(e){return lr(e)?e:e.contextElement}function ti(e){const t=ei(e);if(!cr(t))return Mr(1);const n=t.getBoundingClientRect(),{width:r,height:i,$:a}=Jr(t);let o=(a?Fr(n.width):n.width)/r,s=(a?Fr(n.height):n.height)/i;return o&&Number.isFinite(o)||(o=1),s&&Number.isFinite(s)||(s=1),{x:o,y:s}}const ni=Mr(0);function ri(e){const t=ar(e);return hr()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:ni}function ii(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=!1);const i=e.getBoundingClientRect(),a=ei(e);let o=Mr(1);t&&(r?lr(r)&&(o=ti(r)):o=ti(e));const s=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==ar(e))&&t}(a,n,r)?ri(a):Mr(0);let l=(i.left+s.x)/o.x,c=(i.top+s.y)/o.y,u=i.width/o.x,d=i.height/o.y;if(a){const e=ar(a),t=r&&lr(r)?ar(r):r;let n=e,i=n.frameElement;for(;i&&r&&t!==n;){const e=ti(i),t=i.getBoundingClientRect(),r=mr(i),a=t.left+(i.clientLeft+parseFloat(r.paddingLeft))*e.x,o=t.top+(i.clientTop+parseFloat(r.paddingTop))*e.y;l*=e.x,c*=e.y,u*=e.x,d*=e.y,l+=a,c+=o,n=ar(i),i=n.frameElement}}return Yr({width:u,height:d,x:l,y:c})}const ai=[":popover-open",":modal"];function oi(e){return ai.some((t=>{try{return e.matches(t)}catch(e){return!1}}))}function si(e){return ii(or(e)).left+br(e).scrollLeft}function li(e,t,n){let r;if("viewport"===t)r=function(e,t){const n=ar(e),r=or(e),i=n.visualViewport;let a=r.clientWidth,o=r.clientHeight,s=0,l=0;if(i){a=i.width,o=i.height;const e=hr();(!e||e&&"fixed"===t)&&(s=i.offsetLeft,l=i.offsetTop)}return{width:a,height:o,x:s,y:l}}(e,n);else if("document"===t)r=function(e){const t=or(e),n=br(e),r=e.ownerDocument.body,i=$r(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),a=$r(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+si(e);const s=-n.scrollTop;return"rtl"===mr(r).direction&&(o+=$r(t.clientWidth,r.clientWidth)-i),{width:i,height:a,x:o,y:s}}(or(e));else if(lr(t))r=function(e,t){const n=ii(e,!0,"fixed"===t),r=n.top+e.clientTop,i=n.left+e.clientLeft,a=cr(e)?ti(e):Mr(1);return{width:e.clientWidth*a.x,height:e.clientHeight*a.y,x:i*a.x,y:r*a.y}}(t,n);else{const n=ri(e);r={...t,x:t.x-n.x,y:t.y-n.y}}return Yr(r)}function ci(e,t){const n=vr(e);return!(n===t||!lr(n)||gr(n))&&("fixed"===mr(n).position||ci(n,t))}function ui(e,t,n){const r=cr(t),i=or(t),a="fixed"===n,o=ii(e,!0,a,t);let s={scrollLeft:0,scrollTop:0};const l=Mr(0);if(r||!r&&!a)if(("body"!==ir(t)||dr(i))&&(s=br(t)),r){const e=ii(t,!0,a,t);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else i&&(l.x=si(i));return{x:o.left+s.scrollLeft-l.x,y:o.top+s.scrollTop-l.y,width:o.width,height:o.height}}function di(e){return"static"===mr(e).position}function pi(e,t){return cr(e)&&"fixed"!==mr(e).position?t?t(e):e.offsetParent:null}function fi(e,t){const n=ar(e);if(oi(e))return n;if(!cr(e)){let t=vr(e);for(;t&&!gr(t);){if(lr(t)&&!di(t))return t;t=vr(t)}return n}let r=pi(e,t);for(;r&&pr(r)&&di(r);)r=pi(r,t);return r&&gr(r)&&di(r)&&!fr(r)?n:r||function(e){let t=vr(e);for(;cr(t)&&!gr(t);){if(fr(t))return t;t=vr(t)}return null}(e)||n}const hi={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:n,offsetParent:r,strategy:i}=e;const a="fixed"===i,o=or(r),s=!!t&&oi(t.floating);if(r===o||s&&a)return n;let l={scrollLeft:0,scrollTop:0},c=Mr(1);const u=Mr(0),d=cr(r);if((d||!d&&!a)&&(("body"!==ir(r)||dr(o))&&(l=br(r)),cr(r))){const e=ii(r);c=ti(r),u.x=e.x+r.clientLeft,u.y=e.y+r.clientTop}return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x,y:n.y*c.y-l.scrollTop*c.y+u.y}},getDocumentElement:or,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:r,strategy:i}=e;const a=[..."clippingAncestors"===n?oi(t)?[]:function(e,t){const n=t.get(e);if(n)return n;let r=Or(e,[],!1).filter((e=>lr(e)&&"body"!==ir(e))),i=null;const a="fixed"===mr(e).position;let o=a?vr(e):e;for(;lr(o)&&!gr(o);){const t=mr(o),n=fr(o);n||"fixed"!==t.position||(i=null),(a?!n&&!i:!n&&"static"===t.position&&i&&["absolute","fixed"].includes(i.position)||dr(o)&&!n&&ci(e,o))?r=r.filter((e=>e!==o)):i=t,o=vr(o)}return t.set(e,r),r}(t,this._c):[].concat(n),r],o=a[0],s=a.reduce(((e,n)=>{const r=li(t,n,i);return e.top=$r(r.top,e.top),e.right=Lr(r.right,e.right),e.bottom=Lr(r.bottom,e.bottom),e.left=$r(r.left,e.left),e}),li(t,o,i));return{width:s.right-s.left,height:s.bottom-s.top,x:s.left,y:s.top}},getOffsetParent:fi,getElementRects:async function(e){const t=this.getOffsetParent||fi,n=this.getDimensions,r=await n(e.floating);return{reference:ui(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:n}=Jr(e);return{width:t,height:n}},getScale:ti,isElement:lr,isRTL:function(e){return"rtl"===mr(e).direction}};function gi(e,t,n,r){void 0===r&&(r={});const{ancestorScroll:i=!0,ancestorResize:a=!0,elementResize:o="function"==typeof ResizeObserver,layoutShift:s="function"==typeof IntersectionObserver,animationFrame:l=!1}=r,c=ei(e),u=i||a?[...c?Or(c):[],...Or(t)]:[];u.forEach((e=>{i&&e.addEventListener("scroll",n,{passive:!0}),a&&e.addEventListener("resize",n)}));const d=c&&s?function(e,t){let n,r=null;const i=or(e);function a(){var e;clearTimeout(n),null==(e=r)||e.disconnect(),r=null}return function o(s,l){void 0===s&&(s=!1),void 0===l&&(l=1),a();const{left:c,top:u,width:d,height:p}=e.getBoundingClientRect();if(s||t(),!d||!p)return;const f={rootMargin:-Nr(u)+"px "+-Nr(i.clientWidth-(c+d))+"px "+-Nr(i.clientHeight-(u+p))+"px "+-Nr(c)+"px",threshold:$r(0,Lr(1,l))||1};let h=!0;function g(e){const t=e[0].intersectionRatio;if(t!==l){if(!h)return o();t?o(!1,t):n=setTimeout((()=>{o(!1,1e-7)}),1e3)}h=!1}try{r=new IntersectionObserver(g,{...f,root:i.ownerDocument})}catch(e){r=new IntersectionObserver(g,f)}r.observe(e)}(!0),a}(c,n):null;let p,f=-1,h=null;o&&(h=new ResizeObserver((e=>{let[r]=e;r&&r.target===c&&h&&(h.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame((()=>{var e;null==(e=h)||e.observe(t)}))),n()})),c&&!l&&h.observe(c),h.observe(t));let g=l?ii(e):null;return l&&function t(){const r=ii(e);!g||r.x===g.x&&r.y===g.y&&r.width===g.width&&r.height===g.height||n(),g=r,p=requestAnimationFrame(t)}(),n(),()=>{var e;u.forEach((e=>{i&&e.removeEventListener("scroll",n),a&&e.removeEventListener("resize",n)})),null==d||d(),null==(e=h)||e.disconnect(),h=null,l&&cancelAnimationFrame(p)}}const mi=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:i,y:a,placement:o,middlewareData:s}=t,l=await async function(e,t){const{placement:n,platform:r,elements:i}=e,a=await(null==r.isRTL?void 0:r.isRTL(i.floating)),o=Wr(n),s=Qr(n),l="y"===qr(n),c=["left","top"].includes(o)?-1:1,u=a&&l?-1:1,d=zr(t,e);let{mainAxis:p,crossAxis:f,alignmentAxis:h}="number"==typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return s&&"number"==typeof h&&(f="end"===s?-1*h:h),l?{x:f*u,y:p*c}:{x:p*c,y:f*u}}(t,e);return o===(null==(n=s.offset)?void 0:n.placement)&&null!=(r=s.arrow)&&r.alignmentOffset?{}:{x:i+l.x,y:a+l.y,data:{...l,placement:o}}}}},bi=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:i,middlewareData:a,rects:o,initialPlacement:s,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:p,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:h="none",flipAlignment:g=!0,...m}=zr(e,t);if(null!=(n=a.arrow)&&n.alignmentOffset)return{};const b=Wr(i),v=Wr(s)===s,y=await(null==l.isRTL?void 0:l.isRTL(c.floating)),O=p||(v||!g?[Xr(s)]:function(e){const t=Xr(e);return[Gr(e),t,Gr(t)]}(s));p||"none"===h||O.push(...function(e,t,n,r){const i=Qr(e);let a=function(e,t,n){const r=["left","right"],i=["right","left"],a=["top","bottom"],o=["bottom","top"];switch(e){case"top":case"bottom":return n?t?i:r:t?r:i;case"left":case"right":return t?a:o;default:return[]}}(Wr(e),"start"===n,r);return i&&(a=a.map((e=>e+"-"+i)),t&&(a=a.concat(a.map(Gr)))),a}(s,g,h,y));const w=[s,...O],S=await Kr(t,m),x=[];let _=(null==(r=a.flip)?void 0:r.overflows)||[];if(u&&x.push(S[b]),d){const e=function(e,t,n){void 0===n&&(n=!1);const r=Qr(e),i=Hr(e),a=Ur(i);let o="x"===i?r===(n?"end":"start")?"right":"left":"start"===r?"bottom":"top";return t.reference[a]>t.floating[a]&&(o=Xr(o)),[o,Xr(o)]}(i,o,y);x.push(S[e[0]],S[e[1]])}if(_=[..._,{placement:i,overflows:x}],!x.every((e=>e<=0))){var P,E;const e=((null==(P=a.flip)?void 0:P.index)||0)+1,t=w[e];if(t)return{data:{index:e,overflows:_},reset:{placement:t}};let n=null==(E=_.filter((e=>e.overflows[0]<=0)).sort(((e,t)=>e.overflows[1]-t.overflows[1]))[0])?void 0:E.placement;if(!n)switch(f){case"bestFit":{var C;const e=null==(C=_.map((e=>[e.placement,e.overflows.filter((e=>e>0)).reduce(((e,t)=>e+t),0)])).sort(((e,t)=>e[1]-t[1]))[0])?void 0:C[0];e&&(n=e);break}case"initialPlacement":n=s}if(i!==n)return{reset:{placement:n}}}return{}}}},vi=function(e){return void 0===e&&(e={}),{name:"size",options:e,async fn(t){const{placement:n,rects:r,platform:i,elements:a}=t,{apply:o=(()=>{}),...s}=zr(e,t),l=await Kr(t,s),c=Wr(n),u=Qr(n),d="y"===qr(n),{width:p,height:f}=r.floating;let h,g;"top"===c||"bottom"===c?(h=c,g=u===(await(null==i.isRTL?void 0:i.isRTL(a.floating))?"start":"end")?"left":"right"):(g=c,h="end"===u?"top":"bottom");const m=f-l[h],b=p-l[g],v=!t.middlewareData.shift;let y=m,O=b;if(d){const e=p-l.left-l.right;O=u||v?Lr(b,e):e}else{const e=f-l.top-l.bottom;y=u||v?Lr(m,e):e}if(v&&!u){const e=$r(l.left,0),t=$r(l.right,0),n=$r(l.top,0),r=$r(l.bottom,0);d?O=p-2*(0!==e||0!==t?e+t:$r(l.left,l.right)):y=f-2*(0!==n||0!==r?n+r:$r(l.top,l.bottom))}await o({...t,availableWidth:O,availableHeight:y});const w=await i.getDimensions(a.floating);return p!==w.width||f!==w.height?{reset:{rects:!0}}:{}}}};var yi=g(398),Oi=g.n(yi),wi="undefined"!=typeof document?t.useLayoutEffect:t.useEffect;function Si(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if("function"==typeof e&&e.toString()===t.toString())return!0;let n,r,i;if(e&&t&&"object"==typeof e){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;0!=r--;)if(!Si(e[r],t[r]))return!1;return!0}if(i=Object.keys(e),n=i.length,n!==Object.keys(t).length)return!1;for(r=n;0!=r--;)if(!{}.hasOwnProperty.call(t,i[r]))return!1;for(r=n;0!=r--;){const n=i[r];if(!("_owner"===n&&e.$$typeof||Si(e[n],t[n])))return!1}return!0}return e!=e&&t!=t}function xi(e){return"undefined"==typeof window?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function _i(e,t){const n=xi(e);return Math.round(t*n)/n}function Pi(e){const n=t.useRef(e);return wi((()=>{n.current=e})),n}const Ei=(e,t)=>({...bi(e),options:[e,t]}),Ci=(e,t)=>({...vi(e),options:[e,t]});var ki=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"].join(","),Di="undefined"==typeof Element,Ti=Di?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,Ri=!Di&&Element.prototype.getRootNode?function(e){var t;return null==e||null===(t=e.getRootNode)||void 0===t?void 0:t.call(e)}:function(e){return null==e?void 0:e.ownerDocument},Ii=function e(t,n){var r;void 0===n&&(n=!0);var i=null==t||null===(r=t.getAttribute)||void 0===r?void 0:r.call(t,"inert");return""===i||"true"===i||n&&t&&e(t.parentNode)},Ai=function e(t,n,r){for(var i=[],a=Array.from(t);a.length;){var o=a.shift();if(!Ii(o,!1))if("SLOT"===o.tagName){var s=o.assignedElements(),l=e(s.length?s:o.children,!0,r);r.flatten?i.push.apply(i,l):i.push({scopeParent:o,candidates:l})}else{Ti.call(o,ki)&&r.filter(o)&&(n||!t.includes(o))&&i.push(o);var c=o.shadowRoot||"function"==typeof r.getShadowRoot&&r.getShadowRoot(o),u=!Ii(c,!1)&&(!r.shadowRootFilter||r.shadowRootFilter(o));if(c&&u){var d=e(!0===c?o.children:c.children,!0,r);r.flatten?i.push.apply(i,d):i.push({scopeParent:o,candidates:d})}else a.unshift.apply(a,o.children)}}return i},ji=function(e){return!isNaN(parseInt(e.getAttribute("tabindex"),10))},Li=function(e){if(!e)throw new Error("No node provided");return e.tabIndex<0&&(/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||function(e){var t,n=null==e||null===(t=e.getAttribute)||void 0===t?void 0:t.call(e,"contenteditable");return""===n||"true"===n}(e))&&!ji(e)?0:e.tabIndex},$i=function(e,t){return e.tabIndex===t.tabIndex?e.documentOrder-t.documentOrder:e.tabIndex-t.tabIndex},Fi=function(e){return"INPUT"===e.tagName},Ni=function(e){var t=e.getBoundingClientRect(),n=t.width,r=t.height;return 0===n&&0===r},Mi=function(e,t){return!(t.disabled||Ii(t)||function(e){return Fi(e)&&"hidden"===e.type}(t)||function(e,t){var n=t.displayCheck,r=t.getShadowRoot;if("hidden"===getComputedStyle(e).visibility)return!0;var i=Ti.call(e,"details>summary:first-of-type")?e.parentElement:e;if(Ti.call(i,"details:not([open]) *"))return!0;if(n&&"full"!==n&&"legacy-full"!==n){if("non-zero-area"===n)return Ni(e)}else{if("function"==typeof r){for(var a=e;e;){var o=e.parentElement,s=Ri(e);if(o&&!o.shadowRoot&&!0===r(o))return Ni(e);e=e.assignedSlot?e.assignedSlot:o||s===e.ownerDocument?o:s.host}e=a}if(function(e){var t,n,r,i,a=e&&Ri(e),o=null===(t=a)||void 0===t?void 0:t.host,s=!1;if(a&&a!==e)for(s=!!(null!==(n=o)&&void 0!==n&&null!==(r=n.ownerDocument)&&void 0!==r&&r.contains(o)||null!=e&&null!==(i=e.ownerDocument)&&void 0!==i&&i.contains(e));!s&&o;){var l,c,u;s=!(null===(c=o=null===(l=a=Ri(o))||void 0===l?void 0:l.host)||void 0===c||null===(u=c.ownerDocument)||void 0===u||!u.contains(o))}return s}(e))return!e.getClientRects().length;if("legacy-full"!==n)return!0}return!1}(t,e)||function(e){return"DETAILS"===e.tagName&&Array.prototype.slice.apply(e.children).some((function(e){return"SUMMARY"===e.tagName}))}(t)||function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var t=e.parentElement;t;){if("FIELDSET"===t.tagName&&t.disabled){for(var n=0;n<t.children.length;n++){var r=t.children.item(n);if("LEGEND"===r.tagName)return!!Ti.call(t,"fieldset[disabled] *")||!r.contains(e)}return!0}t=t.parentElement}return!1}(t))},Vi=function(e,t){return!(function(e){return function(e){return Fi(e)&&"radio"===e.type}(e)&&!function(e){if(!e.name)return!0;var t,n=e.form||Ri(e),r=function(e){return n.querySelectorAll('input[type="radio"][name="'+e+'"]')};if("undefined"!=typeof window&&void 0!==window.CSS&&"function"==typeof window.CSS.escape)t=r(window.CSS.escape(e.name));else try{t=r(e.name)}catch(e){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",e.message),!1}var i=function(e,t){for(var n=0;n<e.length;n++)if(e[n].checked&&e[n].form===t)return e[n]}(t,e.form);return!i||i===e}(e)}(t)||Li(t)<0||!Mi(e,t))},Bi=function(e){var t=parseInt(e.getAttribute("tabindex"),10);return!!(isNaN(t)||t>=0)},zi=function e(t){var n=[],r=[];return t.forEach((function(t,i){var a=!!t.scopeParent,o=a?t.scopeParent:t,s=function(e,t){var n=Li(e);return n<0&&t&&!ji(e)?0:n}(o,a),l=a?e(t.candidates):o;0===s?a?n.push.apply(n,l):n.push(o):r.push({documentOrder:i,tabIndex:s,item:t,isScope:a,content:l})})),r.sort($i).reduce((function(e,t){return t.isScope?e.push.apply(e,t.content):e.push(t.content),e}),[]).concat(n)},Wi=function(e,t){var n;return n=(t=t||{}).getShadowRoot?Ai([e],t.includeContainer,{filter:Vi.bind(null,t),flatten:!1,getShadowRoot:t.getShadowRoot,shadowRootFilter:Bi}):function(e,t,n){if(Ii(e))return[];var r=Array.prototype.slice.apply(e.querySelectorAll(ki));return t&&Ti.call(e,ki)&&r.unshift(e),r.filter(n)}(e,t.includeContainer,Vi.bind(null,t)),zi(n)},Qi=function(e,t){if(t=t||{},!e)throw new Error("No node provided");return!1!==Ti.call(e,ki)&&Vi(t,e)};const Ui={...n},qi=Ui.useInsertionEffect||(e=>e());function Hi(e){const n=t.useRef((()=>{}));return qi((()=>{n.current=e})),t.useCallback((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return null==n.current?void 0:n.current(...t)}),[])}const Gi="ArrowUp",Xi="ArrowDown",Yi="ArrowLeft",Zi="ArrowRight";function Ki(e,t,n){return Math.floor(e/t)!==n}function Ji(e,t){return t<0||t>=e.current.length}function ea(e,t){return na(e,{disabledIndices:t})}function ta(e,t){return na(e,{decrement:!0,startingIndex:e.current.length,disabledIndices:t})}function na(e,t){let{startingIndex:n=-1,decrement:r=!1,disabledIndices:i,amount:a=1}=void 0===t?{}:t;const o=e.current;let s=n;do{s+=r?-a:a}while(s>=0&&s<=o.length-1&&aa(o,s,i));return s}function ra(e,t,n,r,i){if(-1===e)return-1;const a=n.indexOf(e),o=t[e];switch(i){case"tl":return a;case"tr":return o?a+o.width-1:a;case"bl":return o?a+(o.height-1)*r:a;case"br":return n.lastIndexOf(e)}}function ia(e,t){return t.flatMap(((t,n)=>e.includes(t)?[n]:[]))}function aa(e,t,n){if(n)return n.includes(t);const r=e[t];return null==r||r.hasAttribute("disabled")||"true"===r.getAttribute("aria-disabled")}let oa=0;function sa(e,t){void 0===t&&(t={});const{preventScroll:n=!1,cancelPrevious:r=!0,sync:i=!1}=t;r&&cancelAnimationFrame(oa);const a=()=>null==e?void 0:e.focus({preventScroll:n});i?a():oa=requestAnimationFrame(a)}var la="undefined"!=typeof document?t.useLayoutEffect:t.useEffect;function ca(){return ca=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ca.apply(this,arguments)}let ua=!1,da=0;const pa=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+da++,fa=Ui.useId||function(){const[e,n]=t.useState((()=>ua?pa():void 0));return la((()=>{null==e&&n(pa())}),[]),t.useEffect((()=>{ua=!0}),[]),e};const ha=t.createContext(null),ga=t.createContext(null),ma=()=>{var e;return(null==(e=t.useContext(ha))?void 0:e.id)||null},ba=()=>t.useContext(ga);function va(e){return"data-floating-ui-"+e}function ya(e){const n=(0,t.useRef)(e);return la((()=>{n.current=e})),n}function Oa(e,t){let n=e.filter((e=>{var n;return e.parentId===t&&(null==(n=e.context)?void 0:n.open)})),r=n;for(;r.length;)r=e.filter((e=>{var t;return null==(t=r)?void 0:t.some((t=>{var n;return e.parentId===t.id&&(null==(n=e.context)?void 0:n.open)}))})),n=n.concat(r);return n}let wa=new WeakMap,Sa=new WeakSet,xa={},_a=0;const Pa=e=>e&&(e.host||Pa(e.parentNode)),Ea=(e,t)=>t.map((t=>{if(e.contains(t))return t;const n=Pa(t);return e.contains(n)?n:null})).filter((e=>null!=e));function Ca(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);const r=Dr(e[0]).body;return function(e,t,n,r){const i="data-floating-ui-inert",a=r?"inert":n?"aria-hidden":null,o=Ea(t,e),s=new Set,l=new Set(o),c=[];xa[i]||(xa[i]=new WeakMap);const u=xa[i];return o.forEach((function e(t){t&&!s.has(t)&&(s.add(t),t.parentNode&&e(t.parentNode))})),function e(t){t&&!l.has(t)&&[].forEach.call(t.children,(t=>{if("script"!==ir(t))if(s.has(t))e(t);else{const e=a?t.getAttribute(a):null,n=null!==e&&"false"!==e,r=(wa.get(t)||0)+1,o=(u.get(t)||0)+1;wa.set(t,r),u.set(t,o),c.push(t),1===r&&n&&Sa.add(t),1===o&&t.setAttribute(i,""),!n&&a&&t.setAttribute(a,"true")}}))}(t),s.clear(),_a++,()=>{c.forEach((e=>{const t=(wa.get(e)||0)-1,n=(u.get(e)||0)-1;wa.set(e,t),u.set(e,n),t||(!Sa.has(e)&&a&&e.removeAttribute(a),Sa.delete(e)),n||e.removeAttribute(i)})),_a--,_a||(wa=new WeakMap,wa=new WeakMap,Sa=new WeakSet,xa={})}}(e.concat(Array.from(r.querySelectorAll("[aria-live]"))),r,t,n)}const ka=()=>({getShadowRoot:!0,displayCheck:"function"==typeof ResizeObserver&&ResizeObserver.toString().includes("[native code]")?"full":"none"});function Da(e,t){const n=Wi(e,ka());"prev"===t&&n.reverse();const r=n.indexOf(wr(Dr(e)));return n.slice(r+1)[0]}function Ta(){return Da(document.body,"next")}function Ra(){return Da(document.body,"prev")}function Ia(e,t){const n=t||e.currentTarget,r=e.relatedTarget;return!r||!Sr(n,r)}function Aa(e){Wi(e,ka()).forEach((e=>{e.dataset.tabindex=e.getAttribute("tabindex")||"",e.setAttribute("tabindex","-1")}))}function ja(e){e.querySelectorAll("[data-tabindex]").forEach((e=>{const t=e.dataset.tabindex;delete e.dataset.tabindex,t?e.setAttribute("tabindex",t):e.removeAttribute("tabindex")}))}const La={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"fixed",whiteSpace:"nowrap",width:"1px",top:0,left:0};function $a(e){"Tab"===e.key&&(e.target,clearTimeout(void 0))}const Fa=t.forwardRef((function(e,n){const[r,i]=t.useState();la((()=>(Cr()&&i("button"),document.addEventListener("keydown",$a),()=>{document.removeEventListener("keydown",$a)})),[]);const a={ref:n,tabIndex:0,role:r,"aria-hidden":!r||void 0,[va("focus-guard")]:"",style:La};return t.createElement("span",ca({},e,a))})),Na=t.createContext(null),Ma=va("portal");function Va(e){const{children:n,id:r,root:i=null,preserveTabOrder:a=!0}=e,o=function(e){void 0===e&&(e={});const{id:n,root:r}=e,i=fa(),a=Ba(),[o,s]=t.useState(null),l=t.useRef(null);return la((()=>()=>{null==o||o.remove(),queueMicrotask((()=>{l.current=null}))}),[o]),la((()=>{if(!i)return;if(l.current)return;const e=n?document.getElementById(n):null;if(!e)return;const t=document.createElement("div");t.id=i,t.setAttribute(Ma,""),e.appendChild(t),l.current=t,s(t)}),[n,i]),la((()=>{if(!i)return;if(l.current)return;let e=r||(null==a?void 0:a.portalNode);e&&!lr(e)&&(e=e.current),e=e||document.body;let t=null;n&&(t=document.createElement("div"),t.id=n,e.appendChild(t));const o=document.createElement("div");o.id=i,o.setAttribute(Ma,""),e=t||e,e.appendChild(o),l.current=o,s(o)}),[n,r,i,a]),o}({id:r,root:i}),[s,l]=t.useState(null),c=t.useRef(null),u=t.useRef(null),d=t.useRef(null),p=t.useRef(null),f=!!s&&!s.modal&&s.open&&a&&!(!i&&!o);return t.useEffect((()=>{if(o&&a&&(null==s||!s.modal))return o.addEventListener("focusin",e,!0),o.addEventListener("focusout",e,!0),()=>{o.removeEventListener("focusin",e,!0),o.removeEventListener("focusout",e,!0)};function e(e){o&&Ia(e)&&("focusin"===e.type?ja:Aa)(o)}}),[o,a,null==s?void 0:s.modal]),t.createElement(Na.Provider,{value:t.useMemo((()=>({preserveTabOrder:a,beforeOutsideRef:c,afterOutsideRef:u,beforeInsideRef:d,afterInsideRef:p,portalNode:o,setFocusManagerState:l})),[a,o])},f&&o&&t.createElement(Fa,{"data-type":"outside",ref:c,onFocus:e=>{if(Ia(e,o)){var t;null==(t=d.current)||t.focus()}else{const e=Ra()||(null==s?void 0:s.refs.domReference.current);null==e||e.focus()}}}),f&&o&&t.createElement("span",{"aria-owns":o.id,style:La}),o&&(0,yi.createPortal)(n,o),f&&o&&t.createElement(Fa,{"data-type":"outside",ref:u,onFocus:e=>{if(Ia(e,o)){var t;null==(t=p.current)||t.focus()}else{const t=Ta()||(null==s?void 0:s.refs.domReference.current);null==t||t.focus(),(null==s?void 0:s.closeOnFocusOut)&&(null==s||s.onOpenChange(!1,e.nativeEvent))}}}))}const Ba=()=>t.useContext(Na),za=20;let Wa=[];function Qa(e){Wa=Wa.filter((e=>e.isConnected));let t=e;if(t&&"body"!==ir(t)){if(!Qi(t,ka())){const e=Wi(t,ka())[0];e&&(t=e)}Wa.push(t),Wa.length>za&&(Wa=Wa.slice(-za))}}function Ua(){return Wa.slice().reverse().find((e=>e.isConnected))}const qa=t.forwardRef((function(e,n){return t.createElement("button",ca({},e,{type:"button",ref:n,tabIndex:-1,style:La}))}));function Ha(e){const{context:n,children:r,disabled:i=!1,order:a=["content"],guards:o=!0,initialFocus:s=0,returnFocus:l=!0,modal:c=!0,visuallyHiddenDismiss:u=!1,closeOnFocusOut:d=!0}=e,{open:p,refs:f,nodeId:h,onOpenChange:g,events:m,dataRef:b,elements:{domReference:v,floating:y}}=n,O="number"==typeof s&&s<0,w=jr(v)&&O,S="undefined"==typeof HTMLElement||!("inert"in HTMLElement.prototype)||o,x=ya(a),_=ya(s),P=ya(l),E=ba(),C=Ba(),k=t.useRef(null),D=t.useRef(null),T=t.useRef(!1),R=t.useRef(!1),I=null!=C,A=t.useCallback((function(e){return void 0===e&&(e=y),e?Wi(e,ka()):[]}),[y]),j=t.useCallback((e=>{const t=A(e);return x.current.map((e=>v&&"reference"===e?v:y&&"floating"===e?y:t)).filter(Boolean).flat()}),[v,y,x,A]);function L(e){return!i&&u&&c?t.createElement(qa,{ref:"start"===e?k:D,onClick:e=>g(!1,e.nativeEvent)},"string"==typeof u?u:"Dismiss"):null}t.useEffect((()=>{if(i||!c)return;function e(e){if("Tab"===e.key){Sr(y,wr(Dr(y)))&&0===A().length&&!w&&Ar(e);const t=j(),n=Rr(e);"reference"===x.current[0]&&n===v&&(Ar(e),e.shiftKey?sa(t[t.length-1]):sa(t[1])),"floating"===x.current[1]&&n===y&&e.shiftKey&&(Ar(e),sa(t[0]))}}const t=Dr(y);return t.addEventListener("keydown",e),()=>{t.removeEventListener("keydown",e)}}),[i,v,y,c,x,w,A,j]),t.useEffect((()=>{if(!i&&d)return y&&cr(v)?(v.addEventListener("focusout",t),v.addEventListener("pointerdown",e),!c&&y.addEventListener("focusout",t),()=>{v.removeEventListener("focusout",t),v.removeEventListener("pointerdown",e),!c&&y.removeEventListener("focusout",t)}):void 0;function e(){R.current=!0,setTimeout((()=>{R.current=!1}))}function t(e){const t=e.relatedTarget;queueMicrotask((()=>{const n=!(Sr(v,t)||Sr(y,t)||Sr(t,y)||Sr(null==C?void 0:C.portalNode,t)||null!=t&&t.hasAttribute(va("focus-guard"))||E&&(Oa(E.nodesRef.current,h).find((e=>{var n,r;return Sr(null==(n=e.context)?void 0:n.elements.floating,t)||Sr(null==(r=e.context)?void 0:r.elements.domReference,t)}))||function(e,t){var n;let r=[],i=null==(n=e.find((e=>e.id===t)))?void 0:n.parentId;for(;i;){const t=e.find((e=>e.id===i));i=null==t?void 0:t.parentId,t&&(r=r.concat(t))}return r}(E.nodesRef.current,h).find((e=>{var n,r;return(null==(n=e.context)?void 0:n.elements.floating)===t||(null==(r=e.context)?void 0:r.elements.domReference)===t}))));t&&n&&!R.current&&t!==Ua()&&(T.current=!0,g(!1,e))}))}}),[i,v,y,c,h,E,C,g,d]),t.useEffect((()=>{var e;if(i)return;const t=Array.from((null==C||null==(e=C.portalNode)?void 0:e.querySelectorAll("["+va("portal")+"]"))||[]);if(y){const e=[y,...t,k.current,D.current,x.current.includes("reference")||w?v:null].filter((e=>null!=e)),n=c||w?Ca(e,S,!S):Ca(e);return()=>{n()}}}),[i,v,y,c,x,C,w,S]),la((()=>{if(i||!y)return;const e=wr(Dr(y));queueMicrotask((()=>{const t=j(y),n=_.current,r=("number"==typeof n?t[n]:n.current)||y,i=Sr(y,e);O||i||!p||sa(r,{preventScroll:r===y})}))}),[i,p,y,O,j,_]),la((()=>{if(i||!y)return;let e=!1;const t=Dr(y),n=wr(t);let r=b.current.openEvent;function a(t){let{open:n,reason:i,event:a,nested:o}=t;n&&(r=a),"escape-key"===i&&f.domReference.current&&Qa(f.domReference.current),"hover"===i&&"mouseleave"===a.type&&(T.current=!0),"outside-press"===i&&(o?(T.current=!1,e=!0):T.current=!(Pr(a)||Er(a)))}return Qa(n),m.on("openchange",a),()=>{m.off("openchange",a);const n=wr(t),i=Sr(y,n)||E&&Oa(E.nodesRef.current,h).some((e=>{var t;return Sr(null==(t=e.context)?void 0:t.elements.floating,n)}));(i||r&&["click","mousedown"].includes(r.type))&&f.domReference.current&&Qa(f.domReference.current);const o=Ua();P.current&&!T.current&&cr(o)&&(o===n||n===t.body||i)&&sa(o,{cancelPrevious:!1,preventScroll:e})}}),[i,y,P,b,f,m,E,h]),la((()=>{if(!i&&C)return C.setFocusManagerState({modal:c,closeOnFocusOut:d,open:p,onOpenChange:g,refs:f}),()=>{C.setFocusManagerState(null)}}),[i,C,c,p,g,f,d]),la((()=>{if(i||!y||"function"!=typeof MutationObserver||O)return;const e=()=>{const e=y.getAttribute("tabindex");x.current.includes("floating")||wr(Dr(y))!==f.domReference.current&&0===A().length?"0"!==e&&y.setAttribute("tabindex","0"):"-1"!==e&&y.setAttribute("tabindex","-1")};e();const t=new MutationObserver(e);return t.observe(y,{childList:!0,subtree:!0,attributes:!0}),()=>{t.disconnect()}}),[i,y,f,x,A,O]);const $=!i&&S&&(I||c);return t.createElement(t.Fragment,null,$&&t.createElement(Fa,{"data-type":"inside",ref:null==C?void 0:C.beforeInsideRef,onFocus:e=>{if(c){const e=j();sa("reference"===a[0]?e[0]:e[e.length-1])}else if(null!=C&&C.preserveTabOrder&&C.portalNode)if(T.current=!1,Ia(e,C.portalNode)){const e=Ta()||v;null==e||e.focus()}else{var t;null==(t=C.beforeOutsideRef.current)||t.focus()}}}),!w&&L("start"),r,L("end"),$&&t.createElement(Fa,{"data-type":"inside",ref:null==C?void 0:C.afterInsideRef,onFocus:e=>{if(c)sa(j()[0]);else if(null!=C&&C.preserveTabOrder&&C.portalNode)if(d&&(T.current=!0),Ia(e,C.portalNode)){const e=Ra()||v;null==e||e.focus()}else{var t;null==(t=C.afterOutsideRef.current)||t.focus()}}}))}const Ga={pointerdown:"onPointerDown",mousedown:"onMouseDown",click:"onClick"},Xa={pointerdown:"onPointerDownCapture",mousedown:"onMouseDownCapture",click:"onClickCapture"},Ya=e=>{var t,n;return{escapeKey:"boolean"==typeof e?e:null!=(t=null==e?void 0:e.escapeKey)&&t,outsidePress:"boolean"==typeof e?e:null==(n=null==e?void 0:e.outsidePress)||n}};function Za(e){void 0===e&&(e={});const{nodeId:n}=e,r=function(e){const{open:n=!1,onOpenChange:r,elements:i}=e,a=fa(),o=t.useRef({}),[s]=t.useState((()=>function(){const e=new Map;return{emit(t,n){var r;null==(r=e.get(t))||r.forEach((e=>e(n)))},on(t,n){e.set(t,[...e.get(t)||[],n])},off(t,n){var r;e.set(t,(null==(r=e.get(t))?void 0:r.filter((e=>e!==n)))||[])}}}())),l=null!=ma(),[c,u]=t.useState(i.reference),d=Hi(((e,t,n)=>{o.current.openEvent=e?t:void 0,s.emit("openchange",{open:e,event:t,reason:n,nested:l}),null==r||r(e,t,n)})),p=t.useMemo((()=>({setPositionReference:u})),[]),f=t.useMemo((()=>({reference:c||i.reference||null,floating:i.floating||null,domReference:i.reference})),[c,i.reference,i.floating]);return t.useMemo((()=>({dataRef:o,open:n,onOpenChange:d,elements:f,events:s,floatingId:a,refs:p})),[n,d,f,s,a,p])}({...e,elements:{reference:null,floating:null,...e.elements}}),i=e.rootContext||r,a=i.elements,[o,s]=t.useState(null),[l,c]=t.useState(null),u=(null==a?void 0:a.reference)||o,d=t.useRef(null),p=ba();la((()=>{u&&(d.current=u)}),[u]);const f=function(e){void 0===e&&(e={});const{placement:n="bottom",strategy:r="absolute",middleware:i=[],platform:a,elements:{reference:o,floating:s}={},transform:l=!0,whileElementsMounted:c,open:u}=e,[d,p]=t.useState({x:0,y:0,strategy:r,placement:n,middlewareData:{},isPositioned:!1}),[f,h]=t.useState(i);Si(f,i)||h(i);const[g,m]=t.useState(null),[b,v]=t.useState(null),y=t.useCallback((e=>{e!==x.current&&(x.current=e,m(e))}),[]),O=t.useCallback((e=>{e!==_.current&&(_.current=e,v(e))}),[]),w=o||g,S=s||b,x=t.useRef(null),_=t.useRef(null),P=t.useRef(d),E=null!=c,C=Pi(c),k=Pi(a),D=t.useCallback((()=>{if(!x.current||!_.current)return;const e={placement:n,strategy:r,middleware:f};k.current&&(e.platform=k.current),((e,t,n)=>{const r=new Map,i={platform:hi,...n},a={...i.platform,_c:r};return(async(e,t,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:a=[],platform:o}=n,s=a.filter(Boolean),l=await(null==o.isRTL?void 0:o.isRTL(t));let c=await o.getElementRects({reference:e,floating:t,strategy:i}),{x:u,y:d}=Zr(c,r,l),p=r,f={},h=0;for(let n=0;n<s.length;n++){const{name:a,fn:g}=s[n],{x:m,y:b,data:v,reset:y}=await g({x:u,y:d,initialPlacement:r,placement:p,strategy:i,middlewareData:f,rects:c,platform:o,elements:{reference:e,floating:t}});u=null!=m?m:u,d=null!=b?b:d,f={...f,[a]:{...f[a],...v}},y&&h<=50&&(h++,"object"==typeof y&&(y.placement&&(p=y.placement),y.rects&&(c=!0===y.rects?await o.getElementRects({reference:e,floating:t,strategy:i}):y.rects),({x:u,y:d}=Zr(c,p,l))),n=-1)}return{x:u,y:d,placement:p,strategy:i,middlewareData:f}})(e,t,{...i,platform:a})})(x.current,_.current,e).then((e=>{const t={...e,isPositioned:!0};T.current&&!Si(P.current,t)&&(P.current=t,yi.flushSync((()=>{p(t)})))}))}),[f,n,r,k]);wi((()=>{!1===u&&P.current.isPositioned&&(P.current.isPositioned=!1,p((e=>({...e,isPositioned:!1}))))}),[u]);const T=t.useRef(!1);wi((()=>(T.current=!0,()=>{T.current=!1})),[]),wi((()=>{if(w&&(x.current=w),S&&(_.current=S),w&&S){if(C.current)return C.current(w,S,D);D()}}),[w,S,D,C,E]);const R=t.useMemo((()=>({reference:x,floating:_,setReference:y,setFloating:O})),[y,O]),I=t.useMemo((()=>({reference:w,floating:S})),[w,S]),A=t.useMemo((()=>{const e={position:r,left:0,top:0};if(!I.floating)return e;const t=_i(I.floating,d.x),n=_i(I.floating,d.y);return l?{...e,transform:"translate("+t+"px, "+n+"px)",...xi(I.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:t,top:n}}),[r,l,I.floating,d.x,d.y]);return t.useMemo((()=>({...d,update:D,refs:R,elements:I,floatingStyles:A})),[d,D,R,I,A])}({...e,elements:{...a,...l&&{reference:l}}}),h=t.useCallback((e=>{const t=lr(e)?{getBoundingClientRect:()=>e.getBoundingClientRect(),contextElement:e}:e;c(t),f.refs.setReference(t)}),[f.refs]),g=t.useCallback((e=>{(lr(e)||null===e)&&(d.current=e,s(e)),(lr(f.refs.reference.current)||null===f.refs.reference.current||null!==e&&!lr(e))&&f.refs.setReference(e)}),[f.refs]),m=t.useMemo((()=>({...f.refs,setReference:g,setPositionReference:h,domReference:d})),[f.refs,g,h]),b=t.useMemo((()=>({...f.elements,domReference:u})),[f.elements,u]),v=t.useMemo((()=>({...f,...i,refs:m,elements:b,nodeId:n})),[f,m,b,n,i]);return la((()=>{i.dataRef.current.floatingContext=v;const e=null==p?void 0:p.nodesRef.current.find((e=>e.id===n));e&&(e.context=v)})),t.useMemo((()=>({...f,context:v,refs:m,elements:b})),[f,m,b,v])}const Ka="active",Ja="selected";function eo(e,t,n){const r=new Map,i="item"===n;let a=e;if(i&&e){const{[Ka]:t,[Ja]:n,...r}=e;a=r}return{..."floating"===n&&{tabIndex:-1},...a,...t.map((t=>{const r=t?t[n]:null;return"function"==typeof r?e?r(e):null:r})).concat(e).reduce(((e,t)=>t?(Object.entries(t).forEach((t=>{let[n,a]=t;var o;i&&[Ka,Ja].includes(n)||(0===n.indexOf("on")?(r.has(n)||r.set(n,[]),"function"==typeof a&&(null==(o=r.get(n))||o.push(a),e[n]=function(){for(var e,t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return null==(e=r.get(n))?void 0:e.map((e=>e(...i))).find((e=>void 0!==e))})):e[n]=a)})),e):e),{})}}let to=!1;function no(e,t,n){switch(e){case"vertical":return t;case"horizontal":return n;default:return t||n}}function ro(e,t){return no(t,e===Gi||e===Xi,e===Yi||e===Zi)}function io(e,t,n){return no(t,e===Xi,n?e===Yi:e===Zi)||"Enter"===e||" "===e||""===e}function ao(e,t,n){return no(t,n?e===Zi:e===Yi,e===Gi)}function oo(e,n){const{open:r,onOpenChange:i,elements:{domReference:a,floating:o}}=e,{listRef:s,activeIndex:l,onNavigate:c=(()=>{}),enabled:u=!0,selectedIndex:d=null,allowEscape:p=!1,loop:f=!1,nested:h=!1,rtl:g=!1,virtual:m=!1,focusItemOnOpen:b="auto",focusItemOnHover:v=!0,openOnArrowKeyDown:y=!0,disabledIndices:O,orientation:w="vertical",cols:S=1,scrollItemIntoView:x=!0,virtualItemRef:_,itemSizes:P,dense:E=!1}=n,C=ma(),k=ba(),D=Hi(c),T=t.useRef(b),R=t.useRef(null!=d?d:-1),I=t.useRef(null),A=t.useRef(!0),j=t.useRef(D),L=t.useRef(!!o),$=t.useRef(!1),F=t.useRef(!1),N=ya(O),M=ya(r),V=ya(x),B=ya(o),z=ya(d),[W,Q]=t.useState(),[U,q]=t.useState(),H=Hi((function(e,t,n){function r(e){m?(Q(e.id),null==k||k.events.emit("virtualfocus",e),_&&(_.current=e)):sa(e,{preventScroll:!0,sync:!(!xr().toLowerCase().startsWith("mac")||navigator.maxTouchPoints||!Cr())&&(to||$.current)})}void 0===n&&(n=!1);const i=e.current[t.current];i&&r(i),requestAnimationFrame((()=>{const a=e.current[t.current]||i;if(!a)return;i||r(a);const o=V.current;o&&X&&(n||!A.current)&&(null==a.scrollIntoView||a.scrollIntoView("boolean"==typeof o?{block:"nearest",inline:"nearest"}:o))}))}));la((()=>{document.createElement("div").focus({get preventScroll(){return to=!0,!1}})}),[]),la((()=>{u&&(r&&o?T.current&&null!=d&&(F.current=!0,R.current=d,D(d)):L.current&&(R.current=-1,j.current(null)))}),[u,r,o,d,D]),la((()=>{if(u&&r&&o)if(null==l){if($.current=!1,null!=z.current)return;if(L.current&&(R.current=-1,H(s,R)),!L.current&&T.current&&(null!=I.current||!0===T.current&&null==I.current)){let e=0;const t=()=>{null==s.current[0]?(e<2&&(e?requestAnimationFrame:queueMicrotask)(t),e++):(R.current=null==I.current||io(I.current,w,g)||h?ea(s,N.current):ta(s,N.current),I.current=null,D(R.current))};t()}}else Ji(s,l)||(R.current=l,H(s,R,F.current),F.current=!1)}),[u,r,o,l,z,h,s,w,g,D,H,N]),la((()=>{var e;if(!u||o||!k||m||!L.current)return;const t=k.nodesRef.current,n=null==(e=t.find((e=>e.id===C)))||null==(e=e.context)?void 0:e.elements.floating,r=wr(Dr(o)),i=t.some((e=>e.context&&Sr(e.context.elements.floating,r)));n&&!i&&A.current&&n.focus({preventScroll:!0})}),[u,o,k,C,m]),la((()=>{if(u&&k&&m&&!C)return k.events.on("virtualfocus",e),()=>{k.events.off("virtualfocus",e)};function e(e){q(e.id),_&&(_.current=e)}}),[u,k,m,C,_]),la((()=>{j.current=D,L.current=!!o})),la((()=>{r||(I.current=null)}),[r]);const G=null!=l,X=t.useMemo((()=>{function e(e){if(!r)return;const t=s.current.indexOf(e);-1!==t&&D(t)}const t={onFocus(t){let{currentTarget:n}=t;e(n)},onClick:e=>{let{currentTarget:t}=e;return t.focus({preventScroll:!0})},...v&&{onMouseMove(t){let{currentTarget:n}=t;e(n)},onPointerLeave(e){let{pointerType:t}=e;A.current&&"touch"!==t&&(R.current=-1,H(s,R),D(null),m||sa(B.current,{preventScroll:!0}))}}};return t}),[r,B,H,v,s,D,m]);return t.useMemo((()=>{if(!u)return{};const e=N.current;function t(t){if(A.current=!1,$.current=!0,!M.current&&t.currentTarget===B.current)return;if(h&&ao(t.key,w,g))return Ar(t),i(!1,t.nativeEvent,"list-navigation"),void(cr(a)&&!m&&a.focus());const n=R.current,o=ea(s,e),l=ta(s,e);if("Home"===t.key&&(Ar(t),R.current=o,D(R.current)),"End"===t.key&&(Ar(t),R.current=l,D(R.current)),S>1){const n=P||Array.from({length:s.current.length},(()=>({width:1,height:1}))),r=function(e,t,n){const r=[];let i=0;return e.forEach(((e,a)=>{let{width:o,height:s}=e,l=!1;for(n&&(i=0);!l;){const e=[];for(let n=0;n<o;n++)for(let r=0;r<s;r++)e.push(i+n+r*t);i%t+o<=t&&e.every((e=>null==r[e]))?(e.forEach((e=>{r[e]=a})),l=!0):i++}})),[...r]}(n,S,E),i=r.findIndex((t=>null!=t&&!aa(s.current,t,e))),a=r.reduce(((t,n,r)=>null==n||aa(s.current,n,e)?t:r),-1);if(R.current=r[function(e,t){let{event:n,orientation:r,loop:i,cols:a,disabledIndices:o,minIndex:s,maxIndex:l,prevIndex:c,stopEvent:u=!1}=t,d=c;if(n.key===Gi){if(u&&Ar(n),-1===c)d=l;else if(d=na(e,{startingIndex:d,amount:a,decrement:!0,disabledIndices:o}),i&&(c-a<s||d<0)){const e=c%a,t=l%a,n=l-(t-e);d=t===e?l:t>e?n:n-a}Ji(e,d)&&(d=c)}if(n.key===Xi&&(u&&Ar(n),-1===c?d=s:(d=na(e,{startingIndex:c,amount:a,disabledIndices:o}),i&&c+a>l&&(d=na(e,{startingIndex:c%a-a,amount:a,disabledIndices:o}))),Ji(e,d)&&(d=c)),"both"===r){const t=Nr(c/a);n.key===Zi&&(u&&Ar(n),c%a!=a-1?(d=na(e,{startingIndex:c,disabledIndices:o}),i&&Ki(d,a,t)&&(d=na(e,{startingIndex:c-c%a-1,disabledIndices:o}))):i&&(d=na(e,{startingIndex:c-c%a-1,disabledIndices:o})),Ki(d,a,t)&&(d=c)),n.key===Yi&&(u&&Ar(n),c%a!=0?(d=na(e,{startingIndex:c,decrement:!0,disabledIndices:o}),i&&Ki(d,a,t)&&(d=na(e,{startingIndex:c+(a-c%a),decrement:!0,disabledIndices:o}))):i&&(d=na(e,{startingIndex:c+(a-c%a),decrement:!0,disabledIndices:o})),Ki(d,a,t)&&(d=c));const r=Nr(l/a)===t;Ji(e,d)&&(d=i&&r?n.key===Yi?l:na(e,{startingIndex:c-c%a-1,disabledIndices:o}):c)}return d}({current:r.map((e=>null!=e?s.current[e]:null))},{event:t,orientation:w,loop:f,cols:S,disabledIndices:ia([...e||s.current.map(((e,t)=>aa(s.current,t)?t:void 0)),void 0],r),minIndex:i,maxIndex:a,prevIndex:ra(R.current>l?o:R.current,n,r,S,t.key===Xi?"bl":t.key===Zi?"tr":"tl"),stopEvent:!0})],D(R.current),"both"===w)return}if(ro(t.key,w)){if(Ar(t),r&&!m&&wr(t.currentTarget.ownerDocument)===t.currentTarget)return R.current=io(t.key,w,g)?o:l,void D(R.current);io(t.key,w,g)?R.current=f?n>=l?p&&n!==s.current.length?-1:o:na(s,{startingIndex:n,disabledIndices:e}):Math.min(l,na(s,{startingIndex:n,disabledIndices:e})):R.current=f?n<=o?p&&-1!==n?s.current.length:l:na(s,{startingIndex:n,decrement:!0,disabledIndices:e}):Math.max(o,na(s,{startingIndex:n,decrement:!0,disabledIndices:e})),Ji(s,R.current)?D(null):D(R.current)}}function n(e){"auto"===b&&Pr(e.nativeEvent)&&(T.current=!0)}const o=m&&r&&G&&{"aria-activedescendant":U||W},l=s.current.find((e=>(null==e?void 0:e.id)===W));return{reference:{...o,onKeyDown(n){A.current=!1;const a=0===n.key.indexOf("Arrow"),o=function(e,t,n){return no(t,n?e===Yi:e===Zi,e===Xi)}(n.key,w,g),c=ao(n.key,w,g),u=ro(n.key,w),p=(h?o:u)||"Enter"===n.key||""===n.key.trim();if(m&&r){const e=null==k?void 0:k.nodesRef.current.find((e=>null==e.parentId)),r=k&&e?function(e,t){let n,r=-1;return function t(i,a){a>r&&(n=i,r=a),Oa(e,i).forEach((e=>{t(e.id,a+1)}))}(t,0),e.find((e=>e.id===n))}(k.nodesRef.current,e.id):null;if(a&&r&&_){const e=new KeyboardEvent("keydown",{key:n.key,bubbles:!0});if(o||c){var f,b;const t=(null==(f=r.context)?void 0:f.elements.domReference)===n.currentTarget,i=c&&!t?null==(b=r.context)?void 0:b.elements.domReference:o?l:null;i&&(Ar(n),i.dispatchEvent(e),q(void 0))}var v;if(u&&r.context&&r.context.open&&r.parentId&&n.currentTarget!==r.context.elements.domReference)return Ar(n),void(null==(v=r.context.elements.domReference)||v.dispatchEvent(e))}return t(n)}(r||y||!a)&&(p&&(I.current=h&&u?null:n.key),h?o&&(Ar(n),r?(R.current=ea(s,e),D(R.current)):i(!0,n.nativeEvent,"list-navigation")):u&&(null!=d&&(R.current=d),Ar(n),!r&&y?i(!0,n.nativeEvent,"list-navigation"):t(n),r&&D(R.current)))},onFocus(){r&&!m&&D(null)},onPointerDown:function(e){T.current=b,"auto"===b&&Er(e.nativeEvent)&&(T.current=!0)},onMouseDown:n,onClick:n},floating:{"aria-orientation":"both"===w?void 0:w,...!jr(a)&&o,onKeyDown:t,onPointerMove(){A.current=!0}},item:X}}),[a,B,W,U,N,M,s,u,w,g,m,r,G,h,d,y,p,S,f,b,D,i,X,k,_,P,E])}const so=new Map([["select","listbox"],["combobox","listbox"],["label",!1]]);function lo(e,t,n){let r,i=n.initialDeps??[];return()=>{var a,o,s,l;let c;n.key&&(null==(a=n.debug)?void 0:a.call(n))&&(c=Date.now());const u=e(),d=u.length!==i.length||u.some(((e,t)=>i[t]!==e));if(!d)return r;let p;if(i=u,n.key&&(null==(o=n.debug)?void 0:o.call(n))&&(p=Date.now()),r=t(...u),n.key&&(null==(s=n.debug)?void 0:s.call(n))){const e=Math.round(100*(Date.now()-c))/100,t=Math.round(100*(Date.now()-p))/100,r=t/16,i=(e,t)=>{for(e=String(e);e.length<t;)e=" "+e;return e};console.info(`%c ${i(t,5)} /${i(e,5)} ms`,`\n            font-size: .6rem;\n            font-weight: bold;\n            color: hsl(${Math.max(0,Math.min(120-120*r,120))}deg 100% 31%);`,null==n?void 0:n.key)}return null==(l=null==n?void 0:n.onChange)||l.call(n,r),r}}function co(e,t){if(void 0===e)throw new Error("Unexpected undefined"+(t?`: ${t}`:""));return e}const uo=(e,t,n)=>{let r;return function(...i){e.clearTimeout(r),r=e.setTimeout((()=>t.apply(this,i)),n)}},po=e=>e,fo=e=>{const t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),r=[];for(let e=t;e<=n;e++)r.push(e);return r},ho=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;const i=e=>{const{width:n,height:r}=e;t({width:Math.round(n),height:Math.round(r)})};if(i(n.getBoundingClientRect()),!r.ResizeObserver)return()=>{};const a=new r.ResizeObserver((e=>{const t=e[0];if(null==t?void 0:t.borderBoxSize){const e=t.borderBoxSize[0];if(e)return void i({width:e.inlineSize,height:e.blockSize})}i(n.getBoundingClientRect())}));return a.observe(n,{box:"border-box"}),()=>{a.unobserve(n)}},go={passive:!0},mo="undefined"==typeof window||"onscrollend"in window,bo=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;let i=0;const a=mo?()=>{}:uo(r,(()=>{t(i,!1)}),e.options.isScrollingResetDelay),o=r=>()=>{const{horizontal:o,isRtl:s}=e.options;i=o?n.scrollLeft*(s?-1:1):n.scrollTop,a(),t(i,r)},s=o(!0),l=o(!1);return l(),n.addEventListener("scroll",s,go),n.addEventListener("scrollend",l,go),()=>{n.removeEventListener("scroll",s),n.removeEventListener("scrollend",l)}},vo=(e,t,n)=>{if(null==t?void 0:t.borderBoxSize){const e=t.borderBoxSize[0];if(e)return Math.round(e[n.options.horizontal?"inlineSize":"blockSize"])}return Math.round(e.getBoundingClientRect()[n.options.horizontal?"width":"height"])},yo=(e,{adjustments:t=0,behavior:n},r)=>{var i,a;const o=e+t;null==(a=null==(i=r.scrollElement)?void 0:i.scrollTo)||a.call(i,{[r.options.horizontal?"left":"top"]:o,behavior:n})};class Oo{constructor(e){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let e=null;const t=()=>e||(this.targetWindow&&this.targetWindow.ResizeObserver?e=new this.targetWindow.ResizeObserver((e=>{e.forEach((e=>{this._measureElement(e.target,e)}))})):null);return{disconnect:()=>{var n;null==(n=t())||n.disconnect(),e=null},observe:e=>{var n;return null==(n=t())?void 0:n.observe(e,{box:"border-box"})},unobserve:e=>{var n;return null==(n=t())?void 0:n.unobserve(e)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach((([t,n])=>{void 0===n&&delete e[t]})),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:po,rangeExtractor:fo,onChange:()=>{},measureElement:vo,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,...e}},this.notify=e=>{var t,n;null==(n=(t=this.options).onChange)||n.call(t,this,e)},this.maybeNotify=lo((()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null])),(e=>{this.notify(e)}),{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach((e=>e())),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var e;const t=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==t){if(this.cleanup(),!t)return void this.maybeNotify();this.scrollElement=t,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=(null==(e=this.scrollElement)?void 0:e.window)??null,this.elementsCache.forEach((e=>{this.observer.observe(e)})),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,(e=>{this.scrollRect=e,this.maybeNotify()}))),this.unsubs.push(this.options.observeElementOffset(this,((e,t)=>{this.scrollAdjustments=0,this.scrollDirection=t?this.getScrollOffset()<e?"forward":"backward":null,this.scrollOffset=e,this.isScrolling=t,this.maybeNotify()})))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??("function"==typeof this.options.initialOffset?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(e,t)=>{const n=new Map,r=new Map;for(let i=t-1;i>=0;i--){const t=e[i];if(n.has(t.lane))continue;const a=r.get(t.lane);if(null==a||t.end>a.end?r.set(t.lane,t):t.end<a.end&&n.set(t.lane,!0),n.size===this.options.lanes)break}return r.size===this.options.lanes?Array.from(r.values()).sort(((e,t)=>e.end===t.end?e.index-t.index:e.end-t.end))[0]:void 0},this.getMeasurementOptions=lo((()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled]),((e,t,n,r,i)=>(this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:t,scrollMargin:n,getItemKey:r,enabled:i})),{key:!1}),this.getMeasurements=lo((()=>[this.getMeasurementOptions(),this.itemSizeCache]),(({count:e,paddingStart:t,scrollMargin:n,getItemKey:r,enabled:i},a)=>{if(!i)return this.measurementsCache=[],this.itemSizeCache.clear(),[];0===this.measurementsCache.length&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach((e=>{this.itemSizeCache.set(e.key,e.size)})));const o=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const s=this.measurementsCache.slice(0,o);for(let i=o;i<e;i++){const e=r(i),o=1===this.options.lanes?s[i-1]:this.getFurthestMeasurement(s,i),l=o?o.end+this.options.gap:t+n,c=a.get(e),u="number"==typeof c?c:this.options.estimateSize(i),d=l+u,p=o?o.lane:i%this.options.lanes;s[i]={index:i,start:l,size:u,end:d,key:e,lane:p}}return this.measurementsCache=s,s}),{key:!1,debug:()=>this.options.debug}),this.calculateRange=lo((()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset()]),((e,t,n)=>this.range=e.length>0&&t>0?function({measurements:e,outerSize:t,scrollOffset:n}){const r=e.length-1,i=wo(0,r,(t=>e[t].start),n);let a=i;for(;a<r&&e[a].end<n+t;)a++;return{startIndex:i,endIndex:a}}({measurements:e,outerSize:t,scrollOffset:n}):null),{key:!1,debug:()=>this.options.debug}),this.getIndexes=lo((()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count]),((e,t,n,r)=>null===t?[]:e({startIndex:t.startIndex,endIndex:t.endIndex,overscan:n,count:r})),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{const t=this.options.indexAttribute,n=e.getAttribute(t);return n?parseInt(n,10):(console.warn(`Missing attribute name '${t}={index}' on measured element.`),-1)},this._measureElement=(e,t)=>{const n=this.indexFromElement(e),r=this.measurementsCache[n];if(!r)return;const i=r.key,a=this.elementsCache.get(i);a!==e&&(a&&this.observer.unobserve(a),this.observer.observe(e),this.elementsCache.set(i,e)),e.isConnected&&this.resizeItem(n,this.options.measureElement(e,t,this))},this.resizeItem=(e,t)=>{const n=this.measurementsCache[e];if(!n)return;const r=t-(this.itemSizeCache.get(n.key)??n.size);0!==r&&((void 0!==this.shouldAdjustScrollPositionOnItemSizeChange?this.shouldAdjustScrollPositionOnItemSizeChange(n,r,this):n.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=r,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(n.index),this.itemSizeCache=new Map(this.itemSizeCache.set(n.key,t)),this.notify(!1))},this.measureElement=e=>{e?this._measureElement(e,void 0):this.elementsCache.forEach(((e,t)=>{e.isConnected||(this.observer.unobserve(e),this.elementsCache.delete(t))}))},this.getVirtualItems=lo((()=>[this.getIndexes(),this.getMeasurements()]),((e,t)=>{const n=[];for(let r=0,i=e.length;r<i;r++){const i=t[e[r]];n.push(i)}return n}),{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{const t=this.getMeasurements();if(0!==t.length)return co(t[wo(0,t.length-1,(e=>co(t[e]).start),e)])},this.getOffsetForAlignment=(e,t)=>{const n=this.getSize(),r=this.getScrollOffset();"auto"===t&&(t=e<=r?"start":e>=r+n?"end":"start"),"start"===t||("end"===t?e-=n:"center"===t&&(e-=n/2));const i=this.options.horizontal?"scrollWidth":"scrollHeight",a=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[i]:this.scrollElement[i]:0)-n;return Math.max(Math.min(a,e),0)},this.getOffsetForIndex=(e,t="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));const n=this.measurementsCache[e];if(!n)return;const r=this.getSize(),i=this.getScrollOffset();if("auto"===t)if(n.end>=i+r-this.options.scrollPaddingEnd)t="end";else{if(!(n.start<=i+this.options.scrollPaddingStart))return[i,t];t="start"}const a="end"===t?n.end+this.options.scrollPaddingEnd:n.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(a,t),t]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{null!==this.scrollToIndexTimeoutId&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(e,{align:t="start",behavior:n}={})=>{this.cancelScrollToIndex(),"smooth"===n&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(e,t),{adjustments:void 0,behavior:n})},this.scrollToIndex=(e,{align:t="auto",behavior:n}={})=>{e=Math.max(0,Math.min(e,this.options.count-1)),this.cancelScrollToIndex(),"smooth"===n&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const r=this.getOffsetForIndex(e,t);if(!r)return;const[i,a]=r;this._scrollToOffset(i,{adjustments:void 0,behavior:n}),"smooth"!==n&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout((()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(e))){const[i]=co(this.getOffsetForIndex(e,a));t=i,r=this.getScrollOffset(),Math.abs(t-r)<1||this.scrollToIndex(e,{align:a,behavior:n})}else this.scrollToIndex(e,{align:a,behavior:n});var t,r})))},this.scrollBy=(e,{behavior:t}={})=>{this.cancelScrollToIndex(),"smooth"===t&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+e,{adjustments:void 0,behavior:t})},this.getTotalSize=()=>{var e;const t=this.getMeasurements();let n;return n=0===t.length?this.options.paddingStart:1===this.options.lanes?(null==(e=t[t.length-1])?void 0:e.end)??0:Math.max(...t.slice(-this.options.lanes).map((e=>e.end))),Math.max(n-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(e,{adjustments:t,behavior:n})=>{this.options.scrollToFn(e,{behavior:n,adjustments:t},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(e)}}const wo=(e,t,n,r)=>{for(;e<=t;){const i=(e+t)/2|0,a=n(i);if(a<r)e=i+1;else{if(!(a>r))return i;t=i-1}}return e>0?e-1:0},So="undefined"!=typeof document?t.useLayoutEffect:t.useEffect;var xo=Object.defineProperty,_o=Object.getOwnPropertySymbols,Po=Object.prototype.hasOwnProperty,Eo=Object.prototype.propertyIsEnumerable,Co=(e,t,n)=>t in e?xo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const ko=(0,t.forwardRef)((function(e,n){var i=e,{children:a,active:o,addGroupBottomBorder:s,isMultiValueEdit:l,checked:c}=i,u=((e,t)=>{var n={};for(var r in e)Po.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&_o)for(var r of _o(e))t.indexOf(r)<0&&Eo.call(e,r)&&(n[r]=e[r]);return n})(i,["children","active","addGroupBottomBorder","isMultiValueEdit","checked"]);const d=(0,Wt.useStyles2)(Do),p=(0,t.useId)();return r().createElement("div",((e,t)=>{for(var n in t||(t={}))Po.call(t,n)&&Co(e,n,t[n]);if(_o)for(var n of _o(t))Eo.call(t,n)&&Co(e,n,t[n]);return e})({ref:n,role:"option",id:p,"aria-selected":o,className:(0,Ht.cx)(d.option,o&&d.optionFocused,s&&d.groupBottomBorder)},u),r().createElement("div",{className:d.optionBody,"data-testid":`data-testid ad hoc filter option value ${a}`},r().createElement("span",null,l?r().createElement(Wt.Checkbox,{tabIndex:-1,checked:c,className:d.checkbox}):null,a)))})),Do=e=>({option:(0,Ht.css)({label:"grafana-select-option",top:0,left:0,width:"100%",position:"absolute",padding:e.spacing(1),display:"flex",alignItems:"center",flexDirection:"row",flexShrink:0,whiteSpace:"nowrap",cursor:"pointer","&:hover":{background:e.colors.action.hover,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${e.colors.primary.border}`}}}),optionFocused:(0,Ht.css)({label:"grafana-select-option-focused",background:e.colors.action.focus,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${e.colors.primary.border}`}}),optionBody:(0,Ht.css)({label:"grafana-select-option-body",display:"flex",fontWeight:e.typography.fontWeightMedium,flexDirection:"column",flexGrow:1}),groupBottomBorder:(0,Ht.css)({borderBottom:`1px solid ${e.colors.border.weak}`}),checkbox:(0,Ht.css)({paddingRight:e.spacing(.5)}),multiValueApplyWrapper:(0,Ht.css)({position:"absolute",top:0,left:0,display:"flex",backgroundColor:e.colors.background.primary,color:e.colors.text.primary,boxShadow:e.shadows.z2,overflowY:"auto",zIndex:e.zIndex.dropdown,gap:e.spacing(1.5),padding:`${e.spacing(1.5)} ${e.spacing(1)}`})}),To=()=>r().createElement(ko,{onClick:e=>e.stopPropagation()},"Loading options..."),Ro=()=>r().createElement(ko,{onClick:e=>e.stopPropagation()},"No options found"),Io=({handleFetchOptions:e})=>r().createElement(ko,{onClick:e},"An error has occurred fetching labels. Click to retry"),Ao=({onApply:e,floatingElement:t,maxOptionWidth:n})=>{const i=(0,Wt.useStyles2)(Do),a=null==t?void 0:t.getBoundingClientRect();return r().createElement("div",{className:i.multiValueApplyWrapper,style:{width:`${n}px`,transform:`translate(${null==a?void 0:a.left}px,${null==a?void 0:a.bottom}px)`}},r().createElement(Wt.Button,{onClick:e,size:"sm",tabIndex:-1},"Apply"))},jo={key:"operator",operator:"value",value:"key"},Lo=(e,t,n,r)=>$o(jo[e],t,"value"===e?n:void 0,r),$o=(e,t,n,r)=>{t(e),null==n||n(),setTimeout((()=>null==r?void 0:r.focus()))},Fo=(e,t)=>"key"===e?{key:t.value,keyLabel:t.label?t.label:t.value}:"value"===e?{value:t.value,valueLabels:[t.label?t.label:t.value]}:{[e]:t.value},No="Filter by label values",Mo=(e,t,n,r)=>{var i;return"key"===t?No:"value"===t?n?"Edit values":(null==(i=e.valueLabels)?void 0:i[0])||"":e[t]&&!r?`${e[t]}`:No};var Vo=Object.defineProperty,Bo=Object.defineProperties,zo=Object.getOwnPropertyDescriptors,Wo=Object.getOwnPropertySymbols,Qo=Object.prototype.hasOwnProperty,Uo=Object.prototype.propertyIsEnumerable,qo=(e,t,n)=>t in e?Vo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ho=(e,t)=>{for(var n in t||(t={}))Qo.call(t,n)&&qo(e,n,t[n]);if(Wo)for(var n of Wo(t))Uo.call(t,n)&&qo(e,n,t[n]);return e},Go=(e,t)=>Bo(e,zo(t));const Xo=(0,t.forwardRef)((function({filter:e,model:n,isAlwaysWip:i,handleChangeViewMode:a},o){var s,l,c;const[u,d]=(0,t.useState)(!1),[p,f]=(0,t.useState)([]),[h,g]=(0,t.useState)(!1),[m,b]=(0,t.useState)(!1),[v,y]=(0,t.useState)(""),[O,w]=(0,t.useState)(null),[S,x]=(0,t.useState)(i?"key":"value"),_=(0,Wt.useStyles2)(Zo),[P,E]=(0,t.useState)([]),[C,k]=(0,t.useState)({}),D=(0,t.useRef)(null),T=(0,t.useMemo)((()=>bs.reduce(((e,t)=>t.isMulti?[...e,t.value]:e),[])),[]).includes((null==e?void 0:e.operator)||""),R=T&&"value"===S,I=(0,t.useId)(),A=(0,t.useRef)([]),j=(0,t.useRef)([]),L=(0,t.useMemo)((()=>function(e){const t=new nn,n=[],r=1e4;return(i,a)=>{var o;if(""===i)return e.length>r?e.slice(0,r):e;if("operator"===a){const t=[];for(let n=0;n<e.length;n++)if((null==(o=e[n].label||e[n].value)?void 0:o.includes(i))&&(t.push(e[n]),t.length>r))return t;return t}if(0===n.length)for(let t=0;t<e.length;t++)n.push(e[t].label||e[t].value);const s=t.filter(n,i),l=[];if(s){for(let t=0;t<s.length;t++)if(l.push(e[s[t]]),l.length>r)return l;return l}return e.length>r?e.slice(0,r):e}}(p)),[p]),$=(0,t.useCallback)((()=>{i&&(n._addWip(),x("key"),y(""))}),[n,i]),F=(0,t.useCallback)(((e,t,n,r)=>{if(n.length){const r=[],i=[];n.forEach((e=>{var t;r.push(null!=(t=e.label)?t:e.value),i.push(e.value)})),e._updateFilter(t,{valueLabels:r,values:i,value:i[0]}),E([])}r||setTimeout((()=>{var e;return null==(e=B.domReference.current)?void 0:e.focus()}))}),[]),N=(0,t.useCallback)((e=>{E((t=>t.some((t=>t.value===e.value))?t.filter((t=>t.value!==e.value)):[...t,e]))}),[]),M=(0,t.useCallback)(((t,r,i)=>{d(t),i&&["outside-press","escape-key"].includes(i)&&(R&&F(n,e,P),$(),null==a||a())}),[e,P,a,F,$,R,n]),V=(0,t.useMemo)((()=>[I,...P.map(((e,t)=>`${e.value}-${t}`))]),[I,P]),{refs:B,floatingStyles:z,context:W,getReferenceProps:Q,getFloatingProps:U,getItemProps:q}=(({open:e,onOpenChange:n,activeIndex:r,setActiveIndex:i,outsidePressIdsToIgnore:a,listRef:o,disabledIndicesRef:s})=>{const{refs:l,floatingStyles:c,context:u}=Za({whileElementsMounted:gi,open:e,onOpenChange:n,placement:"bottom-start",middleware:[{...mi(10),options:[10,void 0]},Ei({padding:10}),Ci({apply({availableHeight:e,availableWidth:t,elements:n}){n.floating.style.maxHeight=`${Math.min(300,e)}px`,n.floating.style.maxWidth=`${t}px`},padding:10})]}),d=function(e,n){var r;void 0===n&&(n={});const{open:i,floatingId:a}=e,{enabled:o=!0,role:s="dialog"}=n,l=null!=(r=so.get(s))?r:s,c=fa(),u=null!=ma();return t.useMemo((()=>{if(!o)return{};const e={id:a,...l&&{role:l}};return"tooltip"===l||"label"===s?{reference:{["aria-"+("label"===s?"labelledby":"describedby")]:i?a:void 0},floating:e}:{reference:{"aria-expanded":i?"true":"false","aria-haspopup":"alertdialog"===l?"dialog":l,"aria-controls":i?a:void 0,..."listbox"===l&&{role:"combobox"},..."menu"===l&&{id:c},..."menu"===l&&u&&{role:"menuitem"},..."select"===s&&{"aria-autocomplete":"none"},..."combobox"===s&&{"aria-autocomplete":"list"}},floating:{...e,..."menu"===l&&{"aria-labelledby":c}},item(e){let{active:t,selected:n}=e;const r={role:"option",...t&&{id:a+"-option"}};switch(s){case"select":return{...r,"aria-selected":t&&n};case"combobox":return{...r,...t&&{"aria-selected":!0}}}return{}}}}),[o,s,l,i,a,c,u])}(u,{role:"listbox"}),p=function(e,n){void 0===n&&(n={});const{open:r,onOpenChange:i,elements:{reference:a,domReference:o,floating:s},dataRef:l}=e,{enabled:c=!0,escapeKey:u=!0,outsidePress:d=!0,outsidePressEvent:p="pointerdown",referencePress:f=!1,referencePressEvent:h="pointerdown",ancestorScroll:g=!1,bubbles:m,capture:b}=n,v=ba(),y=Hi("function"==typeof d?d:()=>!1),O="function"==typeof d?y:d,w=t.useRef(!1),S=t.useRef(!1),{escapeKey:x,outsidePress:_}=Ya(m),{escapeKey:P,outsidePress:E}=Ya(b),C=Hi((e=>{var t;if(!r||!c||!u||"Escape"!==e.key)return;const n=null==(t=l.current.floatingContext)?void 0:t.nodeId,a=v?Oa(v.nodesRef.current,n):[];if(!x&&(e.stopPropagation(),a.length>0)){let e=!0;if(a.forEach((t=>{var n;null==(n=t.context)||!n.open||t.context.dataRef.current.__escapeKeyBubbles||(e=!1)})),!e)return}i(!1,function(e){return"nativeEvent"in e}(e)?e.nativeEvent:e,"escape-key")})),k=Hi((e=>{var t;const n=()=>{var t;C(e),null==(t=Rr(e))||t.removeEventListener("keydown",n)};null==(t=Rr(e))||t.addEventListener("keydown",n)})),D=Hi((e=>{var t;const n=w.current;w.current=!1;const r=S.current;if(S.current=!1,"click"===p&&r)return;if(n)return;if("function"==typeof O&&!O(e))return;const a=Rr(e),c="["+va("inert")+"]",u=Dr(s).querySelectorAll(c);let d=lr(a)?a:null;for(;d&&!gr(d);){const e=vr(d);if(gr(e)||!lr(e))break;d=e}if(u.length&&lr(a)&&!a.matches("html,body")&&!Sr(a,s)&&Array.from(u).every((e=>!Sr(d,e))))return;if(cr(a)&&s){const t=a.clientWidth>0&&a.scrollWidth>a.clientWidth,n=a.clientHeight>0&&a.scrollHeight>a.clientHeight;let r=n&&e.offsetX>a.clientWidth;if(n&&"rtl"===mr(a).direction&&(r=e.offsetX<=a.offsetWidth-a.clientWidth),r||t&&e.offsetY>a.clientHeight)return}const f=null==(t=l.current.floatingContext)?void 0:t.nodeId,h=v&&Oa(v.nodesRef.current,f).some((t=>{var n;return Tr(e,null==(n=t.context)?void 0:n.elements.floating)}));if(Tr(e,s)||Tr(e,o)||h)return;const g=v?Oa(v.nodesRef.current,f):[];if(g.length>0){let e=!0;if(g.forEach((t=>{var n;null==(n=t.context)||!n.open||t.context.dataRef.current.__outsidePressBubbles||(e=!1)})),!e)return}i(!1,e,"outside-press")})),T=Hi((e=>{var t;const n=()=>{var t;D(e),null==(t=Rr(e))||t.removeEventListener(p,n)};null==(t=Rr(e))||t.addEventListener(p,n)}));return t.useEffect((()=>{if(!r||!c)return;function e(e){i(!1,e,"ancestor-scroll")}l.current.__escapeKeyBubbles=x,l.current.__outsidePressBubbles=_;const t=Dr(s);u&&t.addEventListener("keydown",P?k:C,P),O&&t.addEventListener(p,E?T:D,E);let n=[];return g&&(lr(o)&&(n=Or(o)),lr(s)&&(n=n.concat(Or(s))),!lr(a)&&a&&a.contextElement&&(n=n.concat(Or(a.contextElement)))),n=n.filter((e=>{var n;return e!==(null==(n=t.defaultView)?void 0:n.visualViewport)})),n.forEach((t=>{t.addEventListener("scroll",e,{passive:!0})})),()=>{u&&t.removeEventListener("keydown",P?k:C,P),O&&t.removeEventListener(p,E?T:D,E),n.forEach((t=>{t.removeEventListener("scroll",e)}))}}),[l,s,o,a,u,O,p,r,i,g,c,x,_,C,P,k,D,E,T]),t.useEffect((()=>{w.current=!1}),[O,p]),t.useMemo((()=>c?{reference:{onKeyDown:C,[Ga[h]]:e=>{f&&i(!1,e.nativeEvent,"reference-press")}},floating:{onKeyDown:C,onMouseDown(){S.current=!0},onMouseUp(){S.current=!0},[Xa[p]]:()=>{w.current=!0}}}:{}),[c,f,p,h,i,C])}(u,{outsidePress:e=>{var t;if(e.currentTarget instanceof Element){const n=e.currentTarget;let r=n.id;if("path"===n.nodeName&&(r=(null==(t=n.parentElement)?void 0:t.id)||""),a.includes(r))return!1}return!0}}),f=oo(u,{listRef:o,activeIndex:r,onNavigate:i,virtual:!0,loop:!0,disabledIndices:s.current}),{getReferenceProps:h,getFloatingProps:g,getItemProps:m}=function(e){void 0===e&&(e=[]);const n=e,r=t.useCallback((t=>eo(t,e,"reference")),n),i=t.useCallback((t=>eo(t,e,"floating")),n),a=t.useCallback((t=>eo(t,e,"item")),e.map((e=>null==e?void 0:e.item)));return t.useMemo((()=>({getReferenceProps:r,getFloatingProps:i,getItemProps:a})),[r,i,a])}([d,p,f]);return{refs:l,floatingStyles:c,context:u,getReferenceProps:h,getFloatingProps:g,getItemProps:m}})({open:u,onOpenChange:M,activeIndex:O,setActiveIndex:w,outsidePressIdsToIgnore:V,listRef:A,disabledIndicesRef:j});(0,t.useImperativeHandle)(o,(()=>()=>{var e;return null==(e=B.domReference.current)?void 0:e.focus()}),[B.domReference]);const H=(0,t.useCallback)((e=>{E((t=>t.filter((t=>t.value!==e.value)))),setTimeout((()=>{var e;return null==(e=B.domReference.current)?void 0:e.focus()}))}),[B.domReference]),G=(e=>e.flatMap((e=>e.options?[e,...e.options]:[e])))(Ks(L(v,S)));"operator"!==S&&v&&G.push({value:v.trim(),label:v.trim(),isCustom:!0});const X=((e,t,n)=>{var r,i,a,o;let s=182;const l=[],c=[];for(let t=0;t<e.length;t++){l.push(null),(null==(r=e[t])?void 0:r.options)&&c.push(t);let n=null!=(a=null!=(i=e[t].label)?i:e[t].value)?a:"",u=8;8*n.length<6*((null==(o=e[t].description)?void 0:o.length)||0)&&(n=e[t].description,u=6);const d=(e[t].isCustom?n.length+18:n.length)*u+16;d>s&&(s=d)}return t.current=[...l],n.current=[...c],s})(G,A,j),Y=(0,t.useCallback)((async t=>{var r;b(!1),g(!0),f([]);let i=[];try{"key"===t?i=await n._getKeys(null):"operator"===t?i=n._getOperators():"value"===t&&(i=await n._getValuesFor(e)),f(i),(null==(r=i[0])?void 0:r.group)&&w(1)}catch(e){b(!0)}g(!1)}),[e,n]),Z=function(e){return function(e){const n=t.useReducer((()=>({})),{})[1],r={...e,onChange:(t,r)=>{var i;r?(0,yi.flushSync)(n):n(),null==(i=e.onChange)||i.call(e,t,r)}},[i]=t.useState((()=>new Oo(r)));return i.setOptions(r),t.useEffect((()=>i._didMount()),[]),So((()=>i._willUpdate())),i}({observeElementRect:ho,observeElementOffset:bo,scrollToFn:yo,...e})}({count:G.length,getScrollElement:()=>B.floating.current,estimateSize:e=>G[e].description?60:38,overscan:5}),K=(0,t.useCallback)(((e,t)=>{"Backspace"!==e.key||v||(t?E((e=>{const t=[...e];return t.splice(-1,1),t})):"key"===S&&(n._removeLastFilter(),Y(S)))}),[v,S,n,Y]),J=(0,t.useCallback)(((t,r)=>{var i;"Tab"!==t.key||t.shiftKey||(r&&(t.preventDefault(),F(n,e,P),null==(i=B.domReference.current)||i.focus()),null==a||a(),$())}),[e,P,a,F,$,n,B.domReference]),ee=(0,t.useCallback)(((t,r)=>{"Tab"===t.key&&t.shiftKey&&(r&&(t.preventDefault(),F(n,e,P,!0)),null==a||a(),$())}),[e,P,a,F,$,n]),te=(0,t.useCallback)(((t,r)=>{if("Enter"===t.key&&null!=O){if(!G[O])return;const t=G[O];r?N(t):(n._updateFilter(e,Fo(S,t)),Lo(S,x,a,B.domReference.current),w(0)),y("")}}),[O,e,S,G,N,a,n,B.domReference]);(0,t.useEffect)((()=>{u&&Y(S)}),[u,S]),(0,t.useEffect)((()=>{var t,n;if(!i){if(x("value"),y(""),T&&(null==(t=null==e?void 0:e.values)?void 0:t.length)){const t=e.values.reduce(((t,n,r)=>{var i;return[...t,{label:(null==(i=e.valueLabels)?void 0:i[r])||n,value:n}]}),[]);E(t)}null==(n=B.domReference.current)||n.focus()}}),[]),(0,t.useEffect)((()=>{R&&P&&setTimeout((()=>k({})))}),[P,R]),(0,t.useLayoutEffect)((()=>{var e,t;null!==O&&Z.range&&(O>(null==(e=Z.range)?void 0:e.endIndex)||O<(null==(t=Z.range)?void 0:t.startIndex))&&Z.scrollToIndex(O)}),[O,Z]);const ne=null!=(s=null==e?void 0:e.keyLabel)?s:null==e?void 0:e.key;return r().createElement("div",{className:_.comboboxWrapper},e?r().createElement("div",{className:_.pillWrapper},(null==e?void 0:e.key)?r().createElement("div",{className:(0,Ht.cx)(_.basePill,_.keyPill)},ne):null,(null==e?void 0:e.key)&&(null==e?void 0:e.operator)&&"operator"!==S?r().createElement("div",{id:I,className:(0,Ht.cx)(_.basePill,_.operatorPill,I),role:"button","aria-label":"Edit filter operator",tabIndex:0,onClick:e=>{e.stopPropagation(),$o("operator",x,void 0,B.domReference.current)},onKeyDown:e=>{ee(e,T),"Enter"===e.key&&$o("operator",x,void 0,B.domReference.current)}},e.operator):null,r().createElement("div",{ref:D}),R?P.map(((e,t)=>r().createElement(Yo,{key:`${e.value}-${t}`,item:e,index:t,handleRemoveMultiValue:H}))):null):null,r().createElement("input",Go(Ho({},Q({ref:B.setReference,onChange:function(e){const t=e.target.value;y(t),w(0)},value:v,placeholder:Mo(e,S,R,i),"aria-autocomplete":"list",onKeyDown(e){u?("operator"===S&&ee(e),K(e,R),J(e,R),te(e,R)):d(!0)}})),{className:(0,Ht.cx)(_.inputStyle,{[_.loadingInputPadding]:!h}),onClick:e=>{e.stopPropagation(),d(!0)},onFocus:()=>{w(0),d(!0)}})),h?r().createElement(Wt.Spinner,{className:_.loadingIndicator,inline:!0}):null,r().createElement(Va,null,u&&r().createElement(Ha,{context:W,initialFocus:-1,visuallyHiddenDismiss:!0,modal:!1},r().createElement(r().Fragment,null,r().createElement("div",{style:Go(Ho({},z),{width:`${m?366:X}px`,transform:R?`translate(${(null==(l=D.current)?void 0:l.getBoundingClientRect().left)||0}px, ${((null==(c=B.domReference.current)?void 0:c.getBoundingClientRect().bottom)||0)+10}px )`:z.transform}),ref:B.setFloating,className:_.dropdownWrapper,tabIndex:-1},r().createElement("div",Go(Ho({style:{height:`${Z.getTotalSize()||38}px`}},U()),{tabIndex:-1}),h?r().createElement(To,null):m?r().createElement(Io,{handleFetchOptions:()=>Y(S)}):G.length||"operator"!==S&&v?Z.getVirtualItems().map((t=>{var i;const o=G[t.index],s=t.index;if(o.options)return r().createElement("div",{key:`${o.label}+${s}`,className:(0,Ht.cx)(_.optionGroupLabel,_.groupTopBorder),style:{height:`${t.size}px`,transform:`translateY(${t.start}px)`}},r().createElement(Wt.Text,{weight:"bold",variant:"bodySmall",color:"secondary"},o.label));const l=G[t.index+1],c=l&&!l.group&&!l.options&&o.group;return r().createElement(ko,Go(Ho({},q({key:`${o.value}-${s}`,ref(e){A.current[s]=e},onClick(t){var r;"value"!==S&&t.stopPropagation(),R?(t.preventDefault(),t.stopPropagation(),N(o),null==(r=B.domReference.current)||r.focus()):(n._updateFilter(e,Fo(S,o)),y(""),Lo(S,x,a,B.domReference.current))}})),{active:O===s,addGroupBottomBorder:c,style:{height:`${t.size}px`,transform:`translateY(${t.start}px)`},"aria-setsize":G.length,"aria-posinset":t.index+1,isMultiValueEdit:R,checked:P.some((e=>e.value===o.value))}),r().createElement("span",null,o.isCustom?"Use custom value: ":""," ",null!=(i=o.label)?i:o.value),o.description?r().createElement("div",{className:_.descriptionText},o.description):null)})):r().createElement(Ro,null))),R&&!h&&!m&&G.length?r().createElement(Ao,{onApply:()=>{F(n,e,P)},floatingElement:B.floating.current,maxOptionWidth:X}):null))))})),Yo=({item:e,handleRemoveMultiValue:t,index:n})=>{var i,a;const o=(0,Wt.useStyles2)(Zo);return r().createElement("div",{className:(0,Ht.cx)(o.basePill,o.valuePill)},r().createElement("span",null," ",null!=(i=e.label)?i:e.value),r().createElement(Wt.Button,{onClick:n=>{n.stopPropagation(),n.preventDefault(),t(e)},onKeyDownCapture:n=>{"Enter"===n.key&&(n.preventDefault(),n.stopPropagation(),t(e))},fill:"text",size:"sm",variant:"secondary",className:o.removeButton,tooltip:`Remove filter value - ${null!=(a=e.label)?a:e.value}`},r().createElement(Wt.Icon,{name:"times",size:"md",id:`${e.value}-${n}`})))},Zo=e=>({comboboxWrapper:(0,Ht.css)({display:"flex",flexWrap:"wrap"}),pillWrapper:(0,Ht.css)({display:"flex",alignItems:"center",flexWrap:"wrap"}),basePill:(0,Ht.css)(Go(Ho({display:"flex",alignItems:"center",background:e.colors.action.disabledBackground,border:`1px solid ${e.colors.border.weak}`,padding:e.spacing(.125,1,.125,1),color:e.colors.text.primary,overflow:"hidden",whiteSpace:"nowrap",minHeight:e.spacing(2.75)},e.typography.bodySmall),{cursor:"pointer"})),keyPill:(0,Ht.css)({fontWeight:e.typography.fontWeightBold,cursor:"default"}),operatorPill:(0,Ht.css)({"&:hover":{background:e.colors.action.hover}}),valuePill:(0,Ht.css)({background:e.colors.action.selected,padding:e.spacing(.125,0,.125,1)}),dropdownWrapper:(0,Ht.css)({backgroundColor:e.colors.background.primary,color:e.colors.text.primary,boxShadow:e.shadows.z2,overflowY:"auto",zIndex:e.zIndex.dropdown}),inputStyle:(0,Ht.css)({paddingBlock:0,"&:focus":{outline:"none"}}),loadingIndicator:(0,Ht.css)({color:e.colors.text.secondary,marginLeft:e.spacing(.5)}),loadingInputPadding:(0,Ht.css)({paddingRight:e.spacing(2.5)}),optionGroupLabel:(0,Ht.css)({padding:e.spacing(1),position:"absolute",top:0,left:0,width:"100%"}),groupTopBorder:(0,Ht.css)({"&:not(:first-child)":{borderTop:`1px solid ${e.colors.border.weak}`}}),removeButton:(0,Ht.css)({marginInline:e.spacing(.5),height:"100%",padding:0,cursor:"pointer","&:hover":{color:e.colors.text.primary}}),descriptionText:(0,Ht.css)(Go(Ho({},e.typography.bodySmall),{color:e.colors.text.secondary,paddingTop:e.spacing(.5)})),multiValueApply:(0,Ht.css)({position:"absolute",top:0,left:0,display:"flex"})});var Ko=Object.defineProperty,Jo=Object.defineProperties,es=Object.getOwnPropertyDescriptors,ts=Object.getOwnPropertySymbols,ns=Object.prototype.hasOwnProperty,rs=Object.prototype.propertyIsEnumerable,is=(e,t,n)=>t in e?Ko(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,as=(e,t)=>{for(var n in t||(t={}))ns.call(t,n)&&is(e,n,t[n]);if(ts)for(var n of ts(t))rs.call(t,n)&&is(e,n,t[n]);return e};function os({filter:e,model:n,readOnly:i,focusOnInputRef:a}){var o,s,l;const c=(0,Wt.useStyles2)(ss),[u,d]=(0,t.useState)(!0),[p,f]=(0,t.useState)(!1),h=(0,t.useRef)(null),g=null!=(o=e.keyLabel)?o:e.key,m=(null==(s=e.valueLabels)?void 0:s.join(", "))||(null==(l=e.values)?void 0:l.join(", "))||e.value,b=(0,t.useCallback)((e=>{null==e||e.stopPropagation(),i||(f(!u),d(!u))}),[i,u]);if((0,t.useEffect)((()=>{var e;p&&(null==(e=h.current)||e.focus(),f(!1))}),[p]),u){const t=r().createElement("span",{className:c.pillText},g," ",e.operator," ",m);return r().createElement("div",{className:(0,Ht.cx)(c.combinedFilterPill,{[c.readOnlyCombinedFilter]:i}),onClick:b,onKeyDown:e=>{"Enter"===e.key&&b()},role:"button","aria-label":`Edit filter with key ${g}`,tabIndex:0,ref:h},m.length<20?t:r().createElement(Wt.Tooltip,{content:r().createElement("div",{className:c.tooltipText},m),placement:"top"},t),i?null:r().createElement(Wt.IconButton,{onClick:t=>{t.stopPropagation(),n._removeFilter(e),setTimeout((()=>null==a?void 0:a()))},onKeyDownCapture:t=>{"Enter"===t.key&&(t.preventDefault(),t.stopPropagation(),n._removeFilter(e),setTimeout((()=>null==a?void 0:a())))},name:"times",size:"md",className:c.removeButton,tooltip:`Remove filter with key ${g}`}))}return r().createElement(Xo,{filter:e,model:n,handleChangeViewMode:b})}const ss=e=>{return{combinedFilterPill:(0,Ht.css)((t=as({display:"flex",alignItems:"center",background:e.colors.action.selected,borderRadius:e.shape.radius.default,border:`1px solid ${e.colors.border.weak}`,padding:e.spacing(.125,0,.125,1),color:e.colors.text.primary,overflow:"hidden",whiteSpace:"nowrap",minHeight:e.spacing(2.75)},e.typography.bodySmall),n={fontWeight:e.typography.fontWeightBold,cursor:"pointer","&:hover":{background:e.colors.action.hover}},Jo(t,es(n)))),readOnlyCombinedFilter:(0,Ht.css)({paddingRight:e.spacing(1),cursor:"text","&:hover":{background:e.colors.action.selected}}),removeButton:(0,Ht.css)({marginInline:e.spacing(.5),cursor:"pointer","&:hover":{color:e.colors.text.primary}}),pillText:(0,Ht.css)({maxWidth:"200px",width:"100%",textOverflow:"ellipsis",overflow:"hidden"}),tooltipText:(0,Ht.css)({textAlign:"center"})};var t,n},ls=(0,t.forwardRef)((function({model:e},n){const{_wip:i}=e.useState();return(0,t.useLayoutEffect)((()=>{i||e._addWip()}),[i]),r().createElement(Xo,{model:e,filter:i,isAlwaysWip:!0,ref:n})})),cs=(0,t.memo)((function({model:e}){const{filters:n,readOnly:i}=e.useState(),a=(0,Wt.useStyles2)(us),o=(0,t.useRef)();return r().createElement("div",{className:(0,Ht.cx)(a.comboboxWrapper,{[a.comboboxFocusOutline]:!i}),onClick:()=>{var e;null==(e=o.current)||e.call(o)}},r().createElement(Wt.Icon,{name:"filter",className:a.filterIcon,size:"lg"}),n.map(((t,n)=>r().createElement(os,{key:n,filter:t,model:e,readOnly:i,focusOnInputRef:o.current}))),i?null:r().createElement(ls,{model:e,ref:o}))})),us=e=>({comboboxWrapper:(0,Ht.css)({display:"flex",flexWrap:"wrap",alignItems:"center",columnGap:e.spacing(1),rowGap:e.spacing(.5),minHeight:e.spacing(4),backgroundColor:e.components.input.background,border:`1px solid ${e.colors.border.strong}`,borderRadius:e.shape.radius.default,paddingInline:e.spacing(1),paddingBlock:e.spacing(.5),flexGrow:1}),comboboxFocusOutline:(0,Ht.css)({"&:focus-within":{outline:"2px dotted transparent",outlineOffset:"2px",boxShadow:`0 0 0 2px ${e.colors.background.canvas}, 0 0 0px 4px ${e.colors.primary.main}`,transitionTimingFunction:"cubic-bezier(0.19, 1, 0.22, 1)",transitionDuration:"0.2s",transitionProperty:"outline, outline-offset, box-shadow",zIndex:2}}),filterIcon:(0,Ht.css)({color:e.colors.text.secondary,alignSelf:"center"})});var ds=Object.defineProperty,ps=Object.getOwnPropertySymbols,fs=Object.prototype.hasOwnProperty,hs=Object.prototype.propertyIsEnumerable,gs=(e,t,n)=>t in e?ds(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ms=(e,t)=>{for(var n in t||(t={}))fs.call(t,n)&&gs(e,n,t[n]);if(ps)for(var n of ps(t))hs.call(t,n)&&gs(e,n,t[n]);return e};const bs=[{value:"=",description:"Equals"},{value:"!=",description:"Not equal"},{value:"=|",description:"One of. Use to filter on multiple values.",isMulti:!0},{value:"!=|",description:"Not one of. Use to exclude multiple values.",isMulti:!0},{value:"=~",description:"Matches regex"},{value:"!~",description:"Does not match regex"},{value:"<",description:"Less than"},{value:">",description:"Greater than"}];class vs extends Q{constructor(e){var t,n;super(ms({type:"adhoc",name:null!=(t=e.name)?t:"Filters",filters:[],datasource:null,applyMode:"auto",filterExpression:null!=(n=e.filterExpression)?n:ys(e.expressionBuilder,e.filters)},e)),this._scopedVars={__sceneObject:Dn(this)},this._dataSourceSrv=(0,a.getDataSourceSrv)(),this._urlSync=new tr(this),"auto"===this.state.applyMode&&function(e){if(e.addActivationHandler((()=>($t.add(e),()=>$t.delete(e)))),Lt)return;const t=(0,a.getTemplateSrv)();(null==t?void 0:t.getAdhocFilters)?(Lt=t.getAdhocFilters,t.getAdhocFilters=function(e){var n;if(0===$t.size)return Lt.call(t);const r=(0,a.getDataSourceSrv)().getInstanceSettings(e);if(!r)return[];for(const e of $t.values())if((null==(n=e.state.datasource)?void 0:n.uid)===r.uid)return e.state.filters;return[]}.bind(t)):console.log("Failed to patch getAdhocFilters")}(this)}setState(e){let t=!1;e.filters&&e.filters!==this.state.filters&&!e.filterExpression&&(e.filterExpression=ys(this.state.expressionBuilder,e.filters),t=e.filterExpression!==this.state.filterExpression),super.setState(e),t&&this.publishEvent(new Re(this),!0)}getValue(){return this.state.filterExpression}_updateFilter(e,t){const{filters:n,_wip:r}=this.state;if(e===r)return void("value"in t&&""!==t.value?this.setState({filters:[...n,ms(ms({},r),t)],_wip:void 0}):this.setState({_wip:ms(ms({},e),t)}));const i=this.state.filters.map((n=>n===e?ms(ms({},n),t):n));this.setState({filters:i})}_removeFilter(e){e!==this.state._wip?this.setState({filters:this.state.filters.filter((t=>t!==e))}):this.setState({_wip:void 0})}_removeLastFilter(){const e=this.state.filters.at(-1);e&&this._removeFilter(e)}async _getKeys(e){var t,n,r;const i=await(null==(n=(t=this.state).getTagKeysProvider)?void 0:n.call(t,this,e));if(i&&i.replace)return Ys(i.values).map(ws);if(this.state.defaultKeys)return this.state.defaultKeys.map(ws);const a=await this._dataSourceSrv.get(this.state.datasource,this._scopedVars);if(!a||!a.getTagKeys)return[];const o=this.state.filters.filter((t=>t.key!==e)).concat(null!=(r=this.state.baseFilters)?r:[]),s=kl.getTimeRange(this).state.value,l=this.state.useQueriesAsFilterForOptions?Us(this):void 0,c=await a.getTagKeys(ms({filters:o,queries:l,timeRange:s},Pn(this)));Zs(c)&&this.setState({error:c.error.message});let u=Ys(c);i&&(u=u.concat(Ys(i.values)));const d=this.state.tagKeyRegexFilter;return d&&(u=u.filter((e=>e.text.match(d)))),u.map(ws)}async _getValuesFor(e){var t,n,r;const i=await(null==(n=(t=this.state).getTagValuesProvider)?void 0:n.call(t,this,e));if(i&&i.replace)return Ys(i.values).map(ws);const a=await this._dataSourceSrv.get(this.state.datasource,this._scopedVars);if(!a||!a.getTagValues)return[];const o=this.state.filters.filter((t=>t.key!==e.key)).concat(null!=(r=this.state.baseFilters)?r:[]),s=kl.getTimeRange(this).state.value,l=this.state.useQueriesAsFilterForOptions?Us(this):void 0,c=await a.getTagValues(ms({key:e.key,filters:o,timeRange:s,queries:l},Pn(this)));Zs(c)&&this.setState({error:c.error.message});let u=Ys(c);return i&&(u=u.concat(Ys(i.values))),u.map(ws)}_addWip(){this.setState({_wip:{key:"",value:"",operator:"=",condition:""}})}_getOperators(){return(this.state.supportsMultiValueOperators?bs:bs.filter((e=>!e.isMulti))).map((({value:e,description:t})=>({label:e,value:e,description:t})))}}function ys(e,t){return(null!=e?e:Bs)(null!=t?t:[])}vs.Component=function({model:e}){const{filters:t,readOnly:n,addFilterButtonText:i}=e.useState(),a=(0,Wt.useStyles2)(Os);return"combobox"===e.state.layout?r().createElement(cs,{model:e}):r().createElement("div",{className:a.wrapper},t.map(((t,n)=>r().createElement(r().Fragment,{key:n},r().createElement(Kn,{filter:t,model:e})))),!n&&r().createElement(er,{model:e,key:"'builder",addFilterButtonText:i}))};const Os=e=>({wrapper:(0,Ht.css)({display:"flex",flexWrap:"wrap",alignItems:"flex-end",columnGap:e.spacing(2),rowGap:e.spacing(1)})});function ws(e){const{text:t,value:n}=e,r={label:t,value:String(null!=n?n:t)};return"group"in e&&(r.group=e.group),r}function Ss(e){return""!==e.key&&""!==e.operator&&""!==e.value}function xs(e){const t=bs.find((t=>t.value===e));return!!t&&Boolean(t.isMulti)}class _s{constructor(){this._resultsMap=new Map,this._prevLayers=[]}getMergedStream(e){(function(e,t){if(e.length!==t.length)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!0;return!1})(e,this._prevLayers)&&(this._resultsMap=new Map,this._prevLayers=e);const t=e.map((e=>e.getResultsStream())),n=[];for(const t of e)n.push(t.activate());return(0,b.merge)(t).pipe((0,b.mergeAll)(),(0,b.filter)((e=>this._resultsMap.get(e.origin.state.key)!==e)),(0,b.map)((e=>(this._resultsMap.set(e.origin.state.key,e),this._resultsMap.values()))),(0,b.finalize)((()=>{n.forEach((e=>e()))})))}}var Ps=Object.defineProperty,Es=Object.defineProperties,Cs=Object.getOwnPropertyDescriptors,ks=Object.getOwnPropertySymbols,Ds=Object.prototype.hasOwnProperty,Ts=Object.prototype.propertyIsEnumerable,Rs=(e,t,n)=>t in e?Ps(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Is=(e,t)=>{for(var n in t||(t={}))Ds.call(t,n)&&Rs(e,n,t[n]);if(ks)for(var n of ks(t))Ts.call(t,n)&&Rs(e,n,t[n]);return e},As=(e,t)=>Es(e,Cs(t));let js=100;function Ls(){return"SQR"+js++}class $s extends Q{constructor(t){super(t),this._dataLayersMerger=new _s,this._variableValueRecorder=new gt,this._results=new b.ReplaySubject(1),this._scopedVars={__sceneObject:Dn(this)},this._variableDependency=new Js(this,{statePaths:["queries","datasource"],onVariableUpdateCompleted:this.onVariableUpdatesCompleted.bind(this),onAnyVariableChanged:this.onAnyVariableChanged.bind(this)}),this.onDataReceived=t=>{const n=(0,e.preProcessPanelData)(t,this.state.data);this._resultAnnotations=t.annotations;const r=this._combineDataLayers(n);let i=this.state._hasFetchedData;i||n.state===ce.Loading||(i=!0),this.setState({data:r,_hasFetchedData:i}),this._results.next({origin:this,data:r})},this.addActivationHandler((()=>this._onActivate()))}getResultsStream(){return this._results}_onActivate(){if(this.isQueryModeAuto()){const e=kl.getTimeRange(this),t=this.getClosestExtraQueryProviders();for(const e of t)this._subs.add(e.subscribeToState(((t,n)=>{e.shouldRerun(n,t,this.state.queries)&&this.runQueries()})));this.subscribeToTimeRangeChanges(e),this.shouldRunQueriesOnActivate()&&this.runQueries()}return this._dataLayersSub||this._handleDataLayers(),()=>this._onDeactivate()}_handleDataLayers(){const e=kl.getDataLayers(this);0!==e.length&&(this._dataLayersSub=this._dataLayersMerger.getMergedStream(e).subscribe(this._onLayersReceived.bind(this)))}_onLayersReceived(t){var n,r,i,a,o;const s=kl.getTimeRange(this),{dataLayerFilter:l}=this.state;let c,u=[],d=[];for(const i of t)for(let t of i.data.series)(null==(n=t.meta)?void 0:n.dataTopic)===e.DataTopic.Annotations&&(u=u.concat(t)),(null==(r=t.meta)?void 0:r.dataTopic)===e.DataTopic.AlertStates&&(d=d.concat(t));if((null==l?void 0:l.panelId)&&(u.length>0&&(u=function(e,t){var n;if(!Array.isArray(e)||0===e.length)return e;const r=Array.from({length:e.length},(()=>new Set));let i=0;for(const a of e){for(let e=0;e<a.length;e++){if(r[i].has(e))continue;let o=!0;const s=a.fields.find((e=>"panelId"===e.name)),l=a.fields.find((e=>"source"===e.name));if(l){s&&"dashboard"===l.values[e].type&&(o=s.values[e]===t.panelId);const r=l.values[e].filter;if(r){const e=(null!=(n=r.ids)?n:[]).includes(t.panelId);r.exclude?e&&(o=!1):e||(o=!1)}}o&&r[i].add(e)}i++}const a=[];i=0;for(const t of e){const e=r[i].size,n=[];for(const e of t.fields){const a=[];for(let n=0;n<t.length;n++)r[i].has(n)&&a.push(e.values[n]);n.push(At(It({},e),{values:a}))}a.push(At(It({},t),{fields:n,length:e})),i++}return a}(u,l)),d.length>0))for(const t of d){const n=new e.DataFrameView(t);for(const e of n)if(e.panelId===l.panelId){c=e;break}}if(Ns(u)&&Ns(this._layerAnnotations)&&(0,re.isEqual)(c,null==(i=this.state.data)?void 0:i.alertState))return;this._layerAnnotations=u;const p=this.state.data?this.state.data:As(Is({},me),{timeRange:s.state.value});this.setState({data:As(Is({},p),{annotations:[...null!=(a=this._resultAnnotations)?a:[],...u],alertState:null!=c?c:null==(o=this.state.data)?void 0:o.alertState})})}onVariableUpdatesCompleted(){this.isQueryModeAuto()&&this.runQueries()}onAnyVariableChanged(e){this._adhocFiltersVar!==e&&this._groupByVar!==e&&this.isQueryModeAuto()&&(e instanceof vs&&this._isRelevantAutoVariable(e)&&this.runQueries(),e instanceof Nn&&this._isRelevantAutoVariable(e)&&this.runQueries())}_isRelevantAutoVariable(e){var t,n;const r=null!=(t=this.state.datasource)?t:Fs(this.state.queries);return"auto"===e.state.applyMode&&(null==r?void 0:r.uid)===(null==(n=e.state.datasource)?void 0:n.uid)}shouldRunQueriesOnActivate(){return this._variableValueRecorder.hasDependenciesChanged(this)?(ft("SceneQueryRunner","Variable dependency changed while inactive, shouldRunQueriesOnActivate returns true"),!0):!this.state.data||!!this._isDataTimeRangeStale(this.state.data)}_isDataTimeRangeStale(e){const t=kl.getTimeRange(this).state.value,n=e.timeRange;return(t.from.unix()!==n.from.unix()||t.to.unix()!==n.to.unix())&&(ft("SceneQueryRunner","Data time range is stale"),!0)}_onDeactivate(){var e;this._querySub&&(this._querySub.unsubscribe(),this._querySub=void 0),this._dataLayersSub&&(this._dataLayersSub.unsubscribe(),this._dataLayersSub=void 0),null==(e=this._timeSub)||e.unsubscribe(),this._timeSub=void 0,this._timeSubRange=void 0,this._adhocFiltersVar=void 0,this._groupByVar=void 0,this._variableValueRecorder.recordCurrentDependencyValuesForSceneObject(this)}setContainerWidth(e){!this._containerWidth&&e>0?(this._containerWidth=e,this.state.maxDataPointsFromWidth&&!this.state.maxDataPoints&&setTimeout((()=>{this.isActive&&!this.state._hasFetchedData&&this.runQueries()}),0)):e>0&&(this._containerWidth=e)}isDataReadyToDisplay(){return Boolean(this.state._hasFetchedData)}subscribeToTimeRangeChanges(e){this._timeSubRange!==e&&(this._timeSub&&this._timeSub.unsubscribe(),this._timeSubRange=e,this._timeSub=e.subscribeToState((()=>{this.runWithTimeRange(e)})))}runQueries(){const e=kl.getTimeRange(this);this.isQueryModeAuto()&&this.subscribeToTimeRangeChanges(e),this.runWithTimeRange(e)}getMaxDataPoints(){var e;return this.state.maxDataPoints?this.state.maxDataPoints:this.state.maxDataPointsFromWidth&&null!=(e=this._containerWidth)?e:500}cancelQuery(){var e;null==(e=this._querySub)||e.unsubscribe(),this._dataLayersSub&&(this._dataLayersSub.unsubscribe(),this._dataLayersSub=void 0),this.setState({data:As(Is({},this.state.data),{state:ce.Done})})}async runWithTimeRange(e){var t,n,r;if(!this.state.maxDataPoints&&this.state.maxDataPointsFromWidth&&!this._containerWidth)return;if(this._dataLayersSub||this._handleDataLayers(),null==(t=this._querySub)||t.unsubscribe(),this._variableDependency.hasDependencyInLoadingState())return ft("SceneQueryRunner","Variable dependency is in loading state, skipping query execution"),void this.setState({data:As(Is({},null!=(n=this.state.data)?n:me),{state:ce.Loading})});const{queries:i}=this.state;if(null==i?void 0:i.length)try{const t=null!=(r=this.state.datasource)?r:Fs(i),n=await ht(t,this._scopedVars);this.findAndSubscribeToAdHocFilters(null==t?void 0:t.uid);const o=(0,a.getRunRequest)(),{primary:s,secondaries:l,processors:c}=this.prepareRequests(e,n);ft("SceneQueryRunner","Starting runRequest",this.state.key);let u=o(n,s);if(l.length>0){const e=l.map((e=>o(n,e))),t=(e=>t=>t.pipe((0,b.mergeMap)((([t,...n])=>{const r=n.flatMap((n=>{var r,i;return null!=(i=null==(r=e.get(n.request.requestId))?void 0:r(t,n))?i:(0,b.of)(n)}));return(0,b.forkJoin)([(0,b.of)(t),...r])})),(0,b.map)((([e,...t])=>{var n,r,i;return r=((e,t)=>{for(var n in t||(t={}))wt.call(t,n)&&xt(e,n,t[n]);if(Ot)for(var n of Ot(t))St.call(t,n)&&xt(e,n,t[n]);return e})({},e),i={series:[...e.series,...t.flatMap((e=>e.series))],annotations:[...null!=(n=e.annotations)?n:[],...t.flatMap((e=>{var t;return null!=(t=e.annotations)?t:[]}))]},vt(r,yt(i))}))))(c);u=(0,b.forkJoin)([u,...e]).pipe(t)}u=u.pipe(Ft({type:"data",request:s,origin:this,cancel:()=>this.cancelQuery()})),this._querySub=u.subscribe(this.onDataReceived)}catch(e){console.error("PanelQueryRunner Error",e),this.onDataReceived(As(Is(Is({},me),this.state.data),{state:ce.Error,errors:[(0,a.toDataQueryError)(e)]}))}else this._setNoDataState()}clone(e){var t;const n=super.clone(e);return this._resultAnnotations&&(n._resultAnnotations=this._resultAnnotations.map((e=>Is({},e)))),this._layerAnnotations&&(n._layerAnnotations=this._layerAnnotations.map((e=>Is({},e)))),n._variableValueRecorder=this._variableValueRecorder.cloneAndRecordCurrentValuesForSceneObject(this),n._containerWidth=this._containerWidth,n._results.next({origin:this,data:null!=(t=this.state.data)?t:me}),n}prepareRequests(t,n){var r;const{minInterval:i,queries:o}=this.state;let s=Is({app:"scenes",requestId:Ls(),timezone:t.getTimeZone(),range:t.state.value,interval:"1s",intervalMs:1e3,targets:(0,re.cloneDeep)(o),maxDataPoints:this.getMaxDataPoints(),scopedVars:this._scopedVars,startTime:Date.now(),liveStreaming:this.state.liveStreaming,rangeRaw:{from:t.state.from,to:t.state.to},cacheTimeout:this.state.cacheTimeout,queryCachingTTL:this.state.queryCachingTTL},jt(this));this._adhocFiltersVar&&(s.filters=this._adhocFiltersVar.state.filters.filter(Ss)),this._groupByVar&&(s.groupByKeys=this._groupByVar.state.value),s.targets=s.targets.map((e=>{var t;return e.datasource&&(e.datasource.uid===n.uid||(null==(t=n.meta)?void 0:t.mixed)||!a.isExpressionReference||(0,a.isExpressionReference)(e.datasource))||(e.datasource=n.getRef()),e}));const l=i?_l(this,i):n.interval,c=e.rangeUtil.calculateInterval(t.state.value,s.maxDataPoints,l);s.scopedVars=Object.assign({},s.scopedVars,{__interval:{text:c.interval,value:c.interval},__interval_ms:{text:c.intervalMs.toString(),value:c.intervalMs}}),s.interval=c.interval,s.intervalMs=c.intervalMs;const u=t.state.value;let d=[],p=new Map;for(const e of null!=(r=this.getClosestExtraQueryProviders())?r:[])for(const{req:t,processor:n}of e.getExtraQueries(s)){const e=Ls();d.push(As(Is({},t),{requestId:e})),p.set(e,null!=n?n:_t)}return s.range=u,{primary:s,secondaries:d,processors:p}}_combineDataLayers(e){return this._layerAnnotations&&this._layerAnnotations.length>0&&(e.annotations=(e.annotations||[]).concat(this._layerAnnotations)),this.state.data&&this.state.data.alertState&&(e.alertState=this.state.data.alertState),e}_setNoDataState(){this.state.data!==me&&this.setState({data:me})}getClosestExtraQueryProviders(){const e=new Map;return this.parent?(ee(this.parent,(t=>(mt(t)&&!e.has(t.constructor)&&e.set(t.constructor,t),t.forEachChild((t=>{mt(t)&&!e.has(t.constructor)&&e.set(t.constructor,t)})),null))),Array.from(e.values())):[]}findAndSubscribeToAdHocFilters(e){const t=function(e){var t;for(const n of $t.values())if((null==(t=n.state.datasource)?void 0:t.uid)===e)return n}(e);this._adhocFiltersVar!==t&&(this._adhocFiltersVar=t,this._updateExplicitVariableDependencies());const n=function(e){var t;for(const n of Nt.values())if((null==(t=n.state.datasource)?void 0:t.uid)===e)return n}(e);this._groupByVar!==n&&(this._groupByVar=n,this._updateExplicitVariableDependencies())}_updateExplicitVariableDependencies(){const e=[];this._adhocFiltersVar&&e.push(this._adhocFiltersVar.state.name),this._groupByVar&&e.push(this._groupByVar.state.name),this._variableDependency.setVariableNames(e)}isQueryModeAuto(){var e;return"auto"===(null!=(e=this.state.runQueriesMode)?e:"auto")}}function Fs(e){var t,n;return null!=(n=null==(t=e.find((e=>null!==e.datasource)))?void 0:t.datasource)?n:void 0}function Ns(e){if(!e)return!0;for(let t=0;t<e.length;t++)if(e[t].length>0)return!1;return!0}function Ms(e,t){return e===t||(0,re.isEqual)(e,t)}function Vs(e){try{return JSON.stringify(e,(()=>{const e=new WeakSet;return(t,n)=>{if("object"==typeof n&&null!==n){if(e.has(n))return;e.add(n)}return n}})())}catch(e){console.error(e)}return""}function Bs(e){return e.map((e=>function(e){var t,n;let r="",i=e.operator;return"=|"===i?(i="=~",r=null==(t=e.values)?void 0:t.map(Ws).join("|")):"!=|"===i?(i="!~",r=null==(n=e.values)?void 0:n.map(Ws).join("|")):r="=~"===i||"!~"===i?Ws(e.value):zs(e.value),`${e.key}${i}"${r}"`}(e))).join(",")}function zs(e){return e.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/"/g,'\\"')}function Ws(e){return zs(e.replace(Qs,"\\$&"))}const Qs=/[*+?()|\\.\[\]{}^$]/g;function Us(e){const t=function(e){const t={};for(const n of e)n.state.key&&(n.state.key in t||(t[n.state.key]=[]),t[n.state.key].push(n));return Object.values(t).flatMap((e=>{const t=e.filter((e=>e.isActive));return 0===t.length&&1===e.length?e:t}))}(kl.findAllObjects(e.getRoot(),(e=>e instanceof $s))).filter((t=>{var n,r;return(null==(n=t.state.datasource)?void 0:n.uid)===(null==(r=e.state.datasource)?void 0:r.uid)}));if(0===t.length)return[];const n=[];return t.forEach((e=>{n.push(...e.state.queries)})),n}function qs(e){return null==e?"":/\|/g[Symbol.replace](e,"__gfp__")}function Hs(e){return null==e?"":/,/g[Symbol.replace](e,"__gfc__")}function Gs(e){return null==e?"":(e=/__gfp__/g[Symbol.replace](e,"|"),e=/__gfc__/g[Symbol.replace](e,","))}function Xs(e,t){return t&&e!==t?[e,t].map(Hs).join(","):Hs(e)}function Ys(e){return Array.isArray(e)?e:e.data}function Zs(e){return!Array.isArray(e)&&Boolean(e.error)}function Ks(e){const t=[],n=new Map;for(const r of e){const e=r.group;if(e){let i=n.get(e);i||(i=[],n.set(e,i),t.push({label:e,options:i})),i.push(r)}else t.push(r)}return t}class Js{constructor(e,t){this._sceneObject=e,this._options=t,this._dependencies=new Set,this._isWaitingForVariables=!1,this.scanCount=0,this._statePaths=t.statePaths}hasDependencyOn(e){return this.getNames().has(e)}variableUpdateCompleted(t,n){const r=this.getNames();let i=!1;(r.has(t.state.name)||r.has(e.DataLinkBuiltInVars.includeVars))&&n&&(i=!0),ft("VariableDependencyConfig","variableUpdateCompleted",t.state.name,i,this._isWaitingForVariables),this._options.onAnyVariableChanged&&this._options.onAnyVariableChanged(t),this._options.onVariableUpdateCompleted&&(this._isWaitingForVariables||i)&&this._options.onVariableUpdateCompleted(),i&&(this._options.onReferencedVariableValueChanged&&this._options.onReferencedVariableValueChanged(t),this._options.onReferencedVariableValueChanged||this._options.onVariableUpdateCompleted||this._sceneObject.forceRender())}hasDependencyInLoadingState(){return kl.hasVariableDependencyInLoadingState(this._sceneObject)?(this._isWaitingForVariables=!0,!0):(this._isWaitingForVariables=!1,!1)}getNames(){const e=this._state,t=this._state=this._sceneObject.state;if(!e)return this.scanStateForDependencies(this._state),this._dependencies;if(t!==e)if(this._statePaths){for(const n of this._statePaths)if("*"===n||t[n]!==e[n]){this.scanStateForDependencies(t);break}}else this.scanStateForDependencies(t);return this._dependencies}setVariableNames(e){this._options.variableNames=e,this.scanStateForDependencies(this._state)}setPaths(e){this._statePaths=e}scanStateForDependencies(e){if(this._dependencies.clear(),this.scanCount+=1,this._options.variableNames)for(const e of this._options.variableNames)this._dependencies.add(e);if(this._statePaths)for(const t of this._statePaths){if("*"===t){this.extractVariablesFrom(e);break}{const n=e[t];n&&this.extractVariablesFrom(n)}}}extractVariablesFrom(e){Ge.lastIndex=0;const t=("string"!=typeof e?Vs(e):e).matchAll(Ge);if(t)for(const e of t){const[,t,n,,r]=e,i=t||n||r;this._dependencies.add(i)}}}const el=e=>Boolean(e.metricFindQuery)&&!Boolean(e.variables),tl=t=>{if(!t.variables)return!1;if(t.variables.getType()!==e.VariableSupportType.Standard)return!1;const n=t.variables;return"toDataQuery"in n&&Boolean(n.toDataQuery)},nl=t=>{if(!t.variables)return!1;if(t.variables.getType()!==e.VariableSupportType.Custom)return!1;const n=t.variables;return"query"in n&&"editor"in n&&Boolean(n.query)&&Boolean(n.editor)};var rl=Object.defineProperty,il=Object.defineProperties,al=Object.getOwnPropertyDescriptors,ol=Object.getOwnPropertySymbols,sl=Object.prototype.hasOwnProperty,ll=Object.prototype.propertyIsEnumerable,cl=(e,t,n)=>t in e?rl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ul=(e,t)=>{for(var n in t||(t={}))sl.call(t,n)&&cl(e,n,t[n]);if(ol)for(var n of ol(t))ll.call(t,n)&&cl(e,n,t[n]);return e},dl=(e,t)=>il(e,al(t));class pl{constructor(e,t=(0,a.getRunRequest)()){this.datasource=e,this._runRequest=t}getTarget(e){if(tl(this.datasource))return this.datasource.variables.toDataQuery(function(e){var t;const n=null!=(t=e.state.query)?t:"";return"string"==typeof n?{query:n,refId:`variable-${e.state.name}`}:null==n.refId?dl(ul({},n),{refId:`variable-${e.state.name}`}):e.state.query}(e));throw new Error("Couldn't create a target with supplied arguments.")}runRequest(e,t){return tl(this.datasource)?this.datasource.variables.query?this._runRequest(this.datasource,t,this.datasource.variables.query.bind(this.datasource.variables)):this._runRequest(this.datasource,t):gl()}}class fl{constructor(e){this.datasource=e}getTarget(e){if(el(this.datasource))return e.state.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({variable:t,searchFilter:n},r){return el(this.datasource)?(0,b.from)(this.datasource.metricFindQuery(t.state.query,dl(ul({},r),{variable:{name:t.state.name,type:t.state.type},searchFilter:n}))).pipe((0,b.mergeMap)((t=>{if(!t||!t.length)return gl();const n=t;return(0,b.of)({series:n,state:e.LoadingState.Done,timeRange:r.range})}))):gl()}}class hl{constructor(e,t=(0,a.getRunRequest)()){this.datasource=e,this._runRequest=t}getTarget(e){if(nl(this.datasource))return e.state.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest(e,t){return nl(this.datasource)?this.datasource.variables.query?this._runRequest(this.datasource,t,this.datasource.variables.query.bind(this.datasource.variables)):this._runRequest(this.datasource,t):gl()}}function gl(){return(0,b.of)({state:e.LoadingState.Done,series:[],timeRange:(0,e.getDefaultTimeRange)()})}const ml=(e,t)=>{const n=[];let r=null;t.lastIndex=0;do{r=t.exec(e),r&&n.push(r)}while(t.global&&r&&""!==r[0]&&void 0!==r[0]);return n};var bl=Object.defineProperty,vl=Object.getOwnPropertySymbols,yl=Object.prototype.hasOwnProperty,Ol=Object.prototype.propertyIsEnumerable,wl=(e,t,n)=>t in e?bl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Sl extends Vt{constructor(t){super(((e,t)=>{for(var n in t||(t={}))yl.call(t,n)&&wl(e,n,t[n]);if(vl)for(var n of vl(t))Ol.call(t,n)&&wl(e,n,t[n]);return e})({type:"query",name:"",value:"",text:"",options:[],datasource:null,regex:"",query:"",refresh:e.VariableRefresh.onDashboardLoad,sort:e.VariableSort.disabled},t)),this._variableDependency=new Js(this,{statePaths:["regex","query","datasource"]}),this.onSearchChange=e=>{Vs(this.state.query).indexOf("__searchFilter")>-1&&this._updateOptionsBasedOnSearchFilter(e)},this._updateOptionsBasedOnSearchFilter=(0,re.debounce)((async e=>{const t=await(0,b.lastValueFrom)(this.getValueOptions({searchFilter:e}));this.setState({options:t,loading:!1})}),400)}getValueOptions(t){return this.state.query?(this.setState({loading:!0,error:null}),(0,b.from)(ht(this.state.datasource,{__sceneObject:Dn(this)})).pipe((0,b.mergeMap)((n=>{const r=function(e){if(tl(e))return new pl(e,(0,a.getRunRequest)());if(el(e))return new fl(e);if(nl(e))return new hl(e);throw new Error(`Couldn't create a query runner for datasource ${e.type}`)}(n),i=r.getTarget(this),o=this.getRequest(i,t.searchFilter);return r.runRequest({variable:this,searchFilter:t.searchFilter},o).pipe(Ft({type:"variable",request:o,origin:this}),(0,b.filter)((t=>t.state===e.LoadingState.Done||t.state===e.LoadingState.Error)),(0,b.take)(1),(0,b.mergeMap)((t=>t.state===e.LoadingState.Error?(0,b.throwError)((()=>t.error)):(0,b.of)(t))),(t=>t.pipe((0,b.map)((t=>{const n=t.series;if(!n||!n.length)return[];if(function(t){if(!t)return!1;if(!t.length)return!0;const n=t[0];if((0,e.isDataFrame)(n))return!1;for(const e in n){if(!n.hasOwnProperty(e))continue;if(null!==n[e]&&"string"!=typeof n[e]&&"number"!=typeof n[e])continue;const t=e.toLowerCase();if("text"===t||"value"===t)return!0}return!1}(n))return n;if(0===n[0].fields.length)return[];const r=(0,e.getProcessedDataFrames)(n),i=[];let a=-1,o=-1,s=-1,l=-1;for(const t of r)for(let r=0;r<t.fields.length;r++){const i=t.fields[r],c=(0,e.getFieldDisplayName)(i,t,n).toLowerCase();i.type===e.FieldType.string&&-1===s&&(s=r),"text"===c&&i.type===e.FieldType.string&&-1===o&&(o=r),"value"===c&&i.type===e.FieldType.string&&-1===a&&(a=r),"expandable"!==c||i.type!==e.FieldType.boolean&&i.type!==e.FieldType.number||-1!==l||(l=r)}if(-1===s)throw new Error("Couldn't find any field of type string in the results.");for(const e of n)for(let t=0;t<e.length;t++){const n=-1!==l?e.fields[l].values.get(t):void 0,r=e.fields[s].values.get(t),c=-1!==o?e.fields[o].values.get(t):null,u=-1!==a?e.fields[a].values.get(t):null;-1!==a||-1!==o?-1!==a||-1===o?-1===a||-1!==o?i.push({text:c,value:u,expandable:n}):i.push({text:u,value:u,expandable:n}):i.push({text:c,value:c,expandable:n}):i.push({text:r,value:r,expandable:n})}return i})))),(0,b.mergeMap)((t=>{let n="";return this.state.regex&&(n=kl.interpolate(this,this.state.regex,void 0,"regex")),(0,b.of)(((t,n,r)=>{var i,a,o,s,l,c;let u,d=[];t&&(u=(0,e.stringToJsRegex)(t));for(let e=0;e<r.length;e++){const t=r[e];let n=void 0===t.text||null===t.text?t.value:t.text,p=void 0===t.value||null===t.value?t.text:t.value;if((0,re.isNumber)(p)&&(p=p.toString()),(0,re.isNumber)(n)&&(n=n.toString()),u){const e=ml(p,u);if(!e.length)continue;const t=e.find((e=>e.groups&&e.groups.value)),r=e.find((e=>e.groups&&e.groups.text)),f=e.find((e=>e.length>1)),h=e.length>1&&f;if(t||r)p=null!=(o=null==(i=null==t?void 0:t.groups)?void 0:i.value)?o:null==(a=null==r?void 0:r.groups)?void 0:a.text,n=null!=(c=null==(s=null==r?void 0:r.groups)?void 0:s.text)?c:null==(l=null==t?void 0:t.groups)?void 0:l.value;else{if(h){for(let t=0;t<e.length;t++){const n=e[t];d.push({label:n[1],value:n[1]})}continue}f&&(n=f[1],p=f[1])}}d.push({label:n,value:p})}return d=(0,re.uniqBy)(d,"value"),((t,n)=>{if(n===e.VariableSort.disabled)return t;const r=e=>{if(!e.text)return-1;const t=e.text.match(/.*?(\d+).*/);return!t||t.length<2?-1:parseInt(t[1],10)},i=e=>e.sort(((e,t)=>e.text?t.text?e.text.localeCompare(t.text,void 0,{numeric:!0}):1:-1));switch(n){case e.VariableSort.alphabeticalAsc:t=(0,re.sortBy)(t,"label");break;case e.VariableSort.alphabeticalDesc:t=(0,re.sortBy)(t,"label").reverse();break;case e.VariableSort.numericalAsc:t=(0,re.sortBy)(t,r);break;case e.VariableSort.numericalDesc:t=(t=(0,re.sortBy)(t,r)).reverse();break;case e.VariableSort.alphabeticalCaseInsensitiveAsc:t=(0,re.sortBy)(t,(e=>(0,re.toLower)(e.label)));break;case e.VariableSort.alphabeticalCaseInsensitiveDesc:t=(t=(0,re.sortBy)(t,(e=>(0,re.toLower)(e.label)))).reverse();break;case e.VariableSort.naturalAsc||7:t=i(t);break;case e.VariableSort.naturalDesc||8:t=(t=i(t)).reverse()}return t})(d,n)})(n,this.state.sort,t))})),(0,b.catchError)((e=>e.cancelled?(0,b.of)([]):(0,b.throwError)((()=>e)))))})))):(0,b.of)([])}getRequest(t,n){const r={__sceneObject:Dn(this)};n&&(r.__searchFilter={value:n,text:n});const i=kl.getTimeRange(this).state.value;return{app:e.CoreApp.Dashboard,requestId:x(),timezone:"",range:i,interval:"",intervalMs:0,targets:[t],scopedVars:r,startTime:Date.now()}}}function xl(e){var t;return null!=(t=ee(e,(e=>e.state.$data)))?t:Ce}function _l(e,t,n,r,i){return""===t||null==t?"":ct(e,t,n,r,i)}function Pl(e,t,n,r){if(t(e))return e;let i=null;return e.forEachChild((e=>{if(e===n)return;let r=Pl(e,t);r&&(i=r)})),i||(r&&e.parent?Pl(e.parent,t,e,!0):null)}function El(e,t){return Pl(e,t,void 0,!0)}function Cl(e,t){const n=[];return e.forEachChild((e=>{t(e)&&n.push(e),n.push(...Cl(e,t))})),n}Sl.Component=({model:e})=>xn(e);const kl={getVariables:function(e){var t;return null!=(t=ee(e,(e=>e.state.$variables)))?t:De},getData:xl,getTimeRange:Te,getLayout:function(e){return ee(e,(e=>function(e){return"isDraggable"in e}(e)?e:void 0))||null},getDataLayers:function(e,t=!1){let n=e,r=[];for(;n;){const e=n.state.$data;if(e){if(pt(e)?r=r.concat(e):e.state.$data&&pt(e.state.$data)&&(r=r.concat(e.state.$data)),t&&r.length>0)break;n=n.parent}else n=n.parent}return r},interpolate:_l,lookupVariable:ae,hasVariableDependencyInLoadingState:function(e){if(!e.variableDependency)return!1;for(const t of e.variableDependency.getNames()){if(e instanceof Sl&&e.state.name===t){console.warn("Query variable is referencing itself");continue}const n=ae(t,e);if(n&&n.parent.isVariableLoadingOrWaitingToUpdate(n))return!0}return!1},findByKey:function(e,t){const n=El(e,(e=>e.state.key===t));if(!n)throw new Error("Unable to find scene with key "+t);return n},findByKeyAndType:function(e,t,n){const r=El(e,(e=>e.state.key===t));if(!r)throw new Error("Unable to find scene with key "+t);if(!(r instanceof n))throw new Error(`Found scene object with key ${t} does not match type ${n.name}`);return r},findObject:El,findAllObjects:Cl,getAncestor:function(e,t){let n=e;for(;n;){if(n instanceof t)return n;n=n.parent}if(!n)throw new Error("Unable to find parent of type "+t.name);return n},findDescendents:function(e,t){function n(e){return e instanceof t}return Cl(e,n).filter(n)},getQueryController:function(e){let t=e;for(;t;){if(t.state.$behaviors)for(const e of t.state.$behaviors)if("isQueryController"in e)return e;t=t.parent}},getUrlSyncManager:function(e){let t=e;for(;t;){if("urlSyncManager"in t.state)return t.state.urlSyncManager;t=t.parent}}};class Dl{constructor(){this.index=new Map}getUniqueKey(e,t){const n=this.index.get(e);if(!n)return this.index.set(e,[t]),e;let r=n.findIndex((e=>e===t));return-1===r&&(function(e){for(const t of e)if(Tl(t)){const n=e.indexOf(t);e.splice(n,1)}}(n),n.push(t),r=n.length-1),r>0?`${e}-${r+1}`:e}clear(){this.index.clear()}}function Tl(e){const t=e.getRoot();return!kl.findObject(t,(t=>t===e))}function Rl(e){const t=new Dl,n={},r=e=>{if(e.urlSync){const r=e.urlSync.getUrlState();for(const[i,a]of Object.entries(r))if(null!=a){const r=t.getUniqueKey(i,e);n[r]=a}}e.forEachChild(r)};return r(e),n}function Il(e,t,n,r){r||Al(e,t,n),e.forEachChild((e=>{Al(e,t,n)})),e.forEachChild((e=>Il(e,t,n,!0)))}function Al(e,t,n){if(e.urlSync){const r={},i=e.urlSync.getUrlState();for(const a of e.urlSync.getKeys()){const o=n.getUniqueKey(a,e),s=t.getAll(o),l=i[a];jl(s,l)||(s.length>0?Array.isArray(l)?r[a]=s:r[a]=s[0]:r[a]=null)}Object.keys(r).length>0&&e.urlSync.updateFromUrl(r)}}function jl(e,t){return 0===e.length&&null==t||(Array.isArray(t)||1!==(null==e?void 0:e.length)?0===(null==t?void 0:t.length)&&null===e||(0,re.isEqual)(e,t):t===e[0])}var Ll=(e=>(e[e.never=0]="never",e[e.onDashboardLoad=1]="onDashboardLoad",e[e.onTimeRangeChanged=2]="onTimeRangeChanged",e))(Ll||{}),$l=(e=>(e[e.Crosshair=1]="Crosshair",e[e.Off=0]="Off",e[e.Tooltip=2]="Tooltip",e))($l||{}),Fl=Object.defineProperty,Nl=Object.defineProperties,Ml=Object.getOwnPropertyDescriptors,Vl=Object.getOwnPropertySymbols,Bl=Object.prototype.hasOwnProperty,zl=Object.prototype.propertyIsEnumerable,Wl=(e,t,n)=>t in e?Fl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Ql extends Q{constructor(e){var t,n;super((t=((e,t)=>{for(var n in t||(t={}))Bl.call(t,n)&&Wl(e,n,t[n]);if(Vl)for(var n of Vl(t))zl.call(t,n)&&Wl(e,n,t[n]);return e})({},e),n={sync:e.sync||$l.Off},Nl(t,Ml(n)))),this.getEventsBus=e=>{if(!this.parent)throw new Error("EnableCursorSync cannot be used as a standalone scene object");return new Ul(this.parent,e)}}getEventsScope(){if(!this.parent)throw new Error("EnableCursorSync cannot be used as a standalone scene object");return this.state.key}}class Ul{constructor(e,t){this._source=e,this._eventsOrigin=t}publish(e){e.origin=this,this._eventsOrigin.publishEvent(e,!0)}getStream(e){return new b.Observable((t=>{const n=this._source.subscribeToEvent(e,(e=>{t.next(e)}));return()=>n.unsubscribe()}))}subscribe(e,t){return this.getStream(e).pipe().subscribe(t)}removeAllListeners(){}newScopedBus(e,t){throw new Error("For internal use only")}}var ql=function(){},Hl="undefined"!=typeof window;const Gl=Hl?t.useLayoutEffect:t.useEffect;var Xl={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};const Yl=Hl&&void 0!==window.ResizeObserver?function(){var e=(0,t.useState)(null),n=e[0],r=e[1],i=(0,t.useState)(Xl),a=i[0],o=i[1],s=(0,t.useMemo)((function(){return new window.ResizeObserver((function(e){if(e[0]){var t=e[0].contentRect,n=t.x,r=t.y,i=t.width,a=t.height,s=t.top,l=t.left,c=t.bottom,u=t.right;o({x:n,y:r,width:i,height:a,top:s,left:l,bottom:c,right:u})}}))}),[]);return Gl((function(){if(n)return s.observe(n),function(){s.disconnect()}}),[n]),[r,a]}:function(){return[ql,Xl]};function Zl(e,t){if(t)return t;let n=e.error?e.error.message:void 0;return e.errors&&(n=e.errors.map((e=>e.message)).join(", ")),n}const Kl=(0,Ht.css)({position:"relative",width:"100%",height:"100%"}),Jl=(0,Ht.css)({position:"absolute",width:"100%",height:"100%"}),ec=e=>({ok:(0,Ht.css)({color:e.colors.success.text}),pending:(0,Ht.css)({color:e.colors.warning.text}),alerting:(0,Ht.css)({color:e.colors.error.text})});var tc=Object.defineProperty,nc=Object.defineProperties,rc=Object.getOwnPropertyDescriptors,ic=Object.getOwnPropertySymbols,ac=Object.prototype.hasOwnProperty,oc=Object.prototype.propertyIsEnumerable,sc=(e,t,n)=>t in e?tc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,lc=(e,t)=>{for(var n in t||(t={}))ac.call(t,n)&&sc(e,n,t[n]);if(ic)for(var n of ic(t))oc.call(t,n)&&sc(e,n,t[n]);return e},cc=(e,t)=>nc(e,rc(t));const uc="hideSeriesFrom",dc=(0,e.isSystemOverrideWithRef)(uc);function pc(t,n=e.ByNamesMatcherMode.exclude,r){return r=null!=r?r:{id:"custom.hideFrom",value:{viz:!0,legend:!1,tooltip:!1}},{__systemRef:uc,matcher:{id:e.FieldMatcherID.byNames,options:{mode:n,names:t,prefix:n===e.ByNamesMatcherMode.exclude?"All except:":void 0,readOnly:!0}},properties:[cc(lc({},r),{value:{viz:!0,legend:!1,tooltip:!1}})]}}const fc=e=>{var t;const n=null==(t=e.matcher.options)?void 0:t.names;return Array.isArray(n)?[...n]:[]},hc=(t,n)=>{const r=new Set;for(const i of t)for(const a of i.fields){if(a.type!==e.FieldType.number)continue;const o=(0,e.getFieldDisplayName)(a,i,t);o!==n&&r.add(o)}return Array.from(r)},gc=(t,n)=>{var r;let i=[];for(const a of t){const t=a.properties.find((e=>"custom.hideFrom"===e.id));if(void 0!==t&&!0===(null==(r=t.value)?void 0:r.legend)){const t=e.fieldMatchers.get(a.matcher.id).get(a.matcher.options);for(const r of n)for(const a of r.fields){if(a.type!==e.FieldType.number)continue;const o=(0,e.getFieldDisplayName)(a,r,n);t(a,r,n)&&i.push(o)}}}return i};var mc=Object.defineProperty,bc=Object.defineProperties,vc=Object.getOwnPropertyDescriptors,yc=Object.getOwnPropertySymbols,Oc=Object.prototype.hasOwnProperty,wc=Object.prototype.propertyIsEnumerable,Sc=(e,t,n)=>t in e?mc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,xc=(e,t)=>{for(var n in t||(t={}))Oc.call(t,n)&&Sc(e,n,t[n]);if(yc)for(var n of yc(t))wc.call(t,n)&&Sc(e,n,t[n]);return e},_c=(e,t)=>bc(e,vc(t));const Pc=(t,n)=>({matcher:{id:e.FieldMatcherID.byName,options:t},properties:[Ec(n)]}),Ec=t=>({id:"color",value:{mode:e.FieldColorModeId.Fixed,fixedColor:t}});var Cc=Object.defineProperty,kc=Object.defineProperties,Dc=Object.getOwnPropertyDescriptors,Tc=Object.getOwnPropertySymbols,Rc=Object.prototype.hasOwnProperty,Ic=Object.prototype.propertyIsEnumerable,Ac=(e,t,n)=>t in e?Cc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,jc=(e,t)=>{for(var n in t||(t={}))Rc.call(t,n)&&Ac(e,n,t[n]);if(Tc)for(var n of Tc(t))Ic.call(t,n)&&Ac(e,n,t[n]);return e},Lc=(e,t)=>kc(e,Dc(t));class $c extends Q{constructor(t){var n;super(jc({options:{},fieldConfig:{defaults:{},overrides:[]},title:"Title",pluginId:"timeseries"},t)),this._variableDependency=new Js(this,{statePaths:["title","options","fieldConfig"]}),this._structureRev=0,this.onTimeRangeChange=t=>{kl.getTimeRange(this).onTimeRangeChange({raw:{from:(0,e.toUtc)(t.from),to:(0,e.toUtc)(t.to)},from:(0,e.toUtc)(t.from),to:(0,e.toUtc)(t.to)})},this.getTimeRange=e=>{const t=kl.findObject(this,(e=>e instanceof Nc)),n=kl.getTimeRange(this);if(t instanceof Nc&&t.isEnabled)return Oe(n.state.from,n.state.to,n.getTimeZone(),n.state.fiscalYearStartMonth,n.state.UNSAFE_nowDelay);const r=this.getPlugin();return r&&!r.meta.skipDataQuery&&e&&e.timeRange?e.timeRange:n.state.value},this.onTitleChange=e=>{this.setState({title:e})},this.onDescriptionChange=e=>{this.setState({description:e})},this.onDisplayModeChange=e=>{this.setState({displayMode:e})},this.onOptionsChange=(t,n=!1,r=!1)=>{const{fieldConfig:i,options:a}=this.state,o=n?t:(0,re.mergeWith)((0,re.cloneDeep)(a),t,((e,t,n,r)=>{if((0,re.isArray)(t))return t;e===t||void 0!==t||(r[n]=t)})),s=(0,e.getPanelOptionsWithDefaults)({plugin:this._plugin,currentOptions:o,currentFieldConfig:i,isAfterPluginChange:r});this.setState({options:s.options})},this.onFieldConfigChange=(t,n)=>{const{fieldConfig:r,options:i}=this.state,a=n?t:(0,re.merge)((0,re.cloneDeep)(r),t),o=(0,e.getPanelOptionsWithDefaults)({plugin:this._plugin,currentOptions:i,currentFieldConfig:a,isAfterPluginChange:!1});this._dataWithFieldConfig=void 0,this.setState({fieldConfig:o.fieldConfig})},this.interpolate=(e,t,n)=>kl.interpolate(this,e,t,n),this.getDescription=()=>{this.publishEvent(new j({origin:this,interaction:"panel-description-shown"}),!0);const{description:t}=this.state;if(t){const n=this.interpolate(t);return(0,e.renderMarkdown)(n)}return""},this.onCancelQuery=()=>{var e;this.publishEvent(new j({origin:this,interaction:"panel-cancel-query-clicked"}),!0);const t=kl.getData(this);null==(e=t.cancelQuery)||e.call(t)},this.onStatusMessageClick=()=>{this.publishEvent(new j({origin:this,interaction:"panel-status-message-clicked"}),!0)},this._onSeriesColorChange=(t,n)=>{this.onFieldConfigChange(((t,n,r)=>{const{overrides:i}=r,a=r.overrides.findIndex((n=>n.matcher.id===e.FieldMatcherID.byName&&n.matcher.options===t));if(a<0)return _c(xc({},r),{overrides:[...r.overrides,Pc(t,n)]});const o=Array.from(i),s=o[a],l=s.properties.findIndex((e=>"color"===e.id));if(l<0)return o[a]=_c(xc({},s),{properties:[...s.properties,Ec(n)]}),_c(xc({},r),{overrides:o});const c=Array.from(s.properties);return c[l]=Ec(n),o[a]=_c(xc({},s),{properties:c}),_c(xc({},r),{overrides:o})})(t,n,this.state.fieldConfig))},this._onSeriesVisibilityChange=(t,n)=>{this._dataWithFieldConfig&&this.onFieldConfigChange(function(t,n,r,i){const{overrides:a}=r,o=t,s=a.findIndex(dc);if(s<0){if(n===Wt.SeriesVisibilityChangeMode.ToggleSelection){const e=pc([o,...gc(a,i)]);return cc(lc({},r),{overrides:[...r.overrides,e]})}const e=pc(hc(i,o));return cc(lc({},r),{overrides:[...r.overrides,e]})}const l=Array.from(a),[c]=l.splice(s,1);if(n===Wt.SeriesVisibilityChangeMode.ToggleSelection){let e=fc(c);const t=gc(l,i);if(t.length>0&&(e=e.filter((e=>t.indexOf(e)<0))),e[0]===o&&1===e.length)return cc(lc({},r),{overrides:l});const n=pc([o,...t]);return cc(lc({},r),{overrides:[...l,n]})}const u=((t,n,r=e.ByNamesMatcherMode.exclude)=>{const i=t.properties.find((e=>"custom.hideFrom"===e.id)),a=fc(t),o=a.findIndex((e=>e===n));return o<0?a.push(n):a.splice(o,1),pc(a,r,i)})(c,o);return((e,t)=>fc(e).length===hc(t).length)(u,i)?cc(lc({},r),{overrides:l}):cc(lc({},r),{overrides:[...l,u]})}(t,n,this.state.fieldConfig,this._dataWithFieldConfig.series),!0)},this._onInstanceStateChange=e=>{this._panelContext&&(this._panelContext=Lc(jc({},this._panelContext),{instanceState:e})),this.setState({_pluginInstanceState:e})},this._onToggleLegendSort=e=>{const t=this.state.options.legend;if(!t)return;let n=t.sortDesc,r=t.sortBy;e!==r&&(n=void 0),!1===n?(r=void 0,n=void 0):(n=!n,r=e),this.onOptionsChange(Lc(jc({},this.state.options),{legend:Lc(jc({},t),{sortBy:r,sortDesc:n})}),!0)},this.addActivationHandler((()=>{this._onActivate()})),null==(n=t.menu)||n.addActivationHandler((()=>{this.publishEvent(new j({origin:this,interaction:"panel-menu-shown"}),!0)}))}_onActivate(){this._plugin||this._loadPlugin(this.state.pluginId)}async _loadPlugin(t,n,r,i){const o=function(e){var t;const{getPanelPluginFromCache:n}=(0,a.getPluginImportUtils)();return null!=(t=n(e))?t:h.get(e)}(t);if(o)this._pluginLoaded(o,n,r,i);else{const{importPanelPlugin:o}=(0,a.getPluginImportUtils)();try{const e=await o(t);this._pluginLoaded(e,n,r,i)}catch(n){this._pluginLoaded(function(t){const n=new e.PanelPlugin((()=>null));return n.meta={id:t,name:t,sort:100,type:e.PluginType.panel,module:"",baseUrl:"",info:{author:{name:""},description:"",links:[],logos:{large:"",small:"public/img/grafana_icon.svg"},screenshots:[],updated:"",version:""}},n}(t)),n instanceof Error&&this.setState({_pluginLoadError:n.message})}}}getLegacyPanelId(){const e=parseInt(this.state.key.replace("panel-",""),10);return isNaN(e)?0:e}async _pluginLoaded(t,n,r,i){const{options:a,fieldConfig:o,title:s,pluginVersion:l,_UNSAFE_customMigrationHandler:c}=this.state,u={title:s,options:a,fieldConfig:o,id:this.getLegacyPanelId(),type:t.meta.id,pluginVersion:l};n&&(u.options=n),r&&(u.fieldConfig=r);const d=this._getPluginVersion(t);null==c||c(u,t),t.onPanelMigration&&d!==this.state.pluginVersion&&(u.options=await t.onPanelMigration(u));const p=(0,e.getPanelOptionsWithDefaults)({plugin:t,currentOptions:u.options,currentFieldConfig:u.fieldConfig,isAfterPluginChange:null!=i&&i});if(this._plugin=t,this.setState({options:p.options,fieldConfig:p.fieldConfig,pluginVersion:d,pluginId:t.meta.id}),t.meta.skipDataQuery){const e=kl.getTimeRange(this);this._subs.add(e.subscribeToState((()=>this.forceRender())))}}_getPluginVersion(e){return e&&e.meta.info.version?e.meta.info.version:a.config.buildInfo.version}getPlugin(){return this._plugin}getPanelContext(){return null!=this._panelContext||(this._panelContext=this.buildPanelContext()),this._panelContext}async changePluginType(e,t,n){var r,i;const{options:a,fieldConfig:o,pluginId:s}=this.state;this._dataWithFieldConfig=void 0,await this._loadPlugin(e,null!=t?t:{},n,!0);const l={title:this.state.title,options:this.state.options,fieldConfig:this.state.fieldConfig,id:1,type:e},c=null==(i=null==(r=this._plugin)?void 0:r.onPanelTypeChanged)?void 0:i.call(r,l,s,a,o);c&&!(0,re.isEmpty)(c)&&this.onOptionsChange(c,!0,!0)}clearFieldConfigCache(){this._dataWithFieldConfig=void 0}applyFieldConfig(t){var n,r,i,o;const s=this._plugin;if(!s||s.meta.skipDataQuery||!t)return me;if(this._prevData===t&&this._dataWithFieldConfig)return this._dataWithFieldConfig;const l=s.dataSupport||{alertStates:!1,annotations:!1},c=s.fieldConfigRegistry,u=null!=(r=null==(n=this._dataWithFieldConfig)?void 0:n.series)?r:[],d=(0,e.applyFieldOverrides)({data:t.series,fieldConfig:this.state.fieldConfig,fieldConfigRegistry:c,replaceVariables:this.interpolate,theme:a.config.theme2,timeZone:null==(i=t.request)?void 0:i.timezone});return(0,e.compareArrayValues)(d,u,e.compareDataFrameStructures)||this._structureRev++,this._dataWithFieldConfig=Lc(jc({},t),{structureRev:this._structureRev,series:d}),this._dataWithFieldConfig.annotations&&(this._dataWithFieldConfig.annotations=(0,e.applyFieldOverrides)({data:this._dataWithFieldConfig.annotations,fieldConfig:{defaults:{},overrides:[]},fieldConfigRegistry:c,replaceVariables:this.interpolate,theme:a.config.theme2,timeZone:null==(o=t.request)?void 0:o.timezone})),l.alertStates||(this._dataWithFieldConfig.alertState=void 0),l.annotations||(this._dataWithFieldConfig.annotations=void 0),this._prevData=t,this._dataWithFieldConfig}buildPanelContext(){const t=(this,kl.findObject(this,(e=>e instanceof Ql)));const n={eventsScope:t?t.getEventsScope():"__global_",eventBus:t?t.getEventsBus(this):(0,a.getAppEvents)(),app:e.CoreApp.Unknown,sync:()=>t?t.state.sync:e.DashboardCursorSync.Off,onSeriesColorChange:this._onSeriesColorChange,onToggleSeriesVisibility:this._onSeriesVisibilityChange,onToggleLegendSort:this._onToggleLegendSort,onInstanceStateChange:this._onInstanceStateChange};return this.state.extendPanelContext&&this.state.extendPanelContext(this,n),n}}$c.Component=function({model:n}){var i;const{title:o,options:s,fieldConfig:l,_pluginLoadError:c,displayMode:u,hoverHeader:d,hoverHeaderOffset:p,menu:f,headerActions:h,titleItems:g,description:m}=n.useState(),[b,{width:v,height:y}]=Yl(),O=(0,t.useMemo)((()=>(0,a.getAppEvents)()),[]),w=(0,t.useCallback)((()=>{O.publish(new e.SetPanelAttentionEvent({panelId:n.state.key}))}),[n.state.key,O]),S=(0,t.useMemo)((()=>(0,re.debounce)(w,100,{leading:!0,trailing:!1})),[w]),x=n.getPlugin(),{dragClass:_,dragClassCancel:P}=function(e){var t,n;const r=kl.getLayout(e),i=null==r?void 0:r.isDraggable();return r&&i&&!function(e,t){let n=e.parent;for(;n&&n!==t;){if("isDraggable"in n.state&&!1===n.state.isDraggable)return!0;n=n.parent}return!1}(e,r)?{dragClass:null==(t=r.getDragClass)?void 0:t.call(r),dragClassCancel:null==(n=null==r?void 0:r.getDragClassCancel)?void 0:n.call(r)}:{dragClass:"",dragClassCancel:""}}(n),E=kl.getData(n),C=E.useState(),k=n.applyFieldConfig(C.data),D=kl.getTimeRange(n).getTimeZone(),T=n.getTimeRange(k),R=n.interpolate(o,void 0,"text"),I=(0,Wt.useStyles2)(ec);if(!x)return r().createElement("div",null,"Loading plugin panel...");if(!x.panel)return r().createElement("div",null,"Panel plugin has no panel component");const A=x.panel;E&&E.setContainerWidth&&E.setContainerWidth(Math.round(v));let j,L,$=[];g&&(Array.isArray(g)?$=$.concat(g.map((e=>r().createElement(e.Component,{model:e,key:`${e.state.key}`})))):ut(g)?$.push(r().createElement(g.Component,{model:g})):$.push(g)),n.state.$timeRange&&$.push(r().createElement(n.state.$timeRange.Component,{model:n.state.$timeRange,key:n.state.key})),k.alertState&&$.push(r().createElement(Wt.Tooltip,{content:null!=(i=k.alertState.state)?i:"unknown",key:`alert-states-icon-${n.state.key}`},r().createElement(Wt.PanelChrome.TitleItem,{className:(0,Ht.cx)({[I.ok]:k.alertState.state===e.AlertState.OK,[I.pending]:k.alertState.state===e.AlertState.Pending,[I.alerting]:k.alertState.state===e.AlertState.Alerting})},r().createElement(Wt.Icon,{name:"alerting"===k.alertState.state?"heart-break":"heart",className:"panel-alert-icon",size:"md"})))),f&&(j=r().createElement(f.Component,{model:f})),h&&(L=Array.isArray(h)?r().createElement(r().Fragment,null,h.map((e=>r().createElement(e.Component,{model:e,key:`${e.state.key}`})))):ut(h)?r().createElement(h.Component,{model:h}):h);const F=k,N=!E.isDataReadyToDisplay||E.isDataReadyToDisplay(),M=n.getPanelContext(),V=n.getLegacyPanelId();return r().createElement("div",{className:Kl},r().createElement("div",{ref:b,className:Jl,"data-viz-panel-key":n.state.key},v>0&&y>0&&r().createElement(Wt.PanelChrome,{title:R,description:(null==m?void 0:m.trim())?n.getDescription:void 0,loadingState:F.state,statusMessage:Zl(F,c),statusMessageOnClick:n.onStatusMessageClick,width:v,height:y,displayMode:u,hoverHeader:d,hoverHeaderOffset:p,titleItems:$,dragClass:_,actions:L,dragClassCancel:P,padding:x.noPadding?"none":"md",menu:j,onCancelQuery:n.onCancelQuery,onFocus:w,onMouseEnter:w,onMouseMove:S},((t,i)=>r().createElement(r().Fragment,null,r().createElement(Wt.ErrorBoundaryAlert,{dependencies:[x,F]},r().createElement(e.PluginContextProvider,{meta:x.meta},r().createElement(Wt.PanelContextProvider,{value:M},N&&r().createElement(A,{id:V,data:F,title:o,timeRange:T,timeZone:D,options:s,fieldConfig:l,transparent:!1,width:t,height:i,renderCounter:0,replaceVariables:n.interpolate,onOptionsChange:n.onOptionsChange,onFieldConfigChange:n.onFieldConfigChange,onChangeTimeRange:n.onTimeRangeChange,eventBus:M.eventBus})))))))))};const Fc=class extends Q{constructor({enabled:e=!1}){super({enabled:e}),this.timerId=void 0,this._activationHandler=()=>(this.state.enabled&&this.enable(),()=>{window.clearInterval(this.timerId),this.timerId=void 0}),this.addActivationHandler(this._activationHandler)}enable(){window.clearInterval(this.timerId),this.timerId=void 0,this.timerId=window.setInterval((()=>{const e=kl.findAllObjects(this.getRoot(),(e=>e instanceof $c));for(const t of e)t.forceRender()}),Fc.REFRESH_RATE),this.setState({enabled:!0})}disable(){window.clearInterval(this.timerId),this.timerId=void 0,this.setState({enabled:!1})}get isEnabled(){return this.state.enabled}};let Nc=Fc;function Mc(e){if("string"==typeof e)return e;if(e){if(e instanceof Error)return e.message;if((0,a.isFetchError)(e)){if(e.data&&e.data.message)return e.data.message;if(e.statusText)return e.statusText}else if(e.hasOwnProperty("message"))return e.message}return JSON.stringify(e)}Nc.REFRESH_RATE=100;var Vc=Object.defineProperty,Bc=Object.getOwnPropertySymbols,zc=Object.prototype.hasOwnProperty,Wc=Object.prototype.propertyIsEnumerable,Qc=(e,t,n)=>t in e?Vc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Uc extends Q{constructor(e,t=[]){super(((e,t)=>{for(var n in t||(t={}))zc.call(t,n)&&Qc(e,n,t[n]);if(Bc)for(var n of Bc(t))Wc.call(t,n)&&Qc(e,n,t[n]);return e})({isEnabled:!0},e)),this._results=new b.ReplaySubject(1),this.isDataLayer=!0,this._variableValueRecorder=new gt,this._variableDependency=new Js(this,{onVariableUpdateCompleted:this.onVariableUpdateCompleted.bind(this)}),this._variableDependency.setPaths(t),this.addActivationHandler((()=>this.onActivate()))}onActivate(){return this.state.isEnabled&&this.onEnable(),this.shouldRunLayerOnActivate()&&this.runLayer(),this.subscribeToState(((e,t)=>{!e.isEnabled&&this.querySub&&(this.querySub.unsubscribe(),this.querySub=void 0,this.onDisable(),this._results.next({origin:this,data:me}),this.setStateHelper({data:me})),e.isEnabled&&!t.isEnabled&&(this.onEnable(),this.runLayer())})),()=>{this.onDeactivate()}}onDeactivate(){this.querySub&&(this.querySub.unsubscribe(),this.querySub=void 0),this.onDisable(),this._variableValueRecorder.recordCurrentDependencyValuesForSceneObject(this)}onVariableUpdateCompleted(){this.runLayer()}cancelQuery(){this.querySub&&(this.querySub.unsubscribe(),this.querySub=void 0,this.publishResults(me))}publishResults(e){this.state.isEnabled&&(this._results.next({origin:this,data:e}),this.setStateHelper({data:e}))}getResultsStream(){return this._results}shouldRunLayerOnActivate(){return!!this.state.isEnabled&&(this._variableValueRecorder.hasDependenciesChanged(this)?(ft("SceneDataLayerBase","Variable dependency changed while inactive, shouldRunLayerOnActivate returns true"),!0):!this.state.data)}setStateHelper(e){Mt(this,e)}}function qc({layer:e}){var t,n;const i=`data-layer-${e.state.key}`,{data:a,isEnabled:o}=e.useState(),s=Boolean(a&&a.state===ce.Loading);return r().createElement("div",{className:Hc},r().createElement(zn,{htmlFor:i,isLoading:s,onCancel:()=>{var t;return null==(t=e.cancelQuery)?void 0:t.call(e)},label:e.state.name,description:e.state.description,error:null==(n=null==(t=e.state.data)?void 0:t.errors)?void 0:n[0].message}),r().createElement(Wt.InlineSwitch,{id:i,value:o,onChange:()=>e.setState({isEnabled:!o})}))}(class extends Q{constructor(){super({})}}).Component=function({model:e}){const t=kl.getDataLayers(e,!0);return 0===t.length?null:r().createElement(r().Fragment,null,t.map((e=>r().createElement(e.Component,{model:e,key:e.state.key}))))};const Hc=(0,Ht.css)({display:"flex"});function Gc(e){return"function"==typeof e}function Xc(e){return function(t){if(function(e){return Gc(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}var Yc=function(e,t){return Yc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},Yc(e,t)};function Zc(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Yc(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function Kc(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}function Jc(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function eu(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o}function tu(e,t,n){if(n||2===arguments.length)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function nu(e){return this instanceof nu?(this.v=e,this):new nu(e)}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var ru,iu,au=(ru=function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}},(iu=ru((function(e){Error.call(e),e.stack=(new Error).stack}))).prototype=Object.create(Error.prototype),iu.prototype.constructor=iu,iu);function ou(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var su=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var e,t,n,r,i;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var o=Jc(a),s=o.next();!s.done;s=o.next())s.value.remove(this)}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}else a.remove(this);var l=this.initialTeardown;if(Gc(l))try{l()}catch(e){i=e instanceof au?e.errors:[e]}var c=this._finalizers;if(c){this._finalizers=null;try{for(var u=Jc(c),d=u.next();!d.done;d=u.next()){var p=d.value;try{cu(p)}catch(e){i=null!=i?i:[],e instanceof au?i=tu(tu([],eu(i)),eu(e.errors)):i.push(e)}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}if(i)throw new au(i)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)cu(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&ou(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&ou(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}();function lu(e){return e instanceof su||e&&"closed"in e&&Gc(e.remove)&&Gc(e.add)&&Gc(e.unsubscribe)}function cu(e){Gc(e)?e():e.unsubscribe()}su.EMPTY;var uu={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},du={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=du.delegate;return(null==i?void 0:i.setTimeout)?i.setTimeout.apply(i,tu([e,t],eu(n))):setTimeout.apply(void 0,tu([e,t],eu(n)))},clearTimeout:function(e){var t=du.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function pu(e){du.setTimeout((function(){var t=uu.onUnhandledError;if(!t)throw e;t(e)}))}function fu(){}var hu=gu("C",void 0,void 0);function gu(e,t,n){return{kind:e,value:t,error:n}}var mu=null,bu=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,lu(t)&&t.add(n)):n.destination=_u,n}return Zc(t,e),t.create=function(e,t,n){return new wu(e,t,n)},t.prototype.next=function(e){this.isStopped?xu(function(e){return gu("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?xu(gu("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?xu(hu,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(su),vu=Function.prototype.bind;function yu(e,t){return vu.call(e,t)}var Ou=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){Su(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){Su(e)}else Su(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){Su(e)}},e}(),wu=function(e){function t(t,n,r){var i,a,o=e.call(this)||this;return Gc(t)||!t?i={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:o&&uu.useDeprecatedNextContext?((a=Object.create(t)).unsubscribe=function(){return o.unsubscribe()},i={next:t.next&&yu(t.next,a),error:t.error&&yu(t.error,a),complete:t.complete&&yu(t.complete,a)}):i=t,o.destination=new Ou(i),o}return Zc(t,e),t}(bu);function Su(e){var t;uu.useDeprecatedSynchronousErrorHandling?(t=e,uu.useDeprecatedSynchronousErrorHandling&&mu&&(mu.errorThrown=!0,mu.error=t)):pu(e)}function xu(e,t){var n=uu.onStoppedNotification;n&&du.setTimeout((function(){return n(e,t)}))}var _u={closed:!0,next:fu,error:function(e){throw e},complete:fu};function Pu(e,t,n,r,i){return new Eu(e,t,n,r,i)}var Eu=function(e){function t(t,n,r,i,a,o){var s=e.call(this,t)||this;return s.onFinalize=a,s.shouldUnsubscribe=o,s._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,s._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,s._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,s}return Zc(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(bu);function Cu(e,t){return Xc((function(n,r){var i=0;n.subscribe(Pu(r,(function(n){r.next(e.call(t,n,i++))})))}))}var ku=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e},Du="function"==typeof Symbol&&Symbol.observable||"@@observable";function Tu(e){return e}var Ru=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r,i=this,a=(r=e)&&r instanceof bu||function(e){return e&&Gc(e.next)&&Gc(e.error)&&Gc(e.complete)}(r)&&lu(r)?e:new wu(e,t,n);return function(e){if(uu.useDeprecatedSynchronousErrorHandling){var t=!mu;if(t&&(mu={errorThrown:!1,error:null}),e(),t){var n=mu,r=n.errorThrown,i=n.error;if(mu=null,r)throw i}}else e()}((function(){var e=i,t=e.operator,n=e.source;a.add(t?t.call(a,n):n?i._subscribe(a):i._trySubscribe(a))})),a},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=Iu(t))((function(t,r){var i=new wu({next:function(t){try{e(t)}catch(e){r(e),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[Du]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0===(n=e).length?Tu:1===n.length?n[0]:function(e){return n.reduce((function(e,t){return t(e)}),e)})(this);var n},e.prototype.toPromise=function(e){var t=this;return new(e=Iu(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function Iu(e){var t;return null!==(t=null!=e?e:uu.Promise)&&void 0!==t?t:Promise}var Au="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function ju(e){if(e instanceof Ru)return e;if(null!=e){if(function(e){return Gc(e[Du])}(e))return a=e,new Ru((function(e){var t=a[Du]();if(Gc(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(ku(e))return i=e,new Ru((function(e){for(var t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()}));if(Gc(null==(r=e)?void 0:r.then))return n=e,new Ru((function(e){n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,pu)}));if(function(e){return Symbol.asyncIterator&&Gc(null==e?void 0:e[Symbol.asyncIterator])}(e))return Lu(e);if(function(e){return Gc(null==e?void 0:e[Au])}(e))return t=e,new Ru((function(e){var n,r;try{for(var i=Jc(t),a=i.next();!a.done;a=i.next()){var o=a.value;if(e.next(o),e.closed)return}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()}));if(function(e){return Gc(null==e?void 0:e.getReader)}(e))return Lu(function(e){return function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),a=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){a.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{(n=i[e](t)).value instanceof nu?Promise.resolve(n.value.v).then(l,c):u(a[0][2],n)}catch(e){u(a[0][3],e)}var n}function l(e){s("next",e)}function c(e){s("throw",e)}function u(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}(this,arguments,(function(){var t,n,r;return Kc(this,(function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,nu(t.read())];case 3:return n=i.sent(),r=n.value,n.done?[4,nu(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,nu(r)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}(e))}var t,n,r,i,a;throw function(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}(e)}function Lu(e){return new Ru((function(t){(function(e,t){var n,r,i,a,o,s,l,c;return o=this,s=void 0,c=function(){var o,s;return Kc(this,(function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=Jc(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,i,(t=e[n](t)).done,t.value)}))}}}(e),l.label=1;case 1:return[4,n.next()];case 2:if((r=l.sent()).done)return[3,4];if(o=r.value,t.next(o),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return s=l.sent(),i={error:s},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(a=n.return)?[4,a.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))},new((l=void 0)||(l=Promise))((function(e,t){function n(e){try{i(c.next(e))}catch(e){t(e)}}function r(e){try{i(c.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof l?i:new l((function(e){e(i)}))).then(n,r)}i((c=c.apply(o,s||[])).next())}))})(e,t).catch((function(e){return t.error(e)}))}))}function $u(e,t,n){return void 0===n&&(n=1/0),Gc(t)?$u((function(n,r){return Cu((function(e,i){return t(n,e,r,i)}))(ju(e(n,r)))}),n):("number"==typeof t&&(n=t),Xc((function(t,r){return function(e,t,n,r,i,a,o,s){var l=[],c=0,u=0,d=!1,p=function(){!d||l.length||c||t.complete()},f=function(e){return c<r?h(e):l.push(e)},h=function(e){c++;var i=!1;ju(n(e,u++)).subscribe(Pu(t,(function(e){t.next(e)}),(function(){i=!0}),void 0,(function(){if(i)try{c--;for(var e=function(){var e=l.shift();h(e)};l.length&&c<r;)e();p()}catch(e){t.error(e)}})))};return e.subscribe(Pu(t,f,(function(){d=!0,p()}))),function(){}}(t,r,e,n)})))}var Fu=Object.defineProperty,Nu=Object.defineProperties,Mu=Object.getOwnPropertyDescriptors,Vu=Object.getOwnPropertySymbols,Bu=Object.prototype.hasOwnProperty,zu=Object.prototype.propertyIsEnumerable,Wu=(e,t,n)=>t in e?Fu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const Qu={prepareAnnotation:e=>{if((0,re.isString)(null==e?void 0:e.query)){const n=e,{query:r}=n;return t=((e,t)=>{for(var n in t||(t={}))Bu.call(t,n)&&Wu(e,n,t[n]);if(Vu)for(var n of Vu(t))zu.call(t,n)&&Wu(e,n,t[n]);return e})({},((e,t)=>{var n={};for(var r in e)Bu.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&Vu)for(var r of Vu(e))t.indexOf(r)<0&&zu.call(e,r)&&(n[r]=e[r]);return n})(n,["query"])),Nu(t,Mu({target:{refId:"annotation_query",query:r},mappings:{}}))}var t;return e},prepareQuery:e=>e.target,processEvents:(t,n)=>function(t,n){return(0,b.of)(t).pipe((t=>t.pipe($u((t=>{if(!(null==t?void 0:t.length))return(0,b.of)(void 0);if(1===t.length)return(0,b.of)(t[0]);return(0,b.of)(t).pipe(e.standardTransformers.mergeTransformer.operator({},{interpolate:e=>e}),Cu((e=>e[0])))})))),Cu((t=>{if(!(null==t?void 0:t.length))return[];let r=!1,i=!1;const a={};for(const n of t.fields)a[(0,e.getFieldDisplayName)(n,t).toLowerCase()]=n;n||(n={});const o=[];for(const s of qu){const l=n[s.key]||{};if(l.source===e.AnnotationEventFieldSource.Skip)continue;const c={key:s.key,split:s.split};if(l.source===e.AnnotationEventFieldSource.Text)c.text=l.value;else{const e=(l.value||s.key).toLowerCase();c.field=a[e],!c.field&&s.field&&(c.field=s.field(t))}(c.field||c.text)&&(o.push(c),"time"===c.key?r=!0:"text"===c.key&&(i=!0))}if(!r||!i)return console.error("Cannot process annotation fields. No time or text present."),[];const s=[];for(let e=0;e<t.length;e++){const t={type:"default",color:"red"};for(const n of o){let r;if(n.text)r=n.text;else if(n.field&&(r=n.field.values.get(e),void 0!==r&&n.regex)){const e=n.regex.exec(r);e&&(r=e[1]?e[1]:e[0])}null!=r&&(n.split&&"string"==typeof r&&(r=r.split(",")),t[n.key]=r)}s.push(t)}return s})))}(n,t.mappings)},Uu=[{key:"time",field:t=>t.fields.find((t=>t.type===e.FieldType.time)),placeholder:"time, or the first time field"},{key:"timeEnd",help:"When this field is defined, the annotation will be treated as a range"},{key:"title"},{key:"text",field:t=>t.fields.find((t=>t.type===e.FieldType.string)),placeholder:"text, or the first text field"},{key:"tags",split:",",help:"The results will be split on comma (,)"},{key:"id"}],qu=[...a.config.publicDashboardAccessToken?[{key:"color"},{key:"isRegion"},{key:"source"}]:[],...Uu,{key:"userId"},{key:"login"},{key:"email"},{key:"prevState"},{key:"newState"},{key:"data"},{key:"panelId"},{key:"alertId"},{key:"dashboardId"},{key:"dashboardUID"}],Hu=["prometheus","loki","elasticsearch","grafana-opensearch-datasource"];var Gu=Object.defineProperty,Xu=Object.defineProperties,Yu=Object.getOwnPropertyDescriptors,Zu=Object.getOwnPropertySymbols,Ku=Object.prototype.hasOwnProperty,Ju=Object.prototype.propertyIsEnumerable,ed=(e,t,n)=>t in e?Gu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,td=(e,t)=>{for(var n in t||(t={}))Ku.call(t,n)&&ed(e,n,t[n]);if(Zu)for(var n of Zu(t))Ju.call(t,n)&&ed(e,n,t[n]);return e},nd=(e,t)=>Xu(e,Yu(t));let rd=100;var id=Object.defineProperty,ad=Object.getOwnPropertySymbols,od=Object.prototype.hasOwnProperty,sd=Object.prototype.propertyIsEnumerable,ld=(e,t,n)=>t in e?id(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;function cd(e){return"panel-alert"===e.eventType}var ud=Object.defineProperty,dd=Object.defineProperties,pd=Object.getOwnPropertyDescriptors,fd=Object.getOwnPropertySymbols,hd=Object.prototype.hasOwnProperty,gd=Object.prototype.propertyIsEnumerable,md=(e,t,n)=>t in e?ud(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,bd=(e,t)=>{for(var n in t||(t={}))hd.call(t,n)&&md(e,n,t[n]);if(fd)for(var n of fd(t))gd.call(t,n)&&md(e,n,t[n]);return e},vd=(e,t)=>dd(e,pd(t));(class extends Uc{constructor(e){super(bd({isEnabled:!0},e),["query"]),this._scopedVars={__sceneObject:Dn(this)}}onEnable(){const e=kl.getTimeRange(this);this._timeRangeSub=e.subscribeToState((()=>{this.runWithTimeRange(e)}))}onDisable(){var e;null==(e=this._timeRangeSub)||e.unsubscribe()}runLayer(){ft("AnnotationsDataLayer","run layer");const e=kl.getTimeRange(this);this.runWithTimeRange(e)}async runWithTimeRange(t){const{query:n}=this.state;if(this.querySub&&this.querySub.unsubscribe(),this._variableDependency.hasDependencyInLoadingState())ft("AnnotationsDataLayer","Variable dependency is in loading state, skipping query execution");else try{let r=function(t,n,r,i){var o;if(t.annotationQuery&&function(e){const{type:t}=e;return!e.annotations||Hu.includes(t)}(t))return console.warn("Using deprecated annotationQuery method, please upgrade your datasource"),(0,b.from)(t.annotationQuery({range:n.state.value,rangeRaw:n.state.value.raw,annotation:r,dashboard:{}})).pipe(Cu((e=>({state:ce.Done,events:e}))));const s=td(td({},Qu),t.annotations),l=td(td({},null==(o=s.getDefaultQuery)?void 0:o.call(s)),r),c=s.prepareAnnotation(l);if(!c)return(0,b.of)({state:ce.Done,events:[]});const u=s.prepareQuery(c);if(!u)return(0,b.of)({state:ce.Done,events:[]});const d=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,p=e.rangeUtil.calculateInterval(n.state.value,d,t.interval),f={__interval:{text:p.interval,value:p.interval},__interval_ms:{text:p.intervalMs.toString(),value:p.intervalMs},__annotation:{text:c.name,value:c},__sceneObject:Dn(i)},h=td(nd(td({startTime:Date.now(),requestId:"AQ"+rd++,range:n.state.value,maxDataPoints:d,scopedVars:f},p),{app:e.CoreApp.Dashboard,timezone:n.getTimeZone(),targets:[nd(td({},u),{refId:"Anno"})]}),jt(i));return(0,a.getRunRequest)()(t,h).pipe($u((t=>{const n=(null==t?void 0:t.series.length)?t.series:t.annotations;return(null==n?void 0:n.length)?(n.forEach((t=>{var n;(null==(n=t.meta)?void 0:n.dataTopic)||(t.meta=nd(td({},t.meta||{}),{dataTopic:e.DataTopic.Annotations}))})),s.processEvents(c,n).pipe(Cu((e=>({state:t.state,events:e||[]}))))):(0,b.of)({state:t.state,events:[]})})))}(await this.resolveDataSource(n),t,n,this).pipe(Ft({type:"annotations",origin:this,cancel:()=>this.cancelQuery()}),(0,b.map)((e=>this.processEvents(n,e))));this.querySub=r.subscribe((e=>{this.publishResults(e)}))}catch(e){this.publishResults(vd(bd({},me),{state:ce.Error,errors:[{message:Mc(e)}]})),console.error("AnnotationsDataLayer error",e)}}async resolveDataSource(e){return await ht(e.datasource||void 0,this._scopedVars)}processEvents(t,n){let r=(i=t,o=n.events||[],i.snapshotData&&delete(i=(0,re.cloneDeep)(i)).snapshotData,o.map((e=>{var t;const n=((e,t)=>{for(var n in t||(t={}))od.call(t,n)&&ld(e,n,t[n]);if(ad)for(var n of ad(t))sd.call(t,n)&&ld(e,n,t[n]);return e})({},e);switch(n.source=i,n.color=a.config.theme2.visualization.getColorByName(i.iconColor),n.type=i.name,n.isRegion=Boolean(n.timeEnd&&n.time!==n.timeEnd),null==(t=n.newState)?void 0:t.toLowerCase()){case"pending":n.color="yellow";break;case"alerting":n.color="red";break;case"ok":case"normal":n.color="green";break;case"no_data":case"nodata":n.color="gray"}return n})));var i,o;r=function(e){let t=[];const n=(0,re.partition)(e,"id"),r=(0,re.groupBy)(n[0],"id");return t=(0,re.map)(r,(e=>e.length>1&&!(0,re.every)(e,cd)?(0,re.find)(e,(e=>"panel-alert"!==e.eventType)):(0,re.head)(e))),t=(0,re.concat)(t,n[1]),t}(r);const s=vd(bd({},me),{state:n.state}),l=(0,e.arrayToDataFrame)(r);return l.meta=vd(bd({},l.meta),{dataTopic:e.DataTopic.Annotations}),s.series=[l],s}}).Component=function({model:e}){const{isHidden:t}=e.useState();return t?null:r().createElement(qc,{layer:e})},Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var yd=Object.defineProperty,Od=Object.defineProperties,wd=Object.getOwnPropertyDescriptors,Sd=Object.getOwnPropertySymbols,xd=Object.prototype.hasOwnProperty,_d=Object.prototype.propertyIsEnumerable,Pd=(e,t,n)=>t in e?yd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Ed extends Q{constructor(){super(...arguments),this.isDataLayer=!0,this._results=new b.ReplaySubject(1),this._dataLayersMerger=new _s}subscribeToAllLayers(e){e.length>0?this.querySub=this._dataLayersMerger.getMergedStream(e).subscribe(this._onLayerUpdateReceived.bind(this)):(this._results.next({origin:this,data:me}),this.setStateHelper({data:me}))}_onLayerUpdateReceived(e){var t;let n=[];for(const r of e)(null==(t=r.data)?void 0:t.series)&&(n=n.concat(r.data.series));const r=(i=((e,t)=>{for(var n in t||(t={}))xd.call(t,n)&&Pd(e,n,t[n]);if(Sd)for(var n of Sd(t))_d.call(t,n)&&Pd(e,n,t[n]);return e})({},me),Od(i,wd({series:n})));var i;this._results.next({origin:this,data:r}),this.setStateHelper({data:r})}getResultsStream(){return this._results}cancelQuery(){var e;null==(e=this.querySub)||e.unsubscribe()}setStateHelper(e){Mt(this,e)}}class Cd extends Ed{constructor(e){var t,n;super({name:null!=(t=e.name)?t:"Data layers",layers:null!=(n=e.layers)?n:[]}),this.addActivationHandler((()=>this._onActivate()))}_onActivate(){return this._subs.add(this.subscribeToState(((e,t)=>{var n;e.layers!==t.layers&&(null==(n=this.querySub)||n.unsubscribe(),this.subscribeToAllLayers(e.layers))}))),this.subscribeToAllLayers(this.state.layers),()=>{var e;null==(e=this.querySub)||e.unsubscribe()}}}Cd.Component=({model:e})=>{const{layers:t}=e.useState();return r().createElement(r().Fragment,null,t.map((e=>r().createElement(e.Component,{model:e,key:e.state.key}))))};var kd=Object.defineProperty,Dd=Object.defineProperties,Td=Object.getOwnPropertyDescriptors,Rd=Object.getOwnPropertySymbols,Id=Object.prototype.hasOwnProperty,Ad=Object.prototype.propertyIsEnumerable,jd=(e,t,n)=>t in e?kd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ld=(e,t)=>{for(var n in t||(t={}))Id.call(t,n)&&jd(e,n,t[n]);if(Rd)for(var n of Rd(t))Ad.call(t,n)&&jd(e,n,t[n]);return e},$d=(e,t)=>Dd(e,Td(t));class Fd extends Q{constructor(e){super(e),this._results=new b.ReplaySubject(1),this._variableDependency=new Js(this,{statePaths:["transformations"],onReferencedVariableValueChanged:()=>this.reprocessTransformations()}),this.addActivationHandler((()=>this.activationHandler()))}activationHandler(){const e=this.getSourceData();return this._subs.add(e.subscribeToState((e=>this.transform(e.data)))),e.state.data&&this.transform(e.state.data),()=>{this._transformSub&&this._transformSub.unsubscribe()}}getSourceData(){if(this.state.$data){if(this.state.$data instanceof Cd)throw new Error("SceneDataLayerSet can not be used as data provider for SceneDataTransformer.");return this.state.$data}if(!this.parent||!this.parent.parent)throw new Error("SceneDataTransformer must either have $data set on it or have a parent.parent with $data");return kl.getData(this.parent.parent)}setContainerWidth(e){this.state.$data&&this.state.$data.setContainerWidth&&this.state.$data.setContainerWidth(e)}isDataReadyToDisplay(){const e=this.getSourceData();return!e.isDataReadyToDisplay||e.isDataReadyToDisplay()}reprocessTransformations(){this.transform(this.getSourceData().state.data,!0)}cancelQuery(){var e,t;null==(t=(e=this.getSourceData()).cancelQuery)||t.call(e)}getResultsStream(){return this._results}clone(e){const t=super.clone(e);return this._prevDataFromSource&&(t._prevDataFromSource=this._prevDataFromSource),t}haveAlreadyTransformedData(e){if(!this._prevDataFromSource)return!1;if(e===this._prevDataFromSource)return!0;const{series:t,annotations:n}=this._prevDataFromSource;return e.series===t&&e.annotations===n&&(this.state.data&&e.state!==this.state.data.state&&this.setState({data:$d(Ld({},this.state.data),{state:e.state})}),!0)}transform(t,n=!1){var r;if(0===this.state.transformations.length||!t)return this._prevDataFromSource=t,this.setState({data:t}),void(t&&this._results.next({origin:this,data:t}));if(!n&&this.haveAlreadyTransformedData(t))return;const i=this.state.transformations.filter((t=>!("options"in t)&&!("topic"in t)||null==t.topic||t.topic===e.DataTopic.Series)).map((e=>"operator"in e?e.operator:e)),o=this.state.transformations.filter((t=>("options"in t||"topic"in t)&&t.topic===e.DataTopic.Annotations)).map((e=>"operator"in e?e.operator:e));this._transformSub&&this._transformSub.unsubscribe();const s={interpolate:e=>{var n;return kl.interpolate(this,e,null==(n=t.request)?void 0:n.scopedVars)}};let l=[(0,e.transformDataFrame)(i,t.series,s)];t.annotations&&t.annotations.length>0&&o.length>0&&l.push((0,e.transformDataFrame)(o,null!=(r=t.annotations)?r:[])),this._transformSub=(0,b.forkJoin)(l).pipe((0,b.map)((e=>{const n=e[0],r=e[1];return $d(Ld({},t),{series:n,annotations:null!=r?r:t.annotations})})),(0,b.catchError)((n=>{var r;console.error("Error transforming data: ",n);const i=(null==(r=this.getSourceData().state.data)?void 0:r.errors)||[],o=(0,a.toDataQueryError)(n);o.message=`Error transforming data: ${o.message}`;const s=$d(Ld({},t),{state:e.LoadingState.Error,errors:[...i,o]});return(0,b.of)(s)}))).subscribe((e=>{this.setState({data:e}),this._results.next({origin:this,data:e}),this._prevDataFromSource=t}))}}class Nd extends Q{}function Md({variable:t,layout:n,showAlways:i,hideLabel:a}){return U(t,{shouldActivateOrKeepAlive:!0}).hide!==e.VariableHide.hideVariable||i?"vertical"===n?r().createElement("div",{className:zd,"data-testid":qt.pages.Dashboard.SubMenu.submenuItem},r().createElement(Vd,{variable:t,layout:n,hideLabel:a}),r().createElement(t.Component,{model:t})):r().createElement("div",{className:Bd,"data-testid":qt.pages.Dashboard.SubMenu.submenuItem},r().createElement(Vd,{variable:t,hideLabel:a}),r().createElement(t.Component,{model:t})):null}function Vd({variable:t,layout:n,hideLabel:i}){var a,o;const{state:s}=t;if(t.state.hide===e.VariableHide.hideLabel||i)return null;const l=`var-${s.key}`,c=null!=(a=s.label)?a:s.name;return r().createElement(zn,{htmlFor:l,isLoading:s.loading,onCancel:()=>{var e;return null==(e=t.onCancel)?void 0:e.call(t)},label:c,error:s.error,layout:n,description:null!=(o=s.description)?o:void 0})}Nd.Component=function({model:e}){const t=kl.getVariables(e).useState();return r().createElement(r().Fragment,null,t.variables.map((t=>r().createElement(Md,{key:t.state.key,variable:t,layout:e.state.layout}))))};const Bd=(0,Ht.css)({display:"flex"}),zd=(0,Ht.css)({display:"flex",flexDirection:"column"});(class extends Q{}).Component=function({model:e}){const t=kl.lookupVariable(e.state.variableName,e);return t?r().createElement(Md,{key:t.state.key,variable:t,layout:e.state.layout,showAlways:!0}):null};class Wd extends Q{constructor(e){super(e),this._variablesThatHaveChanged=new Set,this._variablesToUpdate=new Set,this._updating=new Map,this._variableValueRecorder=new gt,this._variableDependency=new Ud(this._handleParentVariableUpdatesCompleted.bind(this)),this._onActivate=()=>{const e=kl.getTimeRange(this);this._subs.add(this.subscribeToEvent(Re,(e=>this._handleVariableValueChanged(e.payload)))),this._subs.add(e.subscribeToState((()=>{this._refreshTimeRangeBasedVariables()}))),this._subs.add(this.subscribeToState(this._onStateChanged)),this._checkForVariablesThatChangedWhileInactive();for(const e of this.state.variables)this._variableNeedsUpdate(e)&&this._variablesToUpdate.add(e);return this._updateNextBatch(),this._onDeactivate},this._onDeactivate=()=>{var e;for(const t of this._updating.values())null==(e=t.subscription)||e.unsubscribe();for(const e of this.state.variables)this._variablesToUpdate.has(e)||this._updating.has(e)||this._variableValueRecorder.recordCurrentValue(e);this._variablesToUpdate.clear(),this._updating.clear()},this._onStateChanged=(e,t)=>{const n=this._variablesToUpdate.size;for(const n of t.variables)if(!e.variables.includes(n)){const e=this._updating.get(n);(null==e?void 0:e.subscription)&&e.subscription.unsubscribe(),this._updating.delete(n),this._variablesToUpdate.delete(n)}for(const n of e.variables)t.variables.includes(n)||this._variableNeedsUpdate(n)&&this._variablesToUpdate.add(n);0===n&&this._variablesToUpdate.size>0&&this._updateNextBatch()},this.addActivationHandler(this._onActivate)}getByName(e){return this.state.variables.find((t=>t.state.name===e))}_refreshTimeRangeBasedVariables(){for(const t of this.state.variables)"refresh"in t.state&&t.state.refresh===e.VariableRefresh.onTimeRangeChanged&&this._variablesToUpdate.add(t);this._updateNextBatch()}_checkForVariablesThatChangedWhileInactive(){if(this._variableValueRecorder.hasValues())for(const e of this.state.variables)this._variableValueRecorder.hasValueChanged(e)&&(Qd(e,"Changed while in-active"),this._addDependentVariablesToUpdateQueue(e))}_variableNeedsUpdate(e){return!(e.isLazy||!e.validateAndUpdate||this._variableValueRecorder.hasRecordedValue(e)&&(Qd(e,"Skipping updateAndValidate current value valid"),1))}_updateNextBatch(){for(const e of this._variablesToUpdate){if(!e.validateAndUpdate)throw new Error("Variable added to variablesToUpdate but does not have validateAndUpdate");if(this._updating.has(e))continue;if(kl.hasVariableDependencyInLoadingState(e))continue;const t={variable:e};this._updating.set(e,t),Qd(e,"updateAndValidate started"),t.subscription=e.validateAndUpdate().subscribe({next:()=>this._validateAndUpdateCompleted(e),complete:()=>this._validateAndUpdateCompleted(e),error:t=>this._handleVariableError(e,t)})}}_validateAndUpdateCompleted(e){var t;if(!this._updating.has(e))return;const n=this._updating.get(e);null==(t=null==n?void 0:n.subscription)||t.unsubscribe(),this._updating.delete(e),this._variablesToUpdate.delete(e),Qd(e,"updateAndValidate completed"),this._notifyDependentSceneObjects(e),this._updateNextBatch()}cancel(e){var t;const n=this._updating.get(e);null==(t=null==n?void 0:n.subscription)||t.unsubscribe(),this._updating.delete(e),this._variablesToUpdate.delete(e)}_handleVariableError(e,t){var n;const r=this._updating.get(e);null==(n=null==r?void 0:r.subscription)||n.unsubscribe(),this._updating.delete(e),this._variablesToUpdate.delete(e),e.setState({loading:!1,error:t.message}),console.error("SceneVariableSet updateAndValidate error",t),Qd(e,"updateAndValidate error",t),this._notifyDependentSceneObjects(e),this._updateNextBatch()}_handleVariableValueChanged(e){this._variablesThatHaveChanged.add(e),this._addDependentVariablesToUpdateQueue(e),this._updating.has(e)||(this._updateNextBatch(),this._notifyDependentSceneObjects(e))}_handleParentVariableUpdatesCompleted(e,t){t&&this._addDependentVariablesToUpdateQueue(e),this._variablesToUpdate.size>0&&0===this._updating.size&&this._updateNextBatch()}_addDependentVariablesToUpdateQueue(e){for(const t of this.state.variables)t.variableDependency&&t.variableDependency.hasDependencyOn(e.state.name)&&(Qd(t,"Added to update queue, dependant variable value changed"),this._updating.has(t)&&t.onCancel&&t.onCancel(),this._variablesToUpdate.add(t))}_notifyDependentSceneObjects(e){this.parent&&(this._traverseSceneAndNotify(this.parent,e,this._variablesThatHaveChanged.has(e)),this._variablesThatHaveChanged.delete(e))}_traverseSceneAndNotify(e,t,n){if(this!==e&&e.isActive){if(e.state.$variables&&e.state.$variables!==this&&e.state.$variables.getByName(t.state.name))return;e.variableDependency&&e.variableDependency.variableUpdateCompleted(t,n),e.forEachChild((e=>this._traverseSceneAndNotify(e,t,n)))}}isVariableLoadingOrWaitingToUpdate(e){return!(!e.isAncestorLoading||!e.isAncestorLoading())||!(!this._variablesToUpdate.has(e)&&!this._updating.has(e))||kl.hasVariableDependencyInLoadingState(e)}}function Qd(e,t,n){n?ft("SceneVariableSet",`Variable[${e.state.name}]: ${t}`,n):ft("SceneVariableSet",`Variable[${e.state.name}]: ${t}`)}class Ud{constructor(e){this._variableUpdatesCompleted=e,this._emptySet=new Set}getNames(){return this._emptySet}hasDependencyOn(e){return!1}variableUpdateCompleted(e,t){this._variableUpdatesCompleted(e,t)}}Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var qd=Object.defineProperty,Hd=Object.getOwnPropertySymbols,Gd=Object.prototype.hasOwnProperty,Xd=Object.prototype.propertyIsEnumerable,Yd=(e,t,n)=>t in e?qd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Zd extends Vt{constructor(e){super(((e,t)=>{for(var n in t||(t={}))Gd.call(t,n)&&Yd(e,n,t[n]);if(Hd)for(var n of Hd(t))Xd.call(t,n)&&Yd(e,n,t[n]);return e})({type:"custom",query:"",value:"",text:"",options:[],name:""},e)),this._variableDependency=new Js(this,{statePaths:["query"]})}getValueOptions(e){var t;const n=(null!=(t=kl.interpolate(this,this.state.query).match(/(?:\\,|[^,])+/g))?t:[]).map((e=>{var t;e=e.replace(/\\,/g,",");const n=null!=(t=/^(.+)\s:\s(.+)$/g.exec(e))?t:[];if(3===n.length){const[,e,t]=n;return{label:e.trim(),value:t.trim()}}return{label:e.trim(),value:e.trim()}}));return(0,b.of)(n)}}Zd.Component=({model:e})=>xn(e);var Kd=Object.defineProperty,Jd=Object.getOwnPropertySymbols,ep=Object.prototype.hasOwnProperty,tp=Object.prototype.propertyIsEnumerable,np=(e,t,n)=>t in e?Kd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class rp extends Vt{constructor(e){super(((e,t)=>{for(var n in t||(t={}))ep.call(t,n)&&np(e,n,t[n]);if(Jd)for(var n of Jd(t))tp.call(t,n)&&np(e,n,t[n]);return e})({type:"datasource",value:"",text:"",options:[],name:"",regex:"",pluginId:""},e)),this._variableDependency=new Js(this,{statePaths:["regex"]})}getValueOptions(t){if(!this.state.pluginId)return(0,b.of)([]);const n=(0,a.getDataSourceSrv)().getList({metrics:!0,variables:!1,pluginId:this.state.pluginId});let r;if(this.state.regex){const t=kl.interpolate(this,this.state.regex,void 0,"regex");r=(0,e.stringToJsRegex)(t)}const i=[];for(let e=0;e<n.length;e++){const t=n[e];ip(t,r)&&i.push({label:t.name,value:t.uid}),this.state.defaultOptionEnabled&&ap(t,r)&&i.push({label:"default",value:"default"})}return 0===i.length?this.setState({error:"No data sources found"}):this.state.error&&this.setState({error:null}),(0,b.of)(i)}}function ip(e,t){return!t||t.exec(e.name)}function ap(e,t){return!!e.isDefault&&(!t||t.exec("default"))}function op(e,t){const n=["A","B","C","D","E","F","G","H"],r=[];if(t>5)return[];for(const i of n){const n=`${e}${i}`;r.push({name:n,children:op(n,t+1)})}return r}function sp(e,t,n){if(n>=t.length)return e;if("*"===t[n])return e;const r=t[n];let i=[],a=[r];r.startsWith("{")&&(a=r.replace(/\{|\}/g,"").split(","));for(const r of e)for(const e of a)if(-1!==e.indexOf("*")){const a=e.replace("*","");new RegExp(`^${a}.*`,"gi").test(r.name)&&(i=i.concat(sp([r],t,n+1)))}else r.name===e&&(i=i.concat(sp(r.children,t,n+1)));return i}function lp(e){return 0===e.indexOf("value")?[{name:e,children:[]}]:sp(op("",0),e.split("."),0)}rp.Component=({model:e})=>xn(e);var cp=Object.defineProperty,up=Object.getOwnPropertySymbols,dp=Object.prototype.hasOwnProperty,pp=Object.prototype.propertyIsEnumerable,fp=(e,t,n)=>t in e?cp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;function hp({model:e}){const{value:n,key:i,loading:a}=e.useState(),o=(0,t.useCallback)((t=>{e.setValue(t.currentTarget.value)}),[e]),s=(0,t.useCallback)((t=>{"Enter"===t.key&&e.setValue(t.currentTarget.value)}),[e]);return r().createElement(Wt.AutoSizeInput,{id:i,placeholder:"Enter value",minWidth:15,value:n,loading:a,onBlur:o,onKeyDown:s})}(class extends Vt{constructor(t,n=!1){super(((e,t)=>{for(var n in t||(t={}))dp.call(t,n)&&fp(e,n,t[n]);if(up)for(var n of up(t))pp.call(t,n)&&fp(e,n,t[n]);return e})({type:"custom",name:"Test",value:"Value",text:"Text",query:"Query",options:[],refresh:e.VariableRefresh.onDashboardLoad,updateOptions:!0},t)),this.completeUpdate=new b.Subject,this.isGettingValues=!0,this.getValueOptionsCount=0,this.isLazy=!1,this._variableDependency=new Js(this,{statePaths:["query"]}),this.isLazy=n}getValueOptions(e){const{delayMs:t}=this.state;this.getValueOptionsCount+=1;const n=kl.getQueryController(this);return new b.Observable((e=>{const r={type:"variable",origin:this,cancel:()=>e.complete()};if(n&&n.queryStarted(r),this.setState({loading:!0}),this.state.throwError)throw new Error(this.state.throwError);const i=kl.interpolate(this,this.state.query),a=this.getOptions(i),o=this.completeUpdate.subscribe({next:()=>{const t={issuedQuery:i,loading:!1};this.state.updateOptions&&(t.options=a),this.setState(t),e.next(a),e.complete()}});let s;return t?s=window.setTimeout((()=>this.signalUpdateCompleted()),t):0===t&&this.signalUpdateCompleted(),this.isGettingValues=!0,()=>{o.unsubscribe(),window.clearTimeout(s),this.isGettingValues=!1,this.state.loading&&this.setState({loading:!1}),n&&n.queryCompleted(r)}}))}cancel(){const e=ee(this,(e=>e instanceof Wd?e:void 0));null==e||e.cancel(this)}getOptions(e){return this.state.optionsToReturn?this.state.optionsToReturn:lp(e).map((e=>({label:e.name,value:e.name})))}signalUpdateCompleted(){this.completeUpdate.next(1)}}).Component=({model:e})=>xn(e);var gp=Object.defineProperty,mp=Object.getOwnPropertySymbols,bp=Object.prototype.hasOwnProperty,vp=Object.prototype.propertyIsEnumerable,yp=(e,t,n)=>t in e?gp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;(class extends Q{constructor(e){super(((e,t)=>{for(var n in t||(t={}))bp.call(t,n)&&yp(e,n,t[n]);if(mp)for(var n of mp(t))vp.call(t,n)&&yp(e,n,t[n]);return e})({type:"textbox",value:"",name:""},e)),this._urlSync=new be(this,{keys:()=>[this.getKey()]})}getValue(){return this.state.value}setValue(e){e!==this.state.value&&(this.setState({value:e}),this.publishEvent(new Re(this),!0))}getKey(){return`var-${this.state.name}`}getUrlState(){return{[this.getKey()]:this.state.value}}updateFromUrl(e){const t=e[this.getKey()];"string"==typeof t&&this.setValue(t)}}).Component=({model:e})=>r().createElement(hp,{model:e}),Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var Op=Object.defineProperty,wp=Object.getOwnPropertySymbols,Sp=Object.prototype.hasOwnProperty,xp=Object.prototype.propertyIsEnumerable,_p=(e,t,n)=>t in e?Op(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;(class extends Q{constructor(e){super(((e,t)=>{for(var n in t||(t={}))Sp.call(t,n)&&_p(e,n,t[n]);if(wp)for(var n of wp(t))xp.call(t,n)&&_p(e,n,t[n]);return e})({type:"interval",value:"",intervals:["1m","10m","30m","1h","6h","12h","1d","7d","14d","30d"],name:"",autoStepCount:30,autoMinInterval:"10s",autoEnabled:!1,refresh:Ll.onTimeRangeChanged},e)),this._onChange=e=>{this.setState({value:e.value}),this.publishEvent(new Re(this),!0)},this._urlSync=new be(this,{keys:()=>[this.getKey()]})}getKey(){return`var-${this.state.name}`}getUrlState(){return{[this.getKey()]:this.state.value}}updateFromUrl(e){const t={},n=e[this.getKey()];"string"==typeof n&&(n.startsWith("$__auto_interval_")?t.value=He:t.value=n),this.setState(t)}getOptionsForSelect(){const{value:e,intervals:t,autoEnabled:n}=this.state;let r=t.map((e=>({value:e,label:e})));return n&&(r=[{value:He,label:"Auto"},...r]),e&&!r.some((t=>t.value===e))&&r.push({value:e,label:e}),r}getValue(){const{value:e,autoStepCount:t,autoMinInterval:n}=this.state;return e===He?this.getAutoRefreshInteval(t,n):e}getAutoRefreshInteval(t,n){const r=kl.getTimeRange(this).state.value;return e.rangeUtil.calculateInterval(r,t,n).interval}validateAndUpdate(){const{value:e,intervals:t}=this.state;let n=!1;if(e===He)n=!0;else if(!e&&t.length>0){const e=t[0];this.setState({value:e}),n=!0}return n&&this.publishEvent(new Re(this),!0),(0,b.of)({})}}).Component=({model:e})=>{const{key:t,value:n}=e.useState();return r().createElement(Wt.Select,{id:t,placeholder:"Select value",width:"auto",value:n,tabSelectsValue:!1,options:e.getOptionsForSelect(),onChange:e._onChange})};var Pp,Ep,Cp=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)},kp=(e,t,n)=>(Cp(e,t,"read from private field"),n?n.call(e):t.get(e)),Dp=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},Tp=(e,t,n,r)=>(Cp(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n);class Rp extends e.BusEventWithPayload{}Rp.type="new-scene-object-added";class Ip{constructor(e={}){this._urlKeyMapper=new Dl,this._paramsCache=new Ap,this._options=e}initSync(e){var t;if(this._subs&&(ft("UrlSyncManager","Unregister previous scene state subscription",null==(t=this._sceneRoot)?void 0:t.state.key),this._subs.unsubscribe()),ft("UrlSyncManager","init",e.state.key),this._sceneRoot=e,this._subs=new b.Subscription,this._subs.add(e.subscribeToEvent(A,(e=>{this.handleSceneObjectStateChanged(e.payload.changedObject)}))),this._subs.add(e.subscribeToEvent(Rp,(e=>{this.handleNewObject(e.payload)}))),this._urlKeyMapper.clear(),this._lastLocation=a.locationService.getLocation(),this.handleNewObject(this._sceneRoot),this._options.updateUrlOnInit){const t=Rl(e);(function(e,t){for(let n in e)if(!jl(t.getAll(n),e[n]))return!0;return!1})(t,this._paramsCache.getParams())&&a.locationService.partial(t,!0)}}cleanUp(e){this._sceneRoot===e&&(ft("UrlSyncManager","Clean up"),this._subs&&(this._subs.unsubscribe(),this._subs=void 0,ft("UrlSyncManager","Root deactived, unsub to state","same key",this._sceneRoot.state.key===e.state.key)),this._sceneRoot=void 0,this._lastLocation=void 0)}handleNewLocation(e){this._sceneRoot&&this._lastLocation!==e&&(ft("UrlSyncManager","handleNewLocation"),this._lastLocation=e,Il(this._sceneRoot,this._paramsCache.getParams(),this._urlKeyMapper))}handleNewObject(e){this._sceneRoot&&Il(e,this._paramsCache.getParams(),this._urlKeyMapper)}handleSceneObjectStateChanged(e){var t,n;if(!e.urlSync)return;const r=e.urlSync.getUrlState(),i=a.locationService.getSearch(),o={};for(const[t,n]of Object.entries(r)){const r=this._urlKeyMapper.getUniqueKey(t,e);jl(i.getAll(r),n)||(o[r]=n)}if(Object.keys(o).length>0){const i=!0!==(null==(n=(t=e.urlSync).shouldCreateHistoryStep)?void 0:n.call(t,r));ft("UrlSyncManager","onStateChange updating URL"),a.locationService.partial(o,i),this._lastLocation=a.locationService.getLocation()}}getUrlState(e){return Rl(e)}}class Ap{constructor(){Dp(this,Pp,void 0),Dp(this,Ep,void 0)}getParams(){const e=a.locationService.getLocation();return kp(this,Ep)===e||(Tp(this,Ep,e),Tp(this,Pp,new URLSearchParams(e.search))),kp(this,Pp)}}Pp=new WeakMap,Ep=new WeakMap;class jp extends Q{constructor(e){super(e),this.addActivationHandler((()=>{const e=function(e){const t=window.__grafanaSceneContext;return ft("setWindowGrafanaScene","set window.__grafanaSceneContext",e),window.__grafanaSceneContext=e,()=>{window.__grafanaSceneContext===e&&(ft("setWindowGrafanaScene","restore window.__grafanaSceneContext",t),window.__grafanaSceneContext=t)}}(this);return()=>{e()}}))}}jp.Component=function({model:e}){const{body:t,controls:n}=e.useState(),i=(0,Wt.useStyles2)(Lp);return r().createElement("div",{className:i.container},n&&r().createElement("div",{className:i.controls},n.map((e=>r().createElement(e.Component,{key:e.state.key,model:e})))),r().createElement("div",{className:i.body},r().createElement(t.Component,{model:t})))};const Lp=e=>({container:(0,Ht.css)({flexGrow:1,display:"flex",gap:e.spacing(2),minHeight:"100%",flexDirection:"column"}),body:(0,Ht.css)({flexGrow:1,display:"flex",gap:e.spacing(1)}),controls:(0,Ht.css)({display:"flex",gap:e.spacing(2),alignItems:"flex-end",flexWrap:"wrap"})});function $p(e){return e instanceof Lf}(class extends Q{addItem(e){this.setState({items:this.state.items?[...this.state.items,e]:[e]})}setItems(e){this.setState({items:e})}}).Component=function({model:e}){const{items:n=[]}=e.useState(),i=r().useRef(null);(0,t.useEffect)((()=>{i.current&&i.current.focus()}),[]);const a=e=>e.map((e=>{switch(e.type){case"divider":return r().createElement(Wt.Menu.Divider,{key:e.text});case"group":return r().createElement(Wt.Menu.Group,{key:e.text,label:e.text},e.subMenu?a(e.subMenu):void 0);default:return r().createElement(Wt.Menu.Item,{key:e.text,label:e.text,icon:e.iconClassName,childItems:e.subMenu?a(e.subMenu):void 0,url:e.href,onClick:e.onClick,shortcut:e.shortcut,testId:qt.components.Panels.Panel.menuItems(e.text)})}}));return r().createElement(Wt.Menu,{ref:i},a(n))},class extends Q{}.Component=function({model:e}){const{body:t}=e.useState(),n=e.parent;if(n&&!(n instanceof Pf)&&!$p(n))throw new Error("SceneGridItem must be a child of SceneGridLayout or SceneGridRow");return t?r().createElement(t.Component,{model:t}):null};var Fp=g(548),Np=g.n(Fp);var Mp=Object.defineProperty,Vp=Object.getOwnPropertySymbols,Bp=Object.prototype.hasOwnProperty,zp=Object.prototype.propertyIsEnumerable,Wp=(e,t,n)=>t in e?Mp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;function Qp(){const e=(0,t.useRef)(void 0);return null!=e.current||(e.current=(0,re.uniqueId)()),e.current}const Up=r().forwardRef(((e,n)=>{var i=e,{children:a,onLoad:o,onChange:s,className:l}=i,c=((e,t)=>{var n={};for(var r in e)Bp.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&Vp)for(var r of Vp(e))t.indexOf(r)<0&&zp.call(e,r)&&(n[r]=e[r]);return n})(i,["children","onLoad","onChange","className"]);const u=Qp(),{hideEmpty:d}=(0,Wt.useStyles2)(qp),[p,f]=(0,t.useState)(!1),[h,g]=(0,t.useState)(!1),m=(0,t.useRef)(null);var b;(0,t.useImperativeHandle)(n,(()=>m.current)),b=()=>{Up.addCallback(u,(e=>{!p&&e.isIntersecting&&(f(!0),null==o||o()),g(e.isIntersecting),null==s||s(e.isIntersecting)}));const e=m.current;return e&&Up.observer.observe(e),()=>{e&&Up.observer.unobserve(e),delete Up.callbacks[u],0===Object.keys(Up.callbacks).length&&Up.observer.disconnect()}},(0,t.useEffect)(b,[]);const v=`${p?d:""} ${l}`;return r().createElement("div",((e,t)=>{for(var n in t||(t={}))Bp.call(t,n)&&Wp(e,n,t[n]);if(Vp)for(var n of Vp(t))zp.call(t,n)&&Wp(e,n,t[n]);return e})({id:u,ref:m,className:v},c),p&&("function"==typeof a?a({isInView:h}):a))}));function qp(){return{hideEmpty:(0,Ht.css)({"&:empty":{display:"none"}})}}Up.displayName="LazyLoader",Up.callbacks={},Up.addCallback=(e,t)=>Up.callbacks[e]=t,Up.observer=new IntersectionObserver((e=>{for(const t of e)"function"==typeof Up.callbacks[t.target.id]&&Up.callbacks[t.target.id](t)}),{rootMargin:"100px"});var Hp=Object.defineProperty,Gp=Object.defineProperties,Xp=Object.getOwnPropertyDescriptors,Yp=Object.getOwnPropertySymbols,Zp=Object.prototype.hasOwnProperty,Kp=Object.prototype.propertyIsEnumerable,Jp=(e,t,n)=>t in e?Hp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ef=(e,t)=>{for(var n in t||(t={}))Zp.call(t,n)&&Jp(e,n,t[n]);if(Yp)for(var n of Yp(t))Kp.call(t,n)&&Jp(e,n,t[n]);return e},tf=(e,t)=>Gp(e,Xp(t)),nf=(e,t)=>{var n={};for(var r in e)Zp.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&Yp)for(var r of Yp(e))t.indexOf(r)<0&&Kp.call(e,r)&&(n[r]=e[r]);return n};const rf=r().forwardRef(((e,t)=>{var n;const i=e,{grid:a,layoutItem:o,index:s,totalCount:l,isLazy:c,style:u,onLoad:d,onChange:p,children:f}=i,h=nf(i,["grid","layoutItem","index","totalCount","isLazy","style","onLoad","onChange","children"]),g=a.getSceneLayoutChild(o.i),m=null==(n=g.getClassName)?void 0:n.call(g),b=r().createElement(g.Component,{model:g,key:g.state.key});return c?r().createElement(Up,tf(ef({},h),{key:g.state.key,"data-griditem-key":g.state.key,className:(0,Ht.cx)(m,e.className),style:u,ref:t}),b,f):r().createElement("div",tf(ef({},h),{ref:t,key:g.state.key,"data-griditem-key":g.state.key,className:(0,Ht.cx)(m,e.className),style:u}),b,f)}));function af(e,t,n){e.current?t?e.current.classList.add("react-grid-layout--enable-move-animations"):e.current.classList.remove("react-grid-layout--enable-move-animations"):n||setTimeout((()=>af(e,t,!0)),50)}rf.displayName="GridItemWrapper";const of=r().forwardRef(((e,t)=>{var n=nf(e,["handleAxis"]);const i=(0,Wt.useStyles2)(sf);return r().createElement("div",tf(ef({ref:t},n),{className:`${i} scene-resize-handle`}),r().createElement("svg",{width:"16px",height:"16px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r().createElement("path",{d:"M21 15L15 21M21 8L8 21",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})))}));function sf(e){return(0,Ht.css)({position:"absolute",bottom:0,right:0,zIndex:999,padding:e.spacing(1.5,0,0,1.5),color:e.colors.border.strong,cursor:"se-resize","&:hover":{color:e.colors.text.link},svg:{display:"block"},".react-resizable-hide &":{display:"none"}})}of.displayName="ResizeHandle";var lf=Object.defineProperty,cf=Object.defineProperties,uf=Object.getOwnPropertyDescriptors,df=Object.getOwnPropertySymbols,pf=Object.prototype.hasOwnProperty,ff=Object.prototype.propertyIsEnumerable,hf=(e,t,n)=>t in e?lf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var gf=Object.defineProperty,mf=Object.defineProperties,bf=Object.getOwnPropertyDescriptors,vf=Object.getOwnPropertySymbols,yf=Object.prototype.hasOwnProperty,Of=Object.prototype.propertyIsEnumerable,wf=(e,t,n)=>t in e?gf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Sf=(e,t)=>{for(var n in t||(t={}))yf.call(t,n)&&wf(e,n,t[n]);if(vf)for(var n of vf(t))Of.call(t,n)&&wf(e,n,t[n]);return e},xf=(e,t)=>mf(e,bf(t));const _f=class extends Q{constructor(e){super(xf(Sf({},e),{children:Ef(e.children)})),this._skipOnLayoutChange=!1,this._oldLayout=[],this._loadOldLayout=!1,this.onLayoutChange=e=>{if(this._skipOnLayoutChange)this._skipOnLayoutChange=!1;else{this._loadOldLayout&&(e=[...this._oldLayout],this._loadOldLayout=!1);for(const r of e){const e=this.getSceneLayoutChild(r.i),i={x:r.x,y:r.y,width:r.w,height:r.h};n=i,((t=e.state).x!==n.x||t.y!==n.y||t.width!==n.width||t.height!==n.height)&&e.setState(Sf({},i))}var t,n;this.setState({children:Ef(this.state.children)})}},this.onResizeStop=(e,t,n)=>{this.getSceneLayoutChild(n.i).setState({width:n.w,height:n.h})},this.onDragStart=e=>{this._oldLayout=[...e]},this.onDragStop=(e,t,n)=>{const r=this.getSceneLayoutChild(n.i);e=Cf(e);for(let t=0;t<e.length;t++){const n=e[t],r=this.getSceneLayoutChild(n.i),i=r.state;(null==i?void 0:i.x)===n.x&&(null==i?void 0:i.y)===n.y||r.setState({x:n.x,y:n.y})}const i=e.findIndex((e=>e.i===n.i));let a=this.findGridItemSceneParent(e,i-1),o=this.state.children;r instanceof Lf&&a instanceof Lf&&(this.isRowDropValid(e,n,i)||(this._loadOldLayout=!0),a=this),a!==r.parent&&(o=this.moveChildTo(r,a)),this.setState({children:Ef(o)}),this._skipOnLayoutChange=!0}}isDraggable(){var e;return null!=(e=this.state.isDraggable)&&e}getDragClass(){return`grid-drag-handle-${this.state.key}`}getDragClassCancel(){return"grid-drag-cancel"}toggleRow(e){var t,n;if(!e.state.isCollapsed)return e.setState({isCollapsed:!0}),void this.setState({});const r=e.state.children;if(0===r.length)return e.setState({isCollapsed:!1}),void this.setState({});const i=e.state.y,a=(null!=(t=r[0].state.y)?t:i)-(i+1);let o=i;for(const e of r){const t=Sf({},e.state);t.y=null!=(n=t.y)?n:i,t.y-=a,t.y!==e.state.y&&e.setState(t),o=Math.max(o,Number(t.y)+Number(t.height))}const s=o-i-1;for(const t of this.state.children)if(t.state.y>i&&this.pushChildDown(t,s),$p(t)&&t!==e)for(const e of t.state.children)e.state.y>i&&this.pushChildDown(e,s);e.setState({isCollapsed:!1}),this.setState({})}ignoreLayoutChange(e){this._skipOnLayoutChange=e}getSceneLayoutChild(e){for(const t of this.state.children){if(t.state.key===e)return t;if(t instanceof Lf)for(const n of t.state.children)if(n.state.key===e)return n}throw new Error("Scene layout child not found for GridItem")}pushChildDown(e,t){e.setState({y:e.state.y+t})}findGridItemSceneParent(e,t){for(let n=t;n>=0;n--){const t=e[n],r=this.getSceneLayoutChild(t.i);if(r instanceof Lf)return r.state.isCollapsed?this:r}return this}isRowDropValid(e,t,n){if(e[e.length-1].i===t.i)return!0;const r=this.getSceneLayoutChild(e[n+1].i);return r instanceof Lf||r.parent instanceof _f}moveChildTo(e,t){const n=e.parent;let r=this.state.children;const i=e.clone({key:e.state.key});if(n instanceof Lf){const a=n.clone();if(a.setState({children:a.state.children.filter((t=>t.state.key!==e.state.key))}),r=r.map((e=>e===n?a:e)),t instanceof Lf){const e=t.clone();e.setState({children:[...e.state.children,i]}),r=r.map((n=>n===t?e:n))}else r=[...r,i]}else if(!(t instanceof _f)){r=r.filter((t=>t.state.key!==e.state.key));const n=t.clone();n.setState({children:[...n.state.children,i]}),r=r.map((e=>e===t?n:e))}return r}toGridCell(e){var t,n;const r=e.state;let i=null!=(t=r.x)?t:0,a=null!=(n=r.y)?n:0;const o=Number.isInteger(Number(r.width))?Number(r.width):4,s=Number.isInteger(Number(r.height))?Number(r.height):4;let l=e.state.isDraggable,c=e.state.isResizable;return e instanceof Lf&&(l=!!e.state.isCollapsed,c=!1),{i:e.state.key,x:i,y:a,h:s,w:o,isResizable:c,isDraggable:l}}buildGridLayout(e,t){let n=[];for(const e of this.state.children)if(n.push(this.toGridCell(e)),e instanceof Lf&&!e.state.isCollapsed)for(const t of e.state.children)n.push(this.toGridCell(t));return n=Cf(n),this.state.UNSAFE_fitPanels&&(n=function(e,t){const n=t-32,r=Math.max(...e.map((e=>e.h+e.y)))/Math.floor(n/38);return e.map((e=>{return t=((e,t)=>{for(var n in t||(t={}))pf.call(t,n)&&hf(e,n,t[n]);if(df)for(var n of df(t))ff.call(t,n)&&hf(e,n,t[n]);return e})({},e),n={y:Math.round(e.y/r)||0,h:Math.round(e.h/r)||1},cf(t,uf(n));var t,n}))}(n,t)),e<768?(this._skipOnLayoutChange=!0,n.map((e=>xf(Sf({},e),{w:24})))):(this._skipOnLayoutChange=!1,n)}};let Pf=_f;function Ef(e){return e.forEach((e=>{e instanceof Lf&&e.setState({children:Ef(e.state.children)})})),[...e].sort(((e,t)=>e.state.y-t.state.y||e.state.x-t.state.x))}function Cf(e){return[...e].sort(((e,t)=>e.y-t.y||e.x-t.x))}Pf.Component=function({model:e}){const{children:n,isLazy:i,isDraggable:a,isResizable:o}=e.useState(),[s,{width:l,height:c}]=Yl(),u=(0,t.useRef)(null);return(0,t.useEffect)((()=>{af(u,!!a)}),[a]),function(e){if(e.some((e=>void 0===e.state.height||void 0===e.state.width||void 0===e.state.x||void 0===e.state.y)))throw new Error("All children must have a size specified")}(n),r().createElement("div",{ref:s,style:{flex:"1 1 auto",position:"relative",zIndex:1,width:"100%"}},((t,n)=>{if(!t||!n)return null;const s=e.buildGridLayout(t,n);return r().createElement("div",{ref:u,style:{width:`${t}px`,height:"100%"},className:"react-grid-layout"},r().createElement(Np(),{width:t,isDraggable:a&&t>768,isResizable:null!=o&&o,containerPadding:[0,0],useCSSTransforms:!0,margin:[8,8],cols:24,rowHeight:30,draggableHandle:`.grid-drag-handle-${e.state.key}`,draggableCancel:".grid-drag-cancel",layout:s,onDragStart:e.onDragStart,onDragStop:e.onDragStop,onResizeStop:e.onResizeStop,onLayoutChange:e.onLayoutChange,isBounded:!1,resizeHandle:r().createElement(of,null)},s.map(((t,n)=>r().createElement(rf,{key:t.i,grid:e,layoutItem:t,index:n,isLazy:i,totalCount:s.length})))))})(l,c))};var kf=Object.defineProperty,Df=Object.defineProperties,Tf=Object.getOwnPropertyDescriptors,Rf=Object.getOwnPropertySymbols,If=Object.prototype.hasOwnProperty,Af=Object.prototype.propertyIsEnumerable,jf=(e,t,n)=>t in e?kf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Lf extends Q{constructor(e){var t;super((t=((e,t)=>{for(var n in t||(t={}))If.call(t,n)&&jf(e,n,t[n]);if(Rf)for(var n of Rf(t))Af.call(t,n)&&jf(e,n,t[n]);return e})({children:e.children||[],isCollapsible:e.isCollapsible||!0,title:e.title||""},e),Df(t,Tf({x:0,height:1,width:24})))),this._variableDependency=new Js(this,{statePaths:["title"]}),this.onCollapseToggle=()=>{this.state.isCollapsible&&this.getGridLayout().toggleRow(this)}}getGridLayout(){const e=this.parent;if(!(e&&e instanceof Pf))throw new Error("SceneGridRow must be a child of SceneGridLayout");return e}getUrlState(){return{rowc:this.state.isCollapsed?"1":"0"}}updateFromUrl(e){null!=e.rowc&&e.rowc!==this.getUrlState().rowc&&this.onCollapseToggle()}}Lf.Component=function({model:e}){const t=(0,Wt.useStyles2)($f),{isCollapsible:n,isCollapsed:i,title:a,actions:o,children:s}=e.useState(),l=e.getGridLayout(),c=l.getDragClass(),u=l.isDraggable(),d=s?s.length:0,p=1===d?"panel":"panels";return r().createElement("div",{className:(0,Ht.cx)(t.row,i&&t.rowCollapsed)},r().createElement("div",{className:t.rowTitleAndActionsGroup},r().createElement("button",{onClick:e.onCollapseToggle,className:t.rowTitleButton,"aria-label":i?"Expand row":"Collapse row","data-testid":qt.components.DashboardRow.title(kl.interpolate(e,a,void 0,"text"))},n&&r().createElement(Wt.Icon,{name:i?"angle-right":"angle-down"}),r().createElement("span",{className:t.rowTitle,role:"heading"},kl.interpolate(e,a,void 0,"text"))),r().createElement("span",{className:(0,Ht.cx)(t.panelCount,i&&t.panelCountCollapsed)},"(",d," ",p,")"),o&&r().createElement("div",{className:t.rowActions},r().createElement(o.Component,{model:o}))),u&&i&&r().createElement("div",{className:(0,Ht.cx)(t.dragHandle,c)},r().createElement(Wt.Icon,{name:"draggabledots"})))};const $f=e=>({row:(0,Ht.css)({width:"100%",height:"30px",display:"flex",justifyContent:"space-between",gap:e.spacing(1)}),rowTitleButton:(0,Ht.css)({display:"flex",alignItems:"center",cursor:"pointer",background:"transparent",border:"none",gap:e.spacing(1)}),rowCollapsed:(0,Ht.css)({borderBottom:`1px solid ${e.colors.border.weak}`}),rowTitle:(0,Ht.css)({fontSize:e.typography.h5.fontSize,fontWeight:e.typography.fontWeightMedium}),collapsedInfo:(0,Ht.css)({fontSize:e.typography.bodySmall.fontSize,color:e.colors.text.secondary,display:"flex",alignItems:"center",flexGrow:1}),rowTitleAndActionsGroup:(0,Ht.css)({display:"flex","&:hover, &:focus-within":{"& > div":{opacity:1}}}),rowActions:(0,Ht.css)({display:"flex",opacity:0,transition:"200ms opacity ease-in 200ms","&:hover, &:focus-within":{opacity:1}}),dragHandle:(0,Ht.css)({display:"flex",padding:e.spacing(0,1),alignItems:"center",justifyContent:"flex-end",cursor:"move",color:e.colors.text.secondary,"&:hover":{color:e.colors.text.primary}}),panelCount:(0,Ht.css)({paddingLeft:e.spacing(2),color:e.colors.text.secondary,fontStyle:"italic",fontSize:e.typography.size.sm,fontWeight:"normal",display:"none",lineHeight:"30px"}),panelCountCollapsed:(0,Ht.css)({display:"inline-block"})});(class extends Q{constructor(){super(...arguments),this.onToggle=()=>{this.setState({isCollapsed:!this.state.isCollapsed})},this.onRemove=()=>{const e=this.parent;"body"in e.state&&e.setState({body:void 0})}}}).Component=function({model:e}){const{title:t,isCollapsed:n,canCollapse:i,canRemove:a,body:o,controls:s}=e.useState(),l=(0,Wt.useStyles2)($f),c=(0,Wt.useStyles2)(Ff),u=(null!=s?s:[]).map((e=>r().createElement(e.Component,{key:e.state.key,model:e})));return a&&u.push(r().createElement(Wt.ToolbarButton,{icon:"times",variant:"default",onClick:e.onRemove,key:"remove-button","aria-label":"Remove scene"})),r().createElement("div",{className:c.wrapper},r().createElement("div",{className:(0,Ht.cx)(c.row,n&&c.rowCollapsed)},r().createElement("button",{onClick:e.onToggle,className:l.rowTitleButton,"aria-label":n?"Expand scene":"Collapse scene"},i&&r().createElement(Wt.Icon,{name:n?"angle-right":"angle-down"}),r().createElement("span",{className:l.rowTitle,role:"heading"},kl.interpolate(e,t,void 0,"text"))),r().createElement("div",{className:c.actions},u)),!n&&r().createElement(o.Component,{model:o}))};const Ff=e=>({wrapper:(0,Ht.css)({display:"flex",flexDirection:"column",flexGrow:1,gap:e.spacing(1)}),row:(0,Ht.css)({width:"100%",display:"flex",justifyContent:"space-between",gap:e.spacing(1)}),rowCollapsed:(0,Ht.css)({borderBottom:`1px solid ${e.colors.border.weak}`,paddingBottom:e.spacing(1)}),actions:(0,Ht.css)({display:"flex",alignItems:"center",gap:e.spacing(1),justifyContent:"flex-end",flexGrow:1})});(class extends Q{constructor(){super(...arguments),this._variableDependency=new Js(this,{statePaths:["text"]})}}).Component=({model:e})=>{const{text:t,fontSize:n=20,align:i="left",key:a,spacing:o}=e.useState(),s=(0,Wt.useTheme2)(),l=(0,Ht.css)({fontSize:n,display:"flex",flexGrow:1,alignItems:"center",padding:o?s.spacing(o,0):void 0,justifyContent:i});return r().createElement("div",{className:l,"data-testid":a},kl.interpolate(e,t))},class extends Q{}.Component=({model:e})=>{const t=e.useState();return r().createElement(Wt.ToolbarButton,{onClick:t.onClick,icon:t.icon})},class extends Q{}.Component=({model:e})=>{const t=e.useState();return r().createElement("div",{style:{display:"flex"}},t.label&&r().createElement(zn,{label:t.label}),r().createElement(Wt.Input,{defaultValue:t.value,width:8,onBlur:t=>{e.state.onChange(parseInt(t.currentTarget.value,10))}}))};class Nf extends Q{constructor(){super(...arguments),this.onZoom=()=>{const t=kl.getTimeRange(this),n=function(t,n){const r=t.to.valueOf()-t.from.valueOf(),i=t.to.valueOf()-r/2,a=0===r?3e4:2*r,o=i+a/2,s=i-a/2;return{from:(0,e.toUtc)(s),to:(0,e.toUtc)(o),raw:{from:(0,e.toUtc)(s),to:(0,e.toUtc)(o)}}}(t.state.value);t.onTimeRangeChange(n)},this.onChangeFiscalYearStartMonth=e=>{kl.getTimeRange(this).setState({fiscalYearStartMonth:e})},this.toAbsolute=()=>{const t=kl.getTimeRange(this),n=t.state.value,r=(0,e.toUtc)(n.from),i=(0,e.toUtc)(n.to);t.onTimeRangeChange({from:r,to:i,raw:{from:r,to:i}})},this.onMoveBackward=()=>{const e=kl.getTimeRange(this),{state:{value:t}}=e;e.onTimeRangeChange(Vf(Mf.Backward,t,Date.now()))},this.onMoveForward=()=>{const e=kl.getTimeRange(this),{state:{value:t}}=e;e.onTimeRangeChange(Vf(Mf.Forward,t,Date.now()))}}}Nf.Component=function({model:e}){const{hidePicker:t,isOnCanvas:n}=e.useState(),i=kl.getTimeRange(e),a=i.getTimeZone(),o=i.useState();return t?null:r().createElement(Wt.TimeRangePicker,{isOnCanvas:null==n||n,value:o.value,onChange:i.onTimeRangeChange,timeZone:a,fiscalYearStartMonth:o.fiscalYearStartMonth,onMoveBackward:e.onMoveBackward,onMoveForward:e.onMoveForward,onZoom:e.onZoom,onChangeTimeZone:i.onTimeZoneChange,onChangeFiscalYearStartMonth:e.onChangeFiscalYearStartMonth})};var Mf=(e=>(e[e.Backward=0]="Backward",e[e.Forward=1]="Forward",e))(Mf||{});function Vf(t,n,r){const i=n.to.valueOf(),a=n.from.valueOf(),o=(i-a)/2;let s,l;0===t?(s=a-o,l=i-o):(s=a+o,l=i+o,l>r&&i<r&&(l=r,s=a));const c=(0,e.toUtc)(s),u=(0,e.toUtc)(l);return{from:c,to:u,raw:{from:c,to:u}}}var Bf=Object.defineProperty,zf=Object.defineProperties,Wf=Object.getOwnPropertyDescriptors,Qf=Object.getOwnPropertySymbols,Uf=Object.prototype.hasOwnProperty,qf=Object.prototype.propertyIsEnumerable,Hf=(e,t,n)=>t in e?Bf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const Gf=["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"];class Xf extends Q{constructor(t){var n,r,i,o,s;super((o=((e,t)=>{for(var n in t||(t={}))Uf.call(t,n)&&Hf(e,n,t[n]);if(Qf)for(var n of Qf(t))qf.call(t,n)&&Hf(e,n,t[n]);return e})({refresh:""},t),s={autoValue:void 0,autoEnabled:null==(n=t.autoEnabled)||n,autoMinInterval:null!=(r=t.autoMinInterval)?r:a.config.minRefreshInterval,intervals:(null!=(i=t.intervals)?i:Gf).filter((n=>{var r;const i=null!=(r=t.minRefreshInterval)?r:a.config.minRefreshInterval;return!i||e.rangeUtil.intervalToMs(n)>=e.rangeUtil.intervalToMs(i)}))},zf(o,Wf(s)))),this._urlSync=new be(this,{keys:["refresh"]}),this._autoRefreshBlocked=!1,this.onRefresh=()=>{const e=kl.getQueryController(this);if(null==e?void 0:e.state.isRunning)return void e.cancelAll();const t=kl.getTimeRange(this);this._intervalTimer&&clearInterval(this._intervalTimer),t.onRefresh(),this.setupIntervalTimer()},this.onIntervalChanged=e=>{this.setState({refresh:e}),this.setupIntervalTimer()},this.setupAutoTimeRangeListener=()=>kl.getTimeRange(this).subscribeToState(((e,t)=>{e.from===t.from&&e.to===t.to||this.setupIntervalTimer()})),this.calculateAutoRefreshInterval=()=>{var t;const n=kl.getTimeRange(this),r=null!=(t=null==window?void 0:window.innerWidth)?t:2e3;return e.rangeUtil.calculateInterval(n.state.value,r,this.state.autoMinInterval)},this.setupIntervalTimer=()=>{var t;const n=kl.getTimeRange(this),{refresh:r,intervals:i}=this.state;if((this._intervalTimer||""===r)&&clearInterval(this._intervalTimer),""===r)return;if(r!==Wt.RefreshPicker.autoOption.value&&i&&!i.includes(r))return;let a;if(null==(t=this._autoTimeRangeListener)||t.unsubscribe(),r===Wt.RefreshPicker.autoOption.value){const e=this.calculateAutoRefreshInterval();a=e.intervalMs,this._autoTimeRangeListener=this.setupAutoTimeRangeListener(),e.interval!==this.state.autoValue&&this.setState({autoValue:e.interval})}else a=e.rangeUtil.intervalToMs(r);this._intervalTimer=setInterval((()=>{this.isTabVisible()?n.onRefresh():this._autoRefreshBlocked=!0}),a)},this.addActivationHandler((()=>{this.setupIntervalTimer();const e=()=>{this._autoRefreshBlocked&&"visible"===document.visibilityState&&(this._autoRefreshBlocked=!1,this.onRefresh())};return document.addEventListener("visibilitychange",e),()=>{var t;this._intervalTimer&&clearInterval(this._intervalTimer),document.removeEventListener("visibilitychange",e),null==(t=this._autoTimeRangeListener)||t.unsubscribe()}}))}getUrlState(){return{refresh:this.state.refresh}}updateFromUrl(e){const{intervals:t}=this.state,n=e.refresh;n&&"string"==typeof n&&((null==t?void 0:t.includes(n))?this.setState({refresh:n}):this.setState({refresh:t?t[0]:void 0}))}isTabVisible(){return void 0===document.visibilityState||"visible"===document.visibilityState}}Xf.Component=function({model:e}){var t;const{refresh:n,intervals:i,autoEnabled:a,autoValue:o,isOnCanvas:s,primary:l,withText:c}=e.useState(),u=function(e){const t=kl.getQueryController(e);return!!t&&t.useState().isRunning}(e);let d,p,f=n===(null==(t=Wt.RefreshPicker.autoOption)?void 0:t.value)?o:c?"Refresh":void 0;return u&&(d="Cancel all queries",c&&(f="Cancel")),c&&(p="96px"),r().createElement(Wt.RefreshPicker,{showAutoInterval:a,value:n,intervals:i,tooltip:d,width:p,text:f,onRefresh:e.onRefresh,primary:l,onIntervalChanged:e.onIntervalChanged,isLoading:u,isOnCanvas:null==s||s})};const Yf=e=>`${e}-compare`;var Zf=Object.defineProperty,Kf=Object.defineProperties,Jf=Object.getOwnPropertyDescriptors,eh=Object.getOwnPropertySymbols,th=Object.prototype.hasOwnProperty,nh=Object.prototype.propertyIsEnumerable,rh=(e,t,n)=>t in e?Zf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ih=(e,t)=>{for(var n in t||(t={}))th.call(t,n)&&rh(e,n,t[n]);if(eh)for(var n of eh(t))nh.call(t,n)&&rh(e,n,t[n]);return e},ah=(e,t)=>Kf(e,Jf(t));const oh="__previousPeriod",sh="__noPeriod",lh={label:"Previous period",value:oh},ch={label:"No comparison",value:sh},uh=[{label:"Day before",value:"24h"},{label:"Week before",value:"1w"},{label:"Month before",value:"1M"}];(class extends Q{constructor(t){super(ih({compareOptions:uh},t)),this._urlSync=new be(this,{keys:["compareWith"]}),this._onActivate=()=>{const e=kl.getTimeRange(this);this.setState({compareOptions:this.getCompareOptions(e.state.value)}),this._subs.add(e.subscribeToState((e=>{const t=this.getCompareOptions(e.value),n={compareOptions:t};Boolean(this.state.compareWith)&&!t.find((({value:e})=>e===this.state.compareWith))&&(n.compareWith=oh),this.setState(n)})))},this.getCompareOptions=t=>{const n=Math.ceil(t.to.diff(t.from)),r=uh.findIndex((({value:t})=>e.rangeUtil.intervalToMs(t)>=n));return[ch,lh,...uh.slice(r).map((({label:e,value:t})=>({label:e,value:t})))]},this.onCompareWithChanged=e=>{e===sh?this.onClearCompare():this.setState({compareWith:e})},this.onClearCompare=()=>{this.setState({compareWith:void 0})},this.addActivationHandler(this._onActivate)}getExtraQueries(e){const t=[],n=this.getCompareTimeRange(e.range);if(!n)return t;const r=e.targets.filter((e=>!1!==e.timeRangeCompare));return r.length&&t.push({req:ah(ih({},e),{targets:r,range:n}),processor:dh}),t}shouldRerun(e,t,n){return e.compareWith!==t.compareWith&&void 0!==n.find((e=>!1!==e.timeRangeCompare))}getCompareTimeRange(t){let n,r;if(this.state.compareWith){if(this.state.compareWith===oh){const i=t.to.diff(t.from);n=(0,e.dateTime)(t.from).subtract(i),r=(0,e.dateTime)(t.to).subtract(i)}else n=(0,e.dateTime)(t.from).subtract(e.rangeUtil.intervalToMs(this.state.compareWith)),r=(0,e.dateTime)(t.to).subtract(e.rangeUtil.intervalToMs(this.state.compareWith));return{from:n,to:r,raw:{from:n,to:r}}}}getUrlState(){return{compareWith:this.state.compareWith}}updateFromUrl(e){if(!e.compareWith)return;const t=ye(e.compareWith);t&&(this.getCompareOptions(kl.getTimeRange(this).state.value).find((({value:e})=>e===t))?this.setState({compareWith:t}):this.setState({compareWith:"__previousPeriod"}))}}).Component=function({model:e}){var t;const n=(0,Wt.useStyles2)(ph),{compareWith:i,compareOptions:a}=e.useState(),[o,s]=r().useState(i),l=null!=(t=a.find((({value:e})=>e===o)))?t:lh,c=a.find((({value:e})=>e===i)),u=Boolean(c),d=()=>{u?(s(i),e.onClearCompare()):u||e.onCompareWithChanged(l.value)};return r().createElement(Wt.ButtonGroup,null,r().createElement(Wt.ToolbarButton,{variant:"canvas",tooltip:"Enable time frame comparison",onClick:e=>{e.stopPropagation(),e.preventDefault(),d()}},r().createElement(Wt.Checkbox,{label:" ",value:u,onClick:d}),"Comparison"),u?r().createElement(Wt.ButtonSelect,{variant:"canvas",value:c,options:a,onChange:t=>{e.onCompareWithChanged(t.value)}}):r().createElement(Wt.ToolbarButton,{className:n.previewButton,disabled:!0,variant:"canvas",isOpen:!1},l.label))};const dh=(t,n)=>{const r=n.timeRange.from.diff(t.timeRange.from);return n.series.forEach((t=>{t.refId=Yf(t.refId||""),t.meta=ah(ih({},t.meta),{timeCompare:{diffMs:r,isTimeShiftQuery:!0}}),t.fields.forEach((t=>(t.type===e.FieldType.time&&(t.values=t.values.map((e=>r<0?e-r:e+r))),t.config=ah(ih({},t.config),{color:{mode:"fixed",fixedColor:a.config.theme.palette.gray60}}),t)))})),(0,b.of)(n)};function ph(e){return{previewButton:(0,Ht.css)({"&:disabled":{border:`1px solid ${e.colors.secondary.border}`,color:e.colors.text.disabled,opacity:1}})}}(class extends Q{constructor(t){super(t),this.addActivationHandler((()=>{const t=kl.getData(this);this._subs.add(t.subscribeToState((t=>{var n;(null==(n=t.data)?void 0:n.state)===e.LoadingState.Done&&this.performRepeat(t.data)}))),t.state.data&&this.performRepeat(t.state.data)}))}performRepeat(e){const t=[];for(let n=0;n<e.series.length;n++){const r=this.state.getLayoutChild(e,e.series[n],n);t.push(r)}this.state.body.setState({children:t})}}).Component=({model:e})=>{const{body:t}=e.useState();return r().createElement(t.Component,{model:t})},class extends Q{constructor(e){super(e),this._variableDependency=new Js(this,{variableNames:[this.state.variableName],onVariableUpdateCompleted:()=>this.performRepeat()}),this.addActivationHandler((()=>this.performRepeat()))}performRepeat(){if(this._variableDependency.hasDependencyInLoadingState())return;const e=kl.lookupVariable(this.state.variableName,this);if(!(e instanceof Vt))return void console.error("SceneByVariableRepeater: variable is not a MultiValueVariable");const t=function(e){const{value:t,text:n,options:r}=e.state;return e.hasAllValue()?r:Array.isArray(t)&&Array.isArray(n)?t.map(((e,t)=>({value:e,label:n[t]}))):[{value:t,label:n}]}(e),n=[];for(const e of t){const t=this.state.getLayoutChild(e);n.push(t)}this.state.body.setState({children:n})}}.Component=({model:e})=>{const{body:t}=e.useState();return r().createElement(t.Component,{model:t})};const fh=class extends Q{constructor(){super({})}get Component(){return fh.Component}};let hh=fh;hh.Component=e=>r().createElement("div",{style:{flexGrow:1}});class gh extends Q{toggleDirection(){this.setState({direction:"row"===this.state.direction?"column":"row"})}isDraggable(){return!1}}gh.Component=function({model:e,parentState:n}){const{children:i,isHidden:o}=e.useState(),s=function(e,n){return(0,t.useMemo)((()=>{var t,r,i,o,s,l,c,u,d,p;const{direction:f="row",wrap:h}=e,g=a.config.theme2,m={};return n?bh(m,e,n):(m.display="flex",m.flexGrow=1,m.minWidth=e.minWidth,m.minHeight=e.minHeight),m.flexDirection=f,m.gap="8px",m.flexWrap=h||"nowrap",m.alignContent="baseline",m.minWidth=m.minWidth||0,m.minHeight=m.minHeight||0,m[g.breakpoints.down("md")]={flexDirection:null!=(r=null==(t=e.md)?void 0:t.direction)?r:"column",maxWidth:null!=(o=null==(i=e.md)?void 0:i.maxWidth)?o:"unset",maxHeight:null!=(l=null==(s=e.md)?void 0:s.maxHeight)?l:"unset",height:null!=(u=null==(c=e.md)?void 0:c.height)?u:"unset",width:null!=(p=null==(d=e.md)?void 0:d.width)?p:"unset"},(0,Ht.css)(m)}),[n,e])}(e.state,n);return o?null:r().createElement("div",{className:s},i.map((t=>{const n=t.Component;return r().createElement(n,{key:t.state.key,model:t,parentState:e.state})})))};class mh extends Q{}function bh(e,t,n){var r,i,a;const o=null!=(r=n.direction)?r:"row",{xSizing:s="fill",ySizing:l="fill"}=t;return e.display="flex",e.position="relative",e.flexDirection=o,"column"===o?(t.height?e.height=t.height:e.flexGrow="fill"===l?1:0,t.width?e.width=t.width:e.alignSelf="fill"===s?"stretch":"flex-start"):(t.height?e.height=t.height:e.alignSelf="fill"===l?"stretch":"flex-start",t.width?e.width=t.width:e.flexGrow="fill"===s?1:0),e.minWidth=t.minWidth,e.maxWidth=t.maxWidth,e.maxHeight=t.maxHeight,e.minHeight=null!=(i=t.minHeight)?i:n.minHeight,e.height=null!=(a=t.height)?a:n.height,e}mh.Component=function({model:e,parentState:n}){if(!n)throw new Error("SceneFlexItem must be a child of SceneFlexLayout");const{body:i,isHidden:o}=e.useState(),s=function(e,n){return(0,t.useMemo)((()=>{var t,r,i,o,s,l,c,u,d,p;const f=a.config.theme2,h=bh({},e,n);return h[f.breakpoints.down("md")]={maxWidth:null!=(r=null==(t=e.md)?void 0:t.maxWidth)?r:"unset",maxHeight:null!=(o=null==(i=e.md)?void 0:i.maxHeight)?o:"unset",height:null!=(c=null==(s=e.md)?void 0:s.height)?c:null==(l=n.md)?void 0:l.height,width:null!=(p=null==(u=e.md)?void 0:u.width)?p:null==(d=n.md)?void 0:d.width},(0,Ht.css)(h)}),[e,n])}(e.state,n);return!i||o?null:r().createElement("div",{className:s},r().createElement(i.Component,{model:i}))};var vh=Object.defineProperty,yh=Object.getOwnPropertySymbols,Oh=Object.prototype.hasOwnProperty,wh=Object.prototype.propertyIsEnumerable,Sh=(e,t,n)=>t in e?vh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class xh extends Q{constructor(e){var t,n;super(((e,t)=>{for(var n in t||(t={}))Oh.call(t,n)&&Sh(e,n,t[n]);if(yh)for(var n of yh(t))wh.call(t,n)&&Sh(e,n,t[n]);return e})({rowGap:1,columnGap:1,templateColumns:"repeat(auto-fit, minmax(400px, 1fr))",autoRows:null!=(t=e.autoRows)?t:"320px",children:null!=(n=e.children)?n:[]},e))}isDraggable(){return!1}}xh.Component=function({model:e}){const{children:n,isHidden:i,isLazy:o}=e.useState(),s=(l=e.state,(0,t.useMemo)((()=>{var e,t,n,r,i,o,s,c,u,d,p;const f={},h=a.config.theme2;return f.display="grid",f.gridTemplateColumns=l.templateColumns,f.gridTemplateRows=l.templateRows||"unset",f.gridAutoRows=l.autoRows||"unset",f.rowGap=h.spacing(null!=(e=l.rowGap)?e:1),f.columnGap=h.spacing(null!=(t=l.columnGap)?t:1),f.justifyItems=l.justifyItems||"unset",f.alignItems=l.alignItems||"unset",f.justifyContent=l.justifyContent||"unset",f.flexGrow=1,l.md&&(f[h.breakpoints.down("md")]={gridTemplateRows:null==(n=l.md)?void 0:n.templateRows,gridTemplateColumns:null==(r=l.md)?void 0:r.templateColumns,rowGap:l.md.rowGap?h.spacing(null!=(o=null==(i=l.md)?void 0:i.rowGap)?o:1):void 0,columnGap:l.md.columnGap?h.spacing(null!=(c=null==(s=l.md)?void 0:s.rowGap)?c:1):void 0,justifyItems:null==(u=l.md)?void 0:u.justifyItems,alignItems:null==(d=l.md)?void 0:d.alignItems,justifyContent:null==(p=l.md)?void 0:p.justifyContent}),(0,Ht.css)(f)}),[l]));var l;return i?null:r().createElement("div",{className:s},n.map((t=>{const n=t.Component;return o?r().createElement(Up,{key:t.state.key,className:s},r().createElement(n,{key:t.state.key,model:t,parentState:e.state})):r().createElement(n,{key:t.state.key,model:t,parentState:e.state})})))};class _h extends Q{}_h.Component=function({model:e,parentState:n}){if(!n)throw new Error("SceneCSSGridItem must be a child of SceneCSSGridLayout");const{body:i,isHidden:a}=e.useState(),o=(s=e.state,(0,t.useMemo)((()=>{const e={};return e.gridColumn=s.gridColumn||"unset",e.gridRow=s.gridRow||"unset",e.position="relative",(0,Ht.css)(e)}),[s]));var s;return!i||a?null:r().createElement("div",{className:o},r().createElement(i.Component,{model:i}))};var Ph=Object.defineProperty,Eh=Object.getOwnPropertySymbols,Ch=Object.prototype.hasOwnProperty,kh=Object.prototype.propertyIsEnumerable,Dh=(e,t,n)=>t in e?Ph(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Th=(e,t)=>{for(var n in t||(t={}))Ch.call(t,n)&&Dh(e,n,t[n]);if(Eh)for(var n of Eh(t))kh.call(t,n)&&Dh(e,n,t[n]);return e};const Rh=new Set(["ArrowUp","ArrowDown"]),Ih=new Set(["ArrowLeft","ArrowRight"]),Ah={row:{dim:"width",axis:"clientX",min:"minWidth",max:"maxWidth"},column:{dim:"height",axis:"clientY",min:"minHeight",max:"maxHeight"}};function jh({direction:e="row",handleSize:n=32,initialSize:i="auto",primaryPaneStyles:a,secondaryPaneStyles:o,onDragFinished:s,children:l}){const c=r().Children.toArray(l),u=(0,t.useRef)(null),d=(0,t.useRef)(null),p=(0,t.useRef)(null),f=(0,t.useRef)(null),h=(0,t.useRef)(null),g=(0,t.useRef)("1fr"),m=(0,t.useRef)(void 0),b=(0,t.useRef)(void 0),v=Ah[e].dim,y=Ah[e].axis,O=Ah[e].min,w=Ah[e].max;!function(e,n,r=0,i){const a=(0,re.throttle)(n,r);(0,t.useLayoutEffect)((()=>{if(!e)return;const t=new ResizeObserver(a);return t.observe(e,{box:"device-pixel-content-box"}),()=>t.disconnect()}),i)}(f.current,(e=>{for(const t of e){if(!t.target.isSameNode(f.current))return;const e=d.current.getBoundingClientRect()[v],n=$h(d.current);u.current.ariaValueNow=`${(0,re.clamp)((e-n[O])/(n[w]-n[O])*100,0,100)}`}}),500,[w,O,e,v]);const S=(0,t.useRef)(null),x=(0,t.useCallback)((e=>{g.current=d.current.getBoundingClientRect()[v],h.current=f.current.getBoundingClientRect()[v],S.current=e[y],u.current.setPointerCapture(e.pointerId),m.current=$h(d.current),b.current=void 0}),[v,y]),_=(0,t.useCallback)((e=>{if(null!==S.current&&"1fr"!==g.current){const t=e[y]-S.current,r=m.current,i=(0,re.clamp)(g.current+t,r[O],r[w]),a=i/(h.current-n);d.current.style.flexGrow=`${a}`,p.current.style.flexGrow=""+(1-a);const o=(0,re.clamp)((i-r[O])/(r[w]-r[O])*100,0,100);u.current.ariaValueNow=`${o}`}}),[n,y,O,w]),P=(0,t.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),u.current.releasePointerCapture(e.pointerId),S.current=null,null==s||s(parseFloat(d.current.style.flexGrow))}),[s]),E=(0,t.useRef)(new Set),C=(0,t.useRef)(null),k=(0,t.useCallback)((t=>{var r;if(0===E.current.size)return void(C.current=null);if("1fr"===g.current)return;const i=.3*(t-(null!=(r=C.current)?r:t));let a=0;"row"===e?(E.current.has("ArrowLeft")&&(a-=i),E.current.has("ArrowRight")&&(a+=i)):(E.current.has("ArrowUp")&&(a-=i),E.current.has("ArrowDown")&&(a+=i));const o=m.current,s=d.current.getBoundingClientRect()[v],l=(0,re.clamp)(s+a,o[O],o[w]),c=l/(h.current-n);d.current.style.flexGrow=`${c}`,p.current.style.flexGrow=""+(1-c);const f=(l-o[O])/(o[w]-o[O])*100;u.current.ariaValueNow=`${(0,re.clamp)(f,0,100)}`,C.current=t,window.requestAnimationFrame(k)}),[e,n,O,w,v]),D=(0,t.useCallback)((t=>{if("Enter"!==t.key){if("Home"===t.key){m.current=$h(d.current),h.current=f.current.getBoundingClientRect()[v];const e=m.current[O]/(h.current-n);return d.current.style.flexGrow=`${e}`,p.current.style.flexGrow=""+(1-e),void(u.current.ariaValueNow="0")}if("End"===t.key){m.current=$h(d.current),h.current=f.current.getBoundingClientRect()[v];const e=m.current[w]/(h.current-n);return d.current.style.flexGrow=`${e}`,p.current.style.flexGrow=""+(1-e),void(u.current.ariaValueNow="100")}if(("column"===e&&Rh.has(t.key)||"row"===e&&Ih.has(t.key))&&!E.current.has(t.key)&&(b.current=void 0,t.preventDefault(),t.stopPropagation(),g.current=d.current.getBoundingClientRect()[v],h.current=f.current.getBoundingClientRect()[v],m.current=$h(d.current),!E.current.has(t.key))){const e=0===E.current.size;E.current.add(t.key),e&&window.requestAnimationFrame(k)}}else void 0===b.current?(b.current=d.current.style.flexGrow,d.current.style.flexGrow="0",p.current.style.flexGrow="1"):(d.current.style.flexGrow=b.current,p.current.style.flexGrow=""+(1-parseFloat(b.current)),b.current=void 0)}),[e,k,n,w,v,O]),T=(0,t.useCallback)((t=>{"row"===e&&!Ih.has(t.key)||"column"===e&&!Rh.has(t.key)||(E.current.delete(t.key),null==s||s(parseFloat(d.current.style.flexGrow)))}),[e,s]),R=(0,t.useCallback)((()=>{d.current.style.flexGrow="0.5",p.current.style.flexGrow="0.5";const e=$h(d.current);m.current=e,g.current=d.current.getBoundingClientRect()[v],u.current.ariaValueNow=""+(g.current-e[O])/(e[w]-e[O])*100}),[w,v,O]),I=(0,t.useCallback)((()=>{E.current.size>0&&(E.current.clear(),S.current=null,null==s||s(parseFloat(d.current.style.flexGrow)))}),[s]),A=(0,Wt.useStyles2)(Lh),j=Qp(),L=2===c.length?"visible":"hidden";return r().createElement("div",{ref:f,className:A.container,style:{flexDirection:e}},r().createElement("div",{ref:d,className:A.panel,style:Th({flexGrow:"auto"===i?.5:(0,re.clamp)(i,0,1),[O]:"min-content"},a),id:`start-panel-${j}`},c[0]),c[1]&&r().createElement(r().Fragment,null,r().createElement("div",{ref:u,style:{[v]:`${n}px`},className:(0,Ht.cx)(A.handle,{[A.handleHorizontal]:"column"===e}),onPointerUp:P,onPointerDown:x,onPointerMove:_,onKeyDown:D,onKeyUp:T,onDoubleClick:R,onBlur:I,role:"separator","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":50,"aria-controls":`start-panel-${j}`,"aria-label":"Pane resize widget",tabIndex:0}),r().createElement("div",{ref:p,className:A.panel,style:Th({flexGrow:"auto"===i?.5:(0,re.clamp)(1-i,0,1),[O]:"min-content",visibility:`${L}`},o),id:`end-panel-${j}`},c[1])))}function Lh(e){return{handle:(0,Ht.css)({cursor:"col-resize",position:"relative",flexShrink:0,userSelect:"none","&::before":{content:'""',position:"absolute",backgroundColor:e.colors.primary.main,left:"50%",transform:"translate(-50%)",top:0,height:"100%",width:"1px",opacity:0,transition:"opacity ease-in-out 0.2s"},"&::after":{content:'""',width:"4px",borderRadius:"4px",backgroundColor:e.colors.border.weak,transition:"background-color ease-in-out 0.2s",height:"50%",top:"calc(50% - (50%) / 2)",transform:"translateX(-50%)",position:"absolute",left:"50%"},"&:hover, &:focus-visible":{outline:"none","&::before":{opacity:1},"&::after":{backgroundColor:e.colors.primary.main}}}),handleHorizontal:(0,Ht.css)({cursor:"row-resize","&::before":{left:"inherit",transform:"translateY(-50%)",top:"50%",height:"1px",width:"100%"},"&::after":{width:"50%",height:"4px",top:"50%",transform:"translateY(-50%)",left:"calc(50% - (50%) / 2)"}}),container:(0,Ht.css)({display:"flex",width:"100%",flexGrow:1,overflow:"hidden"}),panel:(0,Ht.css)({display:"flex",position:"relative",flexBasis:0})}}function $h(e){if(null===e)return;const t=document.body.style.overflow,n=e.style.width,r=e.style.height,i=e.style.flexGrow;document.body.style.overflow="hidden",e.style.flexGrow="0";const{width:a,height:o}=e.getBoundingClientRect();e.style.flexGrow="100";const{width:s,height:l}=e.getBoundingClientRect();return document.body.style.overflow=t,e.style.width=n,e.style.height=r,e.style.flexGrow=i,{minWidth:a,maxWidth:s,minHeight:o,maxHeight:l}}(class extends Q{toggleDirection(){this.setState({direction:"row"===this.state.direction?"column":"row"})}isDraggable(){return!1}}).Component=function({model:e}){const{primary:t,secondary:n,direction:i,isHidden:a,initialSize:o,primaryPaneStyles:s,secondaryPaneStyles:l}=e.useState();if(a)return null;const c=t.Component,u=null==n?void 0:n.Component;let d=n?o:1;return r().createElement(jh,{direction:i,initialSize:null!=d?d:.5,primaryPaneStyles:s,secondaryPaneStyles:l},r().createElement(c,{key:t.state.key,model:t,parentState:e.state}),u&&n&&r().createElement(u,{key:n.state.key,model:n,parentState:e.state}))};class Fh extends Q{enrichDataRequest(){return{app:this.state.name||"app"}}}Fh.Component=({model:e})=>{const{pages:t}=e.useState();return r().createElement(Nh.Provider,{value:e},r().createElement(i.Switch,null,t.map((e=>r().createElement(i.Route,{key:e.state.url,exact:!1,path:e.state.url,render:t=>f(e,t)})))))};const Nh=(0,t.createContext)(null),Mh=new Map;var Vh=Object.defineProperty,Bh=Object.getOwnPropertySymbols,zh=Object.prototype.hasOwnProperty,Wh=Object.prototype.propertyIsEnumerable,Qh=(e,t,n)=>t in e?Vh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Uh extends Q{}function qh({node:e}){const t=e.useState(),n=(0,Wt.useStyles2)(Hh);return r().createElement("div",{className:n.container},Object.keys(t).map((i=>r().createElement("div",{className:n.row,key:i},r().createElement("div",{className:n.keyName},i),r().createElement("div",{className:n.value},function(e,t,n){if(null===t)return"null";switch(typeof t){case"number":return r().createElement(Wt.Input,{type:"number",defaultValue:t,onBlur:t=>n.setState({[e]:t.currentTarget.valueAsNumber})});case"string":return r().createElement(Wt.Input,{type:"text",defaultValue:t,onBlur:t=>n.setState({[e]:t.currentTarget.value})});case"object":return ut(t)?t.constructor.name:(0,re.isPlainObject)(t)||(0,re.isArray)(t)?r().createElement(Wt.JSONFormatter,{json:t,open:0}):String(t);default:return typeof t}}(i,t[i],e))))))}function Hh(e){return{container:(0,Ht.css)({flexGrow:1,display:"flex",gap:e.spacing(.5),flexDirection:"column"}),row:(0,Ht.css)({display:"flex",gap:e.spacing(2)}),keyName:(0,Ht.css)({display:"flex",flexGrow:"0",width:120,alignItems:"center",height:e.spacing(e.components.height.md)}),value:(0,Ht.css)({flexGrow:1,minHeight:e.spacing(e.components.height.md),display:"flex",alignItems:"center"})}}function Gh({node:e,selectedObject:t,onSelect:n}){const i=(0,Wt.useStyles2)(Xh),a=[],o=e===t;return e.forEachChild((e=>{a.push(r().createElement(Gh,{node:e,key:e.state.key,selectedObject:t,onSelect:n}))})),r().createElement("div",{className:i.container},r().createElement("div",{className:(0,Ht.cx)(i.name,o&&i.selected),onClick:()=>n(e)},e.constructor.name),r().createElement("div",{className:i.children},a))}function Xh(e){return{container:(0,Ht.css)({flexGrow:1,display:"flex",gap:e.spacing(.5),flexDirection:"column"}),name:(0,Ht.css)({flexGrow:1,display:"flex",gap:e.spacing(1),fontSize:e.typography.bodySmall.fontSize,cursor:"pointer",padding:e.spacing(0,1),borderRadius:e.shape.borderRadius(2),position:"relative","&:hover":{background:e.colors.background.secondary}}),selected:(0,Ht.css)({"&::before":{display:"block",content:"' '",position:"absolute",left:0,width:4,bottom:2,top:2,borderRadius:e.shape.radius.default,backgroundImage:e.colors.gradients.brandVertical}}),children:(0,Ht.css)({flexGrow:1,display:"flex",flexDirection:"column",paddingLeft:e.spacing(1)})}}function Yh({scene:e}){const n=(0,Wt.useStyles2)(Zh),[i,a]=(0,t.useState)(!1),[o,s]=(0,t.useState)();return r().createElement(r().Fragment,null,r().createElement(Wt.ToolbarButton,{variant:"canvas",icon:"bug",onClick:()=>a(!0)}),i&&r().createElement(Wt.Drawer,{title:"Scene debugger",onClose:()=>a(!1),size:"lg"},r().createElement("div",{className:n.panes},r().createElement("div",{className:n.pane1},r().createElement("div",{className:n.paneHeading},"Scene graph"),r().createElement(Wt.CustomScrollbar,{autoHeightMin:"100%"},r().createElement("div",{className:n.treeWrapper},r().createElement(Gh,{node:e,selectedObject:o,onSelect:s})))),r().createElement("div",{className:n.pane2},r().createElement("div",{className:n.paneHeading},"Object details"),o&&r().createElement(qh,{node:o})))))}function Zh(e){return{panes:(0,Ht.css)({flexGrow:1,display:"flex",height:"100%",flexDirection:"row",marginTop:e.spacing(-2)}),pane1:(0,Ht.css)({flexGrow:0,display:"flex",height:"100%",flexDirection:"column",borderRight:`1px solid ${e.colors.border.weak}`}),pane2:(0,Ht.css)({flexGrow:1,display:"flex",minHeight:"100%",flexDirection:"column",paddingLeft:e.spacing(2)}),treeWrapper:(0,Ht.css)({paddingRight:e.spacing(2),height:"100%",marginLeft:e.spacing(-1)}),paneHeading:(0,Ht.css)({padding:e.spacing(1,0),fontWeight:e.typography.fontWeightMedium})}}function Kh({page:e,routeProps:n}){const o=function(e){return e.parent instanceof tg?e.parent:e}(e),s=o.useState(),l=function(){const e=(0,i.useLocation)();return(0,a.locationSearchToObject)(e.search||"")}(),c=e.getScene(n.match),u=(0,t.useContext)(Nh),d=s.initializedScene===c,{layout:f}=e.state;(0,t.useLayoutEffect)((()=>{d||o.initializeScene(c)}),[c,o,d]),(0,t.useEffect)((()=>()=>o.setState({initializedScene:void 0})),[o]);const h=function(e,n={}){const r=(0,i.useLocation)(),[o,s]=(0,t.useState)(!1),l=function(e){return(0,t.useMemo)((()=>new Ip({updateUrlOnInit:e.updateUrlOnInit,createBrowserHistorySteps:e.createBrowserHistorySteps})),[e.updateUrlOnInit,e.createBrowserHistorySteps])}(n);return(0,t.useEffect)((()=>(l.initSync(e),s(!0),()=>l.cleanUp(e))),[e,l]),(0,t.useEffect)((()=>{const e=a.locationService.getLocation(),t=e!==r?e:r;e!==r&&ft("useUrlSync","latestLocation different from location"),l.handleNewLocation(t)}),[e,l,r]),o}(o,null==u?void 0:u.state.urlSyncOptions);if(!d&&!h)return null;const g={text:s.title,img:s.titleImg,icon:s.titleIcon,url:p(s.url,s.preserveUrlKeys),hideFromBreadcrumbs:s.hideFromBreadcrumbs,parentItem:Jh(s.getParentPage?s.getParentPage():o.parent)};s.tabs&&(g.children=s.tabs.map((t=>({text:t.state.title,icon:t.state.titleIcon,tabSuffix:t.state.tabSuffix,active:e===t,url:p(t.state.url,t.state.preserveUrlKeys),parentItem:g}))));let m=[];return s.controls&&(m=s.controls.map((e=>r().createElement(e.Component,{model:e,key:e.state.key})))),l["scene-debugger"]&&m.push(r().createElement(Yh,{scene:o,key:"scene-debugger"})),r().createElement(a.PluginPage,{layout:f,pageNav:g,actions:m,renderTitle:s.renderTitle,subTitle:s.subTitle},r().createElement(c.Component,{model:c}))}function Jh(e,t){if(e instanceof tg)return{text:e.state.title,url:p(e.state.url,e.state.preserveUrlKeys),hideFromBreadcrumbs:e.state.hideFromBreadcrumbs,parentItem:Jh(e.state.getParentPage?e.state.getParentPage():e.parent)}}function eg({drilldown:e,parent:t,routeProps:n}){return f(t.getDrilldownPage(e,n.match),n)}Uh.Component=({model:e})=>{const{component:t,props:n,reactNode:i}=e.useState();return t?r().createElement(t,((e,t)=>{for(var n in t||(t={}))zh.call(t,n)&&Qh(e,n,t[n]);if(Bh)for(var n of Bh(t))Wh.call(t,n)&&Qh(e,n,t[n]);return e})({},n)):i||null};class tg extends Q{constructor(e){super(e),this._sceneCache=new Map,this._drilldownCache=new Map}initializeScene(e){this.setState({initializedScene:e})}getScene(e){let t=this._sceneCache.get(e.url);if(t)return t;if(!this.state.getScene)throw new Error("Missing getScene on SceneAppPage "+this.state.title);return t=this.state.getScene(e),this._sceneCache.set(e.url,t),t}getDrilldownPage(e,t){let n=this._drilldownCache.get(t.url);return n||(n=e.getPage(t,this),this._drilldownCache.set(t.url,n),n)}enrichDataRequest(e){if(this.state.getParentPage)return this.state.getParentPage().enrichDataRequest(e);if(!this.parent)return null;const t=this.getRoot();return dt(t)?t.enrichDataRequest(e):null}}tg.Component=function({model:e,routeProps:t}){var n,a;const{tabs:o,drilldowns:s}=e.useState(),l=[];if(o&&o.length>0)for(let t=0;t<o.length;t++){const s=o[t];if(0===t&&l.push(r().createElement(i.Route,{exact:!0,key:e.state.url,path:null!=(n=e.state.routePath)?n:e.state.url,render:e=>f(s,e)})),l.push(r().createElement(i.Route,{exact:!0,key:s.state.url,path:null!=(a=s.state.routePath)?a:s.state.url,render:e=>f(s,e)})),s.state.drilldowns)for(const e of s.state.drilldowns)l.push(r().createElement(i.Route,{exact:!1,key:e.routePath,path:e.routePath,render:t=>r().createElement(eg,{drilldown:e,parent:s,routeProps:t})}))}if(s)for(const t of s)l.push(r().createElement(i.Route,{key:t.routePath,exact:!1,path:t.routePath,render:n=>r().createElement(eg,{drilldown:t,parent:e,routeProps:n})}));return!o&&(c=e,(u=t.match).isExact&&(u.url===c.state.url||c.parent instanceof tg&&c.parent.state.tabs[0]===c&&c.parent.state.url===u.url))?r().createElement(Kh,{page:e,routeProps:t}):(l.push(function(e,t){return r().createElement(i.Route,{key:"fallback route",render:n=>{var i,a,o;const s=null!=(o=null==(a=(i=e.state).getFallbackPage)?void 0:a.call(i))?o:new tg({url:"",title:"Not found",subTitle:"The url did not match any page",getScene:()=>new jp({body:new gh({direction:"column",children:[new mh({body:new Uh({component:()=>r().createElement("div",{"data-testid":"default-fallback-content"},"If you found your way here using a link then there might be a bug in this application.")})})]})})});return r().createElement(Kh,{page:s,routeProps:t})}})}(e,t)),r().createElement(i.Switch,null,l));var c,u};var ng=(e=>(e.Always="always",e.Auto="auto",e.Never="never",e))(ng||{}),rg=(e=>(e.Hue="hue",e.None="none",e.Opacity="opacity",e.Scheme="scheme",e))(rg||{}),ig=(e=>(e.None="none",e.Normal="normal",e.Percent="percent",e))(ig||{}),ag=(e=>(e.Auto="auto",e.Horizontal="horizontal",e.Vertical="vertical",e))(ag||{}),og=(e=>(e.Background="background",e.BackgroundSolid="background_solid",e.None="none",e.Value="value",e))(og||{}),sg=(e=>(e.Area="area",e.Line="line",e.None="none",e))(sg||{}),lg=(e=>(e.Auto="auto",e.Center="center",e))(lg||{}),cg=(e=>(e.Auto="auto",e.Name="name",e.None="none",e.Value="value",e.ValueAndName="value_and_name",e))(cg||{}),ug=(e=>(e.Inverted="inverted",e.SameAsValue="same_as_value",e.Standard="standard",e))(ug||{}),dg=(e=>(e.Multi="multi",e.None="none",e.Single="single",e))(dg||{}),pg=(e=>(e.Basic="basic",e.Gradient="gradient",e.Lcd="lcd",e))(pg||{}),fg=(e=>(e.Color="color",e.Hidden="hidden",e.Text="text",e))(fg||{}),hg=(e=>(e.Auto="auto",e.Left="left",e.Top="top",e))(hg||{}),gg=(e=>(e.Auto="auto",e.Manual="manual",e))(gg||{}),mg=(e=>(e.Auto="auto",e.Lg="lg",e.Md="md",e.Sm="sm",e))(mg||{});ag.Auto,ng.Auto,ig.None,rg.None,pg.Gradient,hg.Auto,gg.Auto,fg.Color,gg.Auto,ng.Auto,dg.Single,rg.None,og.Value,sg.Area,lg.Auto,ug.Standard,cg.Auto,ng.Auto,ng.Auto,mg.Sm,ng.Auto;class bg{constructor(){this._overrides=[]}overrideColor(e){return this._overrides[this._overrides.length-1].properties.push({id:"color",value:e}),this}overrideDecimals(e){return this._overrides[this._overrides.length-1].properties.push({id:"decimals",value:e}),this}overrideDisplayName(e){return this._overrides[this._overrides.length-1].properties.push({id:"displayName",value:e}),this}overrideFilterable(e){return this._overrides[this._overrides.length-1].properties.push({id:"filterable",value:e}),this}overrideLinks(e){return this._overrides[this._overrides.length-1].properties.push({id:"links",value:e}),this}overrideMappings(e){return this._overrides[this._overrides.length-1].properties.push({id:"mappings",value:e}),this}overrideMax(e){return this._overrides[this._overrides.length-1].properties.push({id:"max",value:e}),this}overrideMin(e){return this._overrides[this._overrides.length-1].properties.push({id:"min",value:e}),this}overrideNoValue(e){return this._overrides[this._overrides.length-1].properties.push({id:"noValue",value:e}),this}overrideThresholds(e){return this._overrides[this._overrides.length-1].properties.push({id:"thresholds",value:e}),this}overrideUnit(e){return this._overrides[this._overrides.length-1].properties.push({id:"unit",value:e}),this}}class vg extends bg{match(e){return this._overrides.push({matcher:e,properties:[]}),this}matchFieldsWithName(t){return this._overrides.push({matcher:{id:e.FieldMatcherID.byName,options:t},properties:[]}),this}matchFieldsWithNameByRegex(t){return this._overrides.push({matcher:{id:e.FieldMatcherID.byRegexp,options:t},properties:[]}),this}matchFieldsByType(t){return this._overrides.push({matcher:{id:e.FieldMatcherID.byType,options:t},properties:[]}),this}matchFieldsByQuery(t){return this._overrides.push({matcher:{id:e.FieldMatcherID.byFrameRefID,options:t},properties:[]}),this}matchFieldsByValue(t){return this._overrides.push({matcher:{id:e.FieldMatcherID.byValue,options:t},properties:[]}),this}matchComparisonQuery(e){return this.matchFieldsByQuery(Yf(e))}overrideCustomFieldConfig(e,t){const n=`custom.${String(e)}`;return this._overrides[this._overrides.length-1].properties.push({id:n,value:t}),this}build(){return this._overrides}}var yg=Object.defineProperty,Og=Object.defineProperties,wg=Object.getOwnPropertyDescriptors,Sg=Object.getOwnPropertySymbols,xg=Object.prototype.hasOwnProperty,_g=Object.prototype.propertyIsEnumerable,Pg=(e,t,n)=>t in e?yg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Eg=(e,t)=>{for(var n in t||(t={}))xg.call(t,n)&&Pg(e,n,t[n]);if(Sg)for(var n of Sg(t))_g.call(t,n)&&Pg(e,n,t[n]);return e},Cg=(e,t)=>Og(e,wg(t));class kg{constructor(e){this.defaultFieldConfig=e,this._fieldConfig={defaults:{},overrides:[]},this._overridesBuilder=new vg,this.setDefaults()}setDefaults(){const e={defaults:{custom:this.defaultFieldConfig?(0,re.cloneDeep)(this.defaultFieldConfig()):{}},overrides:[]};this._fieldConfig=e}setColor(e){return this.setFieldConfigDefaults("color",e)}setDecimals(e){return this.setFieldConfigDefaults("decimals",e)}setDisplayName(e){return this.setFieldConfigDefaults("displayName",e)}setFilterable(e){return this.setFieldConfigDefaults("filterable",e)}setLinks(e){return this.setFieldConfigDefaults("links",e)}setMappings(e){return this.setFieldConfigDefaults("mappings",e)}setMax(e){return this.setFieldConfigDefaults("max",e)}setMin(e){return this.setFieldConfigDefaults("min",e)}setNoValue(e){return this.setFieldConfigDefaults("noValue",e)}setThresholds(e){return this.setFieldConfigDefaults("thresholds",e)}setUnit(e){return this.setFieldConfigDefaults("unit",e)}setCustomFieldConfig(e,t){return this._fieldConfig.defaults=Cg(Eg({},this._fieldConfig.defaults),{custom:(0,re.merge)(this._fieldConfig.defaults.custom,{[e]:t})}),this}setOverrides(e){return e(this._overridesBuilder),this}setFieldConfigDefaults(e,t){return this._fieldConfig.defaults=Cg(Eg({},this._fieldConfig.defaults),{[e]:t}),this}build(){return{defaults:this._fieldConfig.defaults,overrides:this._overridesBuilder.build()}}}class Dg{constructor(e){this.defaultOptions=e,this._options={},this.setDefaults()}setDefaults(){this._options=this.defaultOptions?(0,re.cloneDeep)(this.defaultOptions()):{}}setOption(e,t){return this._options=(0,re.merge)(this._options,{[e]:t}),this}build(){return this._options}}var Tg=Object.defineProperty,Rg=Object.defineProperties,Ig=Object.getOwnPropertyDescriptors,Ag=Object.getOwnPropertySymbols,jg=Object.prototype.hasOwnProperty,Lg=Object.prototype.propertyIsEnumerable,$g=(e,t,n)=>t in e?Tg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Fg{constructor(e,t,n,r){this._state={},this._state.title="",this._state.description="",this._state.displayMode="default",this._state.hoverHeader=!1,this._state.pluginId=e,this._state.pluginVersion=t,this._fieldConfigBuilder=new kg(r),this._panelOptionsBuilder=new Dg(n)}setTitle(e){return this._state.title=e,this}setDescription(e){return this._state.description=e,this}setDisplayMode(e){return this._state.displayMode=e,this}setHoverHeader(e){return this._state.hoverHeader=e,this}setMenu(e){return this._state.menu=e,this}setHeaderActions(e){return this._state.headerActions=e,this}setColor(e){return this._fieldConfigBuilder.setColor(e),this}setDecimals(e){return this._fieldConfigBuilder.setDecimals(e),this}setDisplayName(e){return this._fieldConfigBuilder.setDisplayName(e),this}setFilterable(e){return this._fieldConfigBuilder.setFilterable(e),this}setLinks(e){return this._fieldConfigBuilder.setLinks(e),this}setMappings(e){return this._fieldConfigBuilder.setMappings(e),this}setMax(e){return this._fieldConfigBuilder.setMax(e),this}setMin(e){return this._fieldConfigBuilder.setMin(e),this}setNoValue(e){return this._fieldConfigBuilder.setNoValue(e),this}setThresholds(e){return this._fieldConfigBuilder.setThresholds(e),this}setUnit(e){return this._fieldConfigBuilder.setUnit(e),this}setCustomFieldConfig(e,t){return this._fieldConfigBuilder.setCustomFieldConfig(e,t),this}setOverrides(e){return this._fieldConfigBuilder.setOverrides(e),this}setOption(e,t){return this._panelOptionsBuilder.setOption(e,t),this}setData(e){return this._state.$data=e,this}setTimeRange(e){return this._state.$timeRange=e,this}setVariables(e){return this._state.$variables=e,this}setBehaviors(e){return this._state.$behaviors=e,this}build(){const e=new $c((t=((e,t)=>{for(var n in t||(t={}))jg.call(t,n)&&$g(e,n,t[n]);if(Ag)for(var n of Ag(t))Lg.call(t,n)&&$g(e,n,t[n]);return e})({},this._state),n={options:this._panelOptionsBuilder.build(),fieldConfig:this._fieldConfigBuilder.build()},Rg(t,Ig(n))));var t,n;return e}}const Ng=()=>new Fg("logs","10.0.0"),Mg=()=>new Fg("timeseries","10.0.0"),Vg=()=>new kg,Bg=function({dataSource:e}){if(ne.has(e.uid))throw new Error(`A runtime data source with uid ${e.uid} has already been registered`);ne.set(e.uid,e)},zg=JSON.parse('{"id":"grafana-lokiexplore-app"}');function Wg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Qg extends Vt{getValueOptions(e){return(0,b.of)(this.state.options)}constructor(e){super(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Wg(e,t,n[t])}))}return e}({type:"custom",value:"",text:"",options:[],name:""},e))}}function Ug(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Ug(e,t,n[t])}))}return e}Wg(Qg,"Component",(({model:e})=>xn(e)));const Hg={app:zg.id,version:"1.0.1"},Gg={info:(e,t)=>{const n=qg({},Hg,t);console.log(e,n),Xg(e,n)},warn:(e,t)=>{const n=qg({},Hg,t);console.warn(e,n),Yg(e,n)},error:(e,t)=>{const n=qg({},Hg,t);console.error(e,n),Zg(e,n)}},Xg=(e,t)=>{try{(0,a.logInfo)(e,t)}catch(e){console.warn("Failed to log faro event!")}},Yg=(e,t)=>{try{(0,a.logWarning)(e,t)}catch(n){console.warn("Failed to log faro warning!",{msg:e,context:t})}},Zg=(e,t)=>{let n=t;try{!function(e,t){if("object"==typeof e&&null!==e&&("object"==typeof e&&Object.keys(e).forEach((n=>{const r=e[n];"string"!=typeof r&&"boolean"!=typeof r&&"number"!=typeof r||(t[n]=r.toString())})),Kg(e)))if("object"==typeof e.data&&null!==e.data)try{t.data=JSON.stringify(e.data)}catch(e){}else"string"!=typeof e.data&&"boolean"!=typeof e.data&&"number"!=typeof e.data||(t.data=e.data.toString())}(e,n),e instanceof Error?(0,a.logError)(e,n):"string"==typeof e?(0,a.logError)(new Error(e),n):e&&"object"==typeof e?n.msg?(0,a.logError)(new Error(n.msg),n):(0,a.logError)(new Error("error object"),n):(0,a.logError)(new Error("unknown error"),n)}catch(t){console.error("Failed to log faro error!",{err:e,context:n})}},Kg=e=>"data"in e,Jg="filters",em="${filters}",tm="fields",nm="${fields}",rm="patterns",im="${patterns}",am="levels",om="${levels}",sm="fieldBy",lm="labelBy",cm="service",um="ds",dm="${ds}",pm="| json | logfmt | drop __error__, __error_details__",fm="| json | drop __error__, __error_details__",hm="| logfmt",gm="${logsFormat}",mm="lineFilter",bm="${lineFilter}",vm=`{${em}} ${im} ${bm} ${om} ${gm} ${nm}`,ym=`{${em}} ${im} ${gm}`,Om={uid:dm},wm="$__all",Sm="detected_level",xm="service_name",_m="service_label_var",Pm='""';function Em(e){const{labelExpressionToAdd:t="",structuredMetadataToAdd:n="",fieldExpressionToAdd:r="",parser:i}=e;switch(i){case"structuredMetadata":return`{${em}${t}} ${n} ${om} ${im} ${bm}`;case"json":return`{${em}${t}} ${n} ${om} ${im} ${bm} ${fm} ${r} ${nm}`;case"logfmt":return`{${em}${t}} ${n} ${om} ${im} ${bm} ${hm} ${r} ${nm}`;default:return`{${em}${t}} ${n} ${om} ${im} ${bm} ${pm} ${r} ${nm}`}}function Cm(e){const t=kl.lookupVariable(rm,e);if(!(t instanceof Zd))throw new Error("VAR_PATTERNS not found");return t}function km(e){return $m(Jg,e)}function Dm(e){return $m(tm,e)}function Tm(e){return $m(am,e)}function Rm(e){const t=kl.lookupVariable(mm,e);if(!(t instanceof Zd))throw new Error("VAR_LINE_FILTER not found");return t}function Im(e){const t=kl.lookupVariable(lm,e);if(!(t instanceof Qg))throw new Error("VAR_LABEL_GROUP_BY not found");return t}function Am(e){const t=kl.lookupVariable(_m,e);if(!(t instanceof Qg))throw new Error("SERVICE_LABEL_VAR not found");return t}function jm(e){const t=kl.lookupVariable(sm,e);if(!(t instanceof Qg))throw new Error("VAR_FIELD_GROUP_BY not found");return t}function Lm(e){const t=kl.lookupVariable(um,e);if(!(t instanceof rp))throw new Error("VAR_DATASOURCE not found");return t}function $m(e,t){const n=kl.lookupVariable(e,t);if(!(n instanceof vs))throw new Error(`Could not get AdHocFiltersVariable ${e}. Variable not found.`);return n}function Fm(e){const t=kl.lookupVariable(cm,e);if(!(t instanceof Qg))throw new Error("VAR_SERVICE not found");return t}function Nm(e){return`var-${e}`}function Mm(e,t=tm){try{return JSON.parse(e.value)}catch(n){if(Gg.warn(`Failed to parse ${t}`,{value:e.value}),e.value)return{value:e.value,parser:"mixed"};throw n}}function Vm(e,t){return e.state.name===tm&&t?Mm(t):{value:null==t?void 0:t.value}}function Bm(e){const t=e.filters.filter((e=>e.key===xm)).map((e=>e.value));if(!t)throw new Error("Service present in filters selected");return t[0]}function zm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Wm=zg.id,Qm=`/a/${Wm}`;var Um,qm;function Hm(e){return e.replace(/\//g,"-")}!function(e){e.explore="explore",e.logs="logs",e.labels="labels",e.patterns="patterns",e.fields="fields"}(Um||(Um={})),function(e){e.field="field",e.label="label"}(qm||(qm={}));const Gm={explore:()=>Km("explore"),logs:e=>Km(`explore/service/${Hm(e)}/logs`),fields:e=>Km(`explore/service/${Hm(e)}/fields`),patterns:e=>Km(`explore/service/${Hm(e)}/patterns`),labels:e=>Km(`explore/service/${Hm(e)}/labels`)},Xm={label:(e,t)=>Km(`explore/service/${Hm(e)}/label/${t}`),field:(e,t)=>Km(`explore/service/${Hm(e)}/field/${t}`)},Ym={explore:Km("explore"),logs:Km("explore/service/:service/logs"),fields:Km("explore/service/:service/fields"),patterns:Km("explore/service/:service/patterns"),labels:Km("explore/service/:service/labels")},Zm={field:Km("explore/service/:service/field/:label"),label:Km("explore/service/:service/label/:label")};function Km(e){return`${Qm}/${e}`}const Jm=["from","to",`var-${um}`],eb=["from","to","mode","urlColumns","visualizationType","selectedLine","displayedFields",rm,`var-${rm}`,`var-${um}`,`var-${Jg}`,`var-${tm}`,`var-${am}`,`var-${sm}`,`var-${lm}`,`var-${um}`,`var-${mm}`];function tb(){const e=a.locationService.getLocation();return e.pathname.slice(e.pathname.lastIndexOf("/")+1,e.pathname.length)}function nb(){const e=a.locationService.getLocation().pathname.split("/");return e[e.length-2]}function rb(e){return{service:e.params.service}}function ib(e="/explore",t){return`/a/${zg.id}${e}${t?`?${t.toString()}`:""}`}const ab={DatasourceId:`var-${um}`,TimeRangeFrom:"from",TimeRangeTo:"to",Labels:`var-${Jg}`,Fields:`var-${tm}`};function ob(e,t,n){var r;const i=new URLSearchParams(null!==(r=null==n?void 0:n.toString())&&void 0!==r?r:location.search);return i.set(e,t),i}function sb(e,t,n){var r;const i=new URLSearchParams(null!==(r=null==n?void 0:n.toString())&&void 0!==r?r:location.search);return i.append(e,t),i}const lb=`${zg.id}.services.favorite`,cb=`${zg.id}.datasource`;function ub(e){return`${lb}_${e}`}const db=`${zg.id}.values.sort`;function pb(e,t,n){var r;const i=(null!==(r=localStorage.getItem(`${db}.${e}.by`))&&void 0!==r?r:"").split(".");return i[0]&&i[1]?{sortBy:i[0],direction:i[1]}:{sortBy:t,direction:n}}function fb(e,t,n){t&&n&&localStorage.setItem(`${db}.${e}.by`,`${t}.${n}`)}const hb=`${zg.id}.logs.option`;function gb(e){return localStorage.getItem(`${hb}.${e}`)}function mb(e){return`${Lm(e).getValue()}.${Bm(km(e).state)}`}function bb(e){const t=mb(e),n=localStorage.getItem(`${zg.id}.${t}.logs.fields`);return n?JSON.parse(n):[]}function vb(e,t){const n=mb(e);localStorage.setItem(`${zg.id}.${n}.logs.fields`,JSON.stringify(t))}function yb(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function Ob(e){return kl.getAncestor(e,FT)}function wb(e){return kl.interpolate(e,dm)}function Sb(e){const t=a.config.theme2.visualization;return t.getColorByName(t.palette[e%8])}function xb(){var e;return e=function*(e){return yield(0,a.getDataSourceSrv)().get(dm,{__sceneObject:{value:e}})},xb=function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){yb(a,r,i,o,s,"next",e)}function s(e){yb(a,r,i,o,s,"throw",e)}o(void 0)}))},xb.apply(this,arguments)}function _b(e){return null!=e}var Pb;!function(e){e.Equal="=",e.NotEqual="!="}(Pb||(Pb={}));const Eb=["level_extracted",Sm,"level"],Cb=[xm];function kb(e){const t=[...e].map((e=>({label:e,value:String(e)})));return[{label:"All",value:wm},...t]}const Db={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};var Tb,Rb=new Uint8Array(16);function Ib(){if(!Tb&&!(Tb="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Tb(Rb)}for(var Ab=[],jb=0;jb<256;++jb)Ab.push((jb+256).toString(16).slice(1));const Lb=function(e,t,n){if(Db.randomUUID&&!t&&!e)return Db.randomUUID();var r=(e=e||{}).random||(e.rng||Ib)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return function(e,t=0){return(Ab[e[t+0]]+Ab[e[t+1]]+Ab[e[t+2]]+Ab[e[t+3]]+"-"+Ab[e[t+4]]+Ab[e[t+5]]+"-"+Ab[e[t+6]]+Ab[e[t+7]]+"-"+Ab[e[t+8]]+Ab[e[t+9]]+"-"+Ab[e[t+10]]+Ab[e[t+11]]+Ab[e[t+12]]+Ab[e[t+13]]+Ab[e[t+14]]+Ab[e[t+15]]).toLowerCase()}(r)},$b=1024;let Fb=0;class Nb{constructor(e,t){this.from=e,this.to=t}}class Mb{constructor(e={}){this.id=Fb++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof e&&(e=zb.match(e)),t=>{let n=e(t);return void 0===n?null:[this,n]}}}Mb.closedBy=new Mb({deserialize:e=>e.split(" ")}),Mb.openedBy=new Mb({deserialize:e=>e.split(" ")}),Mb.group=new Mb({deserialize:e=>e.split(" ")}),Mb.isolate=new Mb({deserialize:e=>{if(e&&"rtl"!=e&&"ltr"!=e&&"auto"!=e)throw new RangeError("Invalid value for isolate: "+e);return e||"auto"}}),Mb.contextHash=new Mb({perNode:!0}),Mb.lookAhead=new Mb({perNode:!0}),Mb.mounted=new Mb({perNode:!0});class Vb{constructor(e,t,n){this.tree=e,this.overlay=t,this.parser=n}static get(e){return e&&e.props&&e.props[Mb.mounted.id]}}const Bb=Object.create(null);class zb{constructor(e,t,n,r=0){this.name=e,this.props=t,this.id=n,this.flags=r}static define(e){let t=e.props&&e.props.length?Object.create(null):Bb,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(null==e.name?8:0),r=new zb(e.name||"",t,e.id,n);if(e.props)for(let n of e.props)if(Array.isArray(n)||(n=n(r)),n){if(n[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[n[0].id]=n[1]}return r}prop(e){return this.props[e.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(e){if("string"==typeof e){if(this.name==e)return!0;let t=this.prop(Mb.group);return!!t&&t.indexOf(e)>-1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let r of n.split(" "))t[r]=e[n];return e=>{for(let n=e.prop(Mb.group),r=-1;r<(n?n.length:0);r++){let i=t[r<0?e.name:n[r]];if(i)return i}}}}zb.none=new zb("",Object.create(null),0,8);class Wb{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let n of this.types){let r=null;for(let t of e){let e=t(n);e&&(r||(r=Object.assign({},n.props)),r[e[0].id]=e[1])}t.push(r?new zb(n.name,r,n.id,n.flags):n)}return new Wb(t)}}const Qb=new WeakMap,Ub=new WeakMap;var qb;!function(e){e[e.ExcludeBuffers=1]="ExcludeBuffers",e[e.IncludeAnonymous=2]="IncludeAnonymous",e[e.IgnoreMounts=4]="IgnoreMounts",e[e.IgnoreOverlays=8]="IgnoreOverlays"}(qb||(qb={}));class Hb{constructor(e,t,n,r,i){if(this.type=e,this.children=t,this.positions=n,this.length=r,this.props=null,i&&i.length){this.props=Object.create(null);for(let[e,t]of i)this.props["number"==typeof e?e:e.id]=t}}toString(){let e=Vb.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let e of this.children){let n=e.toString();n&&(t&&(t+=","),t+=n)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new ov(this.topNode,e)}cursorAt(e,t=0,n=0){let r=Qb.get(this)||this.topNode,i=new ov(r);return i.moveTo(e,t),Qb.set(this,i._tree),i}get topNode(){return new Jb(this,0,0,null)}resolve(e,t=0){let n=Zb(Qb.get(this)||this.topNode,e,t,!1);return Qb.set(this,n),n}resolveInner(e,t=0){let n=Zb(Ub.get(this)||this.topNode,e,t,!0);return Ub.set(this,n),n}resolveStack(e,t=0){return function(e,t,n){let r=e.resolveInner(t,n),i=null;for(let e=r instanceof Jb?r:r.context.parent;e;e=e.parent)if(e.index<0){let a=e.parent;(i||(i=[r])).push(a.resolve(t,n)),e=a}else{let a=Vb.get(e.tree);if(a&&a.overlay&&a.overlay[0].from<=t&&a.overlay[a.overlay.length-1].to>=t){let o=new Jb(a.tree,a.overlay[0].from+e.from,-1,e);(i||(i=[r])).push(Zb(o,t,n,!1))}}return i?iv(i):r}(this,e,t)}iterate(e){let{enter:t,leave:n,from:r=0,to:i=this.length}=e,a=e.mode||0,o=(a&qb.IncludeAnonymous)>0;for(let e=this.cursor(a|qb.IncludeAnonymous);;){let a=!1;if(e.from<=i&&e.to>=r&&(!o&&e.type.isAnonymous||!1!==t(e))){if(e.firstChild())continue;a=!0}for(;a&&n&&(o||!e.type.isAnonymous)&&n(e),!e.nextSibling();){if(!e.parent())return;a=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:uv(zb.none,this.children,this.positions,0,this.children.length,0,this.length,((e,t,n)=>new Hb(this.type,e,t,n,this.propValues)),e.makeTree||((e,t,n)=>new Hb(zb.none,e,t,n)))}static build(e){return function(e){var t;let{buffer:n,nodeSet:r,maxBufferLength:i=$b,reused:a=[],minRepeatType:o=r.types.length}=e,s=Array.isArray(n)?new Gb(n,n.length):n,l=r.types,c=0,u=0;function d(e,t,n,m,b,v){let{id:y,start:O,end:w,size:S}=s,x=u;for(;S<0;){if(s.next(),-1==S){let t=a[y];return n.push(t),void m.push(O-e)}if(-3==S)return void(c=y);if(-4==S)return void(u=y);throw new RangeError(`Unrecognized record size: ${S}`)}let _,P,E=l[y],C=O-e;if(w-O<=i&&(P=function(e,t){let n=s.fork(),r=0,a=0,l=0,c=n.end-i,u={size:0,start:0,skip:0};e:for(let i=n.pos-e;n.pos>i;){let e=n.size;if(n.id==t&&e>=0){u.size=r,u.start=a,u.skip=l,l+=4,r+=4,n.next();continue}let s=n.pos-e;if(e<0||s<i||n.start<c)break;let d=n.id>=o?4:0,p=n.start;for(n.next();n.pos>s;){if(n.size<0){if(-3!=n.size)break e;d+=4}else n.id>=o&&(d+=4);n.next()}a=p,r+=e,l+=d}return(t<0||r==e)&&(u.size=r,u.start=a,u.skip=l),u.size>4?u:void 0}(s.pos-t,b))){let t=new Uint16Array(P.size-P.skip),n=s.pos-P.size,i=t.length;for(;s.pos>n;)i=g(P.start,t,i);_=new Xb(t,w-P.start,r),C=P.start-e}else{let e=s.pos-S;s.next();let t=[],n=[],r=y>=o?y:-1,a=0,l=w;for(;s.pos>e;)r>=0&&s.id==r&&s.size>=0?(s.end<=l-i&&(f(t,n,O,a,s.end,l,r,x),a=t.length,l=s.end),s.next()):v>2500?p(O,e,t,n):d(O,e,t,n,r,v+1);if(r>=0&&a>0&&a<t.length&&f(t,n,O,a,O,l,r,x),t.reverse(),n.reverse(),r>-1&&a>0){let e=function(e){return(t,n,r)=>{let i,a,o=0,s=t.length-1;if(s>=0&&(i=t[s])instanceof Hb){if(!s&&i.type==e&&i.length==r)return i;(a=i.prop(Mb.lookAhead))&&(o=n[s]+i.length+a)}return h(e,t,n,r,o)}}(E);_=uv(E,t,n,0,t.length,0,w-O,e,e)}else _=h(E,t,n,w-O,x-w)}n.push(_),m.push(C)}function p(e,t,n,a){let o=[],l=0,c=-1;for(;s.pos>t;){let{id:e,start:t,end:n,size:r}=s;if(r>4)s.next();else{if(c>-1&&t<c)break;c<0&&(c=n-i),o.push(e,t,n),l++,s.next()}}if(l){let t=new Uint16Array(4*l),i=o[o.length-2];for(let e=o.length-3,n=0;e>=0;e-=3)t[n++]=o[e],t[n++]=o[e+1]-i,t[n++]=o[e+2]-i,t[n++]=n;n.push(new Xb(t,o[2]-i,r)),a.push(i-e)}}function f(e,t,n,i,a,o,s,l){let c=[],u=[];for(;e.length>i;)c.push(e.pop()),u.push(t.pop()+n-a);e.push(h(r.types[s],c,u,o-a,l-o)),t.push(a-n)}function h(e,t,n,r,i=0,a){if(c){let e=[Mb.contextHash,c];a=a?[e].concat(a):[e]}if(i>25){let e=[Mb.lookAhead,i];a=a?[e].concat(a):[e]}return new Hb(e,t,n,r,a)}function g(e,t,n){let{id:r,start:i,end:a,size:l}=s;if(s.next(),l>=0&&r<o){let o=n;if(l>4){let r=s.pos-(l-4);for(;s.pos>r;)n=g(e,t,n)}t[--n]=o,t[--n]=a-e,t[--n]=i-e,t[--n]=r}else-3==l?c=r:-4==l&&(u=r);return n}let m=[],b=[];for(;s.pos>0;)d(e.start||0,e.bufferStart||0,m,b,-1,0);let v=null!==(t=e.length)&&void 0!==t?t:m.length?b[0]+m[0].length:0;return new Hb(l[e.topID],m.reverse(),b.reverse(),v)}(e)}}Hb.empty=new Hb(zb.none,[],[],0);class Gb{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Gb(this.buffer,this.index)}}class Xb{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return zb.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],r=this.set.types[t],i=r.name;if(/\W/.test(i)&&!r.isError&&(i=JSON.stringify(i)),n==(e+=4))return i;let a=[];for(;e<n;)a.push(this.childString(e)),e=this.buffer[e+3];return i+"("+a.join(",")+")"}findChild(e,t,n,r,i){let{buffer:a}=this,o=-1;for(let s=e;s!=t&&!(Yb(i,r,a[s+1],a[s+2])&&(o=s,n>0));s=a[s+3]);return o}slice(e,t,n){let r=this.buffer,i=new Uint16Array(t-e),a=0;for(let o=e,s=0;o<t;){i[s++]=r[o++],i[s++]=r[o++]-n;let t=i[s++]=r[o++]-n;i[s++]=r[o++]-e,a=Math.max(a,t)}return new Xb(i,a,this.set)}}function Yb(e,t,n,r){switch(e){case-2:return n<t;case-1:return r>=t&&n<t;case 0:return n<t&&r>t;case 1:return n<=t&&r>t;case 2:return r>t;case 4:return!0}}function Zb(e,t,n,r){for(var i;e.from==e.to||(n<1?e.from>=t:e.from>t)||(n>-1?e.to<=t:e.to<t);){let t=!r&&e instanceof Jb&&e.index<0?null:e.parent;if(!t)return e;e=t}let a=r?0:qb.IgnoreOverlays;if(r)for(let r=e,o=r.parent;o;r=o,o=r.parent)r instanceof Jb&&r.index<0&&(null===(i=o.enter(t,n,a))||void 0===i?void 0:i.from)!=r.from&&(e=o);for(;;){let r=e.enter(t,n,a);if(!r)return e;e=r}}class Kb{cursor(e=0){return new ov(this,e)}getChild(e,t=null,n=null){let r=ev(this,e,t,n);return r.length?r[0]:null}getChildren(e,t=null,n=null){return ev(this,e,t,n)}resolve(e,t=0){return Zb(this,e,t,!1)}resolveInner(e,t=0){return Zb(this,e,t,!0)}matchContext(e){return tv(this,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),n=this;for(;t;){let e=t.lastChild;if(!e||e.to!=t.to)break;e.type.isError&&e.from==e.to?(n=t,t=e.prevSibling):t=e}return n}get node(){return this}get next(){return this.parent}}class Jb extends Kb{constructor(e,t,n,r){super(),this._tree=e,this.from=t,this.index=n,this._parent=r}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,n,r,i=0){for(let a=this;;){for(let{children:o,positions:s}=a._tree,l=t>0?o.length:-1;e!=l;e+=t){let l=o[e],c=s[e]+a.from;if(Yb(r,n,c,c+l.length))if(l instanceof Xb){if(i&qb.ExcludeBuffers)continue;let o=l.findChild(0,l.buffer.length,t,n-c,r);if(o>-1)return new rv(new nv(a,l,e,c),null,o)}else if(i&qb.IncludeAnonymous||!l.type.isAnonymous||sv(l)){let o;if(!(i&qb.IgnoreMounts)&&(o=Vb.get(l))&&!o.overlay)return new Jb(o.tree,c,e,a);let s=new Jb(l,c,e,a);return i&qb.IncludeAnonymous||!s.type.isAnonymous?s:s.nextChild(t<0?l.children.length-1:0,t,n,r)}}if(i&qb.IncludeAnonymous||!a.type.isAnonymous)return null;if(e=a.index>=0?a.index+t:t<0?-1:a._parent._tree.children.length,a=a._parent,!a)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,n=0){let r;if(!(n&qb.IgnoreOverlays)&&(r=Vb.get(this._tree))&&r.overlay){let n=e-this.from;for(let{from:e,to:i}of r.overlay)if((t>0?e<=n:e<n)&&(t<0?i>=n:i>n))return new Jb(r.tree,r.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function ev(e,t,n,r){let i=e.cursor(),a=[];if(!i.firstChild())return a;if(null!=n)for(let e=!1;!e;)if(e=i.type.is(n),!i.nextSibling())return a;for(;;){if(null!=r&&i.type.is(r))return a;if(i.type.is(t)&&a.push(i.node),!i.nextSibling())return null==r?a:[]}}function tv(e,t,n=t.length-1){for(let r=e.parent;n>=0;r=r.parent){if(!r)return!1;if(!r.type.isAnonymous){if(t[n]&&t[n]!=r.name)return!1;n--}}return!0}class nv{constructor(e,t,n,r){this.parent=e,this.buffer=t,this.index=n,this.start=r}}class rv extends Kb{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,n){super(),this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,t,n){let{buffer:r}=this.context,i=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.context.start,n);return i<0?null:new rv(this.context,this,i)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,n=0){if(n&qb.ExcludeBuffers)return null;let{buffer:r}=this.context,i=r.findChild(this.index+4,r.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return i<0?null:new rv(this.context,this,i)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new rv(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new rv(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,r=this.index+4,i=n.buffer[this.index+3];if(i>r){let a=n.buffer[this.index+1];e.push(n.slice(r,i,a)),t.push(0)}return new Hb(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function iv(e){if(!e.length)return null;let t=0,n=e[0];for(let r=1;r<e.length;r++){let i=e[r];(i.from>n.from||i.to<n.to)&&(n=i,t=r)}let r=n instanceof Jb&&n.index<0?null:n.parent,i=e.slice();return r?i[t]=r:i.splice(t,1),new av(i,n)}class av{constructor(e,t){this.heads=e,this.node=t}get next(){return iv(this.heads)}}class ov{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Jb)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let t=e._parent;t;t=t._parent)this.stack.unshift(t.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return!!e&&(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0)}yieldBuf(e,t){this.index=e;let{start:n,buffer:r}=this.buffer;return this.type=t||r.set.types[r.buffer[e]],this.from=n+r.buffer[e+1],this.to=n+r.buffer[e+2],!0}yield(e){return!!e&&(e instanceof Jb?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:r}=this.buffer,i=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.buffer.start,n);return!(i<0)&&(this.stack.push(this.index),this.yieldBuf(i))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,n=this.mode){return this.buffer?!(n&qb.ExcludeBuffers)&&this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&qb.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&qb.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode));let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let e=n<0?0:this.stack[n]+4;if(this.index!=e)return this.yieldBuf(t.findChild(e,this.index,-1,0,4))}else{let e=t.buffer[this.index+3];if(e<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(e)}return n<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:r}=this;if(r){if(e>0){if(this.index<r.buffer.buffer.length)return!1}else for(let e=0;e<this.index;e++)if(r.buffer.buffer[e+3]<this.index)return!1;({index:t,parent:n}=r)}else({index:t,_parent:n}=this._tree);for(;n;({index:t,_parent:n}=n))if(t>-1)for(let r=t+e,i=e<0?-1:n._tree.children.length;r!=i;r+=e){let e=n._tree.children[r];if(this.mode&qb.IncludeAnonymous||e instanceof Xb||!e.type.isAnonymous||sv(e))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let r=this.index,i=this.stack.length;i>=0;){for(let a=e;a;a=a._parent)if(a.index==r){if(r==this.index)return a;t=a,n=i+1;break e}r=this.stack[--i]}for(let e=n;e<this.stack.length;e++)t=new rv(this.buffer,t,this.stack[e]);return this.bufferNode=new rv(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let r=!1;if(this.type.isAnonymous||!1!==e(this)){if(this.firstChild()){n++;continue}this.type.isAnonymous||(r=!0)}for(;r&&t&&t(this),r=this.type.isAnonymous,!this.nextSibling();){if(!n)return;this.parent(),n--,r=!0}}}matchContext(e){if(!this.buffer)return tv(this.node,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let r=e.length-1,i=this.stack.length-1;r>=0;i--){if(i<0)return tv(this.node,e,r);let a=n[t.buffer[this.stack[i]]];if(!a.isAnonymous){if(e[r]&&e[r]!=a.name)return!1;r--}}return!0}}function sv(e){return e.children.some((e=>e instanceof Xb||!e.type.isAnonymous||sv(e)))}const lv=new WeakMap;function cv(e,t){if(!e.isAnonymous||t instanceof Xb||t.type!=e)return 1;let n=lv.get(t);if(null==n){n=1;for(let r of t.children){if(r.type!=e||!(r instanceof Hb)){n=1;break}n+=cv(e,r)}lv.set(t,n)}return n}function uv(e,t,n,r,i,a,o,s,l){let c=0;for(let n=r;n<i;n++)c+=cv(e,t[n]);let u=Math.ceil(1.5*c/8),d=[],p=[];return function t(n,r,i,o,s){for(let c=i;c<o;){let i=c,f=r[c],h=cv(e,n[c]);for(c++;c<o;c++){let t=cv(e,n[c]);if(h+t>=u)break;h+=t}if(c==i+1){if(h>u){let e=n[i];t(e.children,e.positions,0,e.children.length,r[i]+s);continue}d.push(n[i])}else{let t=r[c-1]+n[c-1].length-f;d.push(uv(e,n,r,i,c,f,t,null,l))}p.push(f+s-a)}}(t,n,r,i,0),(s||l)(d,p,o)}class dv{startParse(e,t,n){return"string"==typeof e&&(e=new pv(e)),n=n?n.length?n.map((e=>new Nb(e.from,e.to))):[new Nb(0,0)]:[new Nb(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let r=this.startParse(e,t,n);for(;;){let e=r.advance();if(e)return e}}}class pv{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new Mb({perNode:!0});class fv{constructor(e,t,n,r,i,a,o,s,l,c=0,u){this.p=e,this.stack=t,this.state=n,this.reducePos=r,this.pos=i,this.score=a,this.buffer=o,this.bufferBase=s,this.curContext=l,this.lookAhead=c,this.parent=u}toString(){return`[${this.stack.filter(((e,t)=>t%3==0)).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,n=0){let r=e.parser.context;return new fv(e,[],t,n,n,0,[],0,r?new hv(r,r.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var t;let n=e>>19,r=65535&e,{parser:i}=this.p;this.reducePos<this.pos-25&&this.setLookAhead(this.pos);let a=i.dynamicPrecedence(r);if(a&&(this.score+=a),0==n)return this.pushState(i.getGoto(this.state,r,!0),this.reducePos),r<i.minRepeatTerm&&this.storeNode(r,this.reducePos,this.reducePos,4,!0),void this.reduceContext(r,this.reducePos);let o=this.stack.length-3*(n-1)-(262144&e?6:0),s=o?this.stack[o-2]:this.p.ranges[0].from,l=this.reducePos-s;l>=2e3&&!(null===(t=this.p.parser.nodeSet.types[r])||void 0===t?void 0:t.isAnonymous)&&(s==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=l):this.p.lastBigReductionSize<l&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=s,this.p.lastBigReductionSize=l));let c=o?this.stack[o-1]:0,u=this.bufferBase+this.buffer.length-c;if(r<i.minRepeatTerm||131072&e){let e=i.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(r,s,e,u+4,!0)}if(262144&e)this.state=this.stack[o];else{let e=this.stack[o-3];this.state=i.getGoto(e,r,!0)}for(;this.stack.length>o;)this.stack.pop();this.reduceContext(r,s)}storeNode(e,t,n,r=4,i=!1){if(0==e&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let e=this,r=this.buffer.length;if(0==r&&e.parent&&(r=e.bufferBase-e.parent.bufferBase,e=e.parent),r>0&&0==e.buffer[r-4]&&e.buffer[r-1]>-1){if(t==n)return;if(e.buffer[r-2]>=t)return void(e.buffer[r-2]=n)}}if(i&&this.pos!=n){let i=this.buffer.length;if(i>0&&0!=this.buffer[i-4])for(;i>0&&this.buffer[i-2]>n;)this.buffer[i]=this.buffer[i-4],this.buffer[i+1]=this.buffer[i-3],this.buffer[i+2]=this.buffer[i-2],this.buffer[i+3]=this.buffer[i-1],i-=4,r>4&&(r-=4);this.buffer[i]=e,this.buffer[i+1]=t,this.buffer[i+2]=n,this.buffer[i+3]=r}else this.buffer.push(e,t,n,r)}shift(e,t,n,r){if(131072&e)this.pushState(65535&e,this.pos);else if(262144&e)this.pos=r,this.shiftContext(t,n),t<=this.p.parser.maxNode&&this.buffer.push(t,n,r,4);else{let i=e,{parser:a}=this.p;(r>this.pos||t<=a.maxNode)&&(this.pos=r,a.stateFlag(i,1)||(this.reducePos=r)),this.pushState(i,n),this.shiftContext(t,n),t<=a.maxNode&&this.buffer.push(t,n,r,4)}}apply(e,t,n,r){65536&e?this.reduce(e):this.shift(e,t,n,r)}useNode(e,t){let n=this.p.reused.length-1;(n<0||this.p.reused[n]!=e)&&(this.p.reused.push(e),n++);let r=this.pos;this.reducePos=this.pos=r+e.length,this.pushState(t,r),this.buffer.push(n,r,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let n=e.buffer.slice(t),r=e.bufferBase+t;for(;e&&r==e.bufferBase;)e=e.parent;return new fv(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,n,r,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let n=e<=this.p.parser.maxNode;n&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,n?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new gv(this);;){let n=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(0==n)return!1;if(!(65536&n))return!0;t.reduce(n)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let n=[];for(let r,i=0;i<t.length;i+=2)(r=t[i+1])!=this.state&&this.p.parser.hasAction(r,e)&&n.push(t[i],r);if(this.stack.length<120)for(let e=0;n.length<8&&e<t.length;e+=2){let r=t[e+1];n.some(((e,t)=>1&t&&e==r))||n.push(t[e],r)}t=n}let n=[];for(let e=0;e<t.length&&n.length<4;e+=2){let r=t[e+1];if(r==this.state)continue;let i=this.split();i.pushState(r,this.pos),i.storeNode(0,i.pos,i.pos,4,!0),i.shiftContext(t[e],this.pos),i.reducePos=this.pos,i.score-=200,n.push(i)}return n}forceReduce(){let{parser:e}=this.p,t=e.stateSlot(this.state,5);if(!(65536&t))return!1;if(!e.validAction(this.state,t)){let n=t>>19,r=65535&t,i=this.stack.length-3*n;if(i<0||e.getGoto(this.stack[i],r,!1)<0){let e=this.findForcedReduction();if(null==e)return!1;t=e}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}findForcedReduction(){let{parser:e}=this.p,t=[],n=(r,i)=>{if(!t.includes(r))return t.push(r),e.allActions(r,(t=>{if(393216&t);else if(65536&t){let n=(t>>19)-i;if(n>1){let r=65535&t,i=this.stack.length-3*n;if(i>=0&&e.getGoto(this.stack[i],r,!1)>=0)return n<<19|65536|r}}else{let e=n(t,i+1);if(null!=e)return e}}))};return n(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(3!=this.stack.length)return!1;let{parser:e}=this.p;return 65535==e.data[e.stateSlot(this.state,1)]&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||-3!=this.buffer[e])&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||-4!=this.buffer[e])&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new hv(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class hv{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}class gv{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=65535&e,n=e>>19;0==n?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=3*(n-1);let r=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=r}}class mv{constructor(e,t,n){this.stack=e,this.pos=t,this.index=n,this.buffer=e.buffer,0==this.index&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new mv(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;null!=e&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,0==this.index&&this.maybeNext()}fork(){return new mv(this.stack,this.pos,this.index)}}function bv(e,t=Uint16Array){if("string"!=typeof e)return e;let n=null;for(let r=0,i=0;r<e.length;){let a=0;for(;;){let t=e.charCodeAt(r++),n=!1;if(126==t){a=65535;break}t>=92&&t--,t>=34&&t--;let i=t-32;if(i>=46&&(i-=46,n=!0),a+=i,n)break;a*=46}n?n[i++]=a:n=new t(a)}return n}class vv{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const yv=new vv;class Ov{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=yv,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let n=this.range,r=this.rangeIndex,i=this.pos+e;for(;i<n.from;){if(!r)return null;let e=this.ranges[--r];i-=n.from-e.to,n=e}for(;t<0?i>n.to:i>=n.to;){if(r==this.ranges.length-1)return null;let e=this.ranges[++r];i+=e.from-n.to,n=e}return i}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t,n,r=this.chunkOff+e;if(r>=0&&r<this.chunk.length)t=this.pos+e,n=this.chunk.charCodeAt(r);else{let r=this.resolveOffset(e,1);if(null==r)return-1;if(t=r,t>=this.chunk2Pos&&t<this.chunk2Pos+this.chunk2.length)n=this.chunk2.charCodeAt(t-this.chunk2Pos);else{let e=this.rangeIndex,r=this.range;for(;r.to<=t;)r=this.ranges[++e];this.chunk2=this.input.chunk(this.chunk2Pos=t),t+this.chunk2.length>r.to&&(this.chunk2=this.chunk2.slice(0,r.to-t)),n=this.chunk2.charCodeAt(0)}}return t>=this.token.lookAhead&&(this.token.lookAhead=t+1),n}acceptToken(e,t=0){let n=t?this.resolveOffset(t,-1):this.pos;if(null==n||n<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=n}acceptTokenTo(e,t){this.token.value=e,this.token.end=t}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=yv,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let n="";for(let r of this.ranges){if(r.from>=t)break;r.to>e&&(n+=this.input.read(Math.max(r.from,e),Math.min(r.to,t)))}return n}}class wv{constructor(e,t){this.data=e,this.id=t}token(e,t){let{parser:n}=t.p;!function(e,t,n,r,i,a){let o=0,s=1<<r,{dialect:l}=n.p.parser;e:for(;s&e[o];){let n=e[o+1];for(let r=o+3;r<n;r+=2)if((e[r+1]&s)>0){let n=e[r];if(l.allows(n)&&(-1==t.token.value||t.token.value==n||xv(n,t.token.value,i,a))){t.acceptToken(n);break}}let r=t.next,c=0,u=e[o+2];if(!(t.next<0&&u>c&&65535==e[n+3*u-3])){for(;c<u;){let i=c+u>>1,a=n+i+(i<<1),s=e[a],l=e[a+1]||65536;if(r<s)u=i;else{if(!(r>=l)){o=e[a+2],t.advance();continue e}c=i+1}}break}o=e[n+3*u-1]}}(this.data,e,t,this.id,n.data,n.tokenPrecTable)}}function Sv(e,t,n){for(let r,i=t;65535!=(r=e[i]);i++)if(r==n)return i-t;return-1}function xv(e,t,n,r){let i=Sv(n,r,t);return i<0||Sv(n,r,e)<i}wv.prototype.contextual=wv.prototype.fallback=wv.prototype.extend=!1,wv.prototype.fallback=wv.prototype.extend=!1;const _v="undefined"!=typeof process&&process.env&&/\bparse\b/.test(process.env.LOG);let Pv=null;function Ev(e,t,n){let r=e.cursor(qb.IncludeAnonymous);for(r.moveTo(t);;)if(!(n<0?r.childBefore(t):r.childAfter(t)))for(;;){if((n<0?r.to<t:r.from>t)&&!r.type.isError)return n<0?Math.max(0,Math.min(r.to-1,t-25)):Math.min(e.length,Math.max(r.from+1,t+25));if(n<0?r.prevSibling():r.nextSibling())break;if(!r.parent())return n<0?0:e.length}}class Cv{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?Ev(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?Ev(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let n=this.trees[t],r=this.index[t];if(r==n.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let i=n.children[r],a=this.start[t]+n.positions[r];if(a>e)return this.nextStart=a,null;if(i instanceof Hb){if(a==e){if(a<this.safeFrom)return null;let e=a+i.length;if(e<=this.safeTo){let t=i.prop(Mb.lookAhead);if(!t||e+t<this.fragment.to)return i}}this.index[t]++,a+i.length>=Math.max(this.safeFrom,e)&&(this.trees.push(i),this.start.push(a),this.index.push(0))}else this.index[t]++,this.nextStart=a+i.length}}}class kv{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map((e=>new vv))}getActions(e){let t=0,n=null,{parser:r}=e.p,{tokenizers:i}=r,a=r.stateSlot(e.state,3),o=e.curContext?e.curContext.hash:0,s=0;for(let r=0;r<i.length;r++){if(!(1<<r&a))continue;let l=i[r],c=this.tokens[r];if((!n||l.fallback)&&((l.contextual||c.start!=e.pos||c.mask!=a||c.context!=o)&&(this.updateCachedToken(c,l,e),c.mask=a,c.context=o),c.lookAhead>c.end+25&&(s=Math.max(c.lookAhead,s)),0!=c.value)){let r=t;if(c.extended>-1&&(t=this.addActions(e,c.extended,c.end,t)),t=this.addActions(e,c.value,c.end,t),!l.extend&&(n=c,t>r))break}}for(;this.actions.length>t;)this.actions.pop();return s&&e.setLookAhead(s),n||e.pos!=this.stream.end||(n=new vv,n.value=e.p.parser.eofTerm,n.start=n.end=e.pos,t=this.addActions(e,n.value,n.end,t)),this.mainToken=n,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new vv,{pos:n,p:r}=e;return t.start=n,t.end=Math.min(n+1,r.stream.end),t.value=n==r.stream.end?r.parser.eofTerm:0,t}updateCachedToken(e,t,n){let r=this.stream.clipPos(n.pos);if(t.token(this.stream.reset(r,e),n),e.value>-1){let{parser:t}=n.p;for(let r=0;r<t.specialized.length;r++)if(t.specialized[r]==e.value){let i=t.specializers[r](this.stream.read(e.start,e.end),n);if(i>=0&&n.p.parser.dialect.allows(i>>1)){1&i?e.extended=i>>1:e.value=i>>1;break}}}else e.value=0,e.end=this.stream.clipPos(r+1)}putAction(e,t,n,r){for(let t=0;t<r;t+=3)if(this.actions[t]==e)return r;return this.actions[r++]=e,this.actions[r++]=t,this.actions[r++]=n,r}addActions(e,t,n,r){let{state:i}=e,{parser:a}=e.p,{data:o}=a;for(let e=0;e<2;e++)for(let s=a.stateSlot(i,e?2:1);;s+=3){if(65535==o[s]){if(1!=o[s+1]){0==r&&2==o[s+1]&&(r=this.putAction(Av(o,s+2),t,n,r));break}s=Av(o,s+2)}o[s]==t&&(r=this.putAction(Av(o,s+1),t,n,r))}return r}}class Dv{constructor(e,t,n,r){this.parser=e,this.input=t,this.ranges=r,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new Ov(t,r),this.tokens=new kv(e,this.stream),this.topTerm=e.top[1];let{from:i}=r[0];this.stacks=[fv.start(this,e.top[0],i)],this.fragments=n.length&&this.stream.end-i>4*e.bufferLength?new Cv(n,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e,t,n=this.stacks,r=this.minStackPos,i=this.stacks=[];if(this.bigReductionCount>300&&1==n.length){let[e]=n;for(;e.forceReduce()&&e.stack.length&&e.stack[e.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let a=0;a<n.length;a++){let o=n[a];for(;;){if(this.tokens.mainToken=null,o.pos>r)i.push(o);else{if(this.advanceStack(o,i,n))continue;{e||(e=[],t=[]),e.push(o);let n=this.tokens.getMainToken(o);t.push(n.value,n.end)}}break}}if(!i.length){let t=e&&function(e){let t=null;for(let n of e){let e=n.p.stoppedAt;(n.pos==n.p.stream.end||null!=e&&n.pos>e)&&n.p.parser.stateFlag(n.state,2)&&(!t||t.score<n.score)&&(t=n)}return t}(e);if(t)return _v&&console.log("Finish with "+this.stackID(t)),this.stackToTree(t);if(this.parser.strict)throw _v&&e&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+r);this.recovering||(this.recovering=5)}if(this.recovering&&e){let n=null!=this.stoppedAt&&e[0].pos>this.stoppedAt?e[0]:this.runRecovery(e,t,i);if(n)return _v&&console.log("Force-finish "+this.stackID(n)),this.stackToTree(n.forceAll())}if(this.recovering){let e=1==this.recovering?1:3*this.recovering;if(i.length>e)for(i.sort(((e,t)=>t.score-e.score));i.length>e;)i.pop();i.some((e=>e.reducePos>r))&&this.recovering--}else if(i.length>1){e:for(let e=0;e<i.length-1;e++){let t=i[e];for(let n=e+1;n<i.length;n++){let r=i[n];if(t.sameState(r)||t.buffer.length>500&&r.buffer.length>500){if(!((t.score-r.score||t.buffer.length-r.buffer.length)>0)){i.splice(e--,1);continue e}i.splice(n--,1)}}}i.length>12&&i.splice(12,i.length-12)}this.minStackPos=i[0].pos;for(let e=1;e<i.length;e++)i[e].pos<this.minStackPos&&(this.minStackPos=i[e].pos);return null}stopAt(e){if(null!=this.stoppedAt&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,n){let r=e.pos,{parser:i}=this,a=_v?this.stackID(e)+" -> ":"";if(null!=this.stoppedAt&&r>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let t=e.curContext&&e.curContext.tracker.strict,n=t?e.curContext.hash:0;for(let o=this.fragments.nodeAt(r);o;){let r=this.parser.nodeSet.types[o.type.id]==o.type?i.getGoto(e.state,o.type.id):-1;if(r>-1&&o.length&&(!t||(o.prop(Mb.contextHash)||0)==n))return e.useNode(o,r),_v&&console.log(a+this.stackID(e)+` (via reuse of ${i.getName(o.type.id)})`),!0;if(!(o instanceof Hb)||0==o.children.length||o.positions[0]>0)break;let s=o.children[0];if(!(s instanceof Hb&&0==o.positions[0]))break;o=s}}let o=i.stateSlot(e.state,4);if(o>0)return e.reduce(o),_v&&console.log(a+this.stackID(e)+` (via always-reduce ${i.getName(65535&o)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let s=this.tokens.getActions(e);for(let o=0;o<s.length;){let l=s[o++],c=s[o++],u=s[o++],d=o==s.length||!n,p=d?e:e.split(),f=this.tokens.mainToken;if(p.apply(l,c,f?f.start:p.pos,u),_v&&console.log(a+this.stackID(p)+` (via ${65536&l?`reduce of ${i.getName(65535&l)}`:"shift"} for ${i.getName(c)} @ ${r}${p==e?"":", split"})`),d)return!0;p.pos>r?t.push(p):n.push(p)}return!1}advanceFully(e,t){let n=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>n)return Tv(e,t),!0}}runRecovery(e,t,n){let r=null,i=!1;for(let a=0;a<e.length;a++){let o=e[a],s=t[a<<1],l=t[1+(a<<1)],c=_v?this.stackID(o)+" -> ":"";if(o.deadEnd){if(i)continue;if(i=!0,o.restart(),_v&&console.log(c+this.stackID(o)+" (restarted)"),this.advanceFully(o,n))continue}let u=o.split(),d=c;for(let e=0;u.forceReduce()&&e<10&&(_v&&console.log(d+this.stackID(u)+" (via force-reduce)"),!this.advanceFully(u,n));e++)_v&&(d=this.stackID(u)+" -> ");for(let e of o.recoverByInsert(s))_v&&console.log(c+this.stackID(e)+" (via recover-insert)"),this.advanceFully(e,n);this.stream.end>o.pos?(l==o.pos&&(l++,s=0),o.recoverByDelete(s,l),_v&&console.log(c+this.stackID(o)+` (via recover-delete ${this.parser.getName(s)})`),Tv(o,n)):(!r||r.score<o.score)&&(r=o)}return r}stackToTree(e){return e.close(),Hb.build({buffer:mv.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(Pv||(Pv=new WeakMap)).get(e);return t||Pv.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function Tv(e,t){for(let n=0;n<t.length;n++){let r=t[n];if(r.pos==e.pos&&r.sameState(e))return void(t[n].score<e.score&&(t[n]=e))}t.push(e)}class Rv{constructor(e,t,n){this.source=e,this.flags=t,this.disabled=n}allows(e){return!this.disabled||0==this.disabled[e]}}class Iv extends dv{constructor(e){if(super(),this.wrappers=[],14!=e.version)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let n=0;n<e.repeatNodeCount;n++)t.push("");let n=Object.keys(e.topRules).map((t=>e.topRules[t][1])),r=[];for(let e=0;e<t.length;e++)r.push([]);function i(e,t,n){r[e].push([t,t.deserialize(String(n))])}if(e.nodeProps)for(let t of e.nodeProps){let e=t[0];"string"==typeof e&&(e=Mb[e]);for(let n=1;n<t.length;){let r=t[n++];if(r>=0)i(r,e,t[n++]);else{let a=t[n+-r];for(let o=-r;o>0;o--)i(t[n++],e,a);n++}}}this.nodeSet=new Wb(t.map(((t,i)=>zb.define({name:i>=this.minRepeatTerm?void 0:t,id:i,props:r[i],top:n.indexOf(i)>-1,error:0==i,skipped:e.skippedNodes&&e.skippedNodes.indexOf(i)>-1})))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=$b;let a=bv(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let e=0;e<this.specializerSpecs.length;e++)this.specialized[e]=this.specializerSpecs[e].term;this.specializers=this.specializerSpecs.map(jv),this.states=bv(e.states,Uint32Array),this.data=bv(e.stateData),this.goto=bv(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map((e=>"number"==typeof e?new wv(a,e):e)),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,n){let r=new Dv(this,e,t,n);for(let i of this.wrappers)r=i(r,e,t,n);return r}getGoto(e,t,n=!1){let r=this.goto;if(t>=r[0])return-1;for(let i=r[t+1];;){let t=r[i++],a=1&t,o=r[i++];if(a&&n)return o;for(let n=i+(t>>1);i<n;i++)if(r[i]==e)return o;if(a)return-1}}hasAction(e,t){let n=this.data;for(let r=0;r<2;r++)for(let i,a=this.stateSlot(e,r?2:1);;a+=3){if(65535==(i=n[a])){if(1!=n[a+1]){if(2==n[a+1])return Av(n,a+2);break}i=n[a=Av(n,a+2)]}if(i==t||0==i)return Av(n,a+1)}return 0}stateSlot(e,t){return this.states[6*e+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){return!!this.allActions(e,(e=>e==t||null))}allActions(e,t){let n=this.stateSlot(e,4),r=n?t(n):void 0;for(let n=this.stateSlot(e,1);null==r;n+=3){if(65535==this.data[n]){if(1!=this.data[n+1])break;n=Av(this.data,n+2)}r=t(Av(this.data,n+1))}return r}nextStates(e){let t=[];for(let n=this.stateSlot(e,1);;n+=3){if(65535==this.data[n]){if(1!=this.data[n+1])break;n=Av(this.data,n+2)}if(!(1&this.data[n+2])){let e=this.data[n+1];t.some(((t,n)=>1&n&&t==e))||t.push(this.data[n],e)}}return t}configure(e){let t=Object.assign(Object.create(Iv.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let n=this.topRules[e.top];if(!n)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=n}return e.tokenizers&&(t.tokenizers=this.tokenizers.map((t=>{let n=e.tokenizers.find((e=>e.from==t));return n?n.to:t}))),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map(((n,r)=>{let i=e.specializers.find((e=>e.from==n.external));if(!i)return n;let a=Object.assign(Object.assign({},n),{external:i.to});return t.specializers[r]=jv(a),a}))),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),null!=e.strict&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),null!=e.bufferLength&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return null==t?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),n=t.map((()=>!1));if(e)for(let r of e.split(" ")){let e=t.indexOf(r);e>=0&&(n[e]=!0)}let r=null;for(let e=0;e<t.length;e++)if(!n[e])for(let n,i=this.dialects[t[e]];65535!=(n=this.data[i++]);)(r||(r=new Uint8Array(this.maxTerm+1)))[n]=1;return new Rv(e,n,r)}static deserialize(e){return new Iv(e)}}function Av(e,t){return e[t]|e[t+1]<<16}function jv(e){if(e.external){let t=e.extend?1:0;return(n,r)=>e.external(n,r)<<1|t}return e.get}const Lv={json:1,logfmt:2,unpack:3,pattern:4,regexp:5,label_format:7,line_format:8,label_replace:9,vector:10,offset:11,bool:12,on:13,ignoring:14,group_left:15,group_right:16,unwrap:6,decolorize:17,drop:18,keep:19},$v={by:20,without:21,and:22,or:23,unless:24,sum:25,avg:26,count:27,max:28,min:29,stddev:30,stdvar:31,bottomk:32,topk:33,sort:34,sort_desc:35},Fv={__proto__:null,ip:295,count_over_time:301,rate:303,rate_counter:305,bytes_over_time:307,bytes_rate:309,avg_over_time:311,sum_over_time:313,min_over_time:315,max_over_time:317,stddev_over_time:319,stdvar_over_time:321,quantile_over_time:323,first_over_time:325,last_over_time:327,absent_over_time:329,bytes:335,duration:337,duration_seconds:339},Nv=Iv.deserialize({version:14,states:"EtOYQPOOO#cQPO'#DUOOQO'#ER'#ERO#hQPO'#ERO$}QPO'#DTOYQPO'#DTOOQO'#Ed'#EdO%[QPO'#EcOOQO'#FP'#FPO%aQPO'#FOQ%lQPOOO&mQPO'#F]O&rQPO'#F^OOQO'#Eb'#EbOOQO'#DS'#DSOOQO'#Ee'#EeOOQO'#Ef'#EfOOQO'#Eg'#EgOOQO'#Eh'#EhOOQO'#Ei'#EiOOQO'#Ej'#EjOOQO'#Ek'#EkOOQO'#El'#ElOOQO'#Em'#EmOOQO'#En'#EnOOQO'#Eo'#EoOOQO'#Ep'#EpOOQO'#Eq'#EqOOQO'#Er'#ErOOQO'#Es'#EsO&wQPO'#DWOOQO'#DV'#DVO'VQPO,59pOOQO,5:m,5:mOOQO'#Dc'#DcO'_QPO'#DbO'gQPO'#DaO)lQPO'#D`O*{QPO'#D`OOQO'#D_'#D_O+sQPO,59oO-}QPO,59oO.UQPO,5:|O.]QPO,5:}O.hQPO'#E|O0sQPO,5;jO0zQPO,5;jO1PQPO,5;lO1PQPO,5;lO1PQPO,5;lO1PQPO,5;lO1PQPO,5;lO1PQPO,5;lOYQPO,5;wO3cQPO,5;xO3hQPO,59rO#cQPO,59qOOQO1G/[1G/[OOQO'#Dh'#DhO3mQPO,59|O5^QPO,59|OOQO'#Di'#DiO5cQPO,59{OOQO,59{,59{O5kQPO'#DWO6YQPO'#DlO8PQPO'#DoO9sQPO'#DoOOQO'#Do'#DoOOQO'#Dv'#DvOOQO'#Dt'#DtO+kQPO'#DtO9xQPO,59zO;iQPO'#EVO;nQPO'#EWOOQO'#EZ'#EZO;sQPO'#E[O;xQPO'#E_OOQO,59z,59zOOQO,59y,59yOOQO1G/Z1G/ZOOQO1G0h1G0hO;}QPO'#EtO.`QPO'#EtO<XQPO1G0iO<^QPO1G0iO<cQPO,5;hO=oQPO1G1UO=vQPO1G1UO=}QPO1G1UO>UQPO'#FSO@dQPO'#FRO@nQPO'#FROYQPO1G1WOYQPO1G1WOYQPO1G1WOYQPO1G1WOYQPO1G1WOYQPO1G1WO@xQPO1G1cOAPQPO1G1dOOQO1G/^1G/^OOQO1G/]1G/]O5cQPO1G/hOAUQPO1G/hOAZQPO'#DjOBzQPO'#DjOOQO1G/g1G/gOCbQPO,59rOCPQPO,5:cOOQO'#Dm'#DmOClQPO,5:WOEcQPO'#DrOOQO'#Dq'#DqOGVQPO,5:_OHvQPO,5:[OOQO,5:Z,5:ZOJgQPO,5:`O+kQPO,5:`O+kQPO,5:`OOQO,5:q,5:qOJuQPO'#EYOOQO'#EX'#EXOJzQPO,5:rOLkQPO'#E^OOQO'#E^'#E^OOQO'#E]'#E]ONbQPO,5:vO!!RQPO'#EaOOQO'#Ea'#EaOOQO'#E`'#E`O!#xQPO,5:yO!%iQPO'#D`O;}QPO,5;`O!%pQPO'#EuO!%uQPO,5;`O!%}QPO,5;`O!&[QPO,5;`O!&iQPO,5;`O!&nQPO7+&TO.`QPO7+&TOOQO'#E}'#E}O!(OQPO1G1SOOQO1G1S1G1SOYQPO7+&pO!(WQPO7+&pO!)hQPO7+&pO!)oQPO7+&pO!)vQQO'#FTOOQO,5;n,5;nO!,UQPO,5;mO!,]QPO,5;mO!-nQPO7+&rO!-uQPO7+&rOOQO7+&r7+&rO!.SQPO7+&rO!.ZQPO7+&rO!/`QPO7+&rO!/pQPO7+&}OOQO7+'O7+'OOOQO7+%S7+%SO!/uQPO7+%SO5cQPO,5:UO!/zQPO,5:UO!0PQPO1G/{OOQO1G/}1G/}OOQO1G0U1G0UOOQO1G0W1G0WOOQO,5:X,5:XO!0UQPO1G/yO!1uQPO,5:^O!1zQPO,5:]OOQO1G/z1G/zO!2PQPO1G/zO!3pQPO,5:tO;nQPO,5:sO;sQPO,5:wO;xQPO,5:zO!3xQPO,5;cO!%uQPO1G0zO!4WQPO1G0zO!4`QPO,5;aO+kQPO,5;cO!4eQPO1G0zO!4oQPO'#EvO!4tQPO1G0zO!4eQPO1G0zO!4|QPO1G0zO!5ZQPO1G0zO!%xQPO1G0zOOQO1G0z1G0zOOQO<<Io<<IoO!5fQPO<<IoO!5kQPO,5;iOOQO7+&n7+&nO!5pQPO<<J[OOQO<<J[<<J[OYQPO<<J[OOQO'#FV'#FVO!5wQPO,5;oOOQO'#FU'#FUOOQO,5;o,5;oOOQO1G1X1G1XO!6PQPO1G1XO!8YQPO<<JiOOQO<<Hn<<HnOOQO1G/p1G/pO!8_QPO1G/pO!8dQPO7+%gOOQO1G/x1G/xOOQO1G/w1G/wOOQO1G0`1G0`OOQO1G0_1G0_OOQO1G0c1G0cOOQO1G0f1G0fOOQO'#Ex'#ExOOQO1G0}1G0}O!8iQPO1G0}OOQO'#Ey'#EyOOQO'#Ez'#EzOOQO'#E{'#E{OOQO7+&f7+&fOOQO1G0{1G0{O!8nQPO1G0}O!9SQPO7+&fOOQO,5;b,5;bO!9[QPO7+&fO!%xQPO7+&fO!9fQPO7+&fO!9qQPOAN?ZOOQO1G1T1G1TO!;RQPOAN?vO!<cQPOAN?vO!<jQQO1G1ZOOQO1G1Z1G1ZOOQO7+&s7+&sO!<rQPOAN@TOOQO7+%[7+%[O!<wQPO<<IRO!<|QPO7+&iO!=RQPO<<JQO!=ZQPO<<JQO!=cQPO'#EwO!=hQPO<<JQOOQOG24uG24uOOQOG25bG25bOOQO1G1[1G1[OOQO7+&u7+&uO!=pQPOG25oOOQOAN>mAN>mO!=uQPO<<JTOOQOAN?lAN?lO!=zQPOAN?lO!>SQPOLD+ZOOQOAN?oAN?oOOQO,5:r,5:rO!>XQPO!$'NuO!>^QPO!)9DaO!>cQPO!.K9{OOQO!4//g!4//gO;nQPO'#EWO!>hQPO'#D`O!?`QPO,59oO!@fQPO'#DTOYQPO1G1WOYQPO1G1WOYQPO1G1WOYQPO1G1WOYQPO1G1WOYQPO1G1WO1PQPO,5;lO1PQPO,5;lO1PQPO,5;lO1PQPO,5;lO1PQPO,5;lO1PQPO,5;lO!AqQPO7+&rO!AxQPO7+&rO!BVQPO7+&rO!C_QPO7+&rO!CfQPO7+&rO!B^QPO'#FQ",stateData:"!Cs~O$TOStOS~OXZOY[OiWOjWOkWOlWOmWOnWOoWOpWOqWOrWOsWO!vQO!wRO!xRO$UPO$YTO$[_O$]`O$^aO$_bO$`cO$adO$beO$cfO$dgO$ehO$fiO$gjO$hkO$ilO$jmO~O{nO~O!vqO~O!OrO!QrO!WrO!XrO!YrO!ZrOfwXgwXhwX!lwX!nwX!owX!pwX!qwX!wwX!xwX#{wX#|wX#}wX$OwX~O!_vO$RwX$ZwX~P#mO$Y{O~Od|Oe|O$Y}O~Of!QOg!POh!QO!O!UO!l!UO!n!UO!o!UO!p!UO!q!UO!w!RO!x!RO#{!SO#|!SO#}!SO$O!TO~O$Y!VO~O$Y!WO~O|!XO!O!XO!P!XO!Q!XO~O$V!YO$W!ZO~O}!]O$X!_O~Og!`Of!TXh!TX!O!TX!Q!TX!W!TX!X!TX!Y!TX!Z!TX!_!TX!l!TX!n!TX!o!TX!p!TX!q!TX!w!TX!x!TX#{!TX#|!TX#}!TX$O!TX$R!TX$Z!TX$k!TX$V!TX~O!OrO!QrO!WrO!XrO!YrO!ZrO~Of!SXg!SXh!SX!_!SX!l!SX!n!SX!o!SX!p!SX!q!SX!w!SX!x!SX#{!SX#|!SX#}!SX$O!SX$R!SX$Z!SX$k!SX$V!SX~P)WOP!dOQ!cOR!fOS!eOT!eOV!lOW!kOa!mOb!nOc!oO{!bO$Y!iO~O!_vOfwagwahwa!lwa!nwa!owa!pwa!qwa!wwa!xwa#{wa#|wa#}wa$Owa$Rwa$Zwa~P)WOfvXgvXhvX!OvX!lvX!nvX!ovX!pvX!qvX!wvX!xvX#{vX#|vX#}vX$OvX~O$Z!rO~P,|O$Z!sO~P,|O!v!wO$UPO$Y!uO~O$Y!xO~OXZOY[OiWOjWOkWOlWOmWOnWOoWOpWOqWOrWOsWO!wRO!xRO$UPO$YTO$[_O$]`O$^aO$_bO$`cO$adO$beO$cfO$dgO$ehO$fiO$gjO$hkO$ilO$jmO~O!v!yO~P.mO$Y!{O~O[#OO]!|O^!|OX#uPY#uPi#uPj#uPk#uPl#uPm#uPn#uPo#uPp#uPq#uPr#uPs#uP!v#uP!w#uP!x#uP$U#uP$Y#uP$[#uP$]#uP$^#uP$_#uP$`#uP$a#uP$b#uP$c#uP$d#uP$e#uP$f#uP$g#uP$h#uP$i#uP$j#uP~O!v#WO~O}#XO~Og#ZOf!Uah!Ua!O!Ua!Q!Ua!W!Ua!X!Ua!Y!Ua!Z!Ua!_!Ua!l!Ua!n!Ua!o!Ua!p!Ua!q!Ua!w!Ua!x!Ua#{!Ua#|!Ua#}!Ua$O!Ua$R!Ua$Z!Ua$k!Ua$V!Ua~O$Y#[O~O}#]O$X!_O~O|#`O!O#`O!P!XO!Q!XO!l#aO!n#aO!o#aO!p#aO!q#aO~O{#dO!b#bOf!`Xg!`Xh!`X!O!`X!Q!`X!W!`X!X!`X!Y!`X!Z!`X!_!`X!l!`X!n!`X!o!`X!p!`X!q!`X!w!`X!x!`X#{!`X#|!`X#}!`X$O!`X$R!`X$Z!`X$k!`X$V!`X~O{#dOf!cXg!cXh!cX!O!cX!Q!cX!W!cX!X!cX!Y!cX!Z!cX!_!cX!l!cX!n!cX!o!cX!p!cX!q!cX!w!cX!x!cX#{!cX#|!cX#}!cX$O!cX$R!cX$Z!cX$k!cX$V!cX~O}#hO~Of#jOg#kO$V#jOh!Sa!O!Sa!Q!Sa!W!Sa!X!Sa!Y!Sa!Z!Sa!_!Sa!l!Sa!n!Sa!o!Sa!p!Sa!q!Sa!w!Sa!x!Sa#{!Sa#|!Sa#}!Sa$O!Sa$R!Sa$Z!Sa$k!Sa~O}#lO~O{#mO~O{#pO~O{#tO~O!_#xO$k#zO~P)WO$Z$PO~O$V$QO~O{$RO$Z$TO~Of!uXg!uXh!uX!O!uX!l!uX!n!uX!o!uX!p!uX!q!uX!w!uX!x!uX#{!uX#|!uX#}!uX$O!uX$Z!uX~O$V$UO~P<kO$Z$VO~P,|O!v$WO~P.mO$Y$YO~OX#uXY#uXi#uXj#uXk#uXl#uXm#uXn#uXo#uXp#uXq#uXr#uXs#uX!v#uX!w#uX!x#uX$U#uX$Y#uX$[#uX$]#uX$^#uX$_#uX$`#uX$a#uX$b#uX$c#uX$d#uX$e#uX$f#uX$g#uX$h#uX$i#uX$j#uX~O_$[O`$[O~P>ZO]!|O^!|O~P>ZO$V$dO~P,|O$Z$eO~O}$gO~Og$hOf!^Xh!^X!O!^X!Q!^X!W!^X!X!^X!Y!^X!Z!^X!_!^X!l!^X!n!^X!o!^X!p!^X!q!^X!w!^X!x!^X#{!^X#|!^X#}!^X$O!^X$R!^X$Z!^X$k!^X$V!^X~O$Y$iO~O!m$kO!s$lO!vQO!wRO!xRO~O}#XO$X!_O~PCPO{#dO!b$nOf!`ag!`ah!`a!O!`a!Q!`a!W!`a!X!`a!Y!`a!Z!`a!_!`a!l!`a!n!`a!o!`a!p!`a!q!`a!w!`a!x!`a#{!`a#|!`a#}!`a$O!`a$R!`a$Z!`a$k!`a$V!`a~O|$pOf!fXg!fXh!fX!O!fX!Q!fX!W!fX!X!fX!Y!fX!Z!fX!_!fX!l!fX!n!fX!o!fX!p!fX!q!fX!w!fX!x!fX#{!fX#|!fX#}!fX$O!fX$R!fX$V!fX$Z!fX$k!fX~O$V$qOf!gag!gah!ga!O!ga!Q!ga!W!ga!X!ga!Y!ga!Z!ga!_!ga!l!ga!n!ga!o!ga!p!ga!q!ga!w!ga!x!ga#{!ga#|!ga#}!ga$O!ga$R!ga$Z!ga$k!ga~O$V$qOf!dag!dah!da!O!da!Q!da!W!da!X!da!Y!da!Z!da!_!da!l!da!n!da!o!da!p!da!q!da!w!da!x!da#{!da#|!da#}!da$O!da$R!da$Z!da$k!da~Of#jOg#kO$V#jO$Z$rO~O|$tO~O$V$uOf!zag!zah!za!O!za!Q!za!W!za!X!za!Y!za!Z!za!_!za!l!za!n!za!o!za!p!za!q!za!w!za!x!za#{!za#|!za#}!za$O!za$R!za$Z!za$k!za~O|!XO!O!XO!P!XO!Q!XOf#QXg#QXh#QX!W#QX!X#QX!Y#QX!Z#QX!_#QX!l#QX!n#QX!o#QX!p#QX!q#QX!w#QX!x#QX#{#QX#|#QX#}#QX$O#QX$R#QX$V#QX$Z#QX$k#QX~O$V$vOf#Oag#Oah#Oa!O#Oa!Q#Oa!W#Oa!X#Oa!Y#Oa!Z#Oa!_#Oa!l#Oa!n#Oa!o#Oa!p#Oa!q#Oa!w#Oa!x#Oa#{#Oa#|#Oa#}#Oa$O#Oa$R#Oa$Z#Oa$k#Oa~O|!XO!O!XO!P!XO!Q!XOf#TXg#TXh#TX!W#TX!X#TX!Y#TX!Z#TX!_#TX!l#TX!n#TX!o#TX!p#TX!q#TX!w#TX!x#TX#{#TX#|#TX#}#TX$O#TX$R#TX$V#TX$Z#TX$k#TX~O$V$wOf#Rag#Rah#Ra!O#Ra!Q#Ra!W#Ra!X#Ra!Y#Ra!Z#Ra!_#Ra!l#Ra!n#Ra!o#Ra!p#Ra!q#Ra!w#Ra!x#Ra#{#Ra#|#Ra#}#Ra$O#Ra$R#Ra$Z#Ra$k#Ra~OU$xO~P*{O!m${O~O!_$|O$k#zO~OZ%OO!_#xO$Z#ha~P)WO!_#xO$Z%TO$k#zO~P)WO$Z%UO~Od|Oe|Of#Vqg#Vqh#Vq!O#Vq!l#Vq!n#Vq!o#Vq!p#Vq!q#Vq!w#Vq!x#Vq#{#Vq#|#Vq#}#Vq$O#Vq$R#Vq$Z#Vq$V#Vq~O$V%XO$Z%YO~Od|Oe|Of#rqg#rqh#rq!O#rq!l#rq!n#rq!o#rq!p#rq!q#rq!w#rq!x#rq#{#rq#|#rq#}#rq$O#rq$R#rq$Z#rq$V#rq~O$V%]O~P<kO$Z%[O~P,|O#z%^O$Z%aO~OX#uaY#uai#uaj#uak#ual#uam#uan#uao#uap#uaq#uar#uas#ua!v#ua!w#ua!x#ua$U#ua$[#ua$]#ua$^#ua$_#ua$`#ua$a#ua$b#ua$c#ua$d#ua$e#ua$f#ua$g#ua$h#ua$i#ua$j#ua~O$Y$YO~P!*OO_%cO`%cO$Y#ua~P!*OOf!QOh!QO!O!UO!l!UO!n!UO!o!UO!p!UO!q!UO!w!RO!x!RO#{#tq#|#tq#}#tq$O#tq$R#tq$Z#tq~Og#tq~P!,jOf#tqg#tqh#tq~P!,pOg!PO~P!,jO$R#tq$Z#tq~P%lOf#tqg#tqh#tq!O#tq!l#tq!n#tq!o#tq!p#tq!q#tq#{#tq#|#tq#}#tq$O#tq~O!w!RO!x!RO$R#tq$Z#tq~P!.eO}%dO~O$Z%eO~O}%gO~O$Y%hO~O$V$qOf!gig!gih!gi!O!gi!Q!gi!W!gi!X!gi!Y!gi!Z!gi!_!gi!l!gi!n!gi!o!gi!p!gi!q!gi!w!gi!x!gi#{!gi#|!gi#}!gi$O!gi$R!gi$Z!gi$k!gi~O}%iO~O{#dO~Of#jO$V#jOg!hih!hi!O!hi!Q!hi!W!hi!X!hi!Y!hi!Z!hi!_!hi!l!hi!n!hi!o!hi!p!hi!q!hi!w!hi!x!hi#{!hi#|!hi#}!hi$O!hi$R!hi$Z!hi$k!hi~O{%kO}%kO~O{%pO$m%rO$n%sO$o%tO~OZ%OO$Z#hi~O$l%vO~O!_#xO$Z#hi~P)WO!m%yO~O!_$|O$Z#hi~O!_#xO$Z%{O$k#zO~P)WO!_$|O$Z%{O$k#zO~O$Z%}O~O{&OO~O$Z&PO~P,|O$V&RO$Z&SO~O$Y$YOX#uiY#uii#uij#uik#uil#uim#uin#uio#uip#uiq#uir#uis#ui!v#ui!w#ui!x#ui$U#ui$[#ui$]#ui$^#ui$_#ui$`#ui$a#ui$b#ui$c#ui$d#ui$e#ui$f#ui$g#ui$h#ui$i#ui$j#ui~O$V&UO~O$Z&VO~O}&WO~O$Y&XO~Of#jOg#kO$V#jO!_#ki$k#ki$Z#ki~O!_$|O$Z#hq~O!_#xO$Z#hq~P)WOZ%OO!_&[O$Z#hq~Od|Oe|Of#V!Rg#V!Rh#V!R!O#V!R!l#V!R!n#V!R!o#V!R!p#V!R!q#V!R!w#V!R!x#V!R#{#V!R#|#V!R#}#V!R$O#V!R$R#V!R$Z#V!R$V#V!R~Od|Oe|Of#r!Rg#r!Rh#r!R!O#r!R!l#r!R!n#r!R!o#r!R!p#r!R!q#r!R!w#r!R!x#r!R#{#r!R#|#r!R#}#r!R$O#r!R$R#r!R$Z#r!R$V#r!R~O$Z&_O~P,|O#z%^O$Z&aO~O}&bO~O$Z&cO~O{&dO~O!_$|O$Z#hy~OZ%OO$Z#hy~OU$xO~O!_&[O$Z#hy~O$V&gO~O$Z&hO~O!_$|O$Z#h!R~O}&jO~O$V&kO~O}&lO~O$Z&mO~OP!dOQ!cOR!fOS!eOT!eOV&nOW!kOa!mOb!nOc!oO{!bO$Y!iO~O!_&oOfwagwahwa!lwa!nwa!owa!pwa!qwa!wwa!xwa#{wa#|wa#}wa$Owa$Vwa~P)WO!_&oO$VwX~P#mOf&yOh&yO!O&}O!l&}O!n&}O!o&}O!p&}O!q&}O!w&zO!x&zO#{#tq#|#tq#}#tq$O#tq$V#tq~Og#tq~P!@pOf#tqg#tqh#tq~P!@vOg&xO~P!@pOf&yOg&xOh&yO!O&}O!l&}O!n&}O!o&}O!p&}O!q&}O!w&zO!x&zO#{&{O#|&{O#}&{O$O&|O~O$V#tq~P!B^O!w&zO!x&zO$V#tq~P!.eO",goto:"1l$RPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP$S%R%j&Y&]PPPPPP&t'W'h'v(XPPPP(h(p(yP)S)XP)S)S)[)e)S)m*O*O*XPPPPPP*XP*O*bPPP)S)S*{+R)S)S+Y+])S+c+f+l,_,t-Z-Z-Z-Z-Z-Z-Z-Z-Z-Z-Z-Z-Z-Z-Z-p-y.^.j/S/V/V/V/Y/i,_/l,_0R0w1Y1c1fPPPPP,_,_[YOT}!{$U%]Q$^#PQ$_#QS$`#R&tQ$a#SQ$b#TQ$c#UQ'O&rQ'P&sQ'Q&uQ'R&vQ'S&wR'T!Vt^O}!V!{#P#Q#R#S#T#U$U%]&r&s&t&u&v&wRyTjSOT}!V!{#P#Q#R#S#T#U$U%]S!t{$QQ#}!u]&q&r&s&t&u&v&wRpPQoP^!hv!i#j#k#x$|&oQ#Y!YS#q!n$vT#u!o$wQxSQ#y!tQ$}#|Q%R#}Q%z%QR&p&q[wS!t#|#}%Q&q]!qx#y$}%R%z&piuSx!t#y#|#}$}%Q%R%z&p&qhtSx!t#y#|#}$}%Q%R%z&p&qR!auksSux!t#y#|#}$}%Q%R%z&p&qQ!^sV#^!`#Z$hW![s!`#Z$hR$j#`Q#_!`Q$f#ZR%f$hV!pv#x&oR#c!cQ#f!cQ#g!dR$o#cU#e!c!d#cR%j$qU!jv#x&oQ#i!iQ$r#jQ$s#kR%w$|_!hv!i#j#k#x$|&o_!gv!i#j#k#x$|&ov]OT}!V!{#P#Q#R#S#T#U$U%]&r&s&t&u&v&wT$m#`#aQ#o!lR&i&nS#n!l&nR%l$uR#s!nQ#r!nR%m$vR#w!oQ#v!oR%n$wj^O#P#Q#R#S#T#U&r&s&t&u&v&wQzTQ!z}Q#V!VQ$X!{Q%Z$UR&Q%]w]OT}!V!{#P#Q#R#S#T#U$U%]&r&s&t&u&v&wwVOT}!V!{#P#Q#R#S#T#U$U%]&r&s&t&u&v&wwUOT}!V!{#P#Q#R#S#T#U$U%]&r&s&t&u&v&wQ!v{Q$O!uR%W$QS#|!t#}W$z#y#{%R%SQ%u$yQ%|%TR&Z%{Q%Q#|Q%u$zQ&]%|R&e&ZQ#{!tS$y#y%RQ%P#|Q%S#}S%x$}%QS&Y%z%|R&f&]R%q$xR%o$xQ!OXQ%V$PQ%[$VQ&^%}R&_&PR$S!xwXOT}!V!{#P#Q#R#S#T#U$U%]&r&s&t&u&v&wQ#P!PQ#Q!QQ#R!RQ#S!SQ#T!TQ#U!UQ&r&xQ&s&yQ&t&zQ&u&{Q&v&|R&w&}h!}!P!Q!R!S!T!U&x&y&z&{&|&}R$]#OQ$Z!|Q%b$[R&T%cR%_$YQ%`$YR&`&R",nodeNames:" Json Logfmt Unpack Pattern Regexp Unwrap LabelFormat LineFormat LabelReplace Vector Offset Bool On Ignoring GroupLeft GroupRight Decolorize Drop Keep By Without And Or Unless Sum Avg Count Max Min Stddev Stdvar Bottomk Topk Sort Sort_Desc LineComment LogQL Expr LogExpr Selector Matchers Matcher Identifier Eq String Neq Re Nre PipelineExpr PipelineStage LineFilters LineFilter Filter PipeExact PipeMatch PipePattern Npa FilterOp Ip OrFilter Pipe LogfmtParser LogfmtParserFlags ParserFlag LabelParser JsonExpressionParser LabelExtractionExpressionList LabelExtractionExpression LogfmtExpressionParser LabelFilter IpLabelFilter UnitFilter DurationFilter Gtr Duration Gte Lss Lte Eql BytesFilter Bytes NumberFilter LiteralExpr Number Add Sub LineFormatExpr LabelFormatExpr LabelsFormat LabelFormatMatcher DecolorizeExpr DropLabelsExpr DropLabels DropLabel KeepLabelsExpr KeepLabels KeepLabel MetricExpr RangeAggregationExpr RangeOp CountOverTime Rate RateCounter BytesOverTime BytesRate AvgOverTime SumOverTime MinOverTime MaxOverTime StddevOverTime StdvarOverTime QuantileOverTime FirstOverTime LastOverTime AbsentOverTime LogRangeExpr Range OffsetExpr UnwrapExpr ConvOp BytesConv DurationConv DurationSecondsConv Grouping Labels VectorAggregationExpr VectorOp BinOpExpr BinOpModifier OnOrIgnoringModifier GroupingLabels GroupingLabelList GroupingLabel LabelName Mul Div Mod Pow LabelReplaceExpr VectorExpr",maxTerm:169,skippedNodes:[0,36],repeatNodeCount:0,tokenData:"5r~RvX^#ipq#iqr$^rs$yst%kuv%vxy%{yz&Qz{&V{|&[|}&a}!O&f!O!P(t!P!Q)t!Q!R)y!R![+a![!]2a!^!_2u!_!`3S!`!a3i!c!}3v!}#O4^#P#Q4c#Q#R4h#R#S3v#S#T4m#T#o3v#o#p4y#p#q5O#q#r5m#y#z#i$f$g#i#BY#BZ#i$IS$I_#i$I|$JO#i$JT$JU#i$KV$KW#i&FU&FV#i~#nY$T~X^#ipq#i#y#z#i$f$g#i#BY#BZ#i$IS$I_#i$I|$JO#i$JT$JU#i$KV$KW#i&FU&FV#i~$aR!_!`$j!`!a$o#r#s$t~$oO!O~~$tO!Z~~$yO!Q~~$|UOY$yZr$yrs%`s#O$y#O#P%e#P~$y~%eO}~~%hPO~$y~%pQt~OY%kZ~%k~%{O#}~~&QO$Y~~&VO$Z~~&[O#{~~&aO!w~~&fO$V~~&kP!x~}!O&n~&qQ#_#`&w#g#h(U~&zP#X#Y&}~'QP#X#Y'T~'WP#d#e'Z~'^P}!O'a~'dP#X#Y'g~'jP#a#b'm~'pP#d#e's~'vP#h#i'y~'|P#m#n(P~(UO!b~~(XP#h#i([~(_P#f#g(b~(eP#]#^(h~(kP#V#W(n~(qP#h#i(P~(wP!Q![(z~)PR!v~!Q![(z!g!h)Y#X#Y)Y~)]R{|)f}!O)f!Q![)l~)iP!Q![)l~)qP!v~!Q![)l~)yO#|~~*Oe!v~!O!P(z!Q![+a!g!h,t!i!j-c!m!n-c!o!p-c!r!s-c!v!w-c#U#V-W#W#X-l#X#Y/n#Z#[0Q#[#].T#_#`0Q#a#b0Z#d#e0Q#g#h/]#h#i0Q#k#l0l#l#m1u#m#n1W~+fd!v~!O!P(z!Q![+a!g!h,t!i!j-c!m!n-c!o!p-c!r!s-c!v!w-c#U#V-W#W#X-l#X#Y/n#Z#[0Q#[#].T#_#`0Q#a#b0Z#d#e0Q#g#h/]#h#i0Q#k#l0l#m#n1W~,wT{|)f}!O)f!Q![)l!d!e-W#]#^-]~-]O!s~~-`P#U#V-W~-fQ!d!e-W#]#^-]~-qP!m~!Q![-t~-wS!Q![-t#[#].T#a#b.i#g#h/]~.YP!m~!Q![.]~.`R!Q![.]#a#b.i#g#h/]~.nQ!m~!Q![.t#g#h/W~.wR!Q![.t#a#b/Q#g#h/]~/TP#g#h/W~/]O!m~~/bP!m~!Q![/e~/hQ!Q![/e#a#b/Q~/qT{|)f}!O)f!Q![)l#U#V-W#]#^-]~0TQ#U#V-W#]#^-]~0`S!m~!Q![.t#U#V-W#]#^-]#g#h/W~0qP!m~!Q![0t~0wT!Q![0t#W#X-l#[#].T#a#b.i#g#h/]~1]P!m~!Q![1`~1cU!Q![1`#W#X-l#[#].T#a#b.i#g#h/]#k#l0l~1xR!Q![2R!c!i2R#T#Z2R~2WR!v~!Q![2R!c!i2R#T#Z2RP2fT{P!Q![2a![!]2a!c!}2a#R#S2a#T#o2a~2zP!o~!_!`2}~3SO!p~~3XQ|~!_!`3_#r#s3d~3dO!q~~3iO!P~~3nP!l~!_!`3q~3vO!n~R3}T{P#zQ!Q![3v![!]2a!c!}3v#R#S3v#T#o3v~4cO$k~~4hO$l~~4mO$O~~4pRO#S4m#S#T%`#T~4m~5OO$U~~5TR!_~!_!`5^!`!a5c#r#s5h~5cO!W~~5hO!Y~~5mO!X~~5rO$W~",tokenizers:[0,1],topRules:{LogQL:[0,37]},specialized:[{term:43,get:(e,t)=>(e=>Lv[e.toLowerCase()]||-1)(e)<<1},{term:43,get:(e,t)=>(e=>$v[e.toLowerCase()]||-1)(e)<<1|1},{term:43,get:e=>Fv[e]||-1}],tokenPrec:0}),Mv=98;var Vv=Object.defineProperty,Bv=Object.getOwnPropertySymbols,zv=Object.prototype.hasOwnProperty,Wv=Object.prototype.propertyIsEnumerable,Qv=(e,t,n)=>t in e?Vv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Uv=(e=>(e[e.dontHide=0]="dontHide",e[e.hideLabel=1]="hideLabel",e[e.hideVariable=2]="hideVariable",e))(Uv||{});((e,t)=>{for(var n in t||(t={}))zv.call(t,n)&&Qv(e,n,t[n]);if(Bv)for(var n of Bv(t))Wv.call(t,n)&&Qv(e,n,t[n])})({},{includeAll:!1,multi:!1,options:[],skipUrlSync:!1});const qv=(e,t,n)=>{(0,a.reportInteraction)(((e,t)=>`${zg.id.replace(/-/g,"_")}_${e}_${t}`)(e,t),n)},Hv="service_selection",Gv="service_details",Xv={[Hv]:{search_services_changed:"search_services_changed",service_selected:"service_selected",aggregated_metrics_toggled:"aggregated_metrics_toggled"},[Gv]:{open_in_explore_clicked:"open_in_explore_clicked",action_view_changed:"action_view_changed",add_to_filters_in_breakdown_clicked:"add_to_filters_in_breakdown_clicked",select_field_in_breakdown_clicked:"select_field_in_breakdown_clicked",level_in_logs_volume_clicked:"level_in_logs_volume_clicked",layout_type_changed:"layout_type_changed",search_string_in_logs_changed:"search_string_in_logs_changed",pattern_removed:"pattern_removed",pattern_selected:"pattern_selected",pattern_field_clicked:"pattern_field_clicked",logs_visualization_toggle:"logs_visualization_toggle",logs_detail_filter_applied:"logs_detail_filter_applied",logs_popover_line_filter:"logs_popover_line_filter",logs_toggle_displayed_field:"logs_toggle_displayed_field",logs_clear_displayed_fields:"logs_clear_displayed_fields",value_breakdown_sort_change:"value_breakdown_sort_change",wasm_not_supported:"wasm_not_supported"}},Yv="data-testid search-services",Zv={sortByFunction:"data-testid SortBy function",sortByDirection:"data-testid SortBy direction"},Kv="data-testid search-logs",Jv="data-testid open-explore",ey="data-testid tab-patterns",ty="data-testid tab-logs",ny="data-testid tab-fields",ry="data-testid tab-labels",iy="data-testid button-remove-pattern",ay="data-testid button-filter-include",oy="data-testid button-filter-exclude",sy="data-testid table-wrapper",ly="data-testid button-included-pattern",cy="data-testid button-excluded-pattern",uy="data-testid table-wrapper",dy="data-testid inspect",py=e=>{const{isExcluded:t,isIncluded:n,onInclude:i,onExclude:a,onClear:o,titles:s,buttonFill:l}=e,c=(0,Wt.useStyles2)(fy,n,t);return r().createElement("div",{className:c.container},r().createElement(Wt.Button,{variant:n?"primary":"secondary",fill:l,size:"sm","aria-selected":n,className:c.includeButton,onClick:n?o:i,"data-testid":ay,title:null==s?void 0:s.include},"Include"),r().createElement(Wt.Button,{variant:t?"primary":"secondary",fill:l,size:"sm","aria-selected":t,className:c.excludeButton,onClick:t?o:a,title:null==s?void 0:s.exclude,"data-testid":oy},"Exclude"))},fy=(e,t,n)=>({container:(0,Ht.css)({display:"flex",justifyContent:"center"}),includeButton:(0,Ht.css)({borderRadius:0,borderRight:t?void 0:"none"}),excludeButton:(0,Ht.css)({borderRadius:`0 ${e.shape.radius.default} ${e.shape.radius.default} 0`,borderLeft:n?void 0:"none"})});function hy(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class gy extends e.BusEventBase{constructor(e,t,n){super(),hy(this,"operator",void 0),hy(this,"key",void 0),hy(this,"value",void 0),this.operator=e,this.key=t,this.value=n}}function my(e,t,n,r,i){i||(i=vy(e,r));const a=$m(by(e,i),r);let o;i===tm&&(o=JSON.stringify({value:t,parser:Cw(e,r)}));let s=a.state.filters.filter((n=>{const r=Vm(a,n);return!(n.key===e&&r.value===t)}));const l=s.length!==a.state.filters.length;("include"===n||"exclude"===n||!l&&"toggle"===n)&&(s=[...s,{key:e,operator:"exclude"===n?Pb.NotEqual:Pb.Equal,value:o||t,valueLabels:[t]}]),r.publishEvent(new gy(n,e,t),!0),a.setState({filters:s,hide:Uv.hideLabel})}function by(e,t){return e===Sm?am:t}function vy(e,t){var n,r;return(null===(r=YD(t))||void 0===r||null===(n=r.fields)||void 0===n?void 0:n.find((t=>t.name===e)))?Jg:tm}hy(gy,"type","add-filter");class yy extends Q{constructor(...e){super(...e),hy(this,"onClick",(e=>{const t=Oy(this.state.frame);if(!t)return;my(t.name,t.value,e,this,this.state.variableName);const n=$m(by(t.name,this.state.variableName),this);qv(Gv,Xv.service_details.add_to_filters_in_breakdown_clicked,{filterType:this.state.variableName,key:t.name,action:e,filtersLength:(null==n?void 0:n.state.filters.length)||0})})),hy(this,"isSelected",(()=>{const e=Oy(this.state.frame);if(!e)return{isIncluded:!1,isExcluded:!1};const t=$m(by(e.name,this.state.variableName),this),n=t.state.filters.find((n=>{const r=Vm(t,n);return n.key===e.name&&r.value===e.value}));return n?{isIncluded:n.operator===Pb.Equal,isExcluded:n.operator===Pb.NotEqual}:{isIncluded:!1,isExcluded:!1}}))}}hy(yy,"Component",(({model:e})=>{const{isIncluded:t,isExcluded:n}=e.isSelected();return r().createElement(py,{buttonFill:"outline",isIncluded:t,isExcluded:n,onInclude:()=>e.onClick("include"),onClear:()=>e.onClick("clear"),onExclude:()=>e.onClick("exclude")})}));const Oy=e=>{var t,n;const r=null!==(n=null===(t=e.fields[1])||void 0===t?void 0:t.labels)&&void 0!==n?n:{};if(1!==Object.keys(r).length)return;const i=Object.keys(r)[0];return{name:i,value:r[i]}},wy=(e,t)=>{if(typeof e!=typeof t)return!1;const n=new Set(e),r=new Set(t);return n.size===r.size&&ie().isEqual(n,r)};let Sy;class xy{getServiceSceneState(){return this.serviceSceneState}setPatternsCount(e){this.serviceSceneState||(this.serviceSceneState={}),this.serviceSceneState.patternsCount=e}setLabelsCount(e){this.serviceSceneState||(this.serviceSceneState={}),this.serviceSceneState.labelsCount=e}setFieldsCount(e){this.serviceSceneState||(this.serviceSceneState={}),this.serviceSceneState.fieldsCount=e}setServiceSceneState(e){this.serviceSceneState={patternsCount:e.patternsCount,labelsCount:e.labelsCount,fieldsCount:e.fieldsCount,loading:e.loading}}constructor(){var e,t;t=void 0,(e="serviceSceneState")in this?Object.defineProperty(this,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):this[e]=t}}function _y(){return Sy}function Py(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ey(t,n){return e.urlUtil.renderUrl(t,function(t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Py(e,t,n[t])}))}return e}({},Object.entries(e.urlUtil.getUrlSearchParams()).reduce(((e,[t,n])=>(eb.includes(t)&&(e[t]=n),e)),{}),t)}(n))}function Cy(e,t,n){const r=kl.getAncestor(n,FT);if(r){var i;const o=null===(i=r.state.routeMatch)||void 0===i?void 0:i.params.service;if(o){let r=function(e,t,n){return e===wm&&t===qm.label?Km(`${Um.explore}/service/${Hm(n)}/${Um.labels}`):e===wm&&t===qm.field?Km(`${Um.explore}/service/${Hm(n)}/${Um.fields}`):Km(`${Um.explore}/service/${Hm(n)}/${t}/${Hm(e)}`)}(t,e,o);const i=Ey(r);return n&&_y().setServiceSceneState(n.state),void a.locationService.push(i)}}}function ky(e,t,n){var r;const i=null===(r=kl.getAncestor(t,FT).state.routeMatch)||void 0===r?void 0:r.params.service;if(i){const r=Ey(Km(`${Um.explore}/service/${Hm(i)}/${e}`),n);t&&_y().setServiceSceneState(t.state),a.locationService.push(r)}}function Dy(){const t=a.locationService.getLocation(),n=(r=Gm.explore(),e.urlUtil.renderUrl(r,function(t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){zm(e,t,n[t])}))}return e}({},Object.entries(e.urlUtil.getUrlSearchParams()).reduce(((e,[t,n])=>(Jm.includes(t)&&(e[t]=n),e)),{}),t)}(i)));var r,i;n!==t.pathname+t.search&&a.locationService.push(n)}var Ty=g(308);function Ry(e){return e.map((e=>{var t;return null!==(t=Iy(e))&&void 0!==t?t:"logs"}))}function Iy(e){var t;const n=null===(t=e.fields[1])||void 0===t?void 0:t.labels;if(!n)return null;const r=Object.keys(n);return 0===r.length?null:n[r[0]]}function Ay(e){return'""'===e?"logs":e}const jy="changepoint",Ly=(0,re.memoize)(((t,n,r)=>{if("alphabetical"===n)return Fy(t,r);"outliers"===n&&Ny(t);const i=r=>{var i;try{if("changepoint"===n)return $y(r);if("outliers"===n)return Vy(t,r)}catch(t){Gg.error(t,{msg:"failed to sort"}),n=e.ReducerID.stdDev}const a=e.fieldReducers.get(n);var o,s;return null!==(s=(null!==(o=null===(i=a.reduce)||void 0===i?void 0:i.call(a,r.fields[1],!0,!0))&&void 0!==o?o:(0,e.doStandardCalcs)(r.fields[1],!0,!0))[n])&&void 0!==s?s:0},a=t.map((e=>({value:i(e),dataFrame:e})));return a.sort(((e,t)=>void 0!==e.value&&void 0!==t.value?t.value-e.value:0)),"asc"===r&&a.reverse(),a.map((({dataFrame:e})=>e))}),((e,t,n)=>{const r=e.length>0?e[0].fields[0].values[0]:0,i=e.length>0?e[e.length-1].fields[0].values[e[e.length-1].fields[0].values.length-1]:0,a=e.length>0?Iy(e[0]):"",o=e.length>0?Iy(e[e.length-1]):"",s=e.map((e=>e.length+"_"+e.fields.map((e=>e.name+"_"+e.values[0]+"_"+e.values[e.values.length-1]))));return`${a}_${o}_${r}_${i}_${e.length}_${s}_${t}_${n}`})),$y=t=>{if(!By())throw new Error("WASM not supported, fall back to stdDev");const n=t.fields.filter((t=>t.type===e.FieldType.number)),r=n[0].values.length;let i=Math.floor(r/100)||1;i>1&&(i=Math.ceil(i/2));const a=n[0].values.filter(((e,t)=>t%i==0)),o=new Float64Array(a);return Ty.R1.defaultArgpcp().detectChangepoints(o).indices.length},Fy=(e,t)=>{const n=[...e];return n.sort(((e,t)=>{const n=Iy(e),r=Iy(t);return n&&r&&null!==(i=null==n?void 0:n.localeCompare(r))&&void 0!==i?i:0;var i})),"desc"===t&&n.reverse(),n},Ny=t=>{if(!By())return;const n=(0,e.outerJoinDataFrames)({frames:t});if(!n)return;const r=n.fields.filter((t=>t.type===e.FieldType.number)),i=r[0].values.length,a=new Float64Array(r.flatMap((e=>e.values)));try{const e=Ty.hW.dbscan({sensitivity:.4}).preprocess(a,i);My=e.detect()}catch(e){Gg.error(e,{msg:"initOutlierDetector: OutlierDetector error"})}};let My;const Vy=(e,t)=>{if(!By())throw new Error("WASM not supported, fall back to stdDev");if(!My)throw new Error("Initialize outlier detector first");const n=e.indexOf(t);return My.seriesResults[n].isOutlier?My.seriesResults[n].outlierIntervals.length:0},By=()=>{const e="object"==typeof WebAssembly;return e||qv(Gv,Xv.service_details.wasm_not_supported),e};var zy=function(e){return e.split(/ ?; ?/).reduce((function(e,t){var n=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o}(t.split(/ ?: ?/),2),r=n[0],i=n[1];return r&&i&&(e[r.replace(/-(\w)/g,(function(e,t){return t.toUpperCase()}))]=Number.isNaN(Number(i))?i:Number(i)),e}),{})},Wy=["br","col","colgroup","dl","hr","iframe","img","input","link","menuitem","meta","ol","param","select","table","tbody","tfoot","thead","tr","ul","wbr"],Qy={"accept-charset":"acceptCharset",acceptcharset:"acceptCharset",accesskey:"accessKey",allowfullscreen:"allowFullScreen",autocapitalize:"autoCapitalize",autocomplete:"autoComplete",autocorrect:"autoCorrect",autofocus:"autoFocus",autoplay:"autoPlay",autosave:"autoSave",cellpadding:"cellPadding",cellspacing:"cellSpacing",charset:"charSet",class:"className",classid:"classID",classname:"className",colspan:"colSpan",contenteditable:"contentEditable",contextmenu:"contextMenu",controlslist:"controlsList",crossorigin:"crossOrigin",dangerouslysetinnerhtml:"dangerouslySetInnerHTML",datetime:"dateTime",defaultchecked:"defaultChecked",defaultvalue:"defaultValue",enctype:"encType",for:"htmlFor",formmethod:"formMethod",formaction:"formAction",formenctype:"formEncType",formnovalidate:"formNoValidate",formtarget:"formTarget",frameborder:"frameBorder",hreflang:"hrefLang",htmlfor:"htmlFor",httpequiv:"httpEquiv","http-equiv":"httpEquiv",icon:"icon",innerhtml:"innerHTML",inputmode:"inputMode",itemid:"itemID",itemprop:"itemProp",itemref:"itemRef",itemscope:"itemScope",itemtype:"itemType",keyparams:"keyParams",keytype:"keyType",marginwidth:"marginWidth",marginheight:"marginHeight",maxlength:"maxLength",mediagroup:"mediaGroup",minlength:"minLength",nomodule:"noModule",novalidate:"noValidate",playsinline:"playsInline",radiogroup:"radioGroup",readonly:"readOnly",referrerpolicy:"referrerPolicy",rowspan:"rowSpan",spellcheck:"spellCheck",srcdoc:"srcDoc",srclang:"srcLang",srcset:"srcSet",tabindex:"tabIndex",typemustmatch:"typeMustMatch",usemap:"useMap",accentheight:"accentHeight","accent-height":"accentHeight",alignmentbaseline:"alignmentBaseline","alignment-baseline":"alignmentBaseline",allowreorder:"allowReorder",arabicform:"arabicForm","arabic-form":"arabicForm",attributename:"attributeName",attributetype:"attributeType",autoreverse:"autoReverse",basefrequency:"baseFrequency",baselineshift:"baselineShift","baseline-shift":"baselineShift",baseprofile:"baseProfile",calcmode:"calcMode",capheight:"capHeight","cap-height":"capHeight",clippath:"clipPath","clip-path":"clipPath",clippathunits:"clipPathUnits",cliprule:"clipRule","clip-rule":"clipRule",colorinterpolation:"colorInterpolation","color-interpolation":"colorInterpolation",colorinterpolationfilters:"colorInterpolationFilters","color-interpolation-filters":"colorInterpolationFilters",colorprofile:"colorProfile","color-profile":"colorProfile",colorrendering:"colorRendering","color-rendering":"colorRendering",contentscripttype:"contentScriptType",contentstyletype:"contentStyleType",diffuseconstant:"diffuseConstant",dominantbaseline:"dominantBaseline","dominant-baseline":"dominantBaseline",edgemode:"edgeMode",enablebackground:"enableBackground","enable-background":"enableBackground",externalresourcesrequired:"externalResourcesRequired",fillopacity:"fillOpacity","fill-opacity":"fillOpacity",fillrule:"fillRule","fill-rule":"fillRule",filterres:"filterRes",filterunits:"filterUnits",floodopacity:"floodOpacity","flood-opacity":"floodOpacity",floodcolor:"floodColor","flood-color":"floodColor",fontfamily:"fontFamily","font-family":"fontFamily",fontsize:"fontSize","font-size":"fontSize",fontsizeadjust:"fontSizeAdjust","font-size-adjust":"fontSizeAdjust",fontstretch:"fontStretch","font-stretch":"fontStretch",fontstyle:"fontStyle","font-style":"fontStyle",fontvariant:"fontVariant","font-variant":"fontVariant",fontweight:"fontWeight","font-weight":"fontWeight",glyphname:"glyphName","glyph-name":"glyphName",glyphorientationhorizontal:"glyphOrientationHorizontal","glyph-orientation-horizontal":"glyphOrientationHorizontal",glyphorientationvertical:"glyphOrientationVertical","glyph-orientation-vertical":"glyphOrientationVertical",glyphref:"glyphRef",gradienttransform:"gradientTransform",gradientunits:"gradientUnits",horizadvx:"horizAdvX","horiz-adv-x":"horizAdvX",horizoriginx:"horizOriginX","horiz-origin-x":"horizOriginX",imagerendering:"imageRendering","image-rendering":"imageRendering",kernelmatrix:"kernelMatrix",kernelunitlength:"kernelUnitLength",keypoints:"keyPoints",keysplines:"keySplines",keytimes:"keyTimes",lengthadjust:"lengthAdjust",letterspacing:"letterSpacing","letter-spacing":"letterSpacing",lightingcolor:"lightingColor","lighting-color":"lightingColor",limitingconeangle:"limitingConeAngle",markerend:"markerEnd","marker-end":"markerEnd",markerheight:"markerHeight",markermid:"markerMid","marker-mid":"markerMid",markerstart:"markerStart","marker-start":"markerStart",markerunits:"markerUnits",markerwidth:"markerWidth",maskcontentunits:"maskContentUnits",maskunits:"maskUnits",numoctaves:"numOctaves",overlineposition:"overlinePosition","overline-position":"overlinePosition",overlinethickness:"overlineThickness","overline-thickness":"overlineThickness",paintorder:"paintOrder","paint-order":"paintOrder","panose-1":"panose1",pathlength:"pathLength",patterncontentunits:"patternContentUnits",patterntransform:"patternTransform",patternunits:"patternUnits",pointerevents:"pointerEvents","pointer-events":"pointerEvents",pointsatx:"pointsAtX",pointsaty:"pointsAtY",pointsatz:"pointsAtZ",preservealpha:"preserveAlpha",preserveaspectratio:"preserveAspectRatio",primitiveunits:"primitiveUnits",refx:"refX",refy:"refY",renderingintent:"renderingIntent","rendering-intent":"renderingIntent",repeatcount:"repeatCount",repeatdur:"repeatDur",requiredextensions:"requiredExtensions",requiredfeatures:"requiredFeatures",shaperendering:"shapeRendering","shape-rendering":"shapeRendering",specularconstant:"specularConstant",specularexponent:"specularExponent",spreadmethod:"spreadMethod",startoffset:"startOffset",stddeviation:"stdDeviation",stitchtiles:"stitchTiles",stopcolor:"stopColor","stop-color":"stopColor",stopopacity:"stopOpacity","stop-opacity":"stopOpacity",strikethroughposition:"strikethroughPosition","strikethrough-position":"strikethroughPosition",strikethroughthickness:"strikethroughThickness","strikethrough-thickness":"strikethroughThickness",strokedasharray:"strokeDasharray","stroke-dasharray":"strokeDasharray",strokedashoffset:"strokeDashoffset","stroke-dashoffset":"strokeDashoffset",strokelinecap:"strokeLinecap","stroke-linecap":"strokeLinecap",strokelinejoin:"strokeLinejoin","stroke-linejoin":"strokeLinejoin",strokemiterlimit:"strokeMiterlimit","stroke-miterlimit":"strokeMiterlimit",strokewidth:"strokeWidth","stroke-width":"strokeWidth",strokeopacity:"strokeOpacity","stroke-opacity":"strokeOpacity",suppresscontenteditablewarning:"suppressContentEditableWarning",suppresshydrationwarning:"suppressHydrationWarning",surfacescale:"surfaceScale",systemlanguage:"systemLanguage",tablevalues:"tableValues",targetx:"targetX",targety:"targetY",textanchor:"textAnchor","text-anchor":"textAnchor",textdecoration:"textDecoration","text-decoration":"textDecoration",textlength:"textLength",textrendering:"textRendering","text-rendering":"textRendering",underlineposition:"underlinePosition","underline-position":"underlinePosition",underlinethickness:"underlineThickness","underline-thickness":"underlineThickness",unicodebidi:"unicodeBidi","unicode-bidi":"unicodeBidi",unicoderange:"unicodeRange","unicode-range":"unicodeRange",unitsperem:"unitsPerEm","units-per-em":"unitsPerEm",unselectable:"unselectable",valphabetic:"vAlphabetic","v-alphabetic":"vAlphabetic",vectoreffect:"vectorEffect","vector-effect":"vectorEffect",vertadvy:"vertAdvY","vert-adv-y":"vertAdvY",vertoriginx:"vertOriginX","vert-origin-x":"vertOriginX",vertoriginy:"vertOriginY","vert-origin-y":"vertOriginY",vhanging:"vHanging","v-hanging":"vHanging",videographic:"vIdeographic","v-ideographic":"vIdeographic",viewbox:"viewBox",viewtarget:"viewTarget",vmathematical:"vMathematical","v-mathematical":"vMathematical",wordspacing:"wordSpacing","word-spacing":"wordSpacing",writingmode:"writingMode","writing-mode":"writingMode",xchannelselector:"xChannelSelector",xheight:"xHeight","x-height":"xHeight",xlinkactuate:"xlinkActuate","xlink:actuate":"xlinkActuate",xlinkarcrole:"xlinkArcrole","xlink:arcrole":"xlinkArcrole",xlinkhref:"xlinkHref","xlink:href":"xlinkHref",xlinkrole:"xlinkRole","xlink:role":"xlinkRole",xlinkshow:"xlinkShow","xlink:show":"xlinkShow",xlinktitle:"xlinkTitle","xlink:title":"xlinkTitle",xlinktype:"xlinkType","xlink:type":"xlinkType",xmlbase:"xmlBase","xml:base":"xmlBase",xmllang:"xmlLang","xml:lang":"xmlLang","xml:space":"xmlSpace",xmlnsxlink:"xmlnsXlink","xmlns:xlink":"xmlnsXlink",xmlspace:"xmlSpace",ychannelselector:"yChannelSelector",zoomandpan:"zoomAndPan",onblur:"onBlur",onchange:"onChange",onclick:"onClick",oncontextmenu:"onContextMenu",ondoubleclick:"onDoubleClick",ondrag:"onDrag",ondragend:"onDragEnd",ondragenter:"onDragEnter",ondragexit:"onDragExit",ondragleave:"onDragLeave",ondragover:"onDragOver",ondragstart:"onDragStart",ondrop:"onDrop",onerror:"onError",onfocus:"onFocus",oninput:"onInput",oninvalid:"onInvalid",onkeydown:"onKeyDown",onkeypress:"onKeyPress",onkeyup:"onKeyUp",onload:"onLoad",onmousedown:"onMouseDown",onmouseenter:"onMouseEnter",onmouseleave:"onMouseLeave",onmousemove:"onMouseMove",onmouseout:"onMouseOut",onmouseover:"onMouseOver",onmouseup:"onMouseUp",onscroll:"onScroll",onsubmit:"onSubmit",ontouchcancel:"onTouchCancel",ontouchend:"onTouchEnd",ontouchmove:"onTouchMove",ontouchstart:"onTouchStart",onwheel:"onWheel"},Uy=function(){return Uy=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Uy.apply(this,arguments)},qy=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o},Hy=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};function Gy(e,n){var r;if(void 0===n&&(n={}),!(e&&e instanceof Node))return null;var i,a=n.actions,o=void 0===a?[]:a,s=n.index,l=void 0===s?0:s,c=n.level,u=void 0===c?0:c,d=n.randomKey,p=e,f="".concat(u,"-").concat(l),h=[];if(d&&0===u&&(f="".concat(function(e){void 0===e&&(e=6);for(var t="",n=e;n>0;--n)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.round(61*Math.random())];return t}(),"-").concat(f)),Array.isArray(o)&&o.forEach((function(t){t.condition(p,f,u)&&("function"==typeof t.pre&&((p=t.pre(p,f,u))instanceof Node||(p=e)),"function"==typeof t.post&&h.push(t.post(p,f,u)))})),h.length)return h;switch(p.nodeType){case 1:return t.createElement((i=p.nodeName,/[a-z]+[A-Z]+[a-z]+/.test(i)?i:i.toLowerCase()),function(e,t){var n={key:t};if(e instanceof Element){var r=e.getAttribute("class");r&&(n.className=r),Hy([],qy(e.attributes),!1).forEach((function(e){switch(e.name){case"class":break;case"style":n[e.name]=zy(e.value);break;case"allowfullscreen":case"allowpaymentrequest":case"async":case"autofocus":case"autoplay":case"checked":case"controls":case"default":case"defer":case"disabled":case"formnovalidate":case"hidden":case"ismap":case"itemscope":case"loop":case"multiple":case"muted":case"nomodule":case"novalidate":case"open":case"readonly":case"required":case"reversed":case"selected":case"typemustmatch":n[Qy[e.name]||e.name]=!0;break;default:n[Qy[e.name]||e.name]=e.value}}))}return n}(p,f),function(e,t,n){var r=Hy([],qy(e),!1).map((function(e,r){return Gy(e,Uy(Uy({},n),{index:r,level:t+1}))})).filter(Boolean);return r.length?r:null}(p.childNodes,u,n));case 3:var g=(null===(r=p.nodeValue)||void 0===r?void 0:r.toString())||"";if(/^\s+$/.test(g)&&!/[\u00A0\u202F]/.test(g))return null;if(!p.parentNode)return g;var m=p.parentNode.nodeName.toLowerCase();return Wy.includes(m)?(/\S/.test(g)&&console.warn("A textNode is not allowed inside '".concat(m,"'. Your text \"").concat(g,'" will be ignored')),null):g;default:return null}}function Xy(e,t){return void 0===t&&(t={}),"string"==typeof e?function(e,t){if(void 0===t&&(t={}),!e||"string"!=typeof e)return null;var n=t.nodeOnly,r=void 0!==n&&n,i=t.selector,a=void 0===i?"body > *":i,o=t.type,s=void 0===o?"text/html":o;try{var l=(new DOMParser).parseFromString(e,s).querySelector(a);if(!(l instanceof Node))throw new TypeError("Error parsing input");return r?l:Gy(l,t)}catch(e){}return null}(e,t):e instanceof Node?Gy(e,t):null}var Yy=g(567),Zy={FAILED:"failed",LOADED:"loaded",LOADING:"loading",PENDING:"pending",READY:"ready",UNSUPPORTED:"unsupported"};function Ky(){return Yy.canUseDOM}var Jy=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),eO=function(){return eO=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},eO.apply(this,arguments)},tO=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o},nO=Object.create(null),rO=function(e){function n(t){var n=e.call(this,t)||this;return Object.defineProperty(n,"isInitialized",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(n,"isActive",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(n,"hash",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"handleLoad",{enumerable:!0,configurable:!0,writable:!0,value:function(e,t){void 0===t&&(t=!1),n.isActive&&n.setState({content:e,hasCache:t,status:Zy.LOADED},n.getElement)}}),Object.defineProperty(n,"handleError",{enumerable:!0,configurable:!0,writable:!0,value:function(e){var t=n.props.onError,r="Browser does not support SVG"===e.message?Zy.UNSUPPORTED:Zy.FAILED;n.isActive&&n.setState({status:r},(function(){"function"==typeof t&&t(e)}))}}),Object.defineProperty(n,"request",{enumerable:!0,configurable:!0,writable:!0,value:function(){var e=n.props,t=e.cacheRequests,r=e.fetchOptions,i=e.src;try{return t&&(nO[i]={content:"",status:Zy.LOADING}),fetch(i,r).then((function(e){var t=e.headers.get("content-type"),n=tO((t||"").split(/ ?; ?/),1)[0];if(e.status>299)throw new Error("Not found");if(!["image/svg+xml","text/plain"].some((function(e){return n.includes(e)})))throw new Error("Content type isn't valid: ".concat(n));return e.text()})).then((function(e){var r=n.props.src;if(i===r){if(n.handleLoad(e),t){var a=nO[i];a&&(a.content=e,a.status=Zy.LOADED)}}else nO[i].status===Zy.LOADING&&delete nO[i]})).catch((function(e){n.handleError(e),t&&nO[i]&&delete nO[i]}))}catch(e){return n.handleError(new Error(e.message))}}}),n.state={content:"",element:null,hasCache:!!t.cacheRequests&&!!nO[t.src],status:Zy.PENDING},n.hash=t.uniqueHash||function(e){for(var t,n="abcdefghijklmnopqrstuvwxyz",r="".concat(n).concat(n.toUpperCase()).concat("1234567890"),i="",a=0;a<8;a++)i+=(t=r)[Math.floor(Math.random()*t.length)];return i}(),n}return Jy(n,e),Object.defineProperty(n.prototype,"componentDidMount",{enumerable:!1,configurable:!0,writable:!0,value:function(){if(this.isActive=!0,Ky()&&!this.isInitialized){var e=this.state.status,t=this.props.src;try{if(e===Zy.PENDING){if(!function(){if(!document)return!1;var e=document.createElement("div");e.innerHTML="<svg />";var t=e.firstChild;return!!t&&"http://www.w3.org/2000/svg"===t.namespaceURI}()||"undefined"==typeof window||null===window)throw new Error("Browser does not support SVG");if(!t)throw new Error("Missing src");this.load()}}catch(e){this.handleError(e)}this.isInitialized=!0}}}),Object.defineProperty(n.prototype,"componentDidUpdate",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){if(Ky()){var n=this.state,r=n.hasCache,i=n.status,a=this.props,o=a.onLoad,s=a.src;if(t.status!==Zy.READY&&i===Zy.READY&&o&&o(s,r),e.src!==s){if(!s)return void this.handleError(new Error("Missing src"));this.load()}}}}),Object.defineProperty(n.prototype,"componentWillUnmount",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.isActive=!1}}),Object.defineProperty(n.prototype,"getNode",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this.props,t=e.description,n=e.title;try{var r=Xy(this.processSVG(),{nodeOnly:!0});if(!(r&&r instanceof SVGSVGElement))throw new Error("Could not convert the src to a DOM Node");var i=this.updateSVGAttributes(r);if(t){var a=i.querySelector("desc");a&&a.parentNode&&a.parentNode.removeChild(a);var o=document.createElementNS("http://www.w3.org/2000/svg","desc");o.innerHTML=t,i.prepend(o)}if(void 0!==n){var s=i.querySelector("title");if(s&&s.parentNode&&s.parentNode.removeChild(s),n){var l=document.createElementNS("http://www.w3.org/2000/svg","title");l.innerHTML=n,i.prepend(l)}}return i}catch(e){return this.handleError(e)}}}),Object.defineProperty(n.prototype,"getElement",{enumerable:!1,configurable:!0,writable:!0,value:function(){try{var e=Xy(this.getNode());if(!e||!t.isValidElement(e))throw new Error("Could not convert the src to a React element");this.setState({element:e,status:Zy.READY})}catch(e){this.handleError(new Error(e.message))}}}),Object.defineProperty(n.prototype,"load",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this;this.isActive&&this.setState({content:"",element:null,hasCache:!1,status:Zy.LOADING},(function(){var t=e.props,n=t.cacheRequests,r=t.src,i=n&&nO[r];if(i&&i.status===Zy.LOADED)e.handleLoad(i.content,!0);else{var a,o=r.match(/data:image\/svg[^,]*?(;base64)?,(.*)/);o?a=o[1]?window.atob(o[2]):decodeURIComponent(o[2]):r.includes("<svg")&&(a=r),a?e.handleLoad(a):e.request()}}))}}),Object.defineProperty(n.prototype,"updateSVGAttributes",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this,n=this.props,r=n.baseURL,i=void 0===r?"":r,a=n.uniquifyIDs,o=["id","href","xlink:href","xlink:role","xlink:arcrole"],s=["href","xlink:href"];return a?(function(e,t,n){if(n||2===arguments.length)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}([],tO(e.children),!1).map((function(e){if(e.attributes&&e.attributes.length){var n=Object.values(e.attributes).map((function(e){var n=e,r=e.value.match(/url\((.*?)\)/);return r&&r[1]&&(n.value=e.value.replace(r[0],"url(".concat(i).concat(r[1],"__").concat(t.hash,")"))),n}));o.forEach((function(e){var r,i,a=n.find((function(t){return t.name===e}));a&&(r=e,i=a.value,!s.includes(r)||!i||i.includes("#"))&&(a.value="".concat(a.value,"__").concat(t.hash))}))}return e.children.length?t.updateSVGAttributes(e):e})),e):e}}),Object.defineProperty(n.prototype,"processSVG",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this.state.content,t=this.props.preProcessor;return t?t(e):e}}),Object.defineProperty(n.prototype,"render",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this.state,n=e.element,r=e.status,i=this.props,a=i.children,o=void 0===a?null:a,s=i.innerRef,l=i.loader,c=void 0===l?null:l,u=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r={};for(var i in e)({}).hasOwnProperty.call(e,i)&&(t.includes(i)||(r[i]=e[i]));return r}(this.props,"baseURL","cacheRequests","children","description","fetchOptions","innerRef","loader","onError","onLoad","preProcessor","src","title","uniqueHash","uniquifyIDs");return Ky()?n?t.cloneElement(n,eO({ref:s},u)):[Zy.UNSUPPORTED,Zy.FAILED].includes(r)?o:c:c}}),Object.defineProperty(n,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{cacheRequests:!0,uniquifyIDs:!1}}),n}(t.PureComponent);const iO=rO,aO=e=>({graphicContainer:(0,Ht.css)({display:"flex",justifyContent:"center",margin:"0 auto"}),graphic:(0,Ht.css)({width:"200px",height:"120px",padding:e.spacing(1)}),text:(0,Ht.css)({display:"flex",justifyContent:"center",alignItems:"center"}),wrap:(0,Ht.css)({margin:"0 auto"})}),oO=({children:e})=>{const t=(0,Wt.useStyles2)(aO),n=(0,Wt.useTheme2)();return r().createElement("div",{className:t.wrap},r().createElement("div",{className:t.graphicContainer},r().createElement(iO,{className:t.graphic,src:n.isDark?"/public/plugins/grafana-lokiexplore-app/img/grot_err.svg":"/public/plugins/grafana-lokiexplore-app/img/grot_err_light.svg"})),r().createElement("div",{className:t.text},r().createElement(Wt.Text,{textAlignment:"center",color:"primary",element:"span"},e||"An error occurred")))},sO=new nn({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1});function lO(e,t,n){const[r,i,a]=sO.search(e,t,0,1e5);let o=[],s=new Set;if(r&&a){const t=(e,t)=>{t&&s.add(e)};for(let n=0;n<a.length;n++){let r=a[n];nn.highlight(e[i.idx[r]],i.ranges[r],t),o.push(e[i.idx[r]])}n([o,[...s]])}else t||n([])}const cO=(0,re.debounce)(lO,300);function uO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class dO extends e.BusEventBase{constructor(e,t,n){super(),uO(this,"target",void 0),uO(this,"sortBy",void 0),uO(this,"direction",void 0),this.target=e,this.sortBy=t,this.direction=n}}uO(dO,"type","sort-criteria-changed");class pO extends Q{constructor(t){const{sortBy:n,direction:r}=pb(t.target,jy,"desc");super({target:t.target,sortBy:n,direction:r}),uO(this,"sortingOptions",[{label:"",options:[{value:"changepoint",label:"Most relevant",description:"Smart ordering of graphs based on the most significant spikes in the data"},{value:"outliers",label:"Detected outliers",description:"Order by the amount of detected outliers in the data"},{value:e.ReducerID.stdDev,label:"Widest spread",description:"Sort graphs by deviation from the average value"},{value:"alphabetical",label:"Name",description:"Alphabetical order"},{value:e.ReducerID.sum,label:"Count",description:"Sort graphs by total number of logs"},{value:e.ReducerID.max,label:"Highest spike",description:"Sort graphs by the highest values (max)"},{value:e.ReducerID.min,label:"Lowest dip",description:"Sort graphs by the smallest values (min)"}]},{label:"Percentiles",options:[...e.fieldReducers.selectOptions([],hO).options]}]),uO(this,"onCriteriaChange",(e=>{e.value&&(this.setState({sortBy:e.value}),fb(this.state.target,e.value,this.state.direction),this.publishEvent(new dO(this.state.target,e.value,this.state.direction),!0))})),uO(this,"onDirectionChange",(e=>{e.value&&(this.setState({direction:e.value}),fb(this.state.target,this.state.sortBy,e.value),this.publishEvent(new dO(this.state.target,this.state.sortBy,e.value),!0))}))}}uO(pO,"Component",(({model:e})=>{const{sortBy:t,direction:n}=e.useState(),i=e.sortingOptions.find((e=>e.options.find((e=>e.value===t)))),a=null==i?void 0:i.options.find((e=>e.value===t));return r().createElement(r().Fragment,null,r().createElement(Wt.InlineField,null,r().createElement(Wt.Select,{"data-testid":Zv.sortByDirection,onChange:e.onDirectionChange,"aria-label":"Sort direction",placeholder:"",value:n,options:[{label:"Asc",value:"asc"},{label:"Desc",value:"desc"}]})),r().createElement(Wt.InlineField,{label:"Sort by",htmlFor:"sort-by-criteria",tooltip:"Calculate a derived quantity from the values in your time series and sort by this criteria. Defaults to standard deviation."},r().createElement(Wt.Select,{"data-testid":Zv.sortByFunction,value:a,width:20,isSearchable:!0,options:e.sortingOptions,placeholder:"Choose criteria",onChange:e.onCriteriaChange,inputId:"sort-by-criteria"})))}));const fO=["p10","p25","p75","p90","p99"];function hO(e){return e.id>="p1"&&e.id<="p99"&&fO.includes(e.id)}function gO(e){var t;return null!==(t=Iy(e))&&void 0!==t?t:"No labels"}function mO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class bO extends Q{performRepeat(e){const t=[],n=Ly(e.series,this.sortBy,this.direction);for(let e=0;e<n.length;e++){const r=this.state.getLayoutChild(n[e],e);t.push(r)}this.sortedSeries=n,this.unfilteredChildren=t,this.getFilter()?(this.state.body.setState({children:[]}),this.filterByString(this.getFilter())):this.state.body.setState({children:t})}constructor(t){var{sortBy:n,direction:i,getFilter:a}=t;super(function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(t,["sortBy","direction","getFilter"])),mO(this,"unfilteredChildren",[]),mO(this,"sortBy",void 0),mO(this,"direction",void 0),mO(this,"sortedSeries",[]),mO(this,"getFilter",void 0),mO(this,"sort",((e,t)=>{const n=kl.getData(this);this.sortBy=e,this.direction=t,n.state.data&&this.performRepeat(n.state.data)})),mO(this,"iterateFrames",(e=>{if(kl.getData(this).state.data)for(let t=0;t<this.sortedSeries.length;t++)e(this.sortedSeries,t)})),mO(this,"filterByString",(e=>{let t=[];this.iterateFrames(((e,n)=>{const r=gO(e[n]);t.push(r)})),lO(t,e,(e=>{e&&e[0]?this.filterFrames((t=>{const n=gO(t);return e[0].includes(n)})):this.filterFrames((()=>!0))}))})),mO(this,"filterFrames",(e=>{const t=[];var n,i;this.iterateFrames(((n,r)=>{e(n[r])&&t.push(this.unfilteredChildren[r])})),0===t.length?this.state.body.setState({children:[(n=this.getFilter(),i=this.clearFilter,new gh({direction:"row",children:[new mh({body:new Uh({reactNode:r().createElement("div",{className:vO.alertContainer},r().createElement(Wt.Alert,{title:"",severity:"info",className:vO.noResultsAlert},"No values found matching ",n,"",r().createElement(Wt.Button,{className:vO.clearButton,onClick:i},"Clear filter")))})})]}))]}):this.state.body.setState({children:t})})),mO(this,"clearFilter",(()=>{this.publishEvent(new gw,!0)})),this.sortBy=n,this.direction=i,this.getFilter=a,this.addActivationHandler((()=>{const t=kl.getData(this);this._subs.add(t.subscribeToState(((t,n)=>{var r,i,a,o;((null===(r=t.data)||void 0===r?void 0:r.state)===e.LoadingState.Done||(null===(i=t.data)||void 0===i?void 0:i.state)===e.LoadingState.Streaming&&t.data.series.length>(null!==(o=null===(a=n.data)||void 0===a?void 0:a.series.length)&&void 0!==o?o:0))&&this.performRepeat(t.data)}))),t.state.data&&this.performRepeat(t.state.data)}))}}mO(bO,"Component",(({model:e})=>{const{body:t}=e.useState();return r().createElement(t.Component,{model:t})}));const vO={alertContainer:(0,Ht.css)({flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center"}),noResultsAlert:(0,Ht.css)({minWidth:"30vw",flexGrow:0}),clearButton:(0,Ht.css)({marginLeft:"1.5rem"})};function yO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const OO=e=>{var{value:t,onChange:n,placeholder:i,onClear:a,suffix:o}=e,s=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,["value","onChange","placeholder","onClear","suffix"]);return r().createElement(Wt.Input,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){yO(e,t,n[t])}))}return e}({value:t,onChange:n,suffix:r().createElement(r().Fragment,null,t?r().createElement(Wt.Icon,{onClick:a,title:"Clear search",name:"times",className:wO.clearIcon}):void 0,o&&o),prefix:r().createElement(Wt.Icon,{name:"search"}),placeholder:i},s))},wO={clearIcon:(0,Ht.css)({cursor:"pointer"})};function SO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xO({options:e,value:n,onChange:i,label:a}){const o=(0,Wt.useStyles2)(PO),[s,l]=(0,t.useState)(!1),c=e.map((e=>({label:e.label,value:e.value})));return r().createElement(Wt.InlineField,{label:a},r().createElement(Wt.Select,{options:c,value:n,onOpenMenu:()=>l(!0),onCloseMenu:()=>l(!1),onChange:e=>i(e.value),className:o.select,prefix:s?void 0:r().createElement(Wt.Icon,{name:"search"})}))}function _O({options:e,value:n,onChange:i,label:a,selectOption:o,isLoading:s,initialFilter:l}){var c;const u=(0,Wt.useStyles2)(PO),[d,p]=(0,t.useState)(!1),[f,h]=(0,t.useState)(l),g=e.map((e=>({label:e.label,value:e.value}))),m=f&&n&&(null===(c=f.value)||void 0===c?void 0:c.includes(n))?[f,...g]:g,b=null==m?void 0:m.find((e=>e.value===n));return r().createElement(Wt.InlineField,{grow:!0,label:a},r().createElement(Wt.Select,{isLoading:s,"data-testid":Yv,placeholder:"Search services",options:m,isClearable:!0,value:n,onOpenMenu:()=>p(!0),onCloseMenu:()=>p(!1),allowCustomValue:!0,className:u.asyncSelect,prefix:d||(null==b?void 0:b.__isNew__)?void 0:r().createElement(Wt.Icon,{name:"search"}),onChange:(e,t)=>{return(null==e?void 0:e.__isNew__)?(h((n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){SO(e,t,n[t])}))}return e}({},e),r=null!=(r={icon:"filter"})?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(r)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))})),n)),i(e.value)):"clear"===t.action?i(""):void("select-option"===t.action&&e.value&&!e.__isNew__&&o(e.value));var n,r},onInputChange:(e,t)=>{const n=t;return"input-change"===n.action?i(e):"menu-close"===n.action&&n.prevInputValue?(h({value:n.prevInputValue,label:n.prevInputValue,icon:"filter",__isNew__:!0}),i(n.prevInputValue)):void 0}}))}function PO(e){return{select:(0,Ht.css)({maxWidth:e.spacing(64),minWidth:e.spacing(20)}),asyncSelect:(0,Ht.css)({maxWidth:e.spacing(54.5)})}}function EO({blockingMessage:e,isLoading:t,children:n}){const i=(0,Wt.useStyles2)(CO);return t&&!e&&(e="Loading..."),t?r().createElement(Wt.LoadingPlaceholder,{className:i.statusMessage,text:e}):e?r().createElement("div",{className:i.statusMessage},e):r().createElement(r().Fragment,null,n)}function CO(e){return{statusMessage:(0,Ht.css)({fontStyle:"italic",marginTop:e.spacing(7),textAlign:"center"})}}function kO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class DO extends Q{Selector({model:e}){const{active:t,options:n}=e.useState();return r().createElement(Wt.Field,null,r().createElement(Wt.RadioButtonGroup,{options:n,value:t,onChange:e.onLayoutChange}))}constructor(...e){super(...e),kO(this,"onLayoutChange",(e=>{qv(Gv,Xv.service_details.layout_type_changed,{layout:e,view:tb()}),this.setState({active:e})}))}}function TO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function RO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){TO(e,t,n[t])}))}return e}function IO(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}kO(DO,"Component",(({model:e})=>{const{layouts:t,options:n,active:i}=e.useState(),a=n.findIndex((e=>e.value===i));if(-1===a)return null;const o=t[a];return r().createElement(o.Component,{model:o})}));const AO=(e,t,n)=>IO(RO(IO(RO({},LO),{resource:t,refId:t}),n),{datasource:{uid:dm},expr:e}),jO=(e,t)=>IO(RO({},LO,t),{expr:e}),LO={refId:"A",queryType:"range",editorMode:"code",supportingQueryType:Wm};function $O(e){const t=e.filter((e=>e.operator===Pb.Equal)),n=e.filter((e=>e.operator===Pb.NotEqual)),r=(0,re.groupBy)(t,(e=>e.key));let i=[];for(const e in r){const t=r[e].map((e=>e.value));i.push(1===t.length?MO(r[e][0]):BO(e,t))}const a=n.map((e=>MO(e))).join(", ");return(0,re.trim)(`${i.join(", ")}, ${a}`," ,")}function FO(e){const t=e.filter((e=>e.operator===Pb.Equal)),n=e.filter((e=>e.operator===Pb.NotEqual)),r=(0,re.groupBy)(t,(e=>e.key));let i="";for(const e in r)i+=" | "+r[e].map((e=>`${VO(e)}`)).join(" or ");return`${i} ${n.map((e=>`| ${VO(e)}`)).join(" ")}`.trim()}function NO(e){const t=e.filter((e=>e.operator===Pb.Equal)),n=e.filter((e=>e.operator===Pb.NotEqual)),r=(0,re.groupBy)(t,(e=>e.key));let i="";for(const e in r)i+=" | "+r[e].map((e=>`${MO(e)}`)).join(" or ");return`${i} ${n.map((e=>`| ${MO(e)}`)).join(" ")}`.trim()}function MO(e){return e.value===Pm?`${e.key}${e.operator}${e.value}`:`${e.key}${e.operator}\`${e.value}\``}function VO(e){const t=Mm(e).value;return t===Pm?`${e.key}${e.operator}${t}`:`${e.key}${e.operator}\`${t}\``}function BO(e,t){return`${e}=~"${t.join("|")}"`}function zO(e){const t=e.filter((e=>"exclude"===e.type)).map((e=>`!> \`${e.pattern}\``)).join(" ").trim(),n=e.filter((e=>"include"===e.type));let r="";return n.length>0&&(r=1===n.length?`|> \`${n[0].pattern}\``:`|>  ${n.map((e=>`\`${e.pattern}\``)).join(" or ")}`),`${t} ${r}`.trim()}const WO="repeat(auto-fit, minmax(400px, 1fr))";function QO(e,t,n){let r="",i="";const a=Iw(Dm(e));return n&&n!==Sm?r=` ,${n} != ""`:n&&n===Sm&&(i=` | ${n} != ""`),jO(`sum(count_over_time(${Em({labelExpressionToAdd:r,structuredMetadataToAdd:i,parser:a})} [$__auto])) by (${t})`,{legendFormat:`{{${t}}}`,refId:"LABEL_BREAKDOWN_VALUES"})}function UO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){UO(e,t,n[t])}))}return e}function HO(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}class GO extends Q{onActivate(){var e;this.setState({$data:mS([QO(this,"${labelBy}",String(Im(this).state.value))]),body:this.build()});const t=Im(this);this._subs.add(t.subscribeToState((e=>{e.value===wm&&this.setState({$data:void 0,body:void 0})}))),this.subscribeToEvent(gy,(e=>{this.setState({lastFilterEvent:e})})),this._subs.add(null===(e=this.state.$data)||void 0===e?void 0:e.subscribeToState(((e,t)=>{this.onValuesDataQueryChange(e,t)})))}onValuesDataQueryChange(t,n){var r,i,a,o,s;if((null==t||null===(r=t.data)||void 0===r?void 0:r.errors)&&(null===(i=t.data)||void 0===i?void 0:i.state)!==e.LoadingState.Done){var l;const e=this.state.errors;null==t||null===(l=t.data)||void 0===l||l.errors.forEach((t=>{const n=`${t.status}_${t.traceId}_${t.message}`;void 0===e[n]&&(e[n]=HO(qO({},t),{displayed:!1}))})),this.setState({errors:e}),this.showErrorToast(this.state.errors)}if((null===(a=t.data)||void 0===a?void 0:a.state)===e.LoadingState.Done||(null===(o=t.data)||void 0===o?void 0:o.state)===e.LoadingState.Streaming){const e=this.state.lastFilterEvent;e&&("exclude"===e.operator&&t.data.series.length<1&&this.navigateToLabels(),"include"===e.operator&&t.data.series.length<=1&&this.navigateToLabels())}if((null===(s=t.data)||void 0===s?void 0:s.state)===e.LoadingState.Error&&this.activeLayoutContainsNoPanels()){const e=this.getActiveLayout();if(e instanceof bO){const n=this.getErrorStateAlert(t.data.errors);e.state.body.setState({children:[n]})}}}getActiveLayout(){const e=this.state.body,t=null==e?void 0:e.state.layouts.find((e=>e.isActive));if(t instanceof bO||t instanceof gh)return t}activeLayoutContainsNoPanels(){const e=this.getActiveLayout();if(e instanceof bO){const t=e.state.body.state.children[0];if(t instanceof mh||t instanceof Uh)return!0}return!1}getErrorStateAlert(e){return new Uh({reactNode:r().createElement(Wt.Alert,{title:"Something went wrong with your request",severity:"error"},null==e?void 0:e.map(((e,t)=>this.renderError(t,e))))})}navigateToLabels(){this.setState({lastFilterEvent:void 0}),ky(Um.labels,kl.getAncestor(this,eT))}build(){const e=Im(this).state,t=kl.getAncestor(this,dw),n=String(null==e?void 0:e.value);let i=Mg();i=i.setCustomFieldConfig("stacking",{mode:Wt.StackingMode.Normal}).setCustomFieldConfig("fillOpacity",100).setCustomFieldConfig("lineWidth",0).setCustomFieldConfig("pointSize",0).setCustomFieldConfig("drawStyle",Wt.DrawStyle.Bars).setOverrides(uS).setTitle(n);const a=i.build(),{sortBy:o,direction:s}=pb("labels",jy,"desc"),l=()=>{var e;return null!==(e=t.state.search.state.filter)&&void 0!==e?e:""};return new DO({options:[{value:"single",label:"Single"},{value:"grid",label:"Grid"},{value:"rows",label:"Rows"}],active:"grid",layouts:[new gh({direction:"column",children:[new mh({minHeight:300,body:a})]}),new bO({body:new xh({isLazy:!0,templateColumns:WO,autoRows:"200px",children:[new mh({body:new Uh({reactNode:r().createElement(Wt.LoadingPlaceholder,{text:"Loading..."})})})]}),getLayoutChild:kw(gO,Wt.DrawStyle.Bars,Jg,kl.getAncestor(this,dw).state.sort),sortBy:o,direction:s,getFilter:l}),new bO({body:new xh({templateColumns:"1fr",autoRows:"200px",children:[new mh({body:new Uh({reactNode:r().createElement(Wt.LoadingPlaceholder,{text:"Loading..."})})})]}),getLayoutChild:kw(gO,Wt.DrawStyle.Bars,Jg,kl.getAncestor(this,dw).state.sort),sortBy:o,direction:s,getFilter:l})]})}showErrorToast(t){const n=(0,a.getAppEvents)();let r=[];for(const e in t){const n=t[e];n.displayed||(r.push(n),n.displayed=!0)}r.length&&(this.activeLayoutContainsNoPanels()||n.publish({type:e.AppEvents.alertError.name,payload:null==r?void 0:r.map(((e,t)=>this.renderError(t,e)))}),this.setState({errors:t}))}renderError(e,t){return r().createElement("div",{key:e},t.status&&r().createElement(r().Fragment,null,r().createElement("strong",null,"Status"),": ",t.status," ",r().createElement("br",null)),t.message&&r().createElement(r().Fragment,null,r().createElement("strong",null,"Message"),": ",t.message," ",r().createElement("br",null)),t.traceId&&r().createElement(r().Fragment,null,r().createElement("strong",null,"TraceId"),": ",t.traceId))}static Selector({model:e}){const{body:t}=e.useState();return r().createElement(r().Fragment,null,t&&t instanceof DO&&r().createElement(t.Selector,{model:t}))}constructor(e){super(HO(qO({},e),{errors:{}})),this.addActivationHandler(this.onActivate.bind(this))}}function XO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}UO(GO,"Component",(({model:e})=>{const{body:t}=e.useState();return t?r().createElement(r().Fragment,null,t&&r().createElement(t.Component,{model:t})):r().createElement(Wt.LoadingPlaceholder,{text:"Loading..."})}));class YO extends Q{getExistingFilter(e){if(this.state.labelName!==xm)return null==e?void 0:e.state.filters.find((t=>{const n=Vm(e,t);return t.key===this.state.labelName&&n.value===Pm}))}onActivate(){this._subs.add(kl.getData(this).subscribeToState((t=>{var n;if((null===(n=t.data)||void 0===n?void 0:n.state)===e.LoadingState.Done){var r,i,a;const t=kl.getAncestor(this,eT);(null===(i=t.state.$data)||void 0===i||null===(r=i.state.data)||void 0===r?void 0:r.state)===e.LoadingState.Done&&this.calculateSparsity(),this._subs.add(null===(a=t.state.$data)||void 0===a?void 0:a.subscribeToState((t=>{var n;(null===(n=t.data)||void 0===n?void 0:n.state)===e.LoadingState.Done&&this.calculateSparsity()})))}})))}calculateSparsity(){var e;const t=XD(null===(e=kl.getAncestor(this,eT).state.$data)||void 0===e?void 0:e.state.data),n=null==t?void 0:t.fields.find((e=>"labels"===e.name));if(!n||!t)return void this.setState({showFilterField:!1});const r=this.getVariable(),i=n.values.reduce(((e,t)=>((null==t?void 0:t[this.state.labelName])&&e++,e)),0),a=kl.getAncestor(this,$c);if(void 0!==i&&t.length>0){const e=(i/t.length*100).toLocaleString(),n=`${this.state.labelName} exists on ${e}% of ${t.length} sampled log lines`;a.setState({description:n})}else a.setState({description:void 0});i<t.length||this.getExistingFilter(r)?this.setState({showFilterField:!0}):this.setState({showFilterField:!1})}getVariable(){return this.state.fieldType===qm.field?Dm(this):this.state.labelName===Sm?Tm(this):km(this)}constructor(e){super(e),XO(this,"onClickViewValues",(()=>{const e=kl.getAncestor(this,eT);Cy(this.state.fieldType,this.state.labelName,e)})),XO(this,"onClickExcludeEmpty",(e=>{my(this.state.labelName,Pm,"exclude",this,e)})),XO(this,"onClickIncludeEmpty",(e=>{my(this.state.labelName,Pm,"include",this,e)})),XO(this,"clearFilter",(e=>{my(this.state.labelName,Pm,"clear",this,e)})),this.addActivationHandler(this.onActivate.bind(this))}}XO(YO,"Component",(({model:e})=>{const{hideValueDrilldown:t,labelName:n,showFilterField:i}=e.useState(),a=e.getVariable(),o=a.useState().name,s=e.getExistingFilter(a),l=Vm(a,s),c=null==l?void 0:l.value;return r().createElement(r().Fragment,null,!0===i&&r().createElement(py,{isExcluded:(null==s?void 0:s.operator)===Pb.Equal&&c===Pm,isIncluded:(null==s?void 0:s.operator)===Pb.NotEqual&&c===Pm,onInclude:()=>e.onClickExcludeEmpty(o),onExclude:()=>e.onClickIncludeEmpty(o),onClear:()=>e.clearFilter(o),buttonFill:"text",titles:{include:`Only show logs that contain ${n}`,exclude:`Hide all logs that contain ${n}`}}),!0!==t&&r().createElement(Wt.Button,{title:`View breakdown of values for ${n}`,variant:"primary",fill:"outline",size:"sm",onClick:e.onClickViewValues,"aria-label":`Select ${n}`},"Select"))}));class ZO extends Q{onActivate(){const t=kl.getAncestor(this,$c);this._subs.add(t.subscribeToState(((t,n)=>{var r;const i=kl.getData(this);var a;(null===(r=i.state.data)||void 0===r?void 0:r.state)===e.LoadingState.Done&&this.setState({currentSeriesCount:null===(a=i.state.data)||void 0===a?void 0:a.series.length})})))}constructor(e){super(e),this.addActivationHandler(this.onActivate.bind(this))}}var KO,JO,ew;function tw(e){var t;const n=e.state.body,r=null===(t=e.state.body)||void 0===t?void 0:t.state.$data;r instanceof Fd&&(null==n||n.setState({titleItems:[new ZO({showAllSeries:!1,toggleShowAllSeries:e=>{r.setState({transformations:[]}),e.setState({showAllSeries:!0}),r.reprocessTransformations()}})]}))}ew=({model:t})=>{const{toggleShowAllSeries:n,showAllSeries:i,currentSeriesCount:a}=t.useState(),o=kl.getData(t),{data:s}=o.useState(),l=(0,Wt.useStyles2)(nw);if(!(o instanceof Fd)||i||(null==s?void 0:s.state)!==e.LoadingState.Done||!a||s.series.length<20)return null;const c=o._prevDataFromSource,u=null==c?void 0:c.series.length;return r().createElement("div",{key:"disclaimer",className:l.timeSeriesDisclaimer},r().createElement("span",{className:l.warningMessage},r().createElement(r().Fragment,null,r().createElement(Wt.Icon,{title:"Showing only 20 series",name:"exclamation-triangle","aria-hidden":"true"}))),r().createElement(Wt.Tooltip,{content:"Rendering too many series in a single panel may impact performance and make data harder to read. Consider adding more filters."},r().createElement(Wt.Button,{variant:"secondary",size:"sm",onClick:()=>n(t)},r().createElement(r().Fragment,null,"Show all ",u))))},(JO="Component")in(KO=ZO)?Object.defineProperty(KO,JO,{value:ew,enumerable:!0,configurable:!0,writable:!0}):KO[JO]=ew;const nw=e=>({timeSeriesDisclaimer:(0,Ht.css)({label:"time-series-disclaimer",display:"flex",alignItems:"center",gap:e.spacing(1)}),warningMessage:(0,Ht.css)({display:"flex",alignItems:"center",gap:e.spacing(.5),color:e.colors.warning.main,fontSize:e.typography.bodySmall.fontSize})});function rw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class iw extends Q{sortChildren(e){return(t,n)=>{const r=t.state.body,i=n.state.body;var a;const o=null!==(a=e.get(r.state.title))&&void 0!==a?a:0;var s;return(null!==(s=e.get(i.state.title))&&void 0!==s?s:0)-o}}calculateCardinalityMap(e){const t=KD(e),n=new Map;if(null==t?void 0:t.length)for(let e=0;e<(null==t?void 0:t.length);e++){const r=t.fields[0].values[e],i=t.fields[1].values[e];n.set(r,i)}return n}onActivate(){var e;this.setState({body:this.build()});const t=kl.getAncestor(this,eT);void 0===t.state.fieldsCount&&this.updateFieldCount(),this._subs.add(null===(e=t.state.$detectedFieldsData)||void 0===e?void 0:e.subscribeToState(this.onDetectedFieldsChange))}build(){var e;const t=jm(this).state.options.map((e=>({label:e.label,value:String(e.value)})));kl.getAncestor(this,ww).state.search.reset();const n=this.buildChildren(t),r=kl.getAncestor(this,eT),i=this.calculateCardinalityMap(null===(e=r.state.$detectedFieldsData)||void 0===e?void 0:e.state);n.sort(this.sortChildren(i));const a=n.map((e=>e.clone()));return[...n,...a].map((e=>{tw(e),this.subscribeToPanel(e)})),new DO({options:[{value:"grid",label:"Grid"},{value:"rows",label:"Rows"}],active:"grid",layouts:[new xh({templateColumns:Ow,autoRows:"200px",children:n,isLazy:!0}),new xh({templateColumns:"1fr",autoRows:"200px",children:a,isLazy:!0})]})}subscribeToPanel(e){const t=e.state.body;var n;t&&this._subs.add(null==t||null===(n=t.state.$data)||void 0===n?void 0:n.getResultsStream().subscribe((t=>{t.data.errors&&t.data.errors.length>0&&(e.setState({isHidden:!0}),this.updateFieldCount())})))}buildChildren(e){const t=[],n=ZD(this),r=Dm(this);for(const i of e){const{value:e}=i;if(e===wm||!e)continue;const a=jw(e,r,n),o=mS([jO(a,{legendFormat:Aw(e)?e:`{{${e}}}`,refId:e})]),s=new Fd({$data:o,transformations:[()=>aw(20)]});let l=Mg().setTitle(e).setData(s);l=Aw(e)?l.setHeaderActions(new YO({labelName:String(e),hideValueDrilldown:!0,fieldType:qm.field})):l.setHeaderActions(new YO({labelName:String(e),fieldType:qm.field})).setCustomFieldConfig("stacking",{mode:Wt.StackingMode.Normal}).setCustomFieldConfig("fillOpacity",100).setCustomFieldConfig("lineWidth",0).setCustomFieldConfig("pointSize",0).setCustomFieldConfig("drawStyle",Wt.DrawStyle.Bars).setOverrides(uS);const c=l.build(),u=new _h({body:c});t.push(u)}return t}updateFieldCount(){var e,t,n;const r=null!==(n=null===(e=this.state.body)||void 0===e?void 0:e.state.layouts.find((e=>e.isActive)))&&void 0!==n?n:null===(t=this.state.body)||void 0===t?void 0:t.state.layouts[0],i=null==r?void 0:r.state.children,a=null==i?void 0:i.filter((e=>!e.state.isHidden));var o,s;a&&(null===(o=(s=kl.getAncestor(this,ww).state).changeFieldCount)||void 0===o||o.call(s,a.length))}static Selector({model:e}){const{body:t}=e.useState();return r().createElement(r().Fragment,null,t&&r().createElement(t.Selector,{model:t}))}constructor(t){super(t),rw(this,"onDetectedFieldsChange",((t,n)=>{var r;const i=JD(t),a=JD(n);if((null===(r=t.data)||void 0===r?void 0:r.state)===e.LoadingState.Done&&!wy(null==i?void 0:i.values,null==a?void 0:a.values)){var o;const e=this.calculateCardinalityMap(t);null===(o=this.state.body)||void 0===o||o.state.layouts.forEach((t=>{const n=t,r=new Set(null==i?void 0:i.values),a=n.state.children;for(let e=0;e<a.length;e++){const t=n.state.children[e].state.body;r.has(t.state.title)?r.delete(t.state.title):(a.splice(e,1),e--)}const o=Array.from(r).map((e=>({label:e,value:e})));a.push(...this.buildChildren(o)),a.sort(this.sortChildren(e)),a.map((e=>{tw(e),this.subscribeToPanel(e)})),n.setState({children:a})}))}})),this.addActivationHandler(this.onActivate.bind(this))}}function aw(e){return t=>t.pipe((0,b.map)((t=>t.slice(0,e))))}function ow(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}rw(iw,"Component",(({model:e})=>{const{body:t}=e.useState();return t?r().createElement(r().Fragment,null,t&&r().createElement(t.Component,{model:t})):r().createElement(Wt.LoadingPlaceholder,{text:"Loading..."})}));class sw extends Q{onActivate(){var t;const n=Dm(this),r=kl.getAncestor(this,eT).state.$detectedLabelsData;this.state.body?(null==r||null===(t=r.state.data)||void 0===t?void 0:t.state)===e.LoadingState.Done&&this.update(null==r?void 0:r.state.data.series[0]):this.setState({body:this.build()}),this._subs.add(null==r?void 0:r.subscribeToState(((t,n)=>{var r;(null===(r=t.data)||void 0===r?void 0:r.state)===e.LoadingState.Done&&this.update(t.data.series[0])}))),this._subs.add(n.subscribeToState((()=>{this.updateQueriesOnFieldsVariableChange()})))}getPanelByIndex(e,t){const n=e.state.children[t].state.body;return{panel:n,title:n.state.title}}update(e){var t;const n=Im(this).state.options.filter((e=>e.value!==wm)).map((e=>e.label));null===(t=this.state.body)||void 0===t||t.state.layouts.forEach((t=>{let r=[];const i=t,a=new Set(n),o=i.state.children;for(let e=0;e<o.length;e++){const{title:t}=this.getPanelByIndex(i,e);a.has(t)?a.delete(t):(o.splice(e,1),e--),r.push(t)}const s=Array.from(a).map((e=>({label:e,value:e})));o.push(...this.buildChildren(s));const l=this.calculateCardinalityMap(e);o.sort(this.sortChildren(l)),o.map((e=>{tw(e)})),i.setState({children:o})}))}calculateCardinalityMap(e){const t=new Map;if(null==e?void 0:e.length)for(let n=0;n<(null==e?void 0:e.fields.length);n++){const r=e.fields[n].name,i=e.fields[n].values[0];t.set(r,i)}return t}build(){var t;const n=Im(this);kl.getAncestor(this,dw).state.search.reset();const r=this.buildChildren(n.state.options),i=kl.getAncestor(this,eT).state.$detectedLabelsData;if((null==i||null===(t=i.state.data)||void 0===t?void 0:t.state)===e.LoadingState.Done){const e=this.calculateCardinalityMap(null==i?void 0:i.state.data.series[0]);r.sort(this.sortChildren(e))}const a=r.map((e=>e.clone()));return[...r,...a].map((e=>{tw(e)})),new DO({options:[{value:"grid",label:"Grid"},{value:"rows",label:"Rows"}],active:"grid",layouts:[new xh({isLazy:!0,templateColumns:WO,autoRows:"200px",children:r}),new xh({isLazy:!0,templateColumns:"1fr",autoRows:"200px",children:a})]})}buildChildren(e){const t=[];for(const n of e){const{value:e}=n,r=String(e);if(e===wm||!e)continue;const i=QO(this,String(n.value),String(n.value)),a=this.getDataTransformer(i);t.push(new _h({body:Mg().setTitle(r).setData(a).setHeaderActions(new YO({labelName:r,fieldType:qm.label})).setCustomFieldConfig("stacking",{mode:Wt.StackingMode.Normal}).setCustomFieldConfig("fillOpacity",100).setCustomFieldConfig("lineWidth",0).setCustomFieldConfig("pointSize",0).setCustomFieldConfig("drawStyle",Wt.DrawStyle.Bars).setOverrides(uS).build()}))}return t}sortChildren(e){return(t,n)=>{const r=t.state.body,i=n.state.body;if(r.state.title===Sm)return-1;if(i.state.title===Sm)return 1;var a;const o=null!==(a=e.get(r.state.title))&&void 0!==a?a:0;var s;return(null!==(s=e.get(i.state.title))&&void 0!==s?s:0)-o}}getDataTransformer(e){const t=mS([e]);return new Fd({$data:t,transformations:[()=>aw(20)]})}static Selector({model:e}){const{body:t}=e.useState();return r().createElement(r().Fragment,null,t&&r().createElement(t.Selector,{model:t}))}constructor(e){super(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){ow(e,t,n[t])}))}return e}({},e)),ow(this,"updateQueriesOnFieldsVariableChange",(()=>{var e;null===(e=this.state.body)||void 0===e||e.state.layouts.forEach((e=>{const t=e;for(let e=0;e<t.state.children.length;e++){const{panel:i,title:a}=this.getPanelByIndex(t,e),o=i.state.$data,s=QO(this,a,a);var n,r;if(o instanceof $s&&s.expr===(null==o||null===(r=o.state.queries)||void 0===r||null===(n=r[0])||void 0===n?void 0:n.expr))break;i.setState({$data:this.getDataTransformer(s)})}}))})),this.addActivationHandler(this.onActivate.bind(this))}}ow(sw,"Component",(({model:e})=>{const{body:t}=e.useState();return t?r().createElement(r().Fragment,null,t&&r().createElement(t.Component,{model:t})):r().createElement(Wt.LoadingPlaceholder,{text:"Loading..."})}));class lw extends Q{static Component({model:e}){const{type:t}=e.useState();return r().createElement(oO,null,r().createElement(Wt.Alert,{title:"",severity:"warning"},"We did not find any ",t," for the given timerange. Please"," ",r().createElement("a",{className:Sw.link,href:"https://forms.gle/1sYWCTPvD72T1dPH9",target:"_blank",rel:"noopener noreferrer"},"let us know")," ","if you think this is a mistake."))}}function cw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){cw(e,t,n[t])}))}return e}class dw extends Q{onActivate(){var t,n,r,i,a;const o=kl.getAncestor(this,eT),s=Im(this);this.setState({loading:(null===(n=o.state.$detectedLabelsData)||void 0===n||null===(t=n.state.data)||void 0===t?void 0:t.state)!==e.LoadingState.Done,error:(null===(i=o.state.$detectedLabelsData)||void 0===i||null===(r=i.state.data)||void 0===r?void 0:r.state)===e.LoadingState.Error}),this._subs.add(this.subscribeToEvent(gw,(()=>{this.state.search.clearValueFilter()}))),this._subs.add(this.subscribeToEvent(dO,this.handleSortByChange)),this._subs.add(null===(a=o.state.$detectedLabelsData)||void 0===a?void 0:a.subscribeToState(this.onDetectedLabelsDataChange)),this._subs.add(km(this).subscribeToState(((e,t)=>{this.onLabelsVariableChange(e,t)}))),this._subs.add(s.subscribeToState(((e,t)=>{this.onGroupByVariableChange(e,t)})));const l=YD(this);l&&this.updateOptions(l)}onGroupByVariableChange(e,t){(e.value!==t.value||!wy(e.options,t.options)||void 0===this.state.body||this.state.body instanceof lw)&&this.updateBody()}onLabelsVariableChange(e,t){const n=Im(this),r=e.filters.find((e=>e.key===xm)),i=t.filters.find((e=>e.key===xm));n.state.value===wm&&r!==i&&this.setState({loading:!0,body:void 0,error:void 0})}updateOptions(e){if(!e||!e.length)return void this.setState({loading:!1,body:new lw({type:"labels"})});const t=Im(this),n=function(e){const t=[...e];e.includes(Sm)||t.unshift(Sm);const n=t.map((e=>({label:e,value:String(e)})));return[{label:"All",value:wm},...n]}(e.fields.map((e=>e.name)));var r;t.setState({loading:!1,options:n,value:null!==(r=this.state.value)&&void 0!==r?r:wm})}updateBody(){const e=Im(this);if(!e.state.options||!e.state.options.length)return;const t={loading:!1,blockingMessage:void 0,error:!1};e.hasAllValue()&&this.state.body instanceof GO?t.body=new sw({}):!e.hasAllValue()&&this.state.body instanceof sw?t.body=new GO({}):void 0===this.state.body?e.state.options.length>0?t.body=e.hasAllValue()?new sw({}):new GO({}):t.body=new lw({type:"labels"}):this.state.body instanceof lw&&e.state.options.length>0&&(t.body=e.hasAllValue()?new sw({}):new GO({})),this.setState(uw({},t))}constructor(t){var n,r,i,a,o;super((a=uw({},t),o=null!=(o={$variables:null!==(i=t.$variables)&&void 0!==i?i:new Wd({variables:[new Qg({name:lm,defaultToAll:!1,includeAll:!0,value:null!==(n=t.value)&&void 0!==n?n:wm,options:null!==(r=t.options)&&void 0!==r?r:[]})]}),loading:!0,sort:new pO({target:"labels"}),search:new bw("labels"),value:t.value})?o:{},Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(o)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(o)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(o,e))})),a)),cw(this,"_variableDependency",new Js(this,{variableNames:[Jg]})),cw(this,"onDetectedLabelsDataChange",((t,n)=>{var r,i,a,o,s,l,c,u,d;(null===(r=t.data)||void 0===r?void 0:r.state)===e.LoadingState.Done&&(null===(i=t.data.series)||void 0===i?void 0:i[0])&&!wy(null===(o=t.data.series)||void 0===o||null===(a=o[0])||void 0===a?void 0:a.fields,null===(c=n.data)||void 0===c||null===(l=c.series)||void 0===l||null===(s=l[0])||void 0===s?void 0:s.fields)?this.updateOptions(null===(d=t.data.series)||void 0===d?void 0:d[0]):(null===(u=t.data)||void 0===u?void 0:u.state)===e.LoadingState.Done&&Im(this).setState({loading:!1})})),cw(this,"handleSortByChange",(e=>{var t,n;"labels"===e.target&&(this.state.body instanceof GO&&(null===(n=this.state.body)||void 0===n||null===(t=n.state.body)||void 0===t||t.state.layouts.forEach((t=>{t instanceof bO&&t.sort(e.sortBy,e.direction)}))),qv(Gv,Xv.service_details.value_breakdown_sort_change,{target:"labels",criteria:e.sortBy,direction:e.direction}))})),cw(this,"onChange",(e=>{if(!e)return;const t=Im(this);t.changeValueTo(e);const{sortBy:n,direction:r}=pb("labels",jy,"desc");qv(Gv,Xv.service_details.select_field_in_breakdown_clicked,{label:e,previousLabel:t.getValueText(),view:"labels",sortBy:n,sortByDirection:r});const i=kl.getAncestor(this,eT);Cy(qm.label,e,i)})),this.addActivationHandler(this.onActivate.bind(this))}}function pw(e){return{container:(0,Ht.css)({flexGrow:1,display:"flex",minHeight:"100%",flexDirection:"column"}),content:(0,Ht.css)({flexGrow:1,display:"flex",paddingTop:e.spacing(0)}),controls:(0,Ht.css)({flexGrow:0,display:"flex",alignItems:"top",justifyContent:"space-between",flexDirection:"row-reverse",gap:e.spacing(2)})}}cw(dw,"Component",(({model:e})=>{const{body:t,loading:n,blockingMessage:i,error:a,search:o,sort:s}=e.useState(),l=Im(e),{options:c,value:u}=l.useState(),d=(0,Wt.useStyles2)(pw);return r().createElement("div",{className:d.container},r().createElement(EO,{isLoading:n,blockingMessage:i},r().createElement("div",{className:d.controls},t instanceof GO&&r().createElement(GO.Selector,{model:t}),t instanceof sw&&r().createElement(sw.Selector,{model:t}),!n&&u!==wm&&r().createElement(r().Fragment,null,r().createElement(s.Component,{model:s}),r().createElement(o.Component,{model:o})),!n&&c.length>0&&r().createElement(xO,{label:"Label",options:c,value:String(u),onChange:e.onChange})),a&&r().createElement(Wt.Alert,{title:"",severity:"warning"},"The labels are not available at this moment. Try using a different time range or check again later."),r().createElement("div",{className:d.content},t&&r().createElement(t.Component,{model:t}))))}));class fw extends Q{static Selector({model:e}){const{body:t}=e.useState();return t instanceof DO?r().createElement(r().Fragment,null,t&&r().createElement(t.Selector,{model:t})):r().createElement(r().Fragment,null)}onActivate(){var e;const t=jm(this),n=String(t.state.value),r=jw(n,Dm(this),ZD(this)),i=jO(r,{legendFormat:`{{${n}}}`,refId:n});this.setState({body:this.build(i),$data:mS([i])}),this._subs.add(this.subscribeToEvent(gy,(e=>{this.setState({lastFilterEvent:e})}))),this._subs.add(null===(e=this.state.$data)||void 0===e?void 0:e.subscribeToState((e=>{this.onValuesDataQueryChange(e,i)})))}onValuesDataQueryChange(t,n){var r,i;if((null===(r=t.data)||void 0===r?void 0:r.state)===e.LoadingState.Done){var a;const r=this.state.lastFilterEvent;(null===(a=t.data)||void 0===a?void 0:a.state)===e.LoadingState.Done&&r&&("exclude"===r.operator&&t.data.series.length<1&&this.navigateToFields(),"include"===r.operator&&t.data.series.length<=1&&this.navigateToFields()),this.state.body instanceof Uh&&this.setState({body:this.build(n)})}(null===(i=t.data)||void 0===i?void 0:i.state)===e.LoadingState.Error&&this.setErrorState(t.data.errors)}setErrorState(e){this.setState({body:new Uh({reactNode:r().createElement(Wt.Alert,{title:"Something went wrong with your request",severity:"error"},null==e?void 0:e.map(((e,t)=>r().createElement("div",{key:t},e.status&&r().createElement(r().Fragment,null,r().createElement("strong",null,"Status"),": ",e.status," ",r().createElement("br",null)),e.message&&r().createElement(r().Fragment,null,r().createElement("strong",null,"Message"),": ",e.message," ",r().createElement("br",null)),e.traceId&&r().createElement(r().Fragment,null,r().createElement("strong",null,"TraceId"),": ",e.traceId)))))})})}navigateToFields(){this.setState({lastFilterEvent:void 0}),ky(Um.fields,kl.getAncestor(this,eT))}build(e){const t=jm(this),n=String(t.state.value),{sortBy:i,direction:a}=pb("fields",jy,"desc"),o=kl.getAncestor(this,ww),s=()=>{var e;return null!==(e=o.state.search.state.filter)&&void 0!==e?e:""};return new DO({options:[{value:"single",label:"Single"},{value:"grid",label:"Grid"},{value:"rows",label:"Rows"}],active:"grid",layouts:[new gh({direction:"column",children:[new mh({minHeight:300,body:Mg().setTitle(n).build()})]}),new bO({body:new xh({templateColumns:Ow,autoRows:"200px",children:[new mh({body:new Uh({reactNode:r().createElement(Wt.LoadingPlaceholder,{text:"Loading..."})})})],isLazy:!0}),getLayoutChild:kw(gO,(null==e?void 0:e.expr.includes("count_over_time"))?Wt.DrawStyle.Bars:Wt.DrawStyle.Line,tm,kl.getAncestor(this,ww).state.sort),sortBy:i,direction:a,getFilter:s}),new bO({body:new xh({templateColumns:"1fr",autoRows:"200px",children:[new mh({body:new Uh({reactNode:r().createElement(Wt.LoadingPlaceholder,{text:"Loading..."})})})],isLazy:!0}),getLayoutChild:kw(gO,(null==e?void 0:e.expr.includes("count_over_time"))?Wt.DrawStyle.Bars:Wt.DrawStyle.Line,tm,kl.getAncestor(this,ww).state.sort),sortBy:i,direction:a,getFilter:s})]})}constructor(e){super(e),this.addActivationHandler(this.onActivate.bind(this))}}function hw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(fw,"Component",(({model:e})=>{const{body:t}=e.useState();return t?r().createElement(r().Fragment,null,t&&r().createElement(t.Component,{model:t})):r().createElement(Wt.LoadingPlaceholder,{text:"Loading..."})}));class gw extends e.BusEventBase{}hw(gw,"type","breakdown-search-reset");const mw={};class bw extends Q{filterValues(e){if(this.parent instanceof dw||this.parent instanceof ww){mw[this.cacheKey]=e;const n=this.parent.state.body;var t;n instanceof GO||n instanceof fw?null===(t=n.state.body)||void 0===t||t.forEachChild((t=>{t instanceof bO&&t.state.body.isActive&&t.filterByString(e)})):Gg.warn("invalid parent for search",{typeofBody:typeof n,filter:e})}}constructor(e){var t;super({filter:null!==(t=mw[e])&&void 0!==t?t:""}),hw(this,"cacheKey",void 0),hw(this,"onValueFilterChange",(e=>{this.setState({filter:e.target.value}),this.filterValues(e.target.value)})),hw(this,"clearValueFilter",(()=>{this.setState({filter:""}),this.filterValues("")})),hw(this,"reset",(()=>{this.setState({filter:""}),mw[this.cacheKey]=""})),this.cacheKey=e}}function vw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}hw(bw,"Component",(({model:e})=>{const{filter:t}=e.useState();return r().createElement(OO,{value:t,onChange:e.onValueFilterChange,onClear:e.clearValueFilter,placeholder:"Search for value"})}));const yw=["duration","count","total","bytes"],Ow="repeat(auto-fit, minmax(400px, 1fr))";class ww extends Q{onActivate(){var t,n,r;const i=jm(this),a=kl.getAncestor(this,eT);this.setState({loading:(null===(n=a.state.$detectedLabelsData)||void 0===n||null===(t=n.state.data)||void 0===t?void 0:t.state)!==e.LoadingState.Done}),this._subs.add(this.subscribeToEvent(gw,(()=>{this.state.search.clearValueFilter()}))),this._subs.add(this.subscribeToEvent(dO,this.handleSortByChange)),this._subs.add(i.subscribeToState(this.variableChanged)),this._subs.add(km(this).subscribeToState(((e,t)=>{const n=jm(this),r=e.filters.find((e=>e.key===xm)),i=t.filters.find((e=>e.key===xm));n.state.value===wm&&r!==i&&this.setState({loading:!0,body:void 0})}))),this._subs.add(null===(r=a.state.$detectedFieldsData)||void 0===r?void 0:r.subscribeToState(((t,n)=>{var r,i,a;(null===(r=t.data)||void 0===r?void 0:r.state)===e.LoadingState.Done&&(null===(i=t.data.series)||void 0===i?void 0:i[0])&&this.updateOptions(null===(a=t.data.series)||void 0===a?void 0:a[0])})));const o=ZD(this);o&&this.updateOptions(o)}updateOptions(e){if(!e||!e.length){const e=kl.getAncestor(this,FT),t=this.getVariablesThatCanBeCleared(e);let n;return n=t.length>1?this.buildClearFiltersLayout((()=>this.clearVariables(t))):new lw({type:"fields"}),void this.setState({loading:!1,body:n})}const t=kl.getAncestor(this,eT);var n;jm(this).setState({options:kb(e.fields[0].values.map((e=>String(e)))),loading:!1,value:null!==(n=t.state.drillDownLabel)&&void 0!==n?n:wm}),this.setState({loading:!1})}updateBody(e){const t=jm(this);if(!t.state.options||!t.state.options.length)return;const n={};if(t.state.options&&t.state.options.length<=1){const e=kl.getAncestor(this,FT),t=this.getVariablesThatCanBeCleared(e);t.length>1?n.body=this.buildClearFiltersLayout((()=>this.clearVariables(t))):n.body=new lw({type:"fields"})}else e.value===wm&&this.state.body instanceof fw?n.body=new iw({}):e.value!==wm&&this.state.body instanceof iw?n.body=new fw({}):(void 0===this.state.body||this.state.body instanceof lw||this.state.body instanceof Uh)&&(n.body=e.value===wm?new iw({}):new fw({}));this.setState(n)}getVariablesThatCanBeCleared(e){const t=kl.getVariables(e);let n=[];for(const e of t.state.variables)e instanceof vs&&e.state.filters.length&&n.push(e),e instanceof Qg&&e.state.value&&"logsFormat"!==e.state.name&&n.push(e);return n}buildClearFiltersLayout(e){return new Uh({reactNode:r().createElement(oO,null,r().createElement(Wt.Alert,{title:"",severity:"info"},"No labels match these filters."," ",r().createElement(Wt.Button,{className:Sw.button,onClick:()=>e()},"Clear filters")," "))})}constructor(e){var t,n,r,i;super(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){vw(e,t,n[t])}))}return e}({$variables:null!==(r=e.$variables)&&void 0!==r?r:new Wd({variables:[new Qg({name:sm,defaultToAll:!1,includeAll:!0,value:null!==(t=e.value)&&void 0!==t?t:wm,options:null!==(n=e.options)&&void 0!==n?n:[]})]}),loading:!0,sort:new pO({target:"fields"}),search:new bw("fields"),value:null!==(i=e.value)&&void 0!==i?i:wm},e)),vw(this,"_variableDependency",new Js(this,{variableNames:[Jg]})),vw(this,"variableChanged",((e,t)=>{(e.value!==t.value||!wy(e.options,t.options)||void 0===this.state.body||this.state.body instanceof lw||this.state.body instanceof Uh)&&this.updateBody(e)})),vw(this,"handleSortByChange",(e=>{var t;"fields"===e.target&&(this.state.body instanceof fw&&this.state.body.state.body instanceof DO&&(null===(t=this.state.body.state.body)||void 0===t||t.state.layouts.forEach((t=>{t instanceof bO&&t.sort(e.sortBy,e.direction)}))),qv(Gv,Xv.service_details.value_breakdown_sort_change,{target:"fields",criteria:e.sortBy,direction:e.direction}))})),vw(this,"clearVariables",(e=>{kl.getAncestor(this,FT).setState({patterns:[]}),e.forEach((e=>{e instanceof vs&&"adhoc_service_filter"===e.state.key?e.setState({filters:e.state.filters.filter((e=>e.key===xm))}):e instanceof vs?e.setState({filters:[]}):e instanceof Qg&&e.setState({value:"",text:""})}))})),vw(this,"onFieldSelectorChange",(e=>{if(!e)return;const t=jm(this),{sortBy:n,direction:r}=pb("fields",jy,"desc");qv(Gv,Xv.service_details.select_field_in_breakdown_clicked,{field:e,previousField:t.getValueText(),view:"fields",sortBy:n,sortByDirection:r});const i=kl.getAncestor(this,eT);Cy(qm.field,e,i)})),this.addActivationHandler(this.onActivate.bind(this))}}vw(ww,"Component",(({model:e})=>{const{body:t,loading:n,blockingMessage:i,search:a,sort:o}=e.useState(),s=jm(e),{options:l,value:c}=s.useState(),u=(0,Wt.useStyles2)(xw);return r().createElement("div",{className:u.container},r().createElement(EO,{isLoading:n,blockingMessage:i},r().createElement("div",{className:u.controls},t instanceof iw&&r().createElement(iw.Selector,{model:t}),t instanceof fw&&r().createElement(fw.Selector,{model:t}),!n&&c!==wm&&r().createElement(r().Fragment,null,r().createElement(o.Component,{model:o}),r().createElement(a.Component,{model:a})),!n&&l.length>1&&r().createElement(xO,{label:"Field",options:l,value:String(c),onChange:e.onFieldSelectorChange})),r().createElement("div",{className:u.content},t&&r().createElement(t.Component,{model:t}))))}));const Sw={link:(0,Ht.css)({textDecoration:"underline"}),button:(0,Ht.css)({marginLeft:"1.5rem"})};function xw(e){return{container:(0,Ht.css)({flexGrow:1,display:"flex",minHeight:"100%",flexDirection:"column"}),content:(0,Ht.css)({flexGrow:1,display:"flex",paddingTop:e.spacing(0)}),controls:(0,Ht.css)({flexGrow:0,display:"flex",alignItems:"top",justifyContent:"space-between",flexDirection:"row-reverse",gap:e.spacing(2)})}}const _w=t=>{if(t&&Object.values(e.ReducerID).includes(t))return t};function Pw(e){switch(e){case"json":return"json";case"logfmt":return"logfmt";case"":case"structuredMetadata":return"structuredMetadata";default:return"mixed"}}function Ew(e){var t;const n=new Set(null!==(t=null==e?void 0:e.map((e=>e.toString())))&&void 0!==t?t:[]);n.delete("structuredMetadata");const r=Array.from(n);return 1===r.length?Pw(r[0]):0===n.size?"structuredMetadata":"mixed"}function Cw(e,t){var n;const r=ZD(t),i=null==r?void 0:r.fields[2],a=null==r?void 0:r.fields[0],o=null==a?void 0:a.values.indexOf(e);var s;const l=void 0!==o&&-1!==o?Pw(null!==(s=null==i||null===(n=i.values)||void 0===n?void 0:n[o])&&void 0!==s?s:""):void 0;return void 0===l?(Gg.warn("missing parser, using mixed format for",{fieldName:e}),"mixed"):l}function kw(e,t,n,r){return(i,a)=>{const o=_w(r.state.sortBy),s=Mg().setOption("legend",{showLegend:!1}).setCustomFieldConfig("fillOpacity",9).setTitle(e(i)).setData(new Fd({transformations:[()=>function(e){return t=>t.pipe((0,b.map)((()=>[e])))}(i)]})).setColor({mode:"fixed",fixedColor:Sb(a)}).setOverrides(uS).setHeaderActions(new yy({frame:i,variableName:n}));return t===Wt.DrawStyle.Bars&&s.setCustomFieldConfig("stacking",{mode:Wt.StackingMode.Normal}).setCustomFieldConfig("fillOpacity",100).setCustomFieldConfig("lineWidth",0).setCustomFieldConfig("pointSize",0).setOverrides(uS).setCustomFieldConfig("drawStyle",Wt.DrawStyle.Bars),o&&(s.setOption("legend",{showLegend:!0,calcs:[o]}),s.setDisplayName(" ")),new _h({body:s.build()})}}var Dw;function Tw(e,t,n=0){var r;const i=null===(r=t.fields.find((e=>"labelTypes"===e.name)))||void 0===r?void 0:r.values[n];if(!i)return null;switch(i[e]){case"I":return"I";case"S":return"S";case"P":return"P";default:return null}}function Rw(e,t,n){switch(e){case"I":return Jg;case"P":return tm;case"S":return t===Sm?am:tm;default:{const e=new Error(`Invalid label type for ${t}`);throw Gg.error(e,{value:n,msg:`Invalid label type for ${t}`}),e}}}function Iw(e){return Ew(e.state.filters.map((e=>Mm(e).parser)))}function Aw(e){return yw.includes(e)}function jw(e,t,n){var r;const i=null==n?void 0:n.fields[2],a=null==n?void 0:n.fields[0],o=null==a?void 0:a.values.indexOf(e),s=void 0!==o&&-1!==o?Pw(null==i||null===(r=i.values)||void 0===r?void 0:r[o]):"mixed",l=t.state.filters.map((e=>{var t;const n=null==a?void 0:a.values.indexOf(e.key),r=Mm(e);if(r.parser)return r.parser;var o;const s=void 0!==n&&-1!==n?Pw(null!==(o=null==i||null===(t=i.values)||void 0===t?void 0:t[n])&&void 0!==o?o:"mixed"):void 0;return null!=s?s:"mixed"}));let c="",u="";return"structuredMetadata"===s?u=`| ${e}!=""`:c=`| ${e}!=""`,function(e,t){return Aw(e)?`avg_over_time(${Em(t)} | unwrap `+("duration"===e?"duration":"bytes"===e?"bytes":"")+`(${e}) [$__auto]) by ()`:`sum by (${e}) (count_over_time(${Em(t)} [$__auto]))`}(e,{structuredMetadataToAdd:u,fieldExpressionToAdd:c,parser:Ew([...l,s])})}function Lw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Lw(e,t,n[t])}))}return e}function Fw(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}!function(e){e.Indexed="I",e.StructuredMetadata="S",e.Parsed="P"}(Dw||(Dw={}));class Nw{static fromNode(e){return new Nw(e.from,e.to,e,e.type)}contains(e){return this.from<=e.from&&this.to>=e.to}getExpression(e){return e.substring(this.from,this.to)}constructor(e,t,n,r){Lw(this,"from",void 0),Lw(this,"to",void 0),Lw(this,"type",void 0),Lw(this,"syntaxNode",void 0),this.from=e,this.to=t,this.type=r,this.syntaxNode=n}}function Mw(e,t){const n=[];return Nv.parse(e).iterate({enter:e=>{(void 0===t||t.includes(e.type.id))&&n.push(e.node)}}),n}function Vw(e,t){if(e.type.id===t)return[Nw.fromNode(e)];const n=[];let r=0,i=e.childAfter(r);for(;i;)n.push(...Vw(i,t)),r=i.to,i=e.childAfter(r);return n}function Bw(e){return e.trim().length>2&&!function(e,t){let n=!1;return Nv.parse(e).iterate({enter:({type:e})=>{if(e.id===t)return n=!0,!1}}),n}(e,Mv)}const zw="__stream_shard_number__",Ww=(e,t,n)=>{if(void 0===t||void 0===n)return e.map((e=>Fw($w({},e),{expr:e.expr.replace(`, __stream_shard__=~"${zw}"}`,"}")})));let r=t[n].join("|");return"-1"===r||1===t[n].length?(r="-1"===r?"":r,e.map((e=>Fw($w({},e),{expr:e.expr.replace(`, __stream_shard__=~"${zw}"}`,`, __stream_shard__="${r}"}`)})))):e.map((e=>Fw($w({},e),{expr:e.expr.replace(new RegExp(`${zw}`,"g"),r)})))};function Qw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Uw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Qw(e,t,n[t])}))}return e}function qw(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Hw(t,n,r){const i=(0,e.closestIdx)(n.values[r],t.values);return i<0?0:n.values[r]===t.values[i]&&n.nanos&&t.nanos?n.nanos[r]>t.nanos[i]?i+1:i:n.values[r]>t.values[i]?i+1:i}function Gw(e,t,n,r,i,a){const o=function(e,t,n,r){return e.nanos&&n.nanos?void 0!==e.values[t]&&e.values[t]===n.values[r]&&void 0!==e.nanos[t]&&e.nanos[t]===n.nanos[r]:void 0!==e.values[t]&&e.values[t]===n.values[r]}(e,n,r,a);return!!o&&(!t||!i||void 0!==t.values[n]&&t.values[n]===i.values[a])}function Xw(t,n,r){const i=n.filter((e=>e.name===t.name));return 1===i.length?i[0]:t.labels?i.find((n=>{var r,i;return(0,e.shallowCompare)(null!==(r=t.labels)&&void 0!==r?r:{},null!==(i=n.labels)&&void 0!==i?i:{})})):n[r]}const Yw="Summary: total bytes processed";function Zw(e,t){const n=e.find((e=>e.displayName===Yw)),r=t.find((e=>e.displayName===Yw));if(null!=r&&null!=n)return[{value:r.value+n.value,displayName:Yw,unit:n.unit}];const i=null!=r?r:n;return null!=i?[i]:[]}function Kw(e){return qw(Uw({},e),{fields:e.fields.map((e=>qw(Uw({},e),{values:e.values})))})}function Jw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function eS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Jw(e,t,n[t])}))}return e}function tS(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function nS(t,n){const r=t.interpolateVariablesInQueries(n.targets,n.scopedVars).filter((e=>e.expr)).map((e=>{return tS(eS({},e),{expr:(t=e.expr,t.replace("}",`, __stream_shard__=~"${zw}"}`))});var t}));return function(t,n,r){let i=!1,a={data:[],state:e.LoadingState.Streaming,key:Lb()},o=null,s=new Map,l=null;const c=(u,d,p)=>{if(o&&(o.unsubscribe(),o=null),i)return void u.complete();const f=()=>{const t=d+1;t<p.length?c(u,t,p):(a.state=e.LoadingState.Done,u.next(a),u.complete())},h=e=>{var t,n;if((null==e?void 0:e.errors)&&(null===(t=e.errors[0].message)||void 0===t?void 0:t.includes("maximum of series")))return console.log("Maximum series reached, skipping retry"),!1;const r=null!==(n=s.get(d))&&void 0!==n?n:0;return!(r>3||(s.set(d,r+1),l=setTimeout((()=>{console.log(`Retrying ${d} (${r+1})`),c(u,d,p),l=null}),1500*Math.pow(2,r)),0))},g=function(e,t){return t?e.map((e=>{if(!e.maxLines||!Bw(e.expr))return e;const n=t.data.find((t=>t.refId===e.refId));if(!n)return e;const r=e.maxLines-n.length;return tS(eS({},e),{maxLines:r<0?0:r})})).filter((e=>void 0===e.maxLines||e.maxLines>0)):e}(r,a);if(!g.length)return void f();const m=tS(eS({},n),{targets:Ww(g,p,d)});n.requestId&&(m.requestId=`${n.requestId}_shard_${d}`),o=t.runQuery(m).subscribe({next:t=>{var n;((null!==(n=t.errors)&&void 0!==n?n:[]).length>0||null!=t.error)&&h(t)||(a=function(t,n){if(!t)return qw(Uw({},r=n),{data:r.data.map(Kw)});var r,i,a;n.data.forEach((n=>{const r=t.data.find((t=>function(t,n){var r,i,a,o,s,l;if(t.refId!==n.refId||t.name!==n.name)return!1;const c=null===(r=t.meta)||void 0===r?void 0:r.type;if(c!==(null===(i=n.meta)||void 0===i?void 0:i.type))return!1;if(c===e.DataFrameType.TimeSeriesMulti){const r=t.fields.find((t=>t.type===e.FieldType.number)),i=n.fields.find((t=>t.type===e.FieldType.number));return void 0!==r&&void 0!==i&&(0,e.shallowCompare)(null!==(u=r.labels)&&void 0!==u?u:{},null!==(d=i.labels)&&void 0!==d?d:{});var u,d}const p=null===(o=t.meta)||void 0===o||null===(a=o.custom)||void 0===a?void 0:a.frameType,f=null===(l=n.meta)||void 0===l||null===(s=l.custom)||void 0===s?void 0:s.frameType;return"LabeledTimeValues"===p&&"LabeledTimeValues"===f||p===f}(t,n)));r?function(t,n){var r,i;const a=t.fields.find((t=>t.type===e.FieldType.time)),o=t.fields.find((t=>t.type===e.FieldType.string&&"id"===t.name)),s=n.fields.find((t=>t.type===e.FieldType.time)),l=n.fields.find((t=>t.type===e.FieldType.string&&"id"===t.name));if(!a||!s)return void Gg.error(new Error("Time fields not found in the data frames"));var c;const u=null!==(c=null==s?void 0:s.values.slice(0))&&void 0!==c?c:[],d=Math.max(t.fields.length,n.fields.length);for(let r=0;r<u.length;r++){const i=Hw(a,s,r),c=Gw(a,o,i,s,l,r);for(let a=0;a<d;a++){if(!t.fields[a])continue;const o=Xw(t.fields[a],n.fields,a);if(o)if(c){if(t.fields[a].type===e.FieldType.time)continue;var p;t.fields[a].type===e.FieldType.number?t.fields[a].values[i]=(null!==(p=t.fields[a].values[i])&&void 0!==p?p:0)+o.values[r]:t.fields[a].type===e.FieldType.other?"object"==typeof o.values[r]?t.fields[a].values[i]=Uw({},t.fields[a].values[i],o.values[r]):o.values[r]&&(t.fields[a].values[i]=o.values[r]):t.fields[a].values[i]=o.values[r]}else if(void 0!==o.values[r]){var f,h;t.fields[a].values.splice(i,0,o.values[r]),o.nanos&&(t.fields[a].nanos=null!==(h=t.fields[a].nanos)&&void 0!==h?h:new Array(t.fields[a].values.length-1).fill(0),null===(f=t.fields[a].nanos)||void 0===f||f.splice(i,0,o.nanos[r]))}}}var g,m;t.length=t.fields[0].values.length,t.meta=qw(Uw({},t.meta),{stats:Zw(null!==(g=null===(r=t.meta)||void 0===r?void 0:r.stats)&&void 0!==g?g:[],null!==(m=null===(i=n.meta)||void 0===i?void 0:i.stats)&&void 0!==m?m:[])})}(r,n):t.data.push(Kw(n))}));const o=[...null!==(i=t.errors)&&void 0!==i?i:[],...null!==(a=n.errors)&&void 0!==a?a:[]];var s;o.length>0&&(t.errors=o);const l=null!==(s=t.error)&&void 0!==s?s:n.error;var c,u;null!=l&&(t.error=l);const d=[...null!==(c=t.traceIds)&&void 0!==c?c:[],...null!==(u=n.traceIds)&&void 0!==u?u:[]];return d.length>0&&(t.traceIds=d),t}(a,t))},complete:()=>{a.data.length&&u.next(a),f()},error:e=>{Gg.error(e,{msg:"failed to shard"}),u.next(a),h()||f()}})},u=e=>{o=t.query(n).subscribe({next:e=>{a=e},complete:()=>{e.next(a)},error:t=>{Gg.error(t,{msg:"runNonSplitRequest subscription error"}),e.error(a)}})},d=new b.Observable((e=>{const a=(e=>{const t=Mw(e,[40]);return t.length>0?e.substring(t[0].from,t[0].to).replace(`, __stream_shard__=~"${zw}"}`,"}"):""})(r[0].expr);return t.languageProvider.fetchLabelValues("__stream_shard__",{timeRange:n.range,streamSelector:a||void 0}).then((t=>{const r=t.map((e=>parseInt(e,10)));if(r&&r.length){const t=function(e,t){const n=t.to.diff(t.from,"hour");e=function(e){e.sort(((e,t)=>t-e));let t=Math.floor(e.length/2),n=[];for(let r=0;r<t;r++)n.push(e[r],e[t+r]);return e.length%2!=0&&n.push(e[e.length-1]),n}(e),console.log(`Querying ${e.join(", ")} shards`);const r=function(e,t){return t<24?Math.max(Math.min(Math.ceil(Math.sqrt(e)),e-1),1):e}(e.length,n),i=Math.ceil(e.length/r),a=[];for(let t=0;t<e.length;t+=i){const n=[];for(let r=t;r<t+i&&r<e.length;r+=1)n.push(e[r]);a.push(n)}return a.push([-1]),a}(r,n.range);c(e,0,t)}else console.warn("Shard splitting not supported. Issuing a regular query."),u(e)})).catch((t=>{Gg.error(t,{msg:"failed to fetch label values for __stream_shard__"}),i=!0,u(e)})),()=>{i=!0,l&&(clearTimeout(l),l=null),null!=o&&(o.unsubscribe(),o=null)}}));return d}(t,n,r)}function rS(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function iS(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){rS(a,r,i,o,s,"next",e)}function s(e){rS(a,r,i,o,s,"throw",e)}o(void 0)}))}}const aS="wrapped-loki-ds-uid";class oS extends $s{runQueries(){const e=kl.getTimeRange(this);this.runWithTimeRange(e)}constructor(e){super(e)}}function sS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){sS(e,t,n[t])}))}return e}const cS="logs";function uS(e){e.matchFieldsWithName("info").overrideColor({mode:"fixed",fixedColor:"semi-dark-green"}),e.matchFieldsWithName("debug").overrideColor({mode:"fixed",fixedColor:"semi-dark-blue"}),e.matchFieldsWithName("error").overrideColor({mode:"fixed",fixedColor:"semi-dark-red"}),e.matchFieldsWithName("warn").overrideColor({mode:"fixed",fixedColor:"semi-dark-orange"}),e.matchFieldsWithName("logs").overrideColor({mode:"fixed",fixedColor:"darkgray"})}function dS(e){return e.setCustomFieldConfig("stacking",{mode:Wt.StackingMode.Normal}).setCustomFieldConfig("fillOpacity",100).setCustomFieldConfig("lineWidth",0).setCustomFieldConfig("pointSize",0).setCustomFieldConfig("drawStyle",Wt.DrawStyle.Bars).setOverrides(uS)}function pS(t,n){n.match({id:e.FieldMatcherID.byNames,options:{mode:"exclude",names:t,prefix:"All except:",readOnly:!0}}).overrideCustomFieldConfig("hideFrom",{legend:!1,tooltip:!1,viz:!0});const r=n.build();r[r.length-1].__systemRef="hideSeriesFrom"}function fS(e,t,n){const r=function(e,t){const n=Tm(t),r=n.state.filters.filter((e=>e.operator===Pb.Equal)).map((e=>Ay(e.value))),i=n.state.filters.filter((e=>e.operator===Pb.NotEqual)).map((e=>Ay(e.value)));return e.filter((e=>!i.includes(e)&&(0===r.length||r.includes(e))))}(Ry(t),n);if(null==r?void 0:r.length){const t=dS(Vg()).setOverrides(pS.bind(null,r));t instanceof kg&&e.onFieldConfigChange(t.build(),!0)}}function hS(){return e=>e.pipe((0,b.map)((e=>e.map((e=>(e.fields[1].config.displayNameFromDS||(e.fields[1].config.displayNameFromDS=cS),e))).sort(((e,t)=>{const n=e.fields[1].config.displayNameFromDS,r=(null==n?void 0:n.includes("error"))?4:(null==n?void 0:n.includes("warn"))?3:(null==n?void 0:n.includes("info"))?2:1,i=t.fields[1].config.displayNameFromDS;return r-((null==i?void 0:i.includes("error"))?4:(null==i?void 0:i.includes("warn"))?3:(null==i?void 0:i.includes("info"))?2:1)})))))}function gS(e){return new oS({datasource:{uid:aS},queries:e})}function mS(e,t){return e.find((e=>{var t;return null===(t=e.legendFormat)||void 0===t?void 0:t.toLowerCase().includes("level")}))?new Fd({$data:bS({datasource:{uid:aS},queries:e}),transformations:[hS]}):bS(lS({queries:e},t))}function bS(e){return new $s(lS({datasource:{uid:aS},queries:[]},e))}const vS=({exploration:t})=>r().createElement(Wt.ToolbarButton,{"data-testid":Jv,variant:"canvas",icon:"compass",onClick:()=>{qv(Gv,Xv.service_details.open_in_explore_clicked);const n=wb(t),r=function(e){return kl.interpolate(e,vm).replace(/\s+/g," ")}(t).replace(/\s+/g," ").trimEnd(),i=kl.getTimeRange(t).state.value,o=JSON.stringify({"loki-explore":{range:(0,e.toURLRange)(i.raw),queries:[{refId:"logs",expr:r,datasource:n}],datasource:n}});var s;const l=null!==(s=a.config.appSubUrl)&&void 0!==s?s:"",c=e.urlUtil.renderUrl(`${l}/explore`,{panes:o,schemaVersion:1});window.open(c,"_blank")}},"Open in Explore"),yS=e=>{const t=(0,Wt.useTheme2)(),n=e.caseSensitive?t.colors.text.maxContrast:t.colors.text.disabled,i=OS(t,n);return r().createElement("span",{className:i.container,title:`Case ${e.caseSensitive?"insensitive":"sensitive"} search`},r().createElement("svg",{onClick:()=>e.onCaseSensitiveToggle(e.caseSensitive?"insensitive":"sensitive"),fill:n,width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},r().createElement("text",{fontSize:"13",width:"16",height:"16",x:"50%",y:"50%",dominantBaseline:"central",textAnchor:"middle"},"Aa")))},OS=(e,t)=>({container:(0,Ht.css)({display:"flex",justifyContent:"center",marginLeft:e.spacing.x0_5,cursor:"pointer"})});function wS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class SS extends Q{updateFilter(e,t=!0){this.setState({lineFilter:e}),t?this.updateVariableDebounced(e):this.updateVariable(e)}constructor(e){super(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){wS(e,t,n[t])}))}return e}({lineFilter:(null==e?void 0:e.lineFilter)||"",caseSensitive:!1},e)),wS(this,"onActivate",(()=>{const e=Rm(this).getValue(),t=e.toString();if(!e)return;const n=t.includes("|="),r=n?t.match(/\|=.`(.+?)`/):t.match(/`\(\?i\)(.+)`/);r&&2===r.length&&this.setState({lineFilter:r[1].replace(/\\(.)/g,"$1"),caseSensitive:n})})),wS(this,"handleChange",(e=>{this.updateFilter(e.target.value)})),wS(this,"handleEnter",(e=>{"Enter"===e.key&&this.updateVariable(this.state.lineFilter)})),wS(this,"onCaseSensitiveToggle",(e=>{this.setState({caseSensitive:"sensitive"===e}),this.updateFilter(this.state.lineFilter)})),wS(this,"updateVariableDebounced",(0,re.debounce)((e=>{this.updateVariable(e)}),1e3)),wS(this,"updateVariable",(e=>{const t=Rm(this);""===e?t.changeValueTo(""):this.state.caseSensitive?t.changeValueTo(`|= \`${(0,re.escapeRegExp)(e)}\``):t.changeValueTo(`|~ \`(?i)${(0,re.escapeRegExp)(e)}\``),qv(Gv,Xv.service_details.search_string_in_logs_changed,{searchQueryLength:e.length,containsLevel:e.toLowerCase().includes("level")})})),this.addActivationHandler(this.onActivate)}}wS(SS,"Component",(function({model:e}){const{lineFilter:t,caseSensitive:n}=e.useState();return r().createElement(Wt.Field,{className:xS.field},r().createElement(OO,{"data-testid":Kv,value:t,className:xS.input,onChange:e.handleChange,suffix:r().createElement(yS,{caseSensitive:n,onCaseSensitiveToggle:e.onCaseSensitiveToggle}),placeholder:"Search in log lines",onClear:()=>{e.updateFilter("",!1)},onKeyUp:e.handleEnter}))}));const xS={input:(0,Ht.css)({width:"100%"}),field:(0,Ht.css)({label:"field",width:"100%",marginBottom:0})};function _S(e,t,n){const r=e.getFieldByName(t);if(void 0!==r)return r.type===n?r:void 0}const PS="timestamp",ES="body";function CS(e){const t={};return Object.entries(e).forEach((([e,n])=>{t[e]="string"==typeof n?n:JSON.stringify(n)})),t}function kS(e){var t;return null!==(t=null==e?void 0:e.timeField.name)&&void 0!==t?t:PS}function DS(e){var t;return null!==(t=null==e?void 0:e.bodyField.name)&&void 0!==t?t:ES}function TS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function RS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){TS(e,t,n[t])}))}return e}const IS=`${Wm}.tableColumnWidths`;var AS;!function(e){e.text="text",e.labels="labels",e.auto="auto"}(AS||(AS={}));const jS=(0,t.createContext)({columnWidthMap:{},setColumnWidthMap:()=>{},columns:{},filteredColumns:{},setColumns:()=>{},setFilteredColumns:()=>{},setVisible:()=>!1,visible:!1,bodyState:"auto",setBodyState:()=>{},clearSelectedLine:()=>{}}),LS=({children:e,initialColumns:n,logsFrame:i,setUrlColumns:a,clearSelectedLine:o})=>{const[s,l]=(0,t.useState)($S(n)),[c,u]=(0,t.useState)("auto"),[d,p]=(0,t.useState)(void 0),[f,h]=(0,t.useState)(!1),g=function(){let e={};const t=localStorage.getItem(IS);if(t)try{e=JSON.parse(t)}catch(e){Gg.error(e,{msg:"error parsing table column widths from local storage"})}return e}(),[m,b]=(0,t.useState)(g),v=(0,t.useCallback)((e=>{if(e){const t=$S(e);l(t),a((e=>{let t=[];return Object.keys(e).forEach((n=>{e[n].active&&void 0!==e[n].index&&t.push(n)})),t.sort(((t,n)=>{const r=e[t],i=e[n];return r.index-i.index})),t})(t))}}),[a]),y=(0,t.useCallback)((e=>{h(e)}),[]);return(0,t.useEffect)((()=>{n&&v(n)}),[n,v]),(0,t.useEffect)((()=>{const e=function(e,t){if(!t)return void Gg.warn("missing dataframe, cannot set url state");const n=Object.keys(e).filter((t=>{var n;return null===(n=e[t])||void 0===n?void 0:n.active})).sort(((t,n)=>{const r=e[t],i=e[n];return void 0!==r.index&&void 0!==i.index?r.index-i.index:0})),r=t.timeField,i=t.bodyField;if(r&&i||n.length){const e=[];return(null==r?void 0:r.name)&&e.push(r.name),(null==i?void 0:i.name)&&e.push(i.name),n.length?n:e}return[]}(s,i);(null==e?void 0:e.length)&&(0===Object.keys(s).filter((e=>s[e].active)).length&&function(e,t,n){const r=RS({},e);r[kS(n)]={index:0,active:!0,type:"TIME_FIELD",percentOfLinesWithLabel:100,cardinality:1/0},r[DS(n)]={index:1,active:!0,type:"BODY_FIELD",percentOfLinesWithLabel:100,cardinality:1/0},t(r)}(s,v,i),p(void 0))}),[s,i,p,v]),r().createElement(jS.Provider,{value:{setColumnWidthMap:e=>{localStorage.setItem(IS,JSON.stringify(e)),b(e)},columnWidthMap:m,bodyState:c,setBodyState:u,setFilteredColumns:p,filteredColumns:d,columns:s,setColumns:v,visible:f,setVisible:y,clearSelectedLine:()=>{o()}}},e)},$S=e=>{if("labelTypes"in e){const t=RS({},e),{labelTypes:n}=t;return function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(t,["labelTypes"])}return e},FS=()=>(0,t.useContext)(jS);var NS=g(367);const MS=(0,t.createContext)({cellIndex:{index:null,numberOfMenuItems:3},setActiveCellIndex:e=>!1}),VS=({children:e})=>{const[n,i]=(0,t.useState)({index:null}),a=(0,t.useCallback)((e=>{i(e)}),[]);return r().createElement(MS.Provider,{value:{cellIndex:n,setActiveCellIndex:a}},e)},BS=()=>(0,t.useContext)(MS),zS=(0,t.createContext)({isHeaderMenuActive:!1,setHeaderMenuActive:e=>!1}),WS=({children:e})=>{const[n,i]=(0,t.useState)(!1),a=(0,t.useCallback)((e=>{i(e)}),[]);return r().createElement(zS.Provider,{value:{isHeaderMenuActive:n,setHeaderMenuActive:a}},e)},QS=()=>(0,t.useContext)(zS);function US({searchValue:e,setSearchValue:t}){const{columns:n,setFilteredColumns:i}=FS(),o=e=>{const t=e[0];let r={},o=0;var s;t.forEach((e=>{e in n&&(r[e]=n[e],o++)})),i(r),s=o,(0,a.reportInteraction)("grafana_logs_app_table_text_search_result_count",{resultCount:s})},s=function(e){return{searchWrap:(0,Ht.css)({padding:`${e.spacing(.4)} 0 ${e.spacing(.4)} ${e.spacing(.4)}`})}}((0,Wt.useTheme2)());return r().createElement(Wt.Field,{className:s.searchWrap},r().createElement(Wt.Input,{value:e,type:"text",placeholder:"Search fields by name",onChange:e=>{var r;const a=null===(r=e.currentTarget)||void 0===r?void 0:r.value;var s;t(a),a?(s=a,cO(Object.keys(n),s,o)):i(void 0)}}))}var qS=g(694),HS=g(200);function GS(e,n){var r=(0,t.useState)((function(){return{inputs:n,result:e()}}))[0],i=(0,t.useRef)(!0),a=(0,t.useRef)(r),o=i.current||Boolean(n&&a.current.inputs&&function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(n,a.current.inputs)),s=o?a.current:{inputs:n,result:e()};return(0,t.useEffect)((function(){i.current=!1,a.current=s}),[s]),s.result}var XS=GS,YS=function(e,t){return GS((function(){return e}),t)},ZS=function(e){var t=e.top,n=e.right,r=e.bottom,i=e.left;return{top:t,right:n,bottom:r,left:i,width:n-i,height:r-t,x:i,y:t,center:{x:(n+i)/2,y:(r+t)/2}}},KS=function(e,t){return{top:e.top-t.top,left:e.left-t.left,bottom:e.bottom+t.bottom,right:e.right+t.right}},JS=function(e,t){return{top:e.top+t.top,left:e.left+t.left,bottom:e.bottom-t.bottom,right:e.right-t.right}},ex={top:0,right:0,bottom:0,left:0},tx=function(e){var t=e.borderBox,n=e.margin,r=void 0===n?ex:n,i=e.border,a=void 0===i?ex:i,o=e.padding,s=void 0===o?ex:o,l=ZS(KS(t,r)),c=ZS(JS(t,a)),u=ZS(JS(c,s));return{marginBox:l,borderBox:ZS(t),paddingBox:c,contentBox:u,margin:r,border:a,padding:s}},nx=function(e){var t=e.slice(0,-2);if("px"!==e.slice(-2))return 0;var n=Number(t);return isNaN(n)&&function(e,t){throw new Error("Invariant failed")}(),n},rx=function(e,t){var n,r,i=e.borderBox,a=e.border,o=e.margin,s=e.padding,l=(r=t,{top:(n=i).top+r.y,left:n.left+r.x,bottom:n.bottom+r.y,right:n.right+r.x});return tx({borderBox:l,border:a,margin:o,padding:s})},ix=function(e,t){return void 0===t&&(t={x:window.pageXOffset,y:window.pageYOffset}),rx(e,t)},ax=function(e,t){var n={top:nx(t.marginTop),right:nx(t.marginRight),bottom:nx(t.marginBottom),left:nx(t.marginLeft)},r={top:nx(t.paddingTop),right:nx(t.paddingRight),bottom:nx(t.paddingBottom),left:nx(t.paddingLeft)},i={top:nx(t.borderTopWidth),right:nx(t.borderRightWidth),bottom:nx(t.borderBottomWidth),left:nx(t.borderLeftWidth)};return tx({borderBox:e,margin:n,padding:r,border:i})},ox=function(e){var t=e.getBoundingClientRect(),n=window.getComputedStyle(e);return ax(t,n)},sx=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function lx(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!((r=e[n])===(i=t[n])||sx(r)&&sx(i)))return!1;var r,i;return!0}function cx(e,t){void 0===t&&(t=lx);var n=null;function r(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(n&&n.lastThis===this&&t(r,n.lastArgs))return n.lastResult;var a=e.apply(this,r);return n={lastResult:a,lastArgs:r,lastThis:this},a}return r.clear=function(){n=null},r}const ux=function(e){var t=[],n=null,r=function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];t=i,n||(n=requestAnimationFrame((function(){n=null,e.apply(void 0,t)})))};return r.cancel=function(){n&&(cancelAnimationFrame(n),n=null)},r};function dx(){return dx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},dx.apply(null,arguments)}function px(e,t){}function fx(){}function hx(e,t,n){const r=t.map((t=>{const r=(i=n,a=t.options,{...i,...a});var i,a;return e.addEventListener(t.eventName,t.fn,r),function(){e.removeEventListener(t.eventName,t.fn,r)}}));return function(){r.forEach((e=>{e()}))}}px.bind(null,"warn"),px.bind(null,"error");const gx=!0,mx="Invariant failed";class bx extends Error{}function vx(e,t){if(!e)throw new bx(gx?mx:`${mx}: ${t||""}`)}bx.prototype.toString=function(){return this.message};class yx extends r().Component{constructor(...e){super(...e),this.callbacks=null,this.unbind=fx,this.onWindowError=e=>{const t=this.getCallbacks();t.isDragging()&&t.tryAbort(),e.error instanceof bx&&e.preventDefault()},this.getCallbacks=()=>{if(!this.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return this.callbacks},this.setCallbacks=e=>{this.callbacks=e}}componentDidMount(){this.unbind=hx(window,[{eventName:"error",fn:this.onWindowError}])}componentDidCatch(e){if(!(e instanceof bx))throw e;this.setState({})}componentWillUnmount(){this.unbind()}render(){return this.props.children(this.setCallbacks)}}const Ox=e=>e+1,wx=(e,t)=>{const n=e.droppableId===t.droppableId,r=Ox(e.index),i=Ox(t.index);return n?`\n      You have moved the item from position ${r}\n      to position ${i}\n    `:`\n    You have moved the item from position ${r}\n    in list ${e.droppableId}\n    to list ${t.droppableId}\n    in position ${i}\n  `},Sx=(e,t,n)=>t.droppableId===n.droppableId?`\n      The item ${e}\n      has been combined with ${n.draggableId}`:`\n      The item ${e}\n      in list ${t.droppableId}\n      has been combined with ${n.draggableId}\n      in list ${n.droppableId}\n    `,xx=e=>`\n  The item has returned to its starting position\n  of ${Ox(e.index)}\n`,_x={dragHandleUsageInstructions:"\n  Press space bar to start a drag.\n  When dragging you can use the arrow keys to move the item around and escape to cancel.\n  Some screen readers may require you to be in focus mode or to use your pass through key\n",onDragStart:e=>`\n  You have lifted an item in position ${Ox(e.source.index)}\n`,onDragUpdate:e=>{const t=e.destination;if(t)return wx(e.source,t);const n=e.combine;return n?Sx(e.draggableId,e.source,n):"You are over an area that cannot be dropped on"},onDragEnd:e=>{if("CANCEL"===e.reason)return`\n      Movement cancelled.\n      ${xx(e.source)}\n    `;const t=e.destination,n=e.combine;return t?`\n      You have dropped the item.\n      ${wx(e.source,t)}\n    `:n?`\n      You have dropped the item.\n      ${Sx(e.draggableId,e.source,n)}\n    `:`\n    The item has been dropped while not over a drop area.\n    ${xx(e.source)}\n  `}};var Px=_x;const Ex={x:0,y:0},Cx=(e,t)=>({x:e.x+t.x,y:e.y+t.y}),kx=(e,t)=>({x:e.x-t.x,y:e.y-t.y}),Dx=(e,t)=>e.x===t.x&&e.y===t.y,Tx=e=>({x:0!==e.x?-e.x:0,y:0!==e.y?-e.y:0}),Rx=(e,t,n=0)=>"x"===e?{x:t,y:n}:{x:n,y:t},Ix=(e,t)=>Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2),Ax=(e,t)=>Math.min(...t.map((t=>Ix(e,t)))),jx=e=>t=>({x:e(t.x),y:e(t.y)}),Lx=(e,t)=>({top:e.top+t.y,left:e.left+t.x,bottom:e.bottom+t.y,right:e.right+t.x}),$x=e=>[{x:e.left,y:e.top},{x:e.right,y:e.top},{x:e.left,y:e.bottom},{x:e.right,y:e.bottom}],Fx=(e,t)=>t&&t.shouldClipSubject?((e,t)=>{const n=ZS({top:Math.max(t.top,e.top),right:Math.min(t.right,e.right),bottom:Math.min(t.bottom,e.bottom),left:Math.max(t.left,e.left)});return n.width<=0||n.height<=0?null:n})(t.pageMarginBox,e):ZS(e);var Nx=({page:e,withPlaceholder:t,axis:n,frame:r})=>{const i=((e,t)=>t?Lx(e,t.scroll.diff.displacement):e)(e.marginBox,r),a=((e,t,n)=>n&&n.increasedBy?{...e,[t.end]:e[t.end]+n.increasedBy[t.line]}:e)(i,n,t);return{page:e,withPlaceholder:t,active:Fx(a,r)}},Mx=(e,t)=>{e.frame||vx(!1);const n=e.frame,r=kx(t,n.scroll.initial),i=Tx(r),a={...n,scroll:{initial:n.scroll.initial,current:t,diff:{value:r,displacement:i},max:n.scroll.max}},o=Nx({page:e.subject.page,withPlaceholder:e.subject.withPlaceholder,axis:e.axis,frame:a});return{...e,frame:a,subject:o}};const Vx=cx((e=>e.reduce(((e,t)=>(e[t.descriptor.id]=t,e)),{}))),Bx=cx((e=>e.reduce(((e,t)=>(e[t.descriptor.id]=t,e)),{}))),zx=cx((e=>Object.values(e))),Wx=cx((e=>Object.values(e)));var Qx=cx(((e,t)=>{const n=Wx(t).filter((t=>e===t.descriptor.droppableId)).sort(((e,t)=>e.descriptor.index-t.descriptor.index));return n}));function Ux(e){return e.at&&"REORDER"===e.at.type?e.at.destination:null}function qx(e){return e.at&&"COMBINE"===e.at.type?e.at.combine:null}var Hx=cx(((e,t)=>t.filter((t=>t.descriptor.id!==e.descriptor.id)))),Gx=(e,t)=>e.descriptor.droppableId===t.descriptor.id;const Xx={point:Ex,value:0},Yx={invisible:{},visible:{},all:[]};var Zx={displaced:Yx,displacedBy:Xx,at:null},Kx=(e,t)=>n=>e<=n&&n<=t,Jx=e=>{const t=Kx(e.top,e.bottom),n=Kx(e.left,e.right);return r=>{if(t(r.top)&&t(r.bottom)&&n(r.left)&&n(r.right))return!0;const i=t(r.top)||t(r.bottom),a=n(r.left)||n(r.right);if(i&&a)return!0;const o=r.top<e.top&&r.bottom>e.bottom,s=r.left<e.left&&r.right>e.right;return!(!o||!s)||(o&&a||s&&i)}},e_=e=>{const t=Kx(e.top,e.bottom),n=Kx(e.left,e.right);return e=>t(e.top)&&t(e.bottom)&&n(e.left)&&n(e.right)};const t_={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},n_={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"},r_=({target:e,destination:t,viewport:n,withDroppableDisplacement:r,isVisibleThroughFrameFn:i})=>{const a=r?((e,t)=>{const n=t.frame?t.frame.scroll.diff.displacement:Ex;return Lx(e,n)})(e,t):e;return((e,t,n)=>!!t.subject.active&&n(t.subject.active)(e))(a,t,i)&&((e,t,n)=>n(t)(e))(a,n,i)},i_=e=>r_({...e,isVisibleThroughFrameFn:Jx}),a_=e=>r_({...e,isVisibleThroughFrameFn:e_}),o_=(e,t,n)=>{if("boolean"==typeof n)return n;if(!t)return!0;const{invisible:r,visible:i}=t;if(r[e])return!1;const a=i[e];return!a||a.shouldAnimate};function s_({afterDragging:e,destination:t,displacedBy:n,viewport:r,forceShouldAnimate:i,last:a}){return e.reduce((function(e,o){const s=function(e,t){const n=e.page.marginBox,r={top:t.point.y,right:0,bottom:0,left:t.point.x};return ZS(KS(n,r))}(o,n),l=o.descriptor.id;if(e.all.push(l),!i_({target:s,destination:t,viewport:r,withDroppableDisplacement:!0}))return e.invisible[o.descriptor.id]=!0,e;const c={draggableId:l,shouldAnimate:o_(l,a,i)};return e.visible[l]=c,e}),{all:[],visible:{},invisible:{}})}function l_({insideDestination:e,inHomeList:t,displacedBy:n,destination:r}){const i=function(e,t){if(!e.length)return 0;const n=e[e.length-1].descriptor.index;return t.inHomeList?n:n+1}(e,{inHomeList:t});return{displaced:Yx,displacedBy:n,at:{type:"REORDER",destination:{droppableId:r.descriptor.id,index:i}}}}function c_({draggable:e,insideDestination:t,destination:n,viewport:r,displacedBy:i,last:a,index:o,forceShouldAnimate:s}){const l=Gx(e,n);if(null==o)return l_({insideDestination:t,inHomeList:l,displacedBy:i,destination:n});const c=t.find((e=>e.descriptor.index===o));if(!c)return l_({insideDestination:t,inHomeList:l,displacedBy:i,destination:n});const u=Hx(e,t),d=t.indexOf(c);return{displaced:s_({afterDragging:u.slice(d),destination:n,displacedBy:i,last:a,viewport:r.frame,forceShouldAnimate:s}),displacedBy:i,at:{type:"REORDER",destination:{droppableId:n.descriptor.id,index:o}}}}function u_(e,t){return Boolean(t.effected[e])}const d_=(e,t)=>t.margin[e.start]+t.borderBox[e.size]/2,p_=(e,t,n)=>t[e.crossAxisStart]+n.margin[e.crossAxisStart]+n.borderBox[e.crossAxisSize]/2,f_=({axis:e,moveRelativeTo:t,isMoving:n})=>Rx(e.line,t.marginBox[e.end]+d_(e,n),p_(e,t.marginBox,n)),h_=({axis:e,moveRelativeTo:t,isMoving:n})=>Rx(e.line,t.marginBox[e.start]-((e,t)=>t.margin[e.end]+t.borderBox[e.size]/2)(e,n),p_(e,t.marginBox,n));var g_=(e,t)=>{const n=e.frame;return n?Cx(t,n.scroll.diff.displacement):t},m_=e=>{const t=(({impact:e,draggable:t,droppable:n,draggables:r,afterCritical:i})=>{const a=t.page.borderBox.center,o=e.at;return n&&o?"REORDER"===o.type?(({impact:e,draggable:t,draggables:n,droppable:r,afterCritical:i})=>{const a=Qx(r.descriptor.id,n),o=t.page,s=r.axis;if(!a.length)return(({axis:e,moveInto:t,isMoving:n})=>Rx(e.line,t.contentBox[e.start]+d_(e,n),p_(e,t.contentBox,n)))({axis:s,moveInto:r.page,isMoving:o});const{displaced:l,displacedBy:c}=e,u=l.all[0];if(u){const e=n[u];if(u_(u,i))return h_({axis:s,moveRelativeTo:e.page,isMoving:o});const t=rx(e.page,c.point);return h_({axis:s,moveRelativeTo:t,isMoving:o})}const d=a[a.length-1];if(d.descriptor.id===t.descriptor.id)return o.borderBox.center;if(u_(d.descriptor.id,i)){const e=rx(d.page,Tx(i.displacedBy.point));return f_({axis:s,moveRelativeTo:e,isMoving:o})}return f_({axis:s,moveRelativeTo:d.page,isMoving:o})})({impact:e,draggable:t,draggables:r,droppable:n,afterCritical:i}):(({afterCritical:e,impact:t,draggables:n})=>{const r=qx(t);r||vx(!1);const i=r.draggableId,a=n[i].page.borderBox.center,o=(({displaced:e,afterCritical:t,combineWith:n,displacedBy:r})=>{const i=Boolean(e.visible[n]||e.invisible[n]);return u_(n,t)?i?Ex:Tx(r.point):i?r.point:Ex})({displaced:t.displaced,afterCritical:e,combineWith:i,displacedBy:t.displacedBy});return Cx(a,o)})({impact:e,draggables:r,afterCritical:i}):a})(e),n=e.droppable;return n?g_(n,t):t},b_=(e,t)=>{const n=kx(t,e.scroll.initial),r=Tx(n);return{frame:ZS({top:t.y,bottom:t.y+e.frame.height,left:t.x,right:t.x+e.frame.width}),scroll:{initial:e.scroll.initial,max:e.scroll.max,current:t,diff:{value:n,displacement:r}}}};function v_(e,t){return e.map((e=>t[e]))}var y_=({pageBorderBoxCenter:e,draggable:t,viewport:n})=>{const r=((e,t)=>Cx(e.scroll.diff.displacement,t))(n,e),i=kx(r,t.page.borderBox.center);return Cx(t.client.borderBox.center,i)},O_=({draggable:e,destination:t,newPageBorderBoxCenter:n,viewport:r,withDroppableDisplacement:i,onlyOnMainAxis:a=!1})=>{const o=kx(n,e.page.borderBox.center),s={target:Lx(e.page.borderBox,o),destination:t,withDroppableDisplacement:i,viewport:r};return a?(e=>{return r_({...e,isVisibleThroughFrameFn:(t=e.destination.axis,e=>{const n=Kx(e.top,e.bottom),r=Kx(e.left,e.right);return e=>t===t_?n(e.top)&&n(e.bottom):r(e.left)&&r(e.right)})});var t})(s):a_(s)},w_=({isMovingForward:e,draggable:t,destination:n,draggables:r,previousImpact:i,viewport:a,previousPageBorderBoxCenter:o,previousClientSelection:s,afterCritical:l})=>{if(!n.isEnabled)return null;const c=Qx(n.descriptor.id,r),u=Gx(t,n),d=(({isMovingForward:e,draggable:t,destination:n,insideDestination:r,previousImpact:i})=>{if(!n.isCombineEnabled)return null;if(!Ux(i))return null;function a(e){const t={type:"COMBINE",combine:{draggableId:e,droppableId:n.descriptor.id}};return{...i,at:t}}const o=i.displaced.all,s=o.length?o[0]:null;if(e)return s?a(s):null;const l=Hx(t,r);if(!s)return l.length?a(l[l.length-1].descriptor.id):null;const c=l.findIndex((e=>e.descriptor.id===s));-1===c&&vx(!1);const u=c-1;return u<0?null:a(l[u].descriptor.id)})({isMovingForward:e,draggable:t,destination:n,insideDestination:c,previousImpact:i})||(({isMovingForward:e,isInHomeList:t,draggable:n,draggables:r,destination:i,insideDestination:a,previousImpact:o,viewport:s,afterCritical:l})=>{const c=o.at;if(c||vx(!1),"REORDER"===c.type){const r=(({isMovingForward:e,isInHomeList:t,insideDestination:n,location:r})=>{if(!n.length)return null;const i=r.index,a=e?i+1:i-1,o=n[0].descriptor.index,s=n[n.length-1].descriptor.index;return a<o||a>(t?s:s+1)?null:a})({isMovingForward:e,isInHomeList:t,location:c.destination,insideDestination:a});return null==r?null:c_({draggable:n,insideDestination:a,destination:i,viewport:s,last:o.displaced,displacedBy:o.displacedBy,index:r})}const u=(({isMovingForward:e,destination:t,draggables:n,combine:r,afterCritical:i})=>{if(!t.isCombineEnabled)return null;const a=r.draggableId,o=n[a].descriptor.index;return u_(a,i)?e?o:o-1:e?o+1:o})({isMovingForward:e,destination:i,displaced:o.displaced,draggables:r,combine:c.combine,afterCritical:l});return null==u?null:c_({draggable:n,insideDestination:a,destination:i,viewport:s,last:o.displaced,displacedBy:o.displacedBy,index:u})})({isMovingForward:e,isInHomeList:u,draggable:t,draggables:r,destination:n,insideDestination:c,previousImpact:i,viewport:a,afterCritical:l});if(!d)return null;const p=m_({impact:d,draggable:t,droppable:n,draggables:r,afterCritical:l});if(O_({draggable:t,destination:n,newPageBorderBoxCenter:p,viewport:a.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0}))return{clientSelection:y_({pageBorderBoxCenter:p,draggable:t,viewport:a}),impact:d,scrollJumpRequest:null};const f=kx(p,o),h=(({impact:e,viewport:t,destination:n,draggables:r,maxScrollChange:i})=>{const a=b_(t,Cx(t.scroll.current,i)),o=n.frame?Mx(n,Cx(n.frame.scroll.current,i)):n,s=e.displaced,l=s_({afterDragging:v_(s.all,r),destination:n,displacedBy:e.displacedBy,viewport:a.frame,last:s,forceShouldAnimate:!1}),c=s_({afterDragging:v_(s.all,r),destination:o,displacedBy:e.displacedBy,viewport:t.frame,last:s,forceShouldAnimate:!1}),u={},d={},p=[s,l,c];return s.all.forEach((e=>{const t=function(e,t){for(let n=0;n<t.length;n++){const r=t[n].visible[e];if(r)return r}return null}(e,p);t?d[e]=t:u[e]=!0})),{...e,displaced:{all:s.all,invisible:u,visible:d}}})({impact:d,viewport:a,destination:n,draggables:r,maxScrollChange:f});return{clientSelection:s,impact:h,scrollJumpRequest:f}};const S_=e=>{const t=e.subject.active;return t||vx(!1),t},x_=(e,t)=>{const n=e.page.borderBox.center;return u_(e.descriptor.id,t)?kx(n,t.displacedBy.point):n},__=(e,t)=>{const n=e.page.borderBox;return u_(e.descriptor.id,t)?Lx(n,Tx(t.displacedBy.point)):n};var P_=cx((function(e,t){const n=t[e.line];return{value:n,point:Rx(e.line,n)}}));const E_=(e,t)=>({...e,scroll:{...e.scroll,max:t}}),C_=(e,t,n)=>{const r=e.frame;Gx(t,e)&&vx(!1),e.subject.withPlaceholder&&vx(!1);const i=P_(e.axis,t.displaceBy).point,a=((e,t,n)=>{const r=e.axis;if("virtual"===e.descriptor.mode)return Rx(r.line,t[r.line]);const i=e.subject.page.contentBox[r.size],a=Qx(e.descriptor.id,n).reduce(((e,t)=>e+t.client.marginBox[r.size]),0)+t[r.line]-i;return a<=0?null:Rx(r.line,a)})(e,i,n),o={placeholderSize:i,increasedBy:a,oldFrameMaxScroll:e.frame?e.frame.scroll.max:null};if(!r){const t=Nx({page:e.subject.page,withPlaceholder:o,axis:e.axis,frame:e.frame});return{...e,subject:t}}const s=a?Cx(r.scroll.max,a):r.scroll.max,l=E_(r,s),c=Nx({page:e.subject.page,withPlaceholder:o,axis:e.axis,frame:l});return{...e,subject:c,frame:l}};var k_=e=>{const t=e.at;return t?"REORDER"===t.type?t.destination.droppableId:t.combine.droppableId:null},D_=({state:e,type:t})=>{const n=((e,t)=>{const n=k_(e);return n?t[n]:null})(e.impact,e.dimensions.droppables),r=Boolean(n),i=e.dimensions.droppables[e.critical.droppable.id],a=n||i,o=a.axis.direction,s="vertical"===o&&("MOVE_UP"===t||"MOVE_DOWN"===t)||"horizontal"===o&&("MOVE_LEFT"===t||"MOVE_RIGHT"===t);if(s&&!r)return null;const l="MOVE_DOWN"===t||"MOVE_RIGHT"===t,c=e.dimensions.draggables[e.critical.draggable.id],u=e.current.page.borderBoxCenter,{draggables:d,droppables:p}=e.dimensions;return s?w_({isMovingForward:l,previousPageBorderBoxCenter:u,draggable:c,destination:a,draggables:d,viewport:e.viewport,previousClientSelection:e.current.client.selection,previousImpact:e.impact,afterCritical:e.afterCritical}):(({isMovingForward:e,previousPageBorderBoxCenter:t,draggable:n,isOver:r,draggables:i,droppables:a,viewport:o,afterCritical:s})=>{const l=(({isMovingForward:e,pageBorderBoxCenter:t,source:n,droppables:r,viewport:i})=>{const a=n.subject.active;if(!a)return null;const o=n.axis,s=Kx(a[o.start],a[o.end]),l=zx(r).filter((e=>e!==n)).filter((e=>e.isEnabled)).filter((e=>Boolean(e.subject.active))).filter((e=>Jx(i.frame)(S_(e)))).filter((t=>{const n=S_(t);return e?a[o.crossAxisEnd]<n[o.crossAxisEnd]:n[o.crossAxisStart]<a[o.crossAxisStart]})).filter((e=>{const t=S_(e),n=Kx(t[o.start],t[o.end]);return s(t[o.start])||s(t[o.end])||n(a[o.start])||n(a[o.end])})).sort(((t,n)=>{const r=S_(t)[o.crossAxisStart],i=S_(n)[o.crossAxisStart];return e?r-i:i-r})).filter(((e,t,n)=>S_(e)[o.crossAxisStart]===S_(n[0])[o.crossAxisStart]));if(!l.length)return null;if(1===l.length)return l[0];const c=l.filter((e=>Kx(S_(e)[o.start],S_(e)[o.end])(t[o.line])));return 1===c.length?c[0]:c.length>1?c.sort(((e,t)=>S_(e)[o.start]-S_(t)[o.start]))[0]:l.sort(((e,n)=>{const r=Ax(t,$x(S_(e))),i=Ax(t,$x(S_(n)));return r!==i?r-i:S_(e)[o.start]-S_(n)[o.start]}))[0]})({isMovingForward:e,pageBorderBoxCenter:t,source:r,droppables:a,viewport:o});if(!l)return null;const c=Qx(l.descriptor.id,i),u=(({pageBorderBoxCenter:e,viewport:t,destination:n,insideDestination:r,afterCritical:i})=>{const a=r.filter((e=>a_({target:__(e,i),destination:n,viewport:t.frame,withDroppableDisplacement:!0}))).sort(((t,r)=>{const a=Ix(e,g_(n,x_(t,i))),o=Ix(e,g_(n,x_(r,i)));return a<o?-1:o<a?1:t.descriptor.index-r.descriptor.index}));return a[0]||null})({pageBorderBoxCenter:t,viewport:o,destination:l,insideDestination:c,afterCritical:s}),d=(({previousPageBorderBoxCenter:e,moveRelativeTo:t,insideDestination:n,draggable:r,draggables:i,destination:a,viewport:o,afterCritical:s})=>{if(!t){if(n.length)return null;const e={displaced:Yx,displacedBy:Xx,at:{type:"REORDER",destination:{droppableId:a.descriptor.id,index:0}}},t=m_({impact:e,draggable:r,droppable:a,draggables:i,afterCritical:s}),l=Gx(r,a)?a:C_(a,r,i);return O_({draggable:r,destination:l,newPageBorderBoxCenter:t,viewport:o.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0})?e:null}const l=Boolean(e[a.axis.line]<=t.page.borderBox.center[a.axis.line]),c=(()=>{const e=t.descriptor.index;return t.descriptor.id===r.descriptor.id||l?e:e+1})(),u=P_(a.axis,r.displaceBy);return c_({draggable:r,insideDestination:n,destination:a,viewport:o,displacedBy:u,last:Yx,index:c})})({previousPageBorderBoxCenter:t,destination:l,draggable:n,draggables:i,moveRelativeTo:u,insideDestination:c,viewport:o,afterCritical:s});if(!d)return null;const p=m_({impact:d,draggable:n,droppable:l,draggables:i,afterCritical:s});return{clientSelection:y_({pageBorderBoxCenter:p,draggable:n,viewport:o}),impact:d,scrollJumpRequest:null}})({isMovingForward:l,previousPageBorderBoxCenter:u,draggable:c,isOver:a,draggables:d,droppables:p,viewport:e.viewport,afterCritical:e.afterCritical})};function T_(e){return"DRAGGING"===e.phase||"COLLECTING"===e.phase}function R_(e){const t=Kx(e.top,e.bottom),n=Kx(e.left,e.right);return function(e){return t(e.y)&&n(e.x)}}const I_=(e,t)=>ZS(Lx(e,t));function A_({displaced:e,id:t}){return Boolean(e.visible[t]||e.invisible[t])}var j_=({pageOffset:e,draggable:t,draggables:n,droppables:r,previousImpact:i,viewport:a,afterCritical:o})=>{const s=I_(t.page.borderBox,e),l=function({pageBorderBox:e,draggable:t,droppables:n}){const r=zx(n).filter((t=>{if(!t.isEnabled)return!1;const n=t.subject.active;if(!n)return!1;if(i=n,!((r=e).left<i.right&&r.right>i.left&&r.top<i.bottom&&r.bottom>i.top))return!1;var r,i;if(R_(n)(e.center))return!0;const a=t.axis,o=n.center[a.crossAxisLine],s=e[a.crossAxisStart],l=e[a.crossAxisEnd],c=Kx(n[a.crossAxisStart],n[a.crossAxisEnd]),u=c(s),d=c(l);return!u&&!d||(u?s<o:l>o)}));return r.length?1===r.length?r[0].descriptor.id:function({pageBorderBox:e,draggable:t,candidates:n}){const r=t.page.borderBox.center,i=n.map((t=>{const n=t.axis,i=Rx(t.axis.line,e.center[n.line],t.page.borderBox.center[n.crossAxisLine]);return{id:t.descriptor.id,distance:Ix(r,i)}})).sort(((e,t)=>t.distance-e.distance));return i[0]?i[0].id:null}({pageBorderBox:e,draggable:t,candidates:r}):null}({pageBorderBox:s,draggable:t,droppables:r});if(!l)return Zx;const c=r[l],u=Qx(c.descriptor.id,n),d=((e,t)=>{const n=e.frame;return n?I_(t,n.scroll.diff.value):t})(c,s);return(({draggable:e,pageBorderBoxWithDroppableScroll:t,previousImpact:n,destination:r,insideDestination:i,afterCritical:a})=>{if(!r.isCombineEnabled)return null;const o=r.axis,s=P_(r.axis,e.displaceBy),l=s.value,c=t[o.start],u=t[o.end],d=Hx(e,i).find((e=>{const t=e.descriptor.id,r=e.page.borderBox,i=r[o.size]/4,s=u_(t,a),d=A_({displaced:n.displaced,id:t});return s?d?u>r[o.start]+i&&u<r[o.end]-i:c>r[o.start]-l+i&&c<r[o.end]-l-i:d?u>r[o.start]+l+i&&u<r[o.end]+l-i:c>r[o.start]+i&&c<r[o.end]-i}));return d?{displacedBy:s,displaced:n.displaced,at:{type:"COMBINE",combine:{draggableId:d.descriptor.id,droppableId:r.descriptor.id}}}:null})({pageBorderBoxWithDroppableScroll:d,draggable:t,previousImpact:i,destination:c,insideDestination:u,afterCritical:o})||(({pageBorderBoxWithDroppableScroll:e,draggable:t,destination:n,insideDestination:r,last:i,viewport:a,afterCritical:o})=>{const s=n.axis,l=P_(n.axis,t.displaceBy),c=l.value,u=e[s.start],d=e[s.end],p=function({draggable:e,closest:t,inHomeList:n}){return t?n&&t.descriptor.index>e.descriptor.index?t.descriptor.index-1:t.descriptor.index:null}({draggable:t,closest:Hx(t,r).find((e=>{const t=e.descriptor.id,n=e.page.borderBox.center[s.line],r=u_(t,o),a=A_({displaced:i,id:t});return r?a?d<=n:u<n-c:a?d<=n+c:u<n}))||null,inHomeList:Gx(t,n)});return c_({draggable:t,insideDestination:r,destination:n,viewport:a,last:i,displacedBy:l,index:p})})({pageBorderBoxWithDroppableScroll:d,draggable:t,destination:c,insideDestination:u,last:i.displaced,viewport:a,afterCritical:o})},L_=(e,t)=>({...e,[t.descriptor.id]:t});var $_=({state:e,clientSelection:t,dimensions:n,viewport:r,impact:i,scrollJumpRequest:a})=>{const o=r||e.viewport,s=n||e.dimensions,l=t||e.current.client.selection,c=kx(l,e.initial.client.selection),u={offset:c,selection:l,borderBoxCenter:Cx(e.initial.client.borderBoxCenter,c)},d={selection:Cx(u.selection,o.scroll.current),borderBoxCenter:Cx(u.borderBoxCenter,o.scroll.current),offset:Cx(u.offset,o.scroll.diff.value)},p={client:u,page:d};if("COLLECTING"===e.phase)return{...e,dimensions:s,viewport:o,current:p};const f=s.draggables[e.critical.draggable.id],h=i||j_({pageOffset:d.offset,draggable:f,draggables:s.draggables,droppables:s.droppables,previousImpact:e.impact,viewport:o,afterCritical:e.afterCritical}),g=(({draggable:e,draggables:t,droppables:n,previousImpact:r,impact:i})=>{const a=(({previousImpact:e,impact:t,droppables:n})=>{const r=k_(e),i=k_(t);if(!r)return n;if(r===i)return n;const a=n[r];if(!a.subject.withPlaceholder)return n;const o=(e=>{const t=e.subject.withPlaceholder;t||vx(!1);const n=e.frame;if(!n){const t=Nx({page:e.subject.page,axis:e.axis,frame:null,withPlaceholder:null});return{...e,subject:t}}const r=t.oldFrameMaxScroll;r||vx(!1);const i=E_(n,r),a=Nx({page:e.subject.page,axis:e.axis,frame:i,withPlaceholder:null});return{...e,subject:a,frame:i}})(a);return L_(n,o)})({previousImpact:r,impact:i,droppables:n}),o=k_(i);if(!o)return a;const s=n[o];if(Gx(e,s))return a;if(s.subject.withPlaceholder)return a;const l=C_(s,e,t);return L_(a,l)})({draggable:f,impact:h,previousImpact:e.impact,draggables:s.draggables,droppables:s.droppables});return{...e,current:p,dimensions:{draggables:s.draggables,droppables:g},impact:h,viewport:o,scrollJumpRequest:a||null,forceShouldAnimate:!a&&null}},F_=({impact:e,viewport:t,draggables:n,destination:r,forceShouldAnimate:i})=>{const a=e.displaced,o=function(e,t){return e.map((e=>t[e]))}(a.all,n),s=s_({afterDragging:o,destination:r,displacedBy:e.displacedBy,viewport:t.frame,forceShouldAnimate:i,last:a});return{...e,displaced:s}},N_=({impact:e,draggable:t,droppable:n,draggables:r,viewport:i,afterCritical:a})=>{const o=m_({impact:e,draggable:t,draggables:r,droppable:n,afterCritical:a});return y_({pageBorderBoxCenter:o,draggable:t,viewport:i})},M_=({state:e,dimensions:t,viewport:n})=>{"SNAP"!==e.movementMode&&vx(!1);const r=e.impact,i=n||e.viewport,a=t||e.dimensions,{draggables:o,droppables:s}=a,l=o[e.critical.draggable.id],c=k_(r);c||vx(!1);const u=s[c],d=F_({impact:r,viewport:i,destination:u,draggables:o}),p=N_({impact:d,draggable:l,droppable:u,draggables:o,viewport:i,afterCritical:e.afterCritical});return $_({impact:d,clientSelection:p,state:e,dimensions:a,viewport:i})},V_=({draggable:e,home:t,draggables:n,viewport:r})=>{const i=P_(t.axis,e.displaceBy),a=Qx(t.descriptor.id,n),o=a.indexOf(e);-1===o&&vx(!1);const s=a.slice(o+1),l=s.reduce(((e,t)=>(e[t.descriptor.id]=!0,e)),{}),c={inVirtualList:"virtual"===t.descriptor.mode,displacedBy:i,effected:l};var u;return{impact:{displaced:s_({afterDragging:s,destination:t,displacedBy:i,last:null,viewport:r.frame,forceShouldAnimate:!1}),displacedBy:i,at:{type:"REORDER",destination:(u=e.descriptor,{index:u.index,droppableId:u.droppableId})}},afterCritical:c}};const B_=e=>"SNAP"===e.movementMode,z_=(e,t,n)=>{const r=((e,t)=>({draggables:e.draggables,droppables:L_(e.droppables,t)}))(e.dimensions,t);return!B_(e)||n?$_({state:e,dimensions:r}):M_({state:e,dimensions:r})};function W_(e){return e.isDragging&&"SNAP"===e.movementMode?{...e,scrollJumpRequest:null}:e}const Q_={phase:"IDLE",completed:null,shouldFlush:!1};var U_=(e=Q_,t)=>{if("FLUSH"===t.type)return{...Q_,shouldFlush:!0};if("INITIAL_PUBLISH"===t.type){"IDLE"!==e.phase&&vx(!1);const{critical:n,clientSelection:r,viewport:i,dimensions:a,movementMode:o}=t.payload,s=a.draggables[n.draggable.id],l=a.droppables[n.droppable.id],c={selection:r,borderBoxCenter:s.client.borderBox.center,offset:Ex},u={client:c,page:{selection:Cx(c.selection,i.scroll.initial),borderBoxCenter:Cx(c.selection,i.scroll.initial),offset:Cx(c.selection,i.scroll.diff.value)}},d=zx(a.droppables).every((e=>!e.isFixedOnPage)),{impact:p,afterCritical:f}=V_({draggable:s,home:l,draggables:a.draggables,viewport:i});return{phase:"DRAGGING",isDragging:!0,critical:n,movementMode:o,dimensions:a,initial:u,current:u,isWindowScrollAllowed:d,impact:p,afterCritical:f,onLiftImpact:p,viewport:i,scrollJumpRequest:null,forceShouldAnimate:null}}if("COLLECTION_STARTING"===t.type)return"COLLECTING"===e.phase||"DROP_PENDING"===e.phase?e:("DRAGGING"!==e.phase&&vx(!1),{...e,phase:"COLLECTING"});if("PUBLISH_WHILE_DRAGGING"===t.type)return"COLLECTING"!==e.phase&&"DROP_PENDING"!==e.phase&&vx(!1),(({state:e,published:t})=>{const n=t.modified.map((t=>{const n=e.dimensions.droppables[t.droppableId];return Mx(n,t.scroll)})),r={...e.dimensions.droppables,...Vx(n)},i=Bx((({additions:e,updatedDroppables:t,viewport:n})=>{const r=n.scroll.diff.value;return e.map((e=>{const i=e.descriptor.droppableId,a=(e=>{const t=e.frame;return t||vx(!1),t})(t[i]),o=a.scroll.diff.value,s=(({draggable:e,offset:t,initialWindowScroll:n})=>{const r=rx(e.client,t),i=ix(r,n);return{...e,placeholder:{...e.placeholder,client:r},client:r,page:i}})({draggable:e,offset:Cx(r,o),initialWindowScroll:n.scroll.initial});return s}))})({additions:t.additions,updatedDroppables:r,viewport:e.viewport})),a={...e.dimensions.draggables,...i};t.removals.forEach((e=>{delete a[e]}));const o={droppables:r,draggables:a},s=k_(e.impact),l=s?o.droppables[s]:null,c=o.draggables[e.critical.draggable.id],u=o.droppables[e.critical.droppable.id],{impact:d,afterCritical:p}=V_({draggable:c,home:u,draggables:a,viewport:e.viewport}),f=l&&l.isCombineEnabled?e.impact:d,h=j_({pageOffset:e.current.page.offset,draggable:o.draggables[e.critical.draggable.id],draggables:o.draggables,droppables:o.droppables,previousImpact:f,viewport:e.viewport,afterCritical:p}),g={...e,phase:"DRAGGING",impact:h,onLiftImpact:d,dimensions:o,afterCritical:p,forceShouldAnimate:!1};return"COLLECTING"===e.phase?g:{...g,phase:"DROP_PENDING",reason:e.reason,isWaiting:!1}})({state:e,published:t.payload});if("MOVE"===t.type){if("DROP_PENDING"===e.phase)return e;T_(e)||vx(!1);const{client:n}=t.payload;return Dx(n,e.current.client.selection)?e:$_({state:e,clientSelection:n,impact:B_(e)?e.impact:null})}if("UPDATE_DROPPABLE_SCROLL"===t.type){if("DROP_PENDING"===e.phase)return W_(e);if("COLLECTING"===e.phase)return W_(e);T_(e)||vx(!1);const{id:n,newScroll:r}=t.payload,i=e.dimensions.droppables[n];if(!i)return e;const a=Mx(i,r);return z_(e,a,!1)}if("UPDATE_DROPPABLE_IS_ENABLED"===t.type){if("DROP_PENDING"===e.phase)return e;T_(e)||vx(!1);const{id:n,isEnabled:r}=t.payload,i=e.dimensions.droppables[n];i||vx(!1),i.isEnabled===r&&vx(!1);const a={...i,isEnabled:r};return z_(e,a,!0)}if("UPDATE_DROPPABLE_IS_COMBINE_ENABLED"===t.type){if("DROP_PENDING"===e.phase)return e;T_(e)||vx(!1);const{id:n,isCombineEnabled:r}=t.payload,i=e.dimensions.droppables[n];i||vx(!1),i.isCombineEnabled===r&&vx(!1);const a={...i,isCombineEnabled:r};return z_(e,a,!0)}if("MOVE_BY_WINDOW_SCROLL"===t.type){if("DROP_PENDING"===e.phase||"DROP_ANIMATING"===e.phase)return e;T_(e)||vx(!1),e.isWindowScrollAllowed||vx(!1);const n=t.payload.newScroll;if(Dx(e.viewport.scroll.current,n))return W_(e);const r=b_(e.viewport,n);return B_(e)?M_({state:e,viewport:r}):$_({state:e,viewport:r})}if("UPDATE_VIEWPORT_MAX_SCROLL"===t.type){if(!T_(e))return e;const n=t.payload.maxScroll;if(Dx(n,e.viewport.scroll.max))return e;const r={...e.viewport,scroll:{...e.viewport.scroll,max:n}};return{...e,viewport:r}}if("MOVE_UP"===t.type||"MOVE_DOWN"===t.type||"MOVE_LEFT"===t.type||"MOVE_RIGHT"===t.type){if("COLLECTING"===e.phase||"DROP_PENDING"===e.phase)return e;"DRAGGING"!==e.phase&&vx(!1);const n=D_({state:e,type:t.type});return n?$_({state:e,impact:n.impact,clientSelection:n.clientSelection,scrollJumpRequest:n.scrollJumpRequest}):e}if("DROP_PENDING"===t.type){const n=t.payload.reason;return"COLLECTING"!==e.phase&&vx(!1),{...e,phase:"DROP_PENDING",isWaiting:!0,reason:n}}if("DROP_ANIMATE"===t.type){const{completed:n,dropDuration:r,newHomeClientOffset:i}=t.payload;return"DRAGGING"!==e.phase&&"DROP_PENDING"!==e.phase&&vx(!1),{phase:"DROP_ANIMATING",completed:n,dropDuration:r,newHomeClientOffset:i,dimensions:e.dimensions}}if("DROP_COMPLETE"===t.type){const{completed:e}=t.payload;return{phase:"IDLE",completed:e,shouldFlush:!1}}return e};const q_=e=>({type:"LIFT",payload:e}),H_=e=>({type:"PUBLISH_WHILE_DRAGGING",payload:e}),G_=()=>({type:"COLLECTION_STARTING",payload:null}),X_=e=>({type:"UPDATE_DROPPABLE_SCROLL",payload:e}),Y_=e=>({type:"UPDATE_DROPPABLE_IS_ENABLED",payload:e}),Z_=e=>({type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:e}),K_=e=>({type:"MOVE",payload:e}),J_=()=>({type:"MOVE_UP",payload:null}),eP=()=>({type:"MOVE_DOWN",payload:null}),tP=()=>({type:"MOVE_RIGHT",payload:null}),nP=()=>({type:"MOVE_LEFT",payload:null}),rP=()=>({type:"FLUSH",payload:null}),iP=e=>({type:"DROP_COMPLETE",payload:e}),aP=e=>({type:"DROP",payload:e}),oP="cubic-bezier(.2,1,.1,1)",sP=0,lP=.7,cP=.75,uP={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},dP=`${uP.outOfTheWay}s cubic-bezier(0.2, 0, 0, 1)`,pP={fluid:`opacity ${dP}`,snap:`transform ${dP}, opacity ${dP}`,drop:e=>{const t=`${e}s ${oP}`;return`transform ${t}, opacity ${t}`},outOfTheWay:`transform ${dP}`,placeholder:`height ${dP}, width ${dP}, margin ${dP}`},fP=e=>Dx(e,Ex)?void 0:`translate(${e.x}px, ${e.y}px)`,hP=fP,gP=(e,t)=>{const n=fP(e);if(n)return t?`${n} scale(${cP})`:n},{minDropTime:mP,maxDropTime:bP}=uP,vP=bP-mP;var yP=({getState:e,dispatch:t})=>n=>r=>{if("DROP"!==r.type)return void n(r);const i=e(),a=r.payload.reason;if("COLLECTING"===i.phase)return void t((o={reason:a},{type:"DROP_PENDING",payload:o}));var o;if("IDLE"===i.phase)return;"DROP_PENDING"===i.phase&&i.isWaiting&&vx(!1),"DRAGGING"!==i.phase&&"DROP_PENDING"!==i.phase&&vx(!1);const s=i.critical,l=i.dimensions,c=l.draggables[i.critical.draggable.id],{impact:u,didDropInsideDroppable:d}=(({draggables:e,reason:t,lastImpact:n,home:r,viewport:i,onLiftImpact:a})=>n.at&&"DROP"===t?"REORDER"===n.at.type?{impact:n,didDropInsideDroppable:!0}:{impact:{...n,displaced:Yx},didDropInsideDroppable:!0}:{impact:F_({draggables:e,impact:a,destination:r,viewport:i,forceShouldAnimate:!0}),didDropInsideDroppable:!1})({reason:a,lastImpact:i.impact,afterCritical:i.afterCritical,onLiftImpact:i.onLiftImpact,home:i.dimensions.droppables[i.critical.droppable.id],viewport:i.viewport,draggables:i.dimensions.draggables}),p=d?Ux(u):null,f=d?qx(u):null,h={index:s.draggable.index,droppableId:s.droppable.id},g={draggableId:c.descriptor.id,type:c.descriptor.type,source:h,reason:a,mode:i.movementMode,destination:p,combine:f},m=(({impact:e,draggable:t,dimensions:n,viewport:r,afterCritical:i})=>{const{draggables:a,droppables:o}=n,s=k_(e),l=s?o[s]:null,c=o[t.descriptor.droppableId],u=N_({impact:e,draggable:t,draggables:a,afterCritical:i,droppable:l||c,viewport:r});return kx(u,t.client.borderBox.center)})({impact:u,draggable:c,dimensions:l,viewport:i.viewport,afterCritical:i.afterCritical}),b={critical:i.critical,afterCritical:i.afterCritical,result:g,impact:u};if(Dx(i.current.client.offset,m)&&!Boolean(g.combine))return void t(iP({completed:b}));const v=(({current:e,destination:t,reason:n})=>{const r=Ix(e,t);if(r<=0)return mP;if(r>=1500)return bP;const i=mP+vP*(r/1500);return Number(("CANCEL"===n?.6*i:i).toFixed(2))})({current:i.current.client.offset,destination:m,reason:a});t((e=>({type:"DROP_ANIMATE",payload:e}))({newHomeClientOffset:m,dropDuration:v,completed:b}))},OP=()=>({x:window.pageXOffset,y:window.pageYOffset});var wP=e=>{const t=function({onWindowScroll:e}){const t=ux((function(){e(OP())})),n=function(e){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:t=>{t.target!==window&&t.target!==window.document||e()}}}(t);let r=fx;function i(){return r!==fx}return{start:function(){i()&&vx(!1),r=hx(window,[n])},stop:function(){i()||vx(!1),t.cancel(),r(),r=fx},isActive:i}}({onWindowScroll:t=>{e.dispatch({type:"MOVE_BY_WINDOW_SCROLL",payload:{newScroll:t}})}});return e=>n=>{t.isActive()||"INITIAL_PUBLISH"!==n.type||t.start(),t.isActive()&&(e=>"DROP_COMPLETE"===e.type||"DROP_ANIMATE"===e.type||"FLUSH"===e.type)(n)&&t.stop(),e(n)}};const SP=(e,t)=>{t()},xP=(e,t)=>({draggableId:e.draggable.id,type:e.droppable.type,source:{droppableId:e.droppable.id,index:e.draggable.index},mode:t});function _P(e,t,n,r){if(!e)return void n(r(t));const i=(e=>{let t=!1,n=!1;const r=setTimeout((()=>{n=!0})),i=i=>{t||n||(t=!0,e(i),clearTimeout(r))};return i.wasCalled=()=>t,i})(n);e(t,{announce:i}),i.wasCalled()||n(r(t))}var PP=(e,t)=>{const n=((e,t)=>{const n=(()=>{const e=[];return{add:t=>{const n=setTimeout((()=>(t=>{const n=e.findIndex((e=>e.timerId===t));-1===n&&vx(!1);const[r]=e.splice(n,1);r.callback()})(n))),r={timerId:n,callback:t};e.push(r)},flush:()=>{if(!e.length)return;const t=[...e];e.length=0,t.forEach((e=>{clearTimeout(e.timerId),e.callback()}))}}})();let r=null;const i=n=>{r||vx(!1),r=null,SP(0,(()=>_P(e().onDragEnd,n,t,Px.onDragEnd)))};return{beforeCapture:(t,n)=>{r&&vx(!1),SP(0,(()=>{const r=e().onBeforeCapture;r&&r({draggableId:t,mode:n})}))},beforeStart:(t,n)=>{r&&vx(!1),SP(0,(()=>{const r=e().onBeforeDragStart;r&&r(xP(t,n))}))},start:(i,a)=>{r&&vx(!1);const o=xP(i,a);r={mode:a,lastCritical:i,lastLocation:o.source,lastCombine:null},n.add((()=>{SP(0,(()=>_P(e().onDragStart,o,t,Px.onDragStart)))}))},update:(i,a)=>{const o=Ux(a),s=qx(a);r||vx(!1);const l=!((e,t)=>{if(e===t)return!0;const n=e.draggable.id===t.draggable.id&&e.draggable.droppableId===t.draggable.droppableId&&e.draggable.type===t.draggable.type&&e.draggable.index===t.draggable.index,r=e.droppable.id===t.droppable.id&&e.droppable.type===t.droppable.type;return n&&r})(i,r.lastCritical);l&&(r.lastCritical=i);const c=(d=o,!(null==(u=r.lastLocation)&&null==d||null!=u&&null!=d&&u.droppableId===d.droppableId&&u.index===d.index));var u,d;c&&(r.lastLocation=o);const p=!((e,t)=>null==e&&null==t||null!=e&&null!=t&&e.draggableId===t.draggableId&&e.droppableId===t.droppableId)(r.lastCombine,s);if(p&&(r.lastCombine=s),!l&&!c&&!p)return;const f={...xP(i,r.mode),combine:s,destination:o};n.add((()=>{SP(0,(()=>_P(e().onDragUpdate,f,t,Px.onDragUpdate)))}))},flush:()=>{r||vx(!1),n.flush()},drop:i,abort:()=>{if(!r)return;const e={...xP(r.lastCritical,r.mode),combine:null,destination:null,reason:"CANCEL"};i(e)}}})(e,t);return e=>t=>r=>{if("BEFORE_INITIAL_CAPTURE"===r.type)return void n.beforeCapture(r.payload.draggableId,r.payload.movementMode);if("INITIAL_PUBLISH"===r.type){const e=r.payload.critical;return n.beforeStart(e,r.payload.movementMode),t(r),void n.start(e,r.payload.movementMode)}if("DROP_COMPLETE"===r.type){const e=r.payload.completed.result;return n.flush(),t(r),void n.drop(e)}if(t(r),"FLUSH"===r.type)return void n.abort();const i=e.getState();"DRAGGING"===i.phase&&n.update(i.critical,i.impact)}},EP=e=>t=>n=>{if("DROP_ANIMATION_FINISHED"!==n.type)return void t(n);const r=e.getState();"DROP_ANIMATING"!==r.phase&&vx(!1),e.dispatch(iP({completed:r.completed}))},CP=e=>{let t=null,n=null;return r=>i=>{if("FLUSH"!==i.type&&"DROP_COMPLETE"!==i.type&&"DROP_ANIMATION_FINISHED"!==i.type||(n&&(cancelAnimationFrame(n),n=null),t&&(t(),t=null)),r(i),"DROP_ANIMATE"!==i.type)return;const a={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){"DROP_ANIMATING"===e.getState().phase&&e.dispatch({type:"DROP_ANIMATION_FINISHED",payload:null})}};n=requestAnimationFrame((()=>{n=null,t=hx(window,[a])}))}},kP=e=>t=>n=>{if(t(n),"PUBLISH_WHILE_DRAGGING"!==n.type)return;const r=e.getState();"DROP_PENDING"===r.phase&&(r.isWaiting||e.dispatch(aP({reason:r.reason})))};const DP=qS.compose;var TP=({dimensionMarshal:e,focusMarshal:t,styleMarshal:n,getResponders:r,announce:i,autoScroller:a})=>{return(0,qS.createStore)(U_,DP((0,qS.applyMiddleware)((o=n,()=>e=>t=>{"INITIAL_PUBLISH"===t.type&&o.dragging(),"DROP_ANIMATE"===t.type&&o.dropping(t.payload.completed.result.reason),"FLUSH"!==t.type&&"DROP_COMPLETE"!==t.type||o.resting(),e(t)}),(e=>()=>t=>n=>{"DROP_COMPLETE"!==n.type&&"FLUSH"!==n.type&&"DROP_ANIMATE"!==n.type||e.stopPublishing(),t(n)})(e),(e=>({getState:t,dispatch:n})=>r=>i=>{if("LIFT"!==i.type)return void r(i);const{id:a,clientSelection:o,movementMode:s}=i.payload,l=t();"DROP_ANIMATING"===l.phase&&n(iP({completed:l.completed})),"IDLE"!==t().phase&&vx(!1),n(rP()),n({type:"BEFORE_INITIAL_CAPTURE",payload:{draggableId:a,movementMode:s}});const c={draggableId:a,scrollOptions:{shouldPublishImmediately:"SNAP"===s}},{critical:u,dimensions:d,viewport:p}=e.startPublishing(c);n({type:"INITIAL_PUBLISH",payload:{critical:u,dimensions:d,clientSelection:o,movementMode:s,viewport:p}})})(e),yP,EP,CP,kP,(e=>t=>n=>r=>{if((e=>"DROP_COMPLETE"===e.type||"DROP_ANIMATE"===e.type||"FLUSH"===e.type)(r))return e.stop(),void n(r);if("INITIAL_PUBLISH"===r.type){n(r);const i=t.getState();return"DRAGGING"!==i.phase&&vx(!1),void e.start(i)}n(r),e.scroll(t.getState())})(a),wP,(e=>{let t=!1;return()=>n=>r=>{if("INITIAL_PUBLISH"===r.type)return t=!0,e.tryRecordFocus(r.payload.critical.draggable.id),n(r),void e.tryRestoreFocusRecorded();if(n(r),t){if("FLUSH"===r.type)return t=!1,void e.tryRestoreFocusRecorded();if("DROP_COMPLETE"===r.type){t=!1;const n=r.payload.completed.result;n.combine&&e.tryShiftRecord(n.draggableId,n.combine.draggableId),e.tryRestoreFocusRecorded()}}}})(t),PP(r,i))));var o},RP=({scrollHeight:e,scrollWidth:t,height:n,width:r})=>{const i=kx({x:t,y:e},{x:r,y:n});return{x:Math.max(0,i.x),y:Math.max(0,i.y)}},IP=()=>{const e=document.documentElement;return e||vx(!1),e},AP=()=>{const e=IP();return RP({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,width:e.clientWidth,height:e.clientHeight})};function jP(e,t,n){return n.descriptor.id!==t.id&&(n.descriptor.type===t.type&&"virtual"===e.droppable.getById(n.descriptor.droppableId).descriptor.mode)}var LP=(e,t)=>{let n=null;const r=function({registry:e,callbacks:t}){let n={additions:{},removals:{},modified:{}},r=null;const i=()=>{r||(t.collectionStarting(),r=requestAnimationFrame((()=>{r=null;const{additions:i,removals:a,modified:o}=n,s=Object.keys(i).map((t=>e.draggable.getById(t).getDimension(Ex))).sort(((e,t)=>e.descriptor.index-t.descriptor.index)),l=Object.keys(o).map((t=>({droppableId:t,scroll:e.droppable.getById(t).callbacks.getScrollWhileDragging()}))),c={additions:s,removals:Object.keys(a),modified:l};n={additions:{},removals:{},modified:{}},t.publish(c)})))};return{add:e=>{const t=e.descriptor.id;n.additions[t]=e,n.modified[e.descriptor.droppableId]=!0,n.removals[t]&&delete n.removals[t],i()},remove:e=>{const t=e.descriptor;n.removals[t.id]=!0,n.modified[t.droppableId]=!0,n.additions[t.id]&&delete n.additions[t.id],i()},stop:()=>{r&&(cancelAnimationFrame(r),r=null,n={additions:{},removals:{},modified:{}})}}}({callbacks:{publish:t.publishWhileDragging,collectionStarting:t.collectionStarting},registry:e}),i=t=>{n||vx(!1);const i=n.critical.draggable;"ADDITION"===t.type&&jP(e,i,t.value)&&r.add(t.value),"REMOVAL"===t.type&&jP(e,i,t.value)&&r.remove(t.value)},a={updateDroppableIsEnabled:(r,i)=>{e.droppable.exists(r)||vx(!1),n&&t.updateDroppableIsEnabled({id:r,isEnabled:i})},updateDroppableIsCombineEnabled:(r,i)=>{n&&(e.droppable.exists(r)||vx(!1),t.updateDroppableIsCombineEnabled({id:r,isCombineEnabled:i}))},scrollDroppable:(t,r)=>{n&&e.droppable.getById(t).callbacks.scroll(r)},updateDroppableScroll:(r,i)=>{n&&(e.droppable.exists(r)||vx(!1),t.updateDroppableScroll({id:r,newScroll:i}))},startPublishing:t=>{n&&vx(!1);const r=e.draggable.getById(t.draggableId),a=e.droppable.getById(r.descriptor.droppableId),o={draggable:r.descriptor,droppable:a.descriptor},s=e.subscribe(i);return n={critical:o,unsubscribe:s},(({critical:e,scrollOptions:t,registry:n})=>{const r=(()=>{const e=OP(),t=AP(),n=e.y,r=e.x,i=IP(),a=i.clientWidth,o=i.clientHeight;return{frame:ZS({top:n,left:r,right:r+a,bottom:n+o}),scroll:{initial:e,current:e,max:t,diff:{value:Ex,displacement:Ex}}}})(),i=r.scroll.current,a=e.droppable,o=n.droppable.getAllByType(a.type).map((e=>e.callbacks.getDimensionAndWatchScroll(i,t))),s=n.draggable.getAllByType(e.draggable.type).map((e=>e.getDimension(i)));return{dimensions:{draggables:Bx(s),droppables:Vx(o)},critical:e,viewport:r}})({critical:o,registry:e,scrollOptions:t.scrollOptions})},stopPublishing:()=>{if(!n)return;r.stop();const t=n.critical.droppable;e.droppable.getAllByType(t.type).forEach((e=>e.callbacks.dragStopped())),n.unsubscribe(),n=null}};return a},$P=(e,t)=>"IDLE"===e.phase||"DROP_ANIMATING"===e.phase&&e.completed.result.draggableId!==t&&"DROP"===e.completed.result.reason,FP=e=>{window.scrollBy(e.x,e.y)};const NP=cx((e=>zx(e).filter((e=>!!e.isEnabled&&!!e.frame))));const MP={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:e=>e**2,durationDampening:{stopDampeningAt:1200,accelerateAt:360},disabled:!1};var VP=({startOfRange:e,endOfRange:t,current:n})=>{const r=t-e;return 0===r?0:(n-e)/r},BP=({distanceToEdge:e,thresholds:t,dragStartTime:n,shouldUseTimeDampening:r,getAutoScrollerOptions:i})=>{const a=((e,t,n=(()=>MP))=>{const r=n();if(e>t.startScrollingFrom)return 0;if(e<=t.maxScrollValueAt)return r.maxPixelScroll;if(e===t.startScrollingFrom)return 1;const i=1-VP({startOfRange:t.maxScrollValueAt,endOfRange:t.startScrollingFrom,current:e}),a=r.maxPixelScroll*r.ease(i);return Math.ceil(a)})(e,t,i);return 0===a?0:r?Math.max(((e,t,n)=>{const r=n(),i=r.durationDampening.accelerateAt,a=r.durationDampening.stopDampeningAt,o=t,s=a,l=Date.now()-o;if(l>=a)return e;if(l<i)return 1;const c=VP({startOfRange:i,endOfRange:s,current:l}),u=e*r.ease(c);return Math.ceil(u)})(a,n,i),1):a},zP=({container:e,distanceToEdges:t,dragStartTime:n,axis:r,shouldUseTimeDampening:i,getAutoScrollerOptions:a})=>{const o=((e,t,n=(()=>MP))=>{const r=n();return{startScrollingFrom:e[t.size]*r.startFromPercentage,maxScrollValueAt:e[t.size]*r.maxScrollAtPercentage}})(e,r,a);return t[r.end]<t[r.start]?BP({distanceToEdge:t[r.end],thresholds:o,dragStartTime:n,shouldUseTimeDampening:i,getAutoScrollerOptions:a}):-1*BP({distanceToEdge:t[r.start],thresholds:o,dragStartTime:n,shouldUseTimeDampening:i,getAutoScrollerOptions:a})};const WP=jx((e=>0===e?0:e));var QP=({dragStartTime:e,container:t,subject:n,center:r,shouldUseTimeDampening:i,getAutoScrollerOptions:a})=>{const o={top:r.y-t.top,right:t.right-r.x,bottom:t.bottom-r.y,left:r.x-t.left},s=zP({container:t,distanceToEdges:o,dragStartTime:e,axis:t_,shouldUseTimeDampening:i,getAutoScrollerOptions:a}),l=zP({container:t,distanceToEdges:o,dragStartTime:e,axis:n_,shouldUseTimeDampening:i,getAutoScrollerOptions:a}),c=WP({x:l,y:s});if(Dx(c,Ex))return null;const u=(({container:e,subject:t,proposedScroll:n})=>{const r=t.height>e.height,i=t.width>e.width;return i||r?i&&r?null:{x:i?0:n.x,y:r?0:n.y}:n})({container:t,subject:n,proposedScroll:c});return u?Dx(u,Ex)?null:u:null};const UP=jx((e=>0===e?0:e>0?1:-1)),qP=(()=>{const e=(e,t)=>e<0?e:e>t?e-t:0;return({current:t,max:n,change:r})=>{const i=Cx(t,r),a={x:e(i.x,n.x),y:e(i.y,n.y)};return Dx(a,Ex)?null:a}})(),HP=({max:e,current:t,change:n})=>{const r={x:Math.max(t.x,e.x),y:Math.max(t.y,e.y)},i=UP(n),a=qP({max:r,current:t,change:i});return!a||0!==i.x&&0===a.x||0!==i.y&&0===a.y},GP=(e,t)=>HP({current:e.scroll.current,max:e.scroll.max,change:t}),XP=(e,t)=>{const n=e.frame;return!!n&&HP({current:n.scroll.current,max:n.scroll.max,change:t})};var YP=({state:e,dragStartTime:t,shouldUseTimeDampening:n,scrollWindow:r,scrollDroppable:i,getAutoScrollerOptions:a})=>{const o=e.current.page.borderBoxCenter,s=e.dimensions.draggables[e.critical.draggable.id].page.marginBox;if(e.isWindowScrollAllowed){const i=(({viewport:e,subject:t,center:n,dragStartTime:r,shouldUseTimeDampening:i,getAutoScrollerOptions:a})=>{const o=QP({dragStartTime:r,container:e.frame,subject:t,center:n,shouldUseTimeDampening:i,getAutoScrollerOptions:a});return o&&GP(e,o)?o:null})({dragStartTime:t,viewport:e.viewport,subject:s,center:o,shouldUseTimeDampening:n,getAutoScrollerOptions:a});if(i)return void r(i)}const l=(({center:e,destination:t,droppables:n})=>{if(t){const e=n[t];return e.frame?e:null}const r=((e,t)=>{const n=NP(t).find((t=>(t.frame||vx(!1),R_(t.frame.pageMarginBox)(e))))||null;return n})(e,n);return r})({center:o,destination:k_(e.impact),droppables:e.dimensions.droppables});if(!l)return;const c=(({droppable:e,subject:t,center:n,dragStartTime:r,shouldUseTimeDampening:i,getAutoScrollerOptions:a})=>{const o=e.frame;if(!o)return null;const s=QP({dragStartTime:r,container:o.pageMarginBox,subject:t,center:n,shouldUseTimeDampening:i,getAutoScrollerOptions:a});return s&&XP(e,s)?s:null})({dragStartTime:t,droppable:l,subject:s,center:o,shouldUseTimeDampening:n,getAutoScrollerOptions:a});c&&i(l.descriptor.id,c)},ZP=({move:e,scrollDroppable:t,scrollWindow:n})=>r=>{const i=r.scrollJumpRequest;if(!i)return;const a=k_(r.impact);a||vx(!1);const o=((e,n)=>{if(!XP(e,n))return n;const r=((e,t)=>{const n=e.frame;return n&&XP(e,t)?qP({current:n.scroll.current,max:n.scroll.max,change:t}):null})(e,n);if(!r)return t(e.descriptor.id,n),null;const i=kx(n,r);return t(e.descriptor.id,i),kx(n,i)})(r.dimensions.droppables[a],i);if(!o)return;const s=r.viewport,l=((e,t,r)=>{if(!e)return r;if(!GP(t,r))return r;const i=((e,t)=>{if(!GP(e,t))return null;const n=e.scroll.max,r=e.scroll.current;return qP({current:r,max:n,change:t})})(t,r);if(!i)return n(r),null;const a=kx(r,i);return n(a),kx(r,a)})(r.isWindowScrollAllowed,s,o);l&&((t,n)=>{const r=Cx(t.current.client.selection,n);e({client:r})})(r,l)},KP=({scrollDroppable:e,scrollWindow:t,move:n,getAutoScrollerOptions:r})=>{const i=(({scrollWindow:e,scrollDroppable:t,getAutoScrollerOptions:n=(()=>MP)})=>{const r=ux(e),i=ux(t);let a=null;const o=e=>{a||vx(!1);const{shouldUseTimeDampening:t,dragStartTime:o}=a;YP({state:e,scrollWindow:r,scrollDroppable:i,dragStartTime:o,shouldUseTimeDampening:t,getAutoScrollerOptions:n})};return{start:e=>{a&&vx(!1);const t=Date.now();let r=!1;const i=()=>{r=!0};YP({state:e,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:i,scrollDroppable:i,getAutoScrollerOptions:n}),a={dragStartTime:t,shouldUseTimeDampening:r},r&&o(e)},stop:()=>{a&&(r.cancel(),i.cancel(),a=null)},scroll:o}})({scrollWindow:t,scrollDroppable:e,getAutoScrollerOptions:r}),a=ZP({move:n,scrollWindow:t,scrollDroppable:e});return{scroll:e=>{r().disabled||"DRAGGING"!==e.phase||("FLUID"!==e.movementMode?e.scrollJumpRequest&&a(e):i.scroll(e))},start:i.start,stop:i.stop}};const JP="data-rfd",eE=(()=>{const e=`${JP}-drag-handle`;return{base:e,draggableId:`${e}-draggable-id`,contextId:`${e}-context-id`}})(),tE=(()=>{const e=`${JP}-draggable`;return{base:e,contextId:`${e}-context-id`,id:`${e}-id`}})(),nE=(()=>{const e=`${JP}-droppable`;return{base:e,contextId:`${e}-context-id`,id:`${e}-id`}})(),rE={contextId:`${JP}-scroll-container-context-id`},iE=(e,t)=>e.map((e=>{const n=e.styles[t];return n?`${e.selector} { ${n} }`:""})).join(" ");var aE=e=>{const t=(e=>t=>`[${t}="${e}"]`)(e),n=(()=>{const e="\n      cursor: -webkit-grab;\n      cursor: grab;\n    ";return{selector:t(eE.contextId),styles:{always:"\n          -webkit-touch-callout: none;\n          -webkit-tap-highlight-color: rgba(0,0,0,0);\n          touch-action: manipulation;\n        ",resting:e,dragging:"pointer-events: none;",dropAnimating:e}}})(),r=[(()=>{const e=`\n      transition: ${pP.outOfTheWay};\n    `;return{selector:t(tE.contextId),styles:{dragging:e,dropAnimating:e,userCancel:e}}})(),n,{selector:t(nE.contextId),styles:{always:"overflow-anchor: none;"}},{selector:"body",styles:{dragging:"\n        cursor: grabbing;\n        cursor: -webkit-grabbing;\n        user-select: none;\n        -webkit-user-select: none;\n        -moz-user-select: none;\n        -ms-user-select: none;\n        overflow-anchor: none;\n      "}}];return{always:iE(r,"always"),resting:iE(r,"resting"),dragging:iE(r,"dragging"),dropAnimating:iE(r,"dropAnimating"),userCancel:iE(r,"userCancel")}},oE="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?t.useLayoutEffect:t.useEffect;const sE=()=>{const e=document.querySelector("head");return e||vx(!1),e},lE=e=>{const t=document.createElement("style");return e&&t.setAttribute("nonce",e),t.type="text/css",t};function cE(e,t){return Array.from(e.querySelectorAll(t))}var uE=e=>e&&e.ownerDocument&&e.ownerDocument.defaultView?e.ownerDocument.defaultView:window;function dE(e){return e instanceof uE(e).HTMLElement}function pE(){const e={draggables:{},droppables:{}},t=[];function n(e){t.length&&t.forEach((t=>t(e)))}function r(t){return e.draggables[t]||null}function i(t){return e.droppables[t]||null}return{draggable:{register:t=>{e.draggables[t.descriptor.id]=t,n({type:"ADDITION",value:t})},update:(t,n)=>{const r=e.draggables[n.descriptor.id];r&&r.uniqueId===t.uniqueId&&(delete e.draggables[n.descriptor.id],e.draggables[t.descriptor.id]=t)},unregister:t=>{const i=t.descriptor.id,a=r(i);a&&t.uniqueId===a.uniqueId&&(delete e.draggables[i],e.droppables[t.descriptor.droppableId]&&n({type:"REMOVAL",value:t}))},getById:function(e){const t=r(e);return t||vx(!1),t},findById:r,exists:e=>Boolean(r(e)),getAllByType:t=>Object.values(e.draggables).filter((e=>e.descriptor.type===t))},droppable:{register:t=>{e.droppables[t.descriptor.id]=t},unregister:t=>{const n=i(t.descriptor.id);n&&t.uniqueId===n.uniqueId&&delete e.droppables[t.descriptor.id]},getById:function(e){const t=i(e);return t||vx(!1),t},findById:i,exists:e=>Boolean(i(e)),getAllByType:t=>Object.values(e.droppables).filter((e=>e.descriptor.type===t))},subscribe:function(e){return t.push(e),function(){const n=t.indexOf(e);-1!==n&&t.splice(n,1)}},clean:function(){e.draggables={},e.droppables={},t.length=0}}}var fE=r().createContext(null),hE=()=>{const e=document.body;return e||vx(!1),e},gE={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"};const mE=e=>`rfd-announcement-${e}`;let bE=0;const vE={separator:"::"};var yE="useId"in r()?function(e,t=vE){const n=r().useId();return XS((()=>`${e}${t.separator}${n}`),[t.separator,e,n])}:function(e,t=vE){return XS((()=>`${e}${t.separator}${bE++}`),[t.separator,e])},OE=r().createContext(null);function wE(e){const n=(0,t.useRef)(e);return(0,t.useEffect)((()=>{n.current=e})),n}function SE(e){return"IDLE"!==e.phase&&"DROP_ANIMATING"!==e.phase&&e.isDragging}const xE=9,_E=13,PE=33,EE=34,CE=35,kE=36,DE={[_E]:!0,[xE]:!0};var TE=e=>{DE[e.keyCode]&&e.preventDefault()},RE=(()=>{const e="visibilitychange";return"undefined"==typeof document?e:[e,`ms${e}`,`webkit${e}`,`moz${e}`,`o${e}`].find((e=>`on${e}`in document))||e})();const IE={type:"IDLE"};function AE(){}const jE={[EE]:!0,[PE]:!0,[kE]:!0,[CE]:!0};const LE={type:"IDLE"},$E=["input","button","textarea","select","option","optgroup","video","audio"];function FE(e,t){if(null==t)return!1;if($E.includes(t.tagName.toLowerCase()))return!0;const n=t.getAttribute("contenteditable");return"true"===n||""===n||t!==e&&FE(e,t.parentElement)}function NE(e,t){const n=t.target;return!!dE(n)&&FE(e,n)}var ME=e=>ZS(e.getBoundingClientRect()).center;const VE=(()=>{const e="matches";return"undefined"==typeof document?e:[e,"msMatchesSelector","webkitMatchesSelector"].find((e=>e in Element.prototype))||e})();function BE(e,t){return null==e?null:e[VE](t)?e:BE(e.parentElement,t)}function zE(e,t){return e.closest?e.closest(t):BE(e,t)}function WE(e){e.preventDefault()}function QE({expected:e,phase:t,isLockActive:n,shouldWarn:r}){return!!n()&&e===t}function UE({lockAPI:e,store:t,registry:n,draggableId:r}){if(e.isClaimed())return!1;const i=n.draggable.findById(r);return!!i&&!!i.options.isEnabled&&!!$P(t.getState(),r)}const qE=[function(e){const n=(0,t.useRef)(IE),r=(0,t.useRef)(fx),i=XS((()=>({eventName:"mousedown",fn:function(t){if(t.defaultPrevented)return;if(0!==t.button)return;if(t.ctrlKey||t.metaKey||t.shiftKey||t.altKey)return;const n=e.findClosestDraggableId(t);if(!n)return;const i=e.tryGetLock(n,s,{sourceEvent:t});if(!i)return;t.preventDefault();const a={x:t.clientX,y:t.clientY};r.current(),u(i,a)}})),[e]),a=XS((()=>({eventName:"webkitmouseforcewillbegin",fn:t=>{if(t.defaultPrevented)return;const n=e.findClosestDraggableId(t);if(!n)return;const r=e.findOptionsForDraggable(n);r&&(r.shouldRespectForcePress||e.canGetLock(n)&&t.preventDefault())}})),[e]),o=YS((function(){r.current=hx(window,[a,i],{passive:!1,capture:!0})}),[a,i]),s=YS((()=>{"IDLE"!==n.current.type&&(n.current=IE,r.current(),o())}),[o]),l=YS((()=>{const e=n.current;s(),"DRAGGING"===e.type&&e.actions.cancel({shouldBlockNextClick:!0}),"PENDING"===e.type&&e.actions.abort()}),[s]),c=YS((function(){const e=function({cancel:e,completed:t,getPhase:n,setPhase:r}){return[{eventName:"mousemove",fn:e=>{const{button:t,clientX:i,clientY:a}=e;if(0!==t)return;const o={x:i,y:a},s=n();if("DRAGGING"===s.type)return e.preventDefault(),void s.actions.move(o);if("PENDING"!==s.type&&vx(!1),l=s.point,c=o,!(Math.abs(c.x-l.x)>=5||Math.abs(c.y-l.y)>=5))return;var l,c;e.preventDefault();const u=s.actions.fluidLift(o);r({type:"DRAGGING",actions:u})}},{eventName:"mouseup",fn:r=>{const i=n();"DRAGGING"===i.type?(r.preventDefault(),i.actions.drop({shouldBlockNextClick:!0}),t()):e()}},{eventName:"mousedown",fn:t=>{"DRAGGING"===n().type&&t.preventDefault(),e()}},{eventName:"keydown",fn:t=>{if("PENDING"!==n().type)return 27===t.keyCode?(t.preventDefault(),void e()):void TE(t);e()}},{eventName:"resize",fn:e},{eventName:"scroll",options:{passive:!0,capture:!1},fn:()=>{"PENDING"===n().type&&e()}},{eventName:"webkitmouseforcedown",fn:t=>{const r=n();"IDLE"===r.type&&vx(!1),r.actions.shouldRespectForcePress()?e():t.preventDefault()}},{eventName:RE,fn:e}]}({cancel:l,completed:s,getPhase:()=>n.current,setPhase:e=>{n.current=e}});r.current=hx(window,e,{capture:!0,passive:!1})}),[l,s]),u=YS((function(e,t){"IDLE"!==n.current.type&&vx(!1),n.current={type:"PENDING",point:t,actions:e},c()}),[c]);oE((function(){return o(),function(){r.current()}}),[o])},function(e){const n=(0,t.useRef)(AE),r=XS((()=>({eventName:"keydown",fn:function(t){if(t.defaultPrevented)return;if(32!==t.keyCode)return;const r=e.findClosestDraggableId(t);if(!r)return;const a=e.tryGetLock(r,l,{sourceEvent:t});if(!a)return;t.preventDefault();let o=!0;const s=a.snapLift();function l(){o||vx(!1),o=!1,n.current(),i()}n.current(),n.current=hx(window,function(e,t){function n(){t(),e.cancel()}return[{eventName:"keydown",fn:r=>27===r.keyCode?(r.preventDefault(),void n()):32===r.keyCode?(r.preventDefault(),t(),void e.drop()):40===r.keyCode?(r.preventDefault(),void e.moveDown()):38===r.keyCode?(r.preventDefault(),void e.moveUp()):39===r.keyCode?(r.preventDefault(),void e.moveRight()):37===r.keyCode?(r.preventDefault(),void e.moveLeft()):void(jE[r.keyCode]?r.preventDefault():TE(r))},{eventName:"mousedown",fn:n},{eventName:"mouseup",fn:n},{eventName:"click",fn:n},{eventName:"touchstart",fn:n},{eventName:"resize",fn:n},{eventName:"wheel",fn:n,options:{passive:!0}},{eventName:RE,fn:n}]}(s,l),{capture:!0,passive:!1})}})),[e]),i=YS((function(){n.current=hx(window,[r],{passive:!1,capture:!0})}),[r]);oE((function(){return i(),function(){n.current()}}),[i])},function(e){const n=(0,t.useRef)(LE),r=(0,t.useRef)(fx),i=YS((function(){return n.current}),[]),a=YS((function(e){n.current=e}),[]),o=XS((()=>({eventName:"touchstart",fn:function(t){if(t.defaultPrevented)return;const n=e.findClosestDraggableId(t);if(!n)return;const i=e.tryGetLock(n,l,{sourceEvent:t});if(!i)return;const a=t.touches[0],{clientX:o,clientY:s}=a,c={x:o,y:s};r.current(),p(i,c)}})),[e]),s=YS((function(){r.current=hx(window,[o],{capture:!0,passive:!1})}),[o]),l=YS((()=>{const e=n.current;"IDLE"!==e.type&&("PENDING"===e.type&&clearTimeout(e.longPressTimerId),a(LE),r.current(),s())}),[s,a]),c=YS((()=>{const e=n.current;l(),"DRAGGING"===e.type&&e.actions.cancel({shouldBlockNextClick:!0}),"PENDING"===e.type&&e.actions.abort()}),[l]),u=YS((function(){const e={capture:!0,passive:!1},t={cancel:c,completed:l,getPhase:i},n=hx(window,function({cancel:e,completed:t,getPhase:n}){return[{eventName:"touchmove",options:{capture:!1},fn:t=>{const r=n();if("DRAGGING"!==r.type)return void e();r.hasMoved=!0;const{clientX:i,clientY:a}=t.touches[0],o={x:i,y:a};t.preventDefault(),r.actions.move(o)}},{eventName:"touchend",fn:r=>{const i=n();"DRAGGING"===i.type?(r.preventDefault(),i.actions.drop({shouldBlockNextClick:!0}),t()):e()}},{eventName:"touchcancel",fn:t=>{"DRAGGING"===n().type?(t.preventDefault(),e()):e()}},{eventName:"touchforcechange",fn:t=>{const r=n();"IDLE"===r.type&&vx(!1);const i=t.touches[0];if(!i)return;if(!(i.force>=.15))return;const a=r.actions.shouldRespectForcePress();if("PENDING"!==r.type)return a?r.hasMoved?void t.preventDefault():void e():void t.preventDefault();a&&e()}},{eventName:RE,fn:e}]}(t),e),a=hx(window,function({cancel:e,getPhase:t}){return[{eventName:"orientationchange",fn:e},{eventName:"resize",fn:e},{eventName:"contextmenu",fn:e=>{e.preventDefault()}},{eventName:"keydown",fn:n=>{"DRAGGING"===t().type?(27===n.keyCode&&n.preventDefault(),e()):e()}},{eventName:RE,fn:e}]}(t),e);r.current=function(){n(),a()}}),[c,i,l]),d=YS((function(){const e=i();"PENDING"!==e.type&&vx(!1);const t=e.actions.fluidLift(e.point);a({type:"DRAGGING",actions:t,hasMoved:!1})}),[i,a]),p=YS((function(e,t){"IDLE"!==i().type&&vx(!1);const n=setTimeout(d,120);a({type:"PENDING",point:t,actions:e,longPressTimerId:n}),u()}),[u,i,a,d]);oE((function(){return s(),function(){r.current();const e=i();"PENDING"===e.type&&(clearTimeout(e.longPressTimerId),a(LE))}}),[i,s,a]),oE((function(){return hx(window,[{eventName:"touchmove",fn:()=>{},options:{capture:!1,passive:!1}}])}),[])}];function HE({contextId:e,store:n,registry:r,customSensors:i,enableDefaultSensors:a}){const o=[...a?qE:[],...i||[]],s=(0,t.useState)((()=>function(){let e=null;function t(){e||vx(!1),e=null}return{isClaimed:function(){return Boolean(e)},isActive:function(t){return t===e},claim:function(t){e&&vx(!1);const n={abandon:t};return e=n,n},release:t,tryAbandon:function(){e&&(e.abandon(),t())}}}()))[0],l=YS((function(e,t){SE(e)&&!SE(t)&&s.tryAbandon()}),[s]);oE((function(){let e=n.getState();return n.subscribe((()=>{const t=n.getState();l(e,t),e=t}))}),[s,n,l]),oE((()=>s.tryAbandon),[s.tryAbandon]);const c=YS((e=>UE({lockAPI:s,registry:r,store:n,draggableId:e})),[s,r,n]),u=YS(((t,i,a)=>function({lockAPI:e,contextId:t,store:n,registry:r,draggableId:i,forceSensorStop:a,sourceEvent:o}){if(!UE({lockAPI:e,store:n,registry:r,draggableId:i}))return null;const s=r.draggable.getById(i),l=function(e,t){const n=`[${tE.contextId}="${e}"]`,r=cE(document,n).find((e=>e.getAttribute(tE.id)===t));return r&&dE(r)?r:null}(t,s.descriptor.id);if(!l)return null;if(o&&!s.options.canDragInteractiveElements&&NE(l,o))return null;const c=e.claim(a||fx);let u="PRE_DRAG";function d(){return s.options.shouldRespectForcePress}function p(){return e.isActive(c)}const f=function(e,t){QE({expected:e,phase:u,isLockActive:p,shouldWarn:!0})&&n.dispatch(t())}.bind(null,"DRAGGING");function h(t){function r(){e.release(),u="COMPLETED"}function i(e,i={shouldBlockNextClick:!1}){if(t.cleanup(),i.shouldBlockNextClick){const e=hx(window,[{eventName:"click",fn:WE,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(e)}r(),n.dispatch(aP({reason:e}))}return"PRE_DRAG"!==u&&(r(),vx(!1)),n.dispatch(q_(t.liftActionArgs)),u="DRAGGING",{isActive:()=>QE({expected:"DRAGGING",phase:u,isLockActive:p,shouldWarn:!1}),shouldRespectForcePress:d,drop:e=>i("DROP",e),cancel:e=>i("CANCEL",e),...t.actions}}return{isActive:()=>QE({expected:"PRE_DRAG",phase:u,isLockActive:p,shouldWarn:!1}),shouldRespectForcePress:d,fluidLift:function(e){const t=ux((e=>{f((()=>K_({client:e})))}));return{...h({liftActionArgs:{id:i,clientSelection:e,movementMode:"FLUID"},cleanup:()=>t.cancel(),actions:{move:t}}),move:t}},snapLift:function(){const e={moveUp:()=>f(J_),moveRight:()=>f(tP),moveDown:()=>f(eP),moveLeft:()=>f(nP)};return h({liftActionArgs:{id:i,clientSelection:ME(l),movementMode:"SNAP"},cleanup:fx,actions:e})},abort:function(){QE({expected:"PRE_DRAG",phase:u,isLockActive:p,shouldWarn:!0})&&e.release()}}}({lockAPI:s,registry:r,contextId:e,store:n,draggableId:t,forceSensorStop:i||null,sourceEvent:a&&a.sourceEvent?a.sourceEvent:null})),[e,s,r,n]),d=YS((t=>function(e,t){const n=function(e,t){const n=t.target;if(!((r=n)instanceof uE(r).Element))return null;var r;const i=function(e){return`[${eE.contextId}="${e}"]`}(e),a=zE(n,i);return a&&dE(a)?a:null}(e,t);return n?n.getAttribute(eE.draggableId):null}(e,t)),[e]),p=YS((e=>{const t=r.draggable.findById(e);return t?t.options:null}),[r.draggable]),f=YS((function(){s.isClaimed()&&(s.tryAbandon(),"IDLE"!==n.getState().phase&&n.dispatch(rP()))}),[s,n]),h=YS((()=>s.isClaimed()),[s]),g=XS((()=>({canGetLock:c,tryGetLock:u,findClosestDraggableId:d,findOptionsForDraggable:p,tryReleaseLock:f,isLockClaimed:h})),[c,u,d,p,f,h]);for(let e=0;e<o.length;e++)o[e](g)}const GE=e=>({onBeforeCapture:t=>{const n=()=>{e.onBeforeCapture&&e.onBeforeCapture(t)};r().version.startsWith("16")||r().version.startsWith("17")?n():(0,yi.flushSync)(n)},onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragEnd:e.onDragEnd,onDragUpdate:e.onDragUpdate}),XE=e=>({...MP,...e.autoScrollerOptions,durationDampening:{...MP.durationDampening,...e.autoScrollerOptions}});function YE(e){return e.current||vx(!1),e.current}function ZE(e){const{contextId:n,setCallbacks:i,sensors:a,nonce:o,dragHandleUsageInstructions:s}=e,l=(0,t.useRef)(null),c=wE(e),u=YS((()=>GE(c.current)),[c]),d=YS((()=>XE(c.current)),[c]),p=function(e){const n=XS((()=>mE(e)),[e]),r=(0,t.useRef)(null);return(0,t.useEffect)((function(){const e=document.createElement("div");return r.current=e,e.id=n,e.setAttribute("aria-live","assertive"),e.setAttribute("aria-atomic","true"),dx(e.style,gE),hE().appendChild(e),function(){setTimeout((function(){const t=hE();t.contains(e)&&t.removeChild(e),e===r.current&&(r.current=null)}))}}),[n]),YS((e=>{const t=r.current;t&&(t.textContent=e)}),[])}(n),f=function({contextId:e,text:n}){const r=yE("hidden-text",{separator:"-"}),i=XS((()=>function({contextId:e,uniqueId:t}){return`rfd-hidden-text-${e}-${t}`}({contextId:e,uniqueId:r})),[r,e]);return(0,t.useEffect)((function(){const e=document.createElement("div");return e.id=i,e.textContent=n,e.style.display="none",hE().appendChild(e),function(){const t=hE();t.contains(e)&&t.removeChild(e)}}),[i,n]),i}({contextId:n,text:s}),h=function(e,n){const r=XS((()=>aE(e)),[e]),i=(0,t.useRef)(null),a=(0,t.useRef)(null),o=YS(cx((e=>{const t=a.current;t||vx(!1),t.textContent=e})),[]),s=YS((e=>{const t=i.current;t||vx(!1),t.textContent=e}),[]);oE((()=>{(i.current||a.current)&&vx(!1);const t=lE(n),l=lE(n);return i.current=t,a.current=l,t.setAttribute(`${JP}-always`,e),l.setAttribute(`${JP}-dynamic`,e),sE().appendChild(t),sE().appendChild(l),s(r.always),o(r.resting),()=>{const e=e=>{const t=e.current;t||vx(!1),sE().removeChild(t),e.current=null};e(i),e(a)}}),[n,s,o,r.always,r.resting,e]);const l=YS((()=>o(r.dragging)),[o,r.dragging]),c=YS((e=>{o("DROP"!==e?r.userCancel:r.dropAnimating)}),[o,r.dropAnimating,r.userCancel]),u=YS((()=>{a.current&&o(r.resting)}),[o,r.resting]);return XS((()=>({dragging:l,dropping:c,resting:u})),[l,c,u])}(n,o),g=YS((e=>{YE(l).dispatch(e)}),[]),m=XS((()=>(0,qS.bindActionCreators)({publishWhileDragging:H_,updateDroppableScroll:X_,updateDroppableIsEnabled:Y_,updateDroppableIsCombineEnabled:Z_,collectionStarting:G_},g)),[g]),b=function(){const e=XS(pE,[]);return(0,t.useEffect)((()=>function(){r().version.startsWith("16")||r().version.startsWith("17")?requestAnimationFrame(e.clean):e.clean()}),[e]),e}(),v=XS((()=>LP(b,m)),[b,m]),y=XS((()=>KP({scrollWindow:FP,scrollDroppable:v.scrollDroppable,getAutoScrollerOptions:d,...(0,qS.bindActionCreators)({move:K_},g)})),[v.scrollDroppable,g,d]),O=function(e){const n=(0,t.useRef)({}),r=(0,t.useRef)(null),i=(0,t.useRef)(null),a=(0,t.useRef)(!1),o=YS((function(e,t){const r={id:e,focus:t};return n.current[e]=r,function(){const t=n.current;t[e]!==r&&delete t[e]}}),[]),s=YS((function(t){const n=function(e,t){const n=`[${eE.contextId}="${e}"]`,r=cE(document,n);if(!r.length)return null;const i=r.find((e=>e.getAttribute(eE.draggableId)===t));return i&&dE(i)?i:null}(e,t);n&&n!==document.activeElement&&n.focus()}),[e]),l=YS((function(e,t){r.current===e&&(r.current=t)}),[]),c=YS((function(){i.current||a.current&&(i.current=requestAnimationFrame((()=>{i.current=null;const e=r.current;e&&s(e)})))}),[s]),u=YS((function(e){r.current=null;const t=document.activeElement;t&&t.getAttribute(eE.draggableId)===e&&(r.current=e)}),[]);return oE((()=>(a.current=!0,function(){a.current=!1;const e=i.current;e&&cancelAnimationFrame(e)})),[]),XS((()=>({register:o,tryRecordFocus:u,tryRestoreFocusRecorded:c,tryShiftRecord:l})),[o,u,c,l])}(n),w=XS((()=>TP({announce:p,autoScroller:y,dimensionMarshal:v,focusMarshal:O,getResponders:u,styleMarshal:h})),[p,y,v,O,u,h]);l.current=w;const S=YS((()=>{const e=YE(l);"IDLE"!==e.getState().phase&&e.dispatch(rP())}),[]),x=YS((()=>{const e=YE(l).getState();return"DROP_ANIMATING"===e.phase||"IDLE"!==e.phase&&e.isDragging}),[]);i(XS((()=>({isDragging:x,tryAbort:S})),[x,S]));const _=YS((e=>$P(YE(l).getState(),e)),[]),P=YS((()=>T_(YE(l).getState())),[]),E=XS((()=>({marshal:v,focus:O,contextId:n,canLift:_,isMovementAllowed:P,dragHandleUsageInstructionsId:f,registry:b})),[n,v,f,O,_,P,b]);return HE({contextId:n,store:w,registry:b,customSensors:a||null,enableDefaultSensors:!1!==e.enableDefaultSensors}),(0,t.useEffect)((()=>S),[S]),r().createElement(OE.Provider,{value:E},r().createElement(HS.Provider,{context:fE,store:w},e.children))}let KE=0;var JE="useId"in r()?function(){return r().useId()}:function(){return XS((()=>""+KE++),[])};function eC(e){const t=JE(),n=e.dragHandleUsageInstructions||Px.dragHandleUsageInstructions;return r().createElement(yx,null,(i=>r().createElement(ZE,{nonce:e.nonce,contextId:t,setCallbacks:i,dragHandleUsageInstructions:n,enableDefaultSensors:e.enableDefaultSensors,sensors:e.sensors,onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragUpdate:e.onDragUpdate,onDragEnd:e.onDragEnd,autoScrollerOptions:e.autoScrollerOptions},e.children)))}const tC=5e3,nC=4500,rC=(e,t)=>t?pP.drop(t.duration):e?pP.snap:pP.fluid,iC=(e,t)=>{if(e)return t?sP:lP};var aC=r().createContext(null);function oC(e){const n=(0,t.useContext)(e);return n||vx(!1),n}function sC(e){e.preventDefault()}var lC=(e,t)=>e===t,cC=e=>{const{combine:t,destination:n}=e;return n?n.droppableId:t?t.droppableId:null};function uC(e=null){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:e,combineWith:null}}const dC={mapped:{type:"SECONDARY",offset:Ex,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:uC(null)}},pC={dropAnimationFinished:()=>({type:"DROP_ANIMATION_FINISHED",payload:null})},fC=(0,HS.connect)((()=>{const e=function(){const e=cx(((e,t)=>({x:e,y:t}))),t=cx(((e,t,n=null,r=null,i=null)=>({isDragging:!0,isClone:t,isDropAnimating:Boolean(i),dropAnimation:i,mode:e,draggingOver:n,combineWith:r,combineTargetFor:null}))),n=cx(((e,n,r,i,a=null,o=null,s=null)=>({mapped:{type:"DRAGGING",dropping:null,draggingOver:a,combineWith:o,mode:n,offset:e,dimension:r,forceShouldAnimate:s,snapshot:t(n,i,a,o,null)}})));return(r,i)=>{if(SE(r)){if(r.critical.draggable.id!==i.draggableId)return null;const t=r.current.client.offset,o=r.dimensions.draggables[i.draggableId],s=k_(r.impact),l=(a=r.impact).at&&"COMBINE"===a.at.type?a.at.combine.draggableId:null,c=r.forceShouldAnimate;return n(e(t.x,t.y),r.movementMode,o,i.isClone,s,l,c)}var a;if("DROP_ANIMATING"===r.phase){const e=r.completed;if(e.result.draggableId!==i.draggableId)return null;const n=i.isClone,a=r.dimensions.draggables[i.draggableId],o=e.result,s=o.mode,l=cC(o),c=(e=>e.combine?e.combine.draggableId:null)(o),u={duration:r.dropDuration,curve:oP,moveTo:r.newHomeClientOffset,opacity:c?sP:null,scale:c?cP:null};return{mapped:{type:"DRAGGING",offset:r.newHomeClientOffset,dimension:a,dropping:u,draggingOver:l,combineWith:c,mode:s,forceShouldAnimate:null,snapshot:t(s,n,l,c,u)}}}return null}}(),t=function(){const e=cx(((e,t)=>({x:e,y:t}))),t=cx(uC),n=cx(((e,n=null,r)=>({mapped:{type:"SECONDARY",offset:e,combineTargetFor:n,shouldAnimateDisplacement:r,snapshot:t(n)}}))),r=e=>e?n(Ex,e,!0):null,i=(t,i,a,o)=>{const s=a.displaced.visible[t],l=Boolean(o.inVirtualList&&o.effected[t]),c=qx(a),u=c&&c.draggableId===t?i:null;if(!s){if(!l)return r(u);if(a.displaced.invisible[t])return null;const i=Tx(o.displacedBy.point),s=e(i.x,i.y);return n(s,u,!0)}if(l)return r(u);const d=a.displacedBy.point,p=e(d.x,d.y);return n(p,u,s.shouldAnimate)};return(e,t)=>{if(SE(e))return e.critical.draggable.id===t.draggableId?null:i(t.draggableId,e.critical.draggable.id,e.impact,e.afterCritical);if("DROP_ANIMATING"===e.phase){const n=e.completed;return n.result.draggableId===t.draggableId?null:i(t.draggableId,n.result.draggableId,n.impact,n.afterCritical)}return null}}();return(n,r)=>e(n,r)||t(n,r)||dC}),pC,null,{context:fE,areStatePropsEqual:lC})((e=>{const n=(0,t.useRef)(null),i=YS(((e=null)=>{n.current=e}),[]),a=YS((()=>n.current),[]),{contextId:o,dragHandleUsageInstructionsId:s,registry:l}=oC(OE),{type:c,droppableId:u}=oC(aC),d=XS((()=>({id:e.draggableId,index:e.index,type:c,droppableId:u})),[e.draggableId,e.index,c,u]),{children:p,draggableId:f,isEnabled:h,shouldRespectForcePress:g,canDragInteractiveElements:m,isClone:b,mapped:v,dropAnimationFinished:y}=e;b||function(e){const n=yE("draggable"),{descriptor:r,registry:i,getDraggableRef:a,canDragInteractiveElements:o,shouldRespectForcePress:s,isEnabled:l}=e,c=XS((()=>({canDragInteractiveElements:o,shouldRespectForcePress:s,isEnabled:l})),[o,l,s]),u=YS((e=>{const t=a();return t||vx(!1),function(e,t,n=Ex){const r=window.getComputedStyle(t),i=t.getBoundingClientRect(),a=ax(i,r),o=ix(a,n);return{descriptor:e,placeholder:{client:a,tagName:t.tagName.toLowerCase(),display:r.display},displaceBy:{x:a.marginBox.width,y:a.marginBox.height},client:a,page:o}}(r,t,e)}),[r,a]),d=XS((()=>({uniqueId:n,descriptor:r,options:c,getDimension:u})),[r,u,c,n]),p=(0,t.useRef)(d),f=(0,t.useRef)(!0);oE((()=>(i.draggable.register(p.current),()=>i.draggable.unregister(p.current))),[i.draggable]),oE((()=>{if(f.current)return void(f.current=!1);const e=p.current;p.current=d,i.draggable.update(d,e)}),[d,i.draggable])}(XS((()=>({descriptor:d,registry:l,getDraggableRef:a,canDragInteractiveElements:m,shouldRespectForcePress:g,isEnabled:h})),[d,l,a,m,g,h]));const O=XS((()=>h?{tabIndex:0,role:"button","aria-describedby":s,"data-rfd-drag-handle-draggable-id":f,"data-rfd-drag-handle-context-id":o,draggable:!1,onDragStart:sC}:null),[o,s,f,h]),w=YS((e=>{"DRAGGING"===v.type&&v.dropping&&"transform"===e.propertyName&&(r().version.startsWith("16")||r().version.startsWith("17")?y():(0,yi.flushSync)(y))}),[y,v]),S=XS((()=>{const e=function(e){return"DRAGGING"===e.type?function(e){const t=e.dimension.client,{offset:n,combineWith:r,dropping:i}=e,a=Boolean(r),o=(e=>null!=e.forceShouldAnimate?e.forceShouldAnimate:"SNAP"===e.mode)(e),s=Boolean(i),l=s?gP(n,a):hP(n);return{position:"fixed",top:t.marginBox.top,left:t.marginBox.left,boxSizing:"border-box",width:t.borderBox.width,height:t.borderBox.height,transition:rC(o,i),transform:l,opacity:iC(a,s),zIndex:s?nC:tC,pointerEvents:"none"}}(e):{transform:hP((t=e).offset),transition:t.shouldAnimateDisplacement?void 0:"none"};var t}(v),t="DRAGGING"===v.type&&v.dropping?w:void 0;return{innerRef:i,draggableProps:{"data-rfd-draggable-context-id":o,"data-rfd-draggable-id":f,style:e,onTransitionEnd:t},dragHandleProps:O}}),[o,O,f,v,w,i]),x=XS((()=>({draggableId:d.id,type:d.type,source:{index:d.index,droppableId:d.droppableId}})),[d.droppableId,d.id,d.index,d.type]);return r().createElement(r().Fragment,null,p(S,v.snapshot,x))}));var hC=fC;function gC(e){return oC(aC).isUsingCloneFor!==e.draggableId||e.isClone?r().createElement(hC,e):null}function mC(e){const t="boolean"!=typeof e.isDragDisabled||!e.isDragDisabled,n=Boolean(e.disableInteractiveElementBlocking),i=Boolean(e.shouldRespectForcePress);return r().createElement(gC,dx({},e,{isClone:!1,isEnabled:t,canDragInteractiveElements:n,shouldRespectForcePress:i}))}const bC=e=>t=>e===t,vC=bC("scroll"),yC=bC("auto"),OC=(bC("visible"),(e,t)=>t(e.overflowX)||t(e.overflowY)),wC=e=>null==e||e===document.body||e===document.documentElement?null:(e=>{const t=window.getComputedStyle(e),n={overflowX:t.overflowX,overflowY:t.overflowY};return OC(n,vC)||OC(n,yC)})(e)?e:wC(e.parentElement);var SC=e=>({x:e.scrollLeft,y:e.scrollTop});const xC=e=>!!e&&("fixed"===window.getComputedStyle(e).position||xC(e.parentElement));const _C={passive:!1},PC={passive:!0};var EC=e=>e.shouldPublishImmediately?_C:PC;const CC=e=>e&&e.env.closestScrollable||null;function kC(e){const n=(0,t.useRef)(null),r=oC(OE),i=yE("droppable"),{registry:a,marshal:o}=r,s=wE(e),l=XS((()=>({id:e.droppableId,type:e.type,mode:e.mode})),[e.droppableId,e.mode,e.type]),c=(0,t.useRef)(l),u=XS((()=>cx(((e,t)=>{n.current||vx(!1);const r={x:e,y:t};o.updateDroppableScroll(l.id,r)}))),[l.id,o]),d=YS((()=>{const e=n.current;return e&&e.env.closestScrollable?SC(e.env.closestScrollable):Ex}),[]),p=YS((()=>{const e=d();u(e.x,e.y)}),[d,u]),f=XS((()=>ux(p)),[p]),h=YS((()=>{const e=n.current,t=CC(e);e&&t||vx(!1),e.scrollOptions.shouldPublishImmediately?p():f()}),[f,p]),g=YS(((e,t)=>{n.current&&vx(!1);const i=s.current,a=i.getDroppableRef();a||vx(!1);const o=(e=>({closestScrollable:wC(e),isFixedOnPage:xC(e)}))(a),c={ref:a,descriptor:l,env:o,scrollOptions:t};n.current=c;const u=(({ref:e,descriptor:t,env:n,windowScroll:r,direction:i,isDropDisabled:a,isCombineEnabled:o,shouldClipSubject:s})=>{const l=n.closestScrollable,c=((e,t)=>{const n=ox(e);if(!t)return n;if(e!==t)return n;const r=n.paddingBox.top-t.scrollTop,i=n.paddingBox.left-t.scrollLeft,a=r+t.scrollHeight,o=i+t.scrollWidth,s=KS({top:r,right:o,bottom:a,left:i},n.border);return tx({borderBox:s,margin:n.margin,border:n.border,padding:n.padding})})(e,l),u=ix(c,r),d=(()=>{if(!l)return null;const e=ox(l),t={scrollHeight:l.scrollHeight,scrollWidth:l.scrollWidth};return{client:e,page:ix(e,r),scroll:SC(l),scrollSize:t,shouldClipSubject:s}})(),p=(({descriptor:e,isEnabled:t,isCombineEnabled:n,isFixedOnPage:r,direction:i,client:a,page:o,closest:s})=>{const l=(()=>{if(!s)return null;const{scrollSize:e,client:t}=s,n=RP({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,height:t.paddingBox.height,width:t.paddingBox.width});return{pageMarginBox:s.page.marginBox,frameClient:t,scrollSize:e,shouldClipSubject:s.shouldClipSubject,scroll:{initial:s.scroll,current:s.scroll,max:n,diff:{value:Ex,displacement:Ex}}}})(),c="vertical"===i?t_:n_;return{descriptor:e,isCombineEnabled:n,isFixedOnPage:r,axis:c,isEnabled:t,client:a,page:o,frame:l,subject:Nx({page:o,withPlaceholder:null,axis:c,frame:l})}})({descriptor:t,isEnabled:!a,isCombineEnabled:o,isFixedOnPage:n.isFixedOnPage,direction:i,client:c,page:u,closest:d});return p})({ref:a,descriptor:l,env:o,windowScroll:e,direction:i.direction,isDropDisabled:i.isDropDisabled,isCombineEnabled:i.isCombineEnabled,shouldClipSubject:!i.ignoreContainerClipping}),d=o.closestScrollable;return d&&(d.setAttribute(rE.contextId,r.contextId),d.addEventListener("scroll",h,EC(c.scrollOptions))),u}),[r.contextId,l,h,s]),m=YS((()=>{const e=n.current,t=CC(e);return e&&t||vx(!1),SC(t)}),[]),b=YS((()=>{const e=n.current;e||vx(!1);const t=CC(e);n.current=null,t&&(f.cancel(),t.removeAttribute(rE.contextId),t.removeEventListener("scroll",h,EC(e.scrollOptions)))}),[h,f]),v=YS((e=>{const t=n.current;t||vx(!1);const r=CC(t);r||vx(!1),r.scrollTop+=e.y,r.scrollLeft+=e.x}),[]),y=XS((()=>({getDimensionAndWatchScroll:g,getScrollWhileDragging:m,dragStopped:b,scroll:v})),[b,g,m,v]),O=XS((()=>({uniqueId:i,descriptor:l,callbacks:y})),[y,l,i]);oE((()=>(c.current=O.descriptor,a.droppable.register(O),()=>{n.current&&b(),a.droppable.unregister(O)})),[y,l,b,O,o,a.droppable]),oE((()=>{n.current&&o.updateDroppableIsEnabled(c.current.id,!e.isDropDisabled)}),[e.isDropDisabled,o]),oE((()=>{n.current&&o.updateDroppableIsCombineEnabled(c.current.id,e.isCombineEnabled)}),[e.isCombineEnabled,o])}function DC(){}const TC={width:0,height:0,margin:{top:0,right:0,bottom:0,left:0}};var RC=r().memo((e=>{const n=(0,t.useRef)(null),i=YS((()=>{n.current&&(clearTimeout(n.current),n.current=null)}),[]),{animate:a,onTransitionEnd:o,onClose:s,contextId:l}=e,[c,u]=(0,t.useState)("open"===e.animate);(0,t.useEffect)((()=>c?"open"!==a?(i(),u(!1),DC):n.current?DC:(n.current=setTimeout((()=>{n.current=null,u(!1)})),i):DC),[a,c,i]);const d=YS((e=>{"height"===e.propertyName&&(o(),"close"===a&&s())}),[a,s,o]),p=(({isAnimatingOpenOnMount:e,placeholder:t,animate:n})=>{const r=(({isAnimatingOpenOnMount:e,placeholder:t,animate:n})=>e||"close"===n?TC:{height:t.client.borderBox.height,width:t.client.borderBox.width,margin:t.client.margin})({isAnimatingOpenOnMount:e,placeholder:t,animate:n});return{display:t.display,boxSizing:"border-box",width:r.width,height:r.height,marginTop:r.margin.top,marginRight:r.margin.right,marginBottom:r.margin.bottom,marginLeft:r.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:"none"!==n?pP.placeholder:null}})({isAnimatingOpenOnMount:c,animate:e.animate,placeholder:e.placeholder});return r().createElement(e.placeholder.tagName,{style:p,"data-rfd-placeholder-context-id":l,onTransitionEnd:d,ref:e.innerRef})}));class IC extends r().PureComponent{constructor(...e){super(...e),this.state={isVisible:Boolean(this.props.on),data:this.props.on,animate:this.props.shouldAnimate&&this.props.on?"open":"none"},this.onClose=()=>{"close"===this.state.animate&&this.setState({isVisible:!1})}}static getDerivedStateFromProps(e,t){return e.shouldAnimate?e.on?{isVisible:!0,data:e.on,animate:"open"}:t.isVisible?{isVisible:!0,data:t.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:Boolean(e.on),data:e.on,animate:"none"}}render(){if(!this.state.isVisible)return null;const e={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(e)}}const AC={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:function(){return document.body||vx(!1),document.body}},jC=e=>{let t,n={...e};for(t in AC)void 0===e[t]&&(n={...n,[t]:AC[t]});return n},LC=(e,t)=>e===t.droppable.type,$C=(e,t)=>t.draggables[e.draggable.id],FC=(0,HS.connect)((()=>{const e={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},t={...e,shouldAnimatePlaceholder:!1},n=cx((e=>({draggableId:e.id,type:e.type,source:{index:e.index,droppableId:e.droppableId}}))),r=cx(((r,i,a,o,s,l)=>{const c=s.descriptor.id;if(s.descriptor.droppableId===r){const e=l?{render:l,dragging:n(s.descriptor)}:null,t={isDraggingOver:a,draggingOverWith:a?c:null,draggingFromThisWith:c,isUsingPlaceholder:!0};return{placeholder:s.placeholder,shouldAnimatePlaceholder:!1,snapshot:t,useClone:e}}if(!i)return t;if(!o)return e;const u={isDraggingOver:a,draggingOverWith:c,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:s.placeholder,shouldAnimatePlaceholder:!0,snapshot:u,useClone:null}}));return(n,i)=>{const a=jC(i),o=a.droppableId,s=a.type,l=!a.isDropDisabled,c=a.renderClone;if(SE(n)){const e=n.critical;if(!LC(s,e))return t;const i=$C(e,n.dimensions),a=k_(n.impact)===o;return r(o,l,a,a,i,c)}if("DROP_ANIMATING"===n.phase){const e=n.completed;if(!LC(s,e.critical))return t;const i=$C(e.critical,n.dimensions);return r(o,l,cC(e.result)===o,k_(e.impact)===o,i,c)}if("IDLE"===n.phase&&n.completed&&!n.shouldFlush){const r=n.completed;if(!LC(s,r.critical))return t;const i=k_(r.impact)===o,a=Boolean(r.impact.at&&"COMBINE"===r.impact.at.type),l=r.critical.droppable.id===o;return i?a?e:t:l?e:t}return t}}),{updateViewportMaxScroll:e=>({type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:e})},((e,t,n)=>({...jC(n),...e,...t})),{context:fE,areStatePropsEqual:lC})((e=>{const n=(0,t.useContext)(OE);n||vx(!1);const{contextId:i,isMovementAllowed:a}=n,o=(0,t.useRef)(null),s=(0,t.useRef)(null),{children:l,droppableId:c,type:u,mode:d,direction:p,ignoreContainerClipping:f,isDropDisabled:h,isCombineEnabled:g,snapshot:m,useClone:b,updateViewportMaxScroll:v,getContainerForClone:y}=e,O=YS((()=>o.current),[]),w=YS(((e=null)=>{o.current=e}),[]),S=(YS((()=>s.current),[]),YS(((e=null)=>{s.current=e}),[])),x=YS((()=>{a()&&v({maxScroll:AP()})}),[a,v]);kC({droppableId:c,type:u,mode:d,direction:p,isDropDisabled:h,isCombineEnabled:g,ignoreContainerClipping:f,getDroppableRef:O});const _=XS((()=>r().createElement(IC,{on:e.placeholder,shouldAnimate:e.shouldAnimatePlaceholder},(({onClose:e,data:t,animate:n})=>r().createElement(RC,{placeholder:t,onClose:e,innerRef:S,animate:n,contextId:i,onTransitionEnd:x})))),[i,x,e.placeholder,e.shouldAnimatePlaceholder,S]),P=XS((()=>({innerRef:w,placeholder:_,droppableProps:{"data-rfd-droppable-id":c,"data-rfd-droppable-context-id":i}})),[i,c,_,w]),E=b?b.dragging.draggableId:null,C=XS((()=>({droppableId:c,type:u,isUsingCloneFor:E})),[c,E,u]);return r().createElement(aC.Provider,{value:C},l(P,m),function(){if(!b)return null;const{dragging:e,render:t}=b,n=r().createElement(gC,{draggableId:e.draggableId,index:e.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},((n,r)=>t(n,r,e)));return Oi().createPortal(n,y())}())}));var NC=FC;g(486),Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;function MC(){const e=function(e){return{empty:(0,Ht.css)({marginBottom:e.spacing(2),marginLeft:e.spacing(1.75),fontSize:e.typography.fontSize})}}((0,Wt.useTheme2)());return r().createElement("div",{className:e.empty},"No fields")}function VC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function BC(e){var t=function(e,t){if("object"!==zC(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==zC(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===zC(t)?t:String(t)}function zC(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function WC(e){const t=function(e){return{dragIcon:(0,Ht.css)({cursor:"drag",marginLeft:e.spacing(1),opacity:.4}),labelCount:(0,Ht.css)({marginLeft:e.spacing(.5),marginRight:e.spacing(.5),appearance:"none",background:"none",border:"none",fontSize:e.typography.pxToRem(11),opacity:.6,display:"flex",flexDirection:"column",alignItems:"self-end"}),contentWrap:(0,Ht.css)({display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"}),customWidthWrap:(0,Ht.css)({fontSize:e.typography.bodySmall.fontSize,cursor:"pointer"}),checkboxLabel:(0,Ht.css)({"> span":{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block",maxWidth:"100%"}})}}((0,Wt.useTheme2)());var n,i,a,o,s,l,c;return e.labels[e.label]?r().createElement(r().Fragment,null,r().createElement("div",{className:t.contentWrap},r().createElement(Wt.Checkbox,{className:t.checkboxLabel,label:e.label,onChange:e.onChange,checked:null!==(c=null===(n=e.labels[e.label])||void 0===n?void 0:n.active)&&void 0!==c&&c}),e.showCount&&r().createElement("div",{className:t.labelCount},r().createElement("div",null,null===(i=e.labels[e.label])||void 0===i?void 0:i.percentOfLinesWithLabel,"%"),r().createElement("div",null,null===(a=e.labels[e.label])||void 0===a?void 0:a.cardinality," ",1===(null===(o=e.labels[e.label])||void 0===o?void 0:o.cardinality)?"value":"values")),e.columnWidthMap&&e.setColumnWidthMap&&void 0!==(null===(s=e.columnWidthMap)||void 0===s?void 0:s[e.label])&&r().createElement("div",{onClick:()=>{var t;const n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){VC(e,t,n[t])}))}return e}({},e.columnWidthMap),r=e.label,{[r]:i}=n,a=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(n,[r].map(BC));null===(t=e.setColumnWidthMap)||void 0===t||t.call(e,a)},title:"Clear column width override",className:t.customWidthWrap},"Width: ",null===(l=e.columnWidthMap)||void 0===l?void 0:l[e.label],r().createElement(Wt.Icon,{name:"x"}))),e.draggable&&r().createElement(Wt.Icon,{"aria-label":"Drag and drop icon",title:"Drag and drop to reorder",name:"draggabledots",size:"lg",className:t.dragIcon})):null}function QC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function UC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){QC(e,t,n[t])}))}return e}function qC(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const HC=n=>{const{columnWidthMap:i,setColumnWidthMap:a}=FS(),{reorderColumn:o,labels:s,valueFilter:l,toggleColumn:c}=n,u=(0,t.useContext)(e.ThemeContext),{columns:d}=FS(),p=function(e){return{wrap:(0,Ht.css)({marginTop:e.spacing(1),marginBottom:e.spacing(1),display:"flex",background:e.colors.background.primary}),dragging:(0,Ht.css)({background:e.colors.background.secondary}),columnWrapper:(0,Ht.css)({marginBottom:e.spacing(1.5),paddingLeft:e.spacing(.5)})}}(u),f=Object.keys(s).filter((e=>l(e))),h=e=>{const t=s[e];if(t)return`${e} appears in ${null==t?void 0:t.percentOfLinesWithLabel}% of log lines`};return f.length?r().createElement(eC,{onDragEnd:e=>{e.destination&&o(d,e.source.index,e.destination.index)}},r().createElement(NC,{droppableId:"order-fields",direction:"vertical"},(e=>r().createElement("div",qC(UC({className:p.columnWrapper},e.droppableProps),{ref:e.innerRef}),f.sort(function(e){return(t,n)=>{const r=e[t],i=e[n];return null!=r.index&&null!=i.index?r.index-i.index:0}}(s)).map(((e,t)=>r().createElement(mC,{draggableId:e,key:e,index:t},((t,n)=>r().createElement("div",qC(UC({className:(0,Ht.cx)(p.wrap,n.isDragging?p.dragging:void 0),ref:t.innerRef},t.draggableProps,t.dragHandleProps),{title:h(e)}),r().createElement(WC,{setColumnWidthMap:a,columnWidthMap:i,label:e,onChange:()=>c(e),labels:s,draggable:!0})))))),e.placeholder)))):r().createElement(MC,null)},GC=new Intl.Collator(void 0,{sensitivity:"base"}),XC=e=>{const{labels:t,valueFilter:n,toggleColumn:i}=e,a=function(e){return{wrap:(0,Ht.css)({marginTop:e.spacing(.25),marginBottom:e.spacing(.25),display:"flex",background:e.colors.background.primary,borderBottom:`1px solid ${e.colors.background.canvas}`}),dragging:(0,Ht.css)({background:e.colors.background.secondary}),columnWrapper:(0,Ht.css)({marginBottom:e.spacing(1.5),paddingLeft:e.spacing(.5)})}}((0,Wt.useTheme2)()),o=Object.keys(t).filter((e=>n(e)));return o.length?r().createElement("div",{className:a.columnWrapper},o.sort(function(e){return(t,n)=>{const r=e[t],i=e[n];return null!=r&&null!=i?Number("TIME_FIELD"===i.type)-Number("TIME_FIELD"===r.type)||Number("BODY_FIELD"===i.type)-Number("BODY_FIELD"===r.type)||GC.compare(t,n):0}}(t)).map((e=>{var n;return r().createElement("div",{key:e,className:a.wrap,title:`${e} appears in ${null===(n=t[e])||void 0===n?void 0:n.percentOfLinesWithLabel}% of log lines`},r().createElement(WC,{showCount:!0,label:e,onChange:()=>i(e),labels:t}))}))):r().createElement(MC,null)},YC=e=>{const t=function(e){return{sidebarWrap:(0,Ht.css)({overflowY:"scroll",height:"calc(100% - 50px)","&::-webkit-scrollbar":{display:"none"},scrollbarWidth:"none"}),columnHeaderButton:(0,Ht.css)({appearance:"none",background:"none",border:"none",fontSize:e.typography.pxToRem(11)}),columnHeader:(0,Ht.css)({display:"flex",justifyContent:"space-between",fontSize:e.typography.h6.fontSize,background:e.colors.background.secondary,position:"sticky",top:0,left:0,paddingTop:e.spacing(.75),paddingRight:e.spacing(.75),paddingBottom:e.spacing(.75),paddingLeft:e.spacing(1.5),zIndex:3,marginBottom:e.spacing(2)})}}((0,Wt.useTheme2)());var n,i;return r().createElement("div",{className:t.sidebarWrap},r().createElement(r().Fragment,null,r().createElement("div",{className:t.columnHeader},"Selected fields",r().createElement("button",{onClick:e.clear,className:t.columnHeaderButton},"Reset")),r().createElement(HC,{reorderColumn:e.reorderColumn,toggleColumn:e.toggleColumn,labels:null!==(n=e.filteredColumnsWithMeta)&&void 0!==n?n:e.columnsWithMeta,valueFilter:t=>{var n,r;return null!==(r=null===(n=e.columnsWithMeta[t])||void 0===n?void 0:n.active)&&void 0!==r&&r},id:"selected-fields"}),r().createElement("div",{className:t.columnHeader},"Fields"),r().createElement(XC,{toggleColumn:e.toggleColumn,labels:null!==(i=e.filteredColumnsWithMeta)&&void 0!==i?i:e.columnsWithMeta,valueFilter:t=>{var n;return!(null===(n=e.columnsWithMeta[t])||void 0===n?void 0:n.active)}})))};function ZC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){ZC(e,t,n[t])}))}return e}function JC(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function ek(e){return(t,n,r)=>{if(n===r)return;const i=KC({},t),a=Object.keys(i).filter((e=>i[e].active)).map((e=>{var t;return{fieldName:e,index:null!==(t=i[e].index)&&void 0!==t?t:0}})).sort(((e,t)=>e.index-t.index)),[o]=a.splice(n,1);a.splice(r,0,o),a.filter((e=>void 0!==e)).forEach(((e,t)=>{i[e.fieldName].index=t})),e(i)}}function tk(){const{columns:e,setColumns:n,setVisible:i,filteredColumns:o,setFilteredColumns:s}=FS(),[l,c]=(0,t.useState)(""),u=ek(n);return r().createElement(Wt.ClickOutsideWrapper,{onClick:()=>{i(!1),s(e),c("")},useCapture:!0},r().createElement(US,{searchValue:l,setSearchValue:c}),r().createElement(YC,{toggleColumn:t=>{if(!e||!(t in e))return void function(e,t){let n;try{n={columns:JSON.stringify(t),columnName:e}}catch(t){n={msg:"Table: ColumnSelectionDrawerWrap failed to encode context",columnName:e}}Gg.warn("failed to get column",n)}(t,e);const r=Object.keys(e).filter((t=>e[t].active)).length,i=!e[t].active||void 0;let l;if(l=JC(KC({},e),i?{[t]:JC(KC({},e[t]),{active:i,index:r})}:{[t]:JC(KC({},e[t]),{active:!1,index:void 0})}),function(t){if(e){var n,r;const i=!(null===(n=e[t])||void 0===n?void 0:n.active),o=null===(r=Object.keys(e).filter((t=>{var n;return null===(n=e[t])||void 0===n?void 0:n.active})))||void 0===r?void 0:r.length,s={columnAction:i?"add":"remove",columnCount:i?o+1:o-1};(0,a.reportInteraction)("grafana_logs_app_table_column_filter_clicked",s)}}(t),n(l),o){var u;const e=!(null===(u=o[t])||void 0===u?void 0:u.active);let n;n=JC(KC({},o),e?{[t]:JC(KC({},o[t]),{active:e,index:r})}:{[t]:JC(KC({},o[t]),{active:!1,index:void 0})}),s(n),c("")}},filteredColumnsWithMeta:o,columnsWithMeta:e,clear:()=>{const t=KC({},e);let r=0;Object.keys(t).forEach((e=>{const n="BODY_FIELD"===t[e].type||"TIME_FIELD"===t[e].type;t[e].active=n,t[e].index=n?r++:void 0})),n(t),s(t),c("")},reorderColumn:u}))}const nk=e=>r().createElement(rk,{onMouseOut:e.onMouseOut,onMouseIn:e.onMouseIn,onClick:e.onClick,field:e.field,rowIndex:e.rowIndex},e.children),rk=e=>{var t;const n=(0,Wt.useTheme2)(),i=BS(),a=((e,t,n)=>({active:(0,Ht.css)({height:"calc(100% + 36px)",zIndex:e.zIndex.tooltip,background:"transparent"}),wrap:(0,Ht.css)({position:"absolute",overflowX:"hidden",whiteSpace:"nowrap",width:"100%",height:"100%",left:0,top:0,margin:"auto",background:"transparent"})}))(n,0,null===(t=i.cellIndex)||void 0===t||t.numberOfMenuItems);return r().createElement("div",{onMouseLeave:e.onMouseOut,onMouseEnter:e.onMouseIn,onClick:e.onClick,className:i.cellIndex.index===e.rowIndex&&i.cellIndex.fieldName===e.field.name?(0,Ht.cx)(a.wrap,a.active):a.wrap},e.children)},ik={logsFrame:null,addFilter:e=>{},timeRange:void 0,selectedLine:void 0},ak=(0,t.createContext)(ik),ok=({children:e,logsFrame:t,addFilter:n,selectedLine:i,timeRange:a})=>r().createElement(ak.Provider,{value:{logsFrame:t,addFilter:n,selectedLine:i,timeRange:a}},e),sk=()=>(0,t.useContext)(ak),lk=e=>{const t=((e,t)=>({menu:(0,Ht.css)({position:"relative",paddingRight:"5px",display:"flex",minWidth:"60px",justifyContent:"flex-start"}),menuItemsWrap:(0,Ht.css)({boxShadow:e.shadows.z3,display:"flex",background:e.colors.background.secondary,padding:"5px 0",marginLeft:"column"===t?"5px":void 0}),menuItem:(0,Ht.css)({overflow:"auto",textOverflow:"ellipsis",cursor:"pointer",paddingLeft:"5px",paddingRight:"5px",display:"flex",alignItems:"center"})}))((0,Wt.useTheme2)(),e.pillType),{addFilter:n}=sk();return r().createElement("span",{className:t.menu},r().createElement("span",{className:t.menuItemsWrap},"derived"!==e.fieldType&&r().createElement(r().Fragment,null,r().createElement("div",{className:t.menuItem,onClick:()=>{n({key:e.label,value:e.value,operator:Pb.Equal})}},r().createElement(Wt.Icon,{title:"Add to search",size:"md",name:"plus-circle"})),r().createElement("div",{className:t.menuItem,onClick:()=>{n({key:e.label,value:e.value,operator:Pb.NotEqual})}},r().createElement(Wt.Icon,{title:"Exclude from search",size:"md",name:"minus-circle"}))),e.showColumn&&r().createElement("div",{title:"Add column",onClick:e.showColumn,className:t.menuItem},r().createElement("svg",{width:"18",height:"16",viewBox:"0 0 18 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r().createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.38725 1.33301H13.3872C13.5641 1.33301 13.7336 1.40325 13.8587 1.52827C13.9837 1.65329 14.0539 1.82286 14.0539 1.99967V2.33333C14.0539 2.70152 13.7554 3 13.3872 3H13.0542C12.87 3 12.7206 2.85062 12.7206 2.66634H8.05391V13.333H12.7206C12.7206 13.1491 12.8697 13 13.0536 13H13.3872C13.7554 13 14.0539 13.2985 14.0539 13.6667V13.9997C14.0539 14.1765 13.9837 14.3461 13.8587 14.4711C13.7336 14.5961 13.5641 14.6663 13.3872 14.6663H1.38725C1.21044 14.6663 1.04087 14.5961 0.915843 14.4711C0.790819 14.3461 0.720581 14.1765 0.720581 13.9997V1.99967C0.720581 1.82286 0.790819 1.65329 0.915843 1.52827C1.04087 1.40325 1.21044 1.33301 1.38725 1.33301ZM2.05391 13.333H6.72058V2.66634H2.05391V13.333Z",fill:"#CCCCDC",fillOpacity:"1"}),r().createElement("path",{d:"M13.8538 7.19999H16.2538C16.466 7.19999 16.6695 7.28429 16.8195 7.4343C16.9696 7.58432 17.0538 7.78783 17.0538 7.99999C17.0538 8.21214 16.9696 8.41566 16.8195 8.56567C16.6695 8.71569 16.466 8.79999 16.2538 8.79999H13.8538V11.2C13.8538 11.4121 13.7696 11.6156 13.6195 11.7657C13.4695 11.9157 13.266 12 13.0538 12C12.8416 12 12.6382 11.9157 12.4881 11.7657C12.3381 11.6156 12.2538 11.4121 12.2538 11.2V8.79999H9.85384C9.64165 8.79999 9.43819 8.71569 9.28815 8.56567C9.13811 8.41566 9.05383 8.21214 9.05383 7.99999C9.05383 7.78783 9.13811 7.58432 9.28815 7.4343C9.43819 7.28429 9.64165 7.19999 9.85384 7.19999H12.2538V4.8C12.2538 4.58784 12.3381 4.38433 12.4881 4.23431C12.6382 4.0843 12.8416 4 13.0538 4C13.266 4 13.4695 4.0843 13.6195 4.23431C13.7696 4.38433 13.8538 4.58784 13.8538 4.8V7.19999Z",fill:"#CCCCDC",fillOpacity:"1"}))),e.links&&e.links.map((e=>{var n;return r().createElement("div",{className:t.menuItem,onClick:()=>{window.open(e.href,"_blank")},key:e.href},r().createElement(Wt.Icon,{title:null!==(n=e.title)&&void 0!==n?n:"Link",key:e.href,size:"md",name:"link"}))}))))},ck="detected_level",uk=t=>{const{label:n,value:i}=t,a=(0,Wt.useTheme2)(),{cellIndex:o}=BS();let s;if(n===ck){const e=jk().options;"string"==typeof i&&i in e&&(s=e[i].color)}const l=o.index===t.rowIndex&&t.field.name===o.fieldName,c=((e,t)=>({activePillWrap:(0,Ht.css)({}),pillWrap:(0,Ht.css)({width:"100%"}),pill:(0,Ht.css)({border:`1px solid ${e.colors.border.weak}`,"&:hover":{border:`1px solid ${e.colors.border.strong}`},marginRight:"5px",marginTop:"4px",marginLeft:"5px",padding:"2px 5px",position:"relative",display:"inline-flex",flexDirection:"row-reverse",backgroundColor:"transparent",paddingLeft:t?`${e.spacing(.75)}`:"2px","&:before":{content:'""',position:"absolute",left:0,top:0,height:"100%",width:`${e.spacing(.25)}`,backgroundColor:t}}),menu:(0,Ht.css)({width:"100%"}),menuItem:(0,Ht.css)({overflow:"auto",textOverflow:"ellipsis"}),menuItemText:(0,Ht.css)({width:"65px",display:"inline-block"})}))(a,s);return r().createElement("div",{className:(0,Ht.cx)(c.pillWrap,l?c.activePillWrap:void 0)},!!i&&r().createElement(r().Fragment,null,r().createElement("span",{className:c.pill},r().createElement(r().Fragment,null,i)),l&&"string"==typeof i&&t.field.type!==e.FieldType.time&&r().createElement(lk,{label:t.label,value:i,pillType:"column"})))};var dk;function pk(e){var n;const i=((e,t)=>({clipboardButton:(0,Ht.css)({padding:0,height:"100%",lineHeight:"1",width:"20px"}),inspectButton:(0,Ht.css)({display:"inline-flex",verticalAlign:"middle",margin:0,overflow:"hidden",borderRadius:"5px"}),iconWrapper:(0,Ht.css)({height:"35px",position:"sticky",left:0,display:"flex",background:e.colors.background.secondary,padding:`0 ${e.spacing(.5)}`,zIndex:1,boxShadow:e.shadows.z2}),inspect:(0,Ht.css)({padding:"5px 3px","&:hover":{color:e.colors.text.link,cursor:"pointer"}})}))((0,Wt.useTheme2)()),{logsFrame:o,timeRange:s}=sk(),l=null==o||null===(n=o.idField)||void 0===n?void 0:n.values[e.rowIndex],c=null==o?void 0:o.bodyField.values[e.rowIndex],[u,d]=(0,t.useState)(!1);return r().createElement(r().Fragment,null,r().createElement("div",{className:i.iconWrapper},r().createElement("div",{className:i.inspect},r().createElement(Wt.IconButton,{"data-testid":dy,className:i.inspectButton,tooltip:"View log line",variant:"secondary","aria-label":"View log line",tooltipPlacement:"top",size:"md",name:"eye",onClick:()=>d(!0),tabIndex:0})),r().createElement("div",{className:i.inspect},r().createElement(Wt.ClipboardButton,{className:i.clipboardButton,icon:"share-alt",variant:"secondary",fill:"text",size:"md",tooltip:"Copy link to log line",tooltipPlacement:"top",tabIndex:0,getText:()=>{const t=a.locationService.getLocation(),n=new URLSearchParams(t.search);if(n&&s){const r={row:e.rowIndex,id:l};n.set("from",s.from.toISOString()),n.set("to",s.to.toISOString()),n.set("selectedLine",JSON.stringify(r));const i=n.toString().replace(/\+/g,"%20");return window.location.origin+t.pathname+"?"+i}return""}}))),r().createElement(r().Fragment,null,u&&r().createElement(Wt.Modal,{onDismiss:()=>d(!1),isOpen:!0,title:"Inspect value"},r().createElement("pre",null,c),r().createElement(Wt.Modal.ButtonRow,null,r().createElement(Wt.ClipboardButton,{icon:"copy",getText:()=>e.value},"Copy to Clipboard")))))}!function(e){e.SelectedLine="selectedLine",e.From="from",e.To="to"}(dk||(dk={}));const fk=t=>{var n;let i=t.value;const a=t.field,o=a.display(i),s=((t,n)=>({flexWrap:(0,Ht.css)({display:"flex",alignItems:"flex-start",flexDirection:n===e.FieldType.number?"row-reverse":"row",textAlign:n===e.FieldType.number?"right":"left"}),content:(0,Ht.css)({position:"relative",overflow:"hidden",display:"flex",height:"100%"}),linkWrapper:(0,Ht.css)({color:t.colors.text.link,marginTop:"7px",marginLeft:"7px","&:hover":{textDecoration:"underline"}})}))((0,Wt.useTheme2)(),t.field.type),{setVisible:l}=FS(),{cellIndex:c,setActiveCellIndex:u}=BS(),d={index:t.rowIndex},p=Boolean(null===(n=(0,Wt.getCellLinks)(t.field,d))||void 0===n?void 0:n.length);return null===i?r().createElement(r().Fragment,null):(i=r().isValidElement(t.value)?t.value:"object"==typeof i?JSON.stringify(t.value):(0,e.formattedValueToString)(o),r().createElement(nk,{onClick:()=>t.rowIndex===c.index&&t.field.name===c.fieldName?u({index:null}):u({index:t.rowIndex,fieldName:t.field.name,numberOfMenuItems:3}),field:t.field,rowIndex:t.rowIndex},r().createElement("div",{className:s.content},0===t.fieldIndex&&r().createElement(pk,{value:i,rowIndex:t.rowIndex}),r().createElement("div",{className:s.flexWrap}),!p&&((e,n)=>r().createElement(uk,{field:t.field,rowIndex:t.rowIndex,showColumns:()=>l(!0),label:n,value:e}))(i,a.name),p&&a.getLinks&&r().createElement(Wt.DataLinksContextMenu,{links:()=>{var e;return null!==(e=(0,Wt.getCellLinks)(a,d))&&void 0!==e?e:[]}},(e=>e.openMenu?r().createElement("div",{className:s.linkWrapper,onClick:e.openMenu},r().createElement(r().Fragment,null,i)):r().createElement("div",{className:s.linkWrapper},r().createElement(r().Fragment,null,i)))))))};function hk(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gk(e){const t=(0,Wt.useTheme2)();let n;if(e.label===ck){const t=jk().options;e.value in t&&(n=t[e.value].color)}const i=((e,t)=>({pill:(0,Ht.css)({flex:"0 1 auto",marginLeft:e.spacing(.5),marginRight:e.spacing(.5),padding:`${e.spacing(.25)} ${e.spacing(.25)}`,position:"relative",display:"inline-flex",flexDirection:"column",marginTop:e.spacing(.5)}),activePill:(0,Ht.css)({}),valueWrap:(0,Ht.css)({border:`1px solid ${e.colors.background.secondary}`,boxShadow:`-2px 2px 5px 0px ${e.colors.background.secondary}`,backgroundColor:"transparent",cursor:"pointer",position:"relative",paddingRight:`${e.spacing(.5)}`,paddingLeft:t?`${e.spacing(.75)}`:`${e.spacing(.5)}`,"&:before":{content:'""',position:"absolute",left:0,top:0,height:"100%",width:`${e.spacing(.25)}`,backgroundColor:t},"&:hover":{border:`1px solid ${e.colors.border.strong}`}})}))(t,n);return r().createElement("span",{className:(0,Ht.cx)(i.pill,e.menuActive?i.activePill:void 0),onClick:e.onClick},r().createElement("span",{className:i.valueWrap},e.label,"=",e.value),e.menuActive&&r().createElement(lk,{pillType:"logPill",fieldType:e.fieldType,links:e.links,label:e.label,value:e.value,showColumn:e.onClickAdd}))}const mk=n=>{const{label:i}=n,{cellIndex:o,setActiveCellIndex:s}=BS(),{columns:l,setColumns:c}=FS(),u=n.value,d=(0,a.getTemplateSrv)(),p=(0,t.useMemo)((()=>d.replace.bind(d)),[d]),f=n.field;if(!f||(null==f?void 0:f.type)===e.FieldType.other)return null;const h={index:n.rowIndex};n.originalField&&n.isDerivedField&&n.originalFrame&&(n.originalField.getLinks=(0,e.getLinksSupplier)(n.originalFrame,n.originalField,{},p));const g=n.originalField&&(0,Wt.getCellLinks)(n.originalField,h);return r().createElement(gk,{onClick:()=>n.rowIndex===o.index&&f.name===o.fieldName&&i===o.subFieldName?s({index:null}):s({index:n.rowIndex,fieldName:f.name,subFieldName:i,numberOfMenuItems:n.isDerivedField?2:3}),menuActive:o.index===n.rowIndex&&o.fieldName===f.name&&o.subFieldName===i,fieldType:n.isDerivedField?"derived":void 0,label:i,value:u,onClickAdd:()=>(e=>{const t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){hk(e,t,n[t])}))}return e}({},l),n=Object.keys(l).filter((e=>l[e].active)).length;t[e].active?(t[e].active=!1,t[e].index=void 0):(t[e].active=!0,t[e].index=n),c(t)})(i),links:g})},bk=e=>{var t,n;null==e||null===(n=e.current)||void 0===n||n.scrollTo({left:null===(t=e.current)||void 0===t?void 0:t.scrollLeft})};function vk({scrollerRef:e}){const t=(e=>({scroller:Ht.css`
    position: absolute;
    right: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 20px;
    top: 32px;
    margin-top: -24px;
    // For some reason clicking on this button causes text to be selected in the following row
    user-select: none;
  `,scrollLeft:Ht.css`
    cursor: pointer;
    background: ${e.colors.background.primary};

    &:hover {
      background: ${e.colors.background.secondary};
    }
  `,scrollRight:Ht.css`
    cursor: pointer;
    background: ${e.colors.background.primary};

    &:hover {
      background: ${e.colors.background.secondary};
    }
  `}))((0,Wt.useTheme2)());return r().createElement("div",{className:t.scroller},r().createElement("span",{onPointerDown:()=>{var t,n;null==(t=e)||null===(n=t.current)||void 0===n||n.scrollTo({top:0,left:0,behavior:"smooth"})},onPointerUp:()=>bk(e),className:t.scrollLeft},r().createElement(Wt.Icon,{name:"arrow-left"})),r().createElement("span",{onPointerDown:()=>{var t,n;null==(t=e)||null===(n=t.current)||void 0===n||n.scrollTo({top:0,left:t.current.scrollWidth,behavior:"smooth"})},onPointerUp:()=>bk(e),className:t.scrollRight},r().createElement(Wt.Icon,{name:"arrow-right"})))}function yk(e){const t=(0,Wt.useTheme2)(),n=Ok(t);return r().createElement("div",{className:n.rawLogLine},r().createElement(r().Fragment,null,e.value))}const Ok=(e,t)=>({rawLogLine:(0,Ht.css)({fontFamily:e.typography.fontFamilyMonospace,height:"35px",lineHeight:"35px",paddingRight:e.spacing(1.5),paddingLeft:e.spacing(1),fontSize:e.typography.bodySmall.fontSize})}),wk=n=>{let i=n.value;const a=n.field,o=a.display(i),s=(0,Wt.useTheme2)(),l=Sk(s),{columns:c,setVisible:u,bodyState:d}=FS(),{logsFrame:p}=sk(),[f,h]=(0,t.useState)(!1),g=(0,t.useRef)(null);i=r().isValidElement(n.value)?n.value:"object"==typeof i?JSON.stringify(n.value):(0,e.formattedValueToString)(o);const m=(t=>Object.keys(c).filter((e=>e!==DS(p))).sort(((e,t)=>e===ck?-1:t===ck?1:"LINK_FIELD"===c[e].type?-1:"LINK_FIELD"===c[t].type?1:c[e].cardinality>c[t].cardinality?-1:1)).filter((e=>!c[e].active&&c[e].cardinality>1)).map((i=>{var o;const s=t[i],l=null==p||null===(o=p.raw)||void 0===o?void 0:o.fields.find((e=>e.name===i)),d=null==a?void 0:a.values[n.rowIndex],f=!s&&!!d;if(s)return r().createElement(mk,{originalFrame:void 0,field:a,columns:c,rowIndex:n.rowIndex,frame:n.frame,showColumns:()=>u(!0),key:i,label:i,isDerivedField:!1,value:s});if(f&&(null==l?void 0:l.name)){const t=null==l?void 0:l.values[n.rowIndex];if((null==l?void 0:l.type)===e.FieldType.string&&t)return r().createElement(mk,{originalFrame:null==p?void 0:p.raw,originalField:l,field:a,value:t,columns:c,rowIndex:n.rowIndex,frame:n.frame,showColumns:()=>u(!0),key:l.name,label:l.name,isDerivedField:!0})}return null})).filter((e=>e)))(n.labels),b=d===AS.auto,v=m.length>0;return r().createElement(nk,{onMouseIn:()=>{h(!0)},onMouseOut:()=>{h(!1)},rowIndex:n.rowIndex,field:n.field},r().createElement(NS.ScrollSyncPane,{innerRef:g,group:"horizontal"},r().createElement("div",{className:l.content},0===n.fieldIndex&&r().createElement(pk,{rowIndex:n.rowIndex,value:i}),b&&v&&r().createElement(r().Fragment,null,m),d===AS.labels&&v&&r().createElement(r().Fragment,null,m),d===AS.labels&&!v&&r().createElement(yk,{value:i}),b&&!v&&r().createElement(yk,{value:i}),d===AS.text&&r().createElement(yk,{value:i}),f&&r().createElement(vk,{scrollerRef:g}))))},Sk=e=>({content:Ht.css`
    white-space: nowrap;
    overflow-x: auto;
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
    padding-right: 30px;
    display: flex;
    align-items: flex-start;
    height: 100%;
    &::-webkit-scrollbar {
      display: none; /* Chrome, Safari and Opera */
    }

    &:after {
      pointer-events: none;
      content: '';
      width: 100%;
      height: 100%;
      position: absolute;
      left: 0;
      top: 0;
      // Fade out text in last 10px to background color to add affordance to horiziontal scroll
      background: linear-gradient(to right, transparent calc(100% - 10px), ${e.colors.background.primary});
    }
  `}),xk=e=>{const{setHeaderMenuActive:n,isHeaderMenuActive:i}=QS(),{logsFrame:a}=sk(),o=(0,t.useRef)(null),s=((e,t,n)=>({tableHeaderMenu:(0,Ht.css)({label:"tableHeaderMenu",width:"100%",minWidth:"250px",height:"100%",maxHeight:"400px",backgroundColor:e.colors.background.primary,border:`1px solid ${e.colors.border.weak}`,padding:e.spacing(2),margin:e.spacing(1,0),boxShadow:e.shadows.z3,borderRadius:e.shape.radius.default}),button:(0,Ht.css)({appearance:"none",right:"5px",background:"none",border:"none",padding:0}),wrapper:(0,Ht.css)({display:"flex",marginLeft:t?"56px":"6px",width:n?"calc(100% + 6px)":"100%",borderRight:`1px solid ${e.colors.border.weak}`,marginRight:"-6px"}),defaultContentWrapper:(0,Ht.css)({borderLeft:t?`1px solid ${e.colors.border.weak}`:"none",marginLeft:t?"-6px":0,paddingLeft:t?"12px":0,display:"flex"})}))((0,Wt.useTheme2)(),0===e.fieldIndex,e.field.name===DS(a));return r().createElement("span",{className:s.wrapper},r().createElement("span",{className:s.defaultContentWrapper},e.defaultContent),r().createElement("button",{className:s.button,ref:o,onClick:e=>{n(!i)}},r().createElement(Wt.Icon,{title:"Show menu",name:"ellipsis-v"})),o.current&&r().createElement(Wt.Popover,{show:i,content:r().createElement(Wt.ClickOutsideWrapper,{onClick:()=>n(!1),useCapture:!0},r().createElement("div",{className:s.tableHeaderMenu},e.children)),referenceElement:o.current}))};function _k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pk(e){const{setHeaderMenuActive:n}=QS(),{columns:i,setColumns:a,bodyState:o,setBodyState:s}=FS(),{logsFrame:l}=sk(),c=Ek(),u=(0,t.useCallback)((e=>{const t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){_k(e,t,n[t])}))}return e}({},i);Object.keys(t).filter((n=>{const r=t[n].index,i=t[e.name].index;return t[n].active&&i&&r&&r>i})).map((e=>t[e])).forEach((e=>{void 0!==e.index&&e.index--})),t[e.name].active=!1,t[e.name].index=void 0,a(t)}),[i,a]),d=e.headerProps.field.name===DS(l);return r().createElement(xk,e.headerProps,r().createElement("div",{className:c.linkWrap},r().createElement("a",{className:c.link,onClick:()=>{e.openColumnManagementDrawer(),n(!1)}},r().createElement(Wt.Icon,{className:c.icon,name:"columns",size:"md"}),"Manage columns")),r().createElement("div",{className:c.linkWrap},r().createElement("a",{className:c.link,onClick:()=>u(e.headerProps.field)},r().createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 17 16",width:"17",height:"16",className:"css-q2u0ig-Icon"},r().createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.73446 1.33301H12.2345C12.3892 1.33301 12.5375 1.40325 12.6469 1.52827C12.7563 1.65329 12.8178 1.82286 12.8178 1.99967V4.74967C12.8178 5.07184 12.5566 5.33301 12.2345 5.33301C11.9123 5.33301 11.6511 5.07184 11.6511 4.74967V2.66634H7.56779V13.333H11.6511V10.9163C11.6511 10.5942 11.9123 10.333 12.2345 10.333C12.5566 10.333 12.8178 10.5942 12.8178 10.9163V13.9997C12.8178 14.1765 12.7563 14.3461 12.6469 14.4711C12.5375 14.5961 12.3892 14.6663 12.2345 14.6663H1.73446C1.57975 14.6663 1.43137 14.5961 1.32198 14.4711C1.21258 14.3461 1.15112 14.1765 1.15112 13.9997V1.99967C1.15112 1.82286 1.21258 1.65329 1.32198 1.52827C1.43137 1.40325 1.57975 1.33301 1.73446 1.33301ZM2.31779 13.333H6.40112V2.66634H2.31779V13.333Z",fill:"#CCCCDC",fillOpacity:"1"}),r().createElement("path",{d:"M15.9893 10.6315C15.9498 10.7263 15.8919 10.8123 15.819 10.8846C15.7467 10.9575 15.6607 11.0154 15.5659 11.0549C15.4712 11.0943 15.3695 11.1147 15.2668 11.1147C15.1641 11.1147 15.0625 11.0943 14.9677 11.0549C14.8729 11.0154 14.7869 10.9575 14.7146 10.8846L12.9335 9.09573L11.1524 10.8846C11.0801 10.9575 10.9941 11.0154 10.8993 11.0549C10.8045 11.0943 10.7028 11.1147 10.6002 11.1147C10.4975 11.1147 10.3958 11.0943 10.301 11.0549C10.2063 11.0154 10.1202 10.9575 10.0479 10.8846C9.97504 10.8123 9.91717 10.7263 9.87769 10.6315C9.8382 10.5367 9.81787 10.4351 9.81787 10.3324C9.81787 10.2297 9.8382 10.1281 9.87769 10.0333C9.91717 9.9385 9.97504 9.85248 10.0479 9.78017L11.8368 7.99906L10.0479 6.21795C9.90148 6.07149 9.8192 5.87285 9.8192 5.66573C9.8192 5.4586 9.90148 5.25996 10.0479 5.1135C10.1944 4.96705 10.393 4.88477 10.6002 4.88477C10.8073 4.88477 11.0059 4.96705 11.1524 5.1135L12.9335 6.90239L14.7146 5.1135C14.8611 4.96705 15.0597 4.88477 15.2668 4.88477C15.4739 4.88477 15.6726 4.96705 15.819 5.1135C15.9655 5.25996 16.0478 5.4586 16.0478 5.66573C16.0478 5.87285 15.9655 6.07149 15.819 6.21795L14.0302 7.99906L15.819 9.78017C15.8919 9.85248 15.9498 9.9385 15.9893 10.0333C16.0288 10.1281 16.0491 10.2297 16.0491 10.3324C16.0491 10.4351 16.0288 10.5367 15.9893 10.6315Z",fill:"#CCCCDC",fillOpacity:"1"})),"Remove column")),e.slideLeft&&r().createElement("div",{className:c.linkWrap},r().createElement("a",{className:c.link,onClick:()=>{var t;return null===(t=e.slideLeft)||void 0===t?void 0:t.call(e,i)}},r().createElement(Wt.Icon,{className:(0,Ht.cx)(c.icon,c.reverse),name:"arrow-from-right",size:"md"}),"Move left")),e.slideRight&&r().createElement("div",{className:c.linkWrap},r().createElement("a",{className:c.link,onClick:()=>{var t;return null===(t=e.slideRight)||void 0===t?void 0:t.call(e,i)}},r().createElement(Wt.Icon,{className:c.icon,name:"arrow-from-right",size:"md"}),"Move right")),d&&r().createElement("div",{className:c.linkWrap},r().createElement("a",{className:c.link,onClick:()=>{o===AS.text?s(AS.labels):s(AS.text)}},o===AS.text?r().createElement(Wt.Icon,{className:c.icon,name:"brackets-curly",size:"md"}):r().createElement(Wt.Icon,{className:c.icon,name:"text-fields",size:"md"}),o===AS.text?"Show labels":"Show log text")),e.autoColumnWidths&&r().createElement("div",{className:c.linkWrap},r().createElement("a",{className:c.link,onClick:()=>{var t;return null===(t=e.autoColumnWidths)||void 0===t?void 0:t.call(e)}},r().createElement(Wt.Icon,{className:c.icon,name:"arrows-h",size:"md"}),"Reset column widths")))}const Ek=()=>({reverse:(0,Ht.css)({transform:"scaleX(-1)"}),link:(0,Ht.css)({paddingTop:"5px",paddingBottom:"5px"}),icon:(0,Ht.css)({marginRight:"10px"}),linkWrap:(0,Ht.css)({})});function Ck(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function kk(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Dk(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){kk(e,t,n[t])}))}return e}function Tk(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Rk(e){return r().createElement(Wt.Table,{onColumnResize:e.onResize,initialSortBy:[{displayName:kS(e.logsFrame),desc:!0}],initialRowIndex:e.selectedLine,cellHeight:se.Sm,data:e.data,height:e.height,width:e.width,footerOptions:{show:!0,reducer:["count"],countRows:!0}})}const Ik=n=>{const{height:i,timeZone:o,logsFrame:s,width:l,labels:c}=n,u=(0,Wt.useTheme2)(),d={section:(0,Ht.css)({position:"relative"}),tableWrap:(0,Ht.css)({".cellActions":{display:"none !important"}})},[p,f]=(0,t.useState)(void 0),{columns:h,visible:g,setVisible:m,setFilteredColumns:v,setColumns:y,clearSelectedLine:O,columnWidthMap:w,setColumnWidthMap:S}=FS(),{selectedLine:x}=sk(),[_]=(0,t.useState)(x),P=ek(y),E=(0,a.getTemplateSrv)(),C=(0,t.useMemo)((()=>E.replace.bind(E)),[E]),k=(0,t.useCallback)((t=>{if(!t.length)return t;const[n]=(0,e.applyFieldOverrides)({data:[t],timeZone:o,theme:u,replaceVariables:C,fieldConfig:{defaults:{custom:{}},overrides:[]}});for(const[o,u]of n.fields.entries()){var i,a;u.type=u.type===e.FieldType.string?null!==(i=Ak(u))&&void 0!==i?i:e.FieldType.string:u.type,u.config=Tk(Dk({},u.config),{custom:Dk({inspect:!0,filterable:!0,headerComponent:e=>r().createElement(WS,null,r().createElement(Pk,{headerProps:Tk(Dk({},e),{fieldIndex:o}),openColumnManagementDrawer:()=>m(!0),slideLeft:0!==o?e=>P(e,o,o-1):void 0,slideRight:o!==t.fields.length-1?e=>P(e,o,o+1):void 0,autoColumnWidths:Object.keys(w).length>0?()=>{S({})}:void 0})),width:null!==(a=w[u.name])&&void 0!==a?a:$k(u,o,h,l,n.fields.length,s),cellOptions:Lk(u,o,c,s)},u.config.custom),filterable:!0})}return n}),[o,u,c,l,C,m,w]);(0,t.useEffect)((()=>{const t=function(){var t,n=(t=function*(){const t=(n=s.raw).fields.filter((t=>{var r,i,a;const o="json.RawMessage"===(null===(r=t.typeInfo)||void 0===r?void 0:r.frame)&&"labels"===t.name&&(null==n||null===(i=n.meta)||void 0===i?void 0:i.type)!==e.DataFrameType.LogLines,s="labels"===t.name&&t.type===e.FieldType.other&&(null==n||null===(a=n.meta)||void 0===a?void 0:a.type)===e.DataFrameType.LogLines;return o||s})).flatMap((e=>[{id:"extractFields",options:{format:"json",keepTime:!1,replace:!1,source:e.name}}]));var n;let r=function(e){let t={};return Object.keys(e).filter((t=>e[t].active)).forEach((n=>{const r=e[n].index;void 0!==r&&(t[n]=r)})),t}(h);const i=function(e){let t={};for(const n in e)t[n]=!0;return Object.keys(e).length>0?{id:"organize",options:{indexByName:e,includeByName:t}}:null}(r);if(i)t.push(i);else{const e={time:s.timeField,body:s.bodyField,extraFields:s.extraFields};e&&void 0!==e.body&&void 0!==e.time&&t.push(function(e){return{id:"organize",options:{indexByName:{[e.time.name]:0,[e.body.name]:1},includeByName:{[e.body.name]:!0,[e.time.name]:!0}}}}(e))}if(t.length>0){const n=yield(0,b.lastValueFrom)((0,e.transformDataFrame)(t,[s.raw])),r=k(n[0]);f(r)}else f(k(s.raw))},function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(e){Ck(a,r,i,o,s,"next",e)}function s(e){Ck(a,r,i,o,s,"throw",e)}o(void 0)}))});return function(){return n.apply(this,arguments)}}();t()}),[s.raw,s.bodyField,s.timeField,s.extraFields,k,h]),(0,t.useEffect)((()=>{_&&x&&O()}),[_,O,x]);const D=s.raw.fields.find((e=>e.name===function(e){var t,n;return null!==(n=null==e||null===(t=e.idField)||void 0===t?void 0:t.name)&&void 0!==n?n:"id"}(s))),T=null==D?void 0:D.values.findIndex((e=>e===(null==_?void 0:_.id))),R=T&&-1!==T?T:void 0;return p?r().createElement("div",{"data-testid":uy,className:d.section},g&&r().createElement(Wt.Drawer,{size:"sm",onClose:()=>{m(!1),v(h)}},r().createElement(tk,null)),r().createElement("div",{className:d.tableWrap},r().createElement(VS,null,r().createElement(NS.ScrollSync,{horizontal:!0,vertical:!1,proportional:!1},r().createElement(Rk,{logsFrame:s,selectedLine:R,data:p,height:i,width:l,onResize:(0,re.debounce)(((e,t)=>{const n=Object.keys(h).filter((e=>h[e].active)).find((t=>t===e));if(n&&t>0){const e=Dk({},w);e[n]=t,S(e)}}),100)}))))):r().createElement(r().Fragment,null)};function Ak(t){if(t.name){const n=t.name.toLowerCase();if("date"===n||"time"===n)return e.FieldType.time}for(let e=0;e<t.values.length;e++){const n=t.values[e];if(null!=n)return Vk(n)}}const jk=()=>({options:{critical:{color:"#705da0",index:0},crit:{color:"#705da0",index:1},error:{color:"#e24d42",index:2},err:{color:"#e24d42",index:3},eror:{color:"#e24d42",index:4},warning:{color:"#FF9900",index:5},warn:{color:"#FF9900",index:6},info:{color:"#7eb26d",index:7},debug:{color:"#1f78c1",index:8},trace:{color:"#6ed0e0",index:9}},type:e.MappingType.ValueToText});function Lk(e,t,n,i){return e.name===DS(i)?{cellComponent:e=>r().createElement(wk,Tk(Dk({},e),{fieldIndex:t,labels:n[e.rowIndex]})),type:Wt.TableCellDisplayMode.Custom}:{cellComponent:e=>r().createElement(fk,Tk(Dk({},e),{fieldIndex:t})),type:Wt.TableCellDisplayMode.Custom}}function $k(t,n,r,i,a,o){var s,l;const c=a<=2?i:Math.min(i/2),u=0===n?50:0;if(t.type===e.FieldType.time)return 200+u;const d=r[t.name];if(void 0===d)return;var p;const f=Math.max(null!==(p=d.maxLength)&&void 0!==p?p:0,t.name.length);return d.maxLength?Math.min(Math.max(6.5*f+95+u,90+u),c):t.name!==DS(o)?Math.min(Math.max(6.5*(null!==(h=null===(l=t.values)||void 0===l||null===(s=l[0])||void 0===s?void 0:s.length)&&void 0!==h?h:80)+95+u,90+u),c):void 0;var h}const Fk=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d{3,})?(?:Z|[-+]\d{2}:?\d{2})$/,Nk=n=>{const{logsFrame:i}=sk(),[a,o]=(0,t.useState)({width:0,height:0});!function(e){const{ref:n,onResize:r}=e;(0,t.useEffect)((()=>{let e=null==n?void 0:n.current;if(e){if(void 0===window.ResizeObserver)return window.addEventListener("resize",r,!1),()=>{window.removeEventListener("resize",r,!1)};{const t=new window.ResizeObserver((e=>{e.length&&r()}));return t.observe(e),()=>{e&&t.unobserve(e)}}}}),[r,n])}({ref:n.panelWrap,onResize:()=>{const e=n.panelWrap.current;e&&(a.width===e.clientWidth&&a.height===e.clientHeight||o({width:e.clientWidth,height:e.clientHeight}))}});const s={section:(0,Ht.css)({position:"relative"})},l=(0,e.getTimeZone)(),c=(0,t.useCallback)((e=>{const t=n.urlColumns;return(null==t?void 0:t.length)&&Object.values(t).forEach(((t,n)=>{e[t]&&(e[t].active=!0,e[t].index=n)})),e}),[n.urlColumns]);if(!i||!i.raw.length)return null;var u;const d=null!==(u=i.getLogFrameLabelsAsLabels())&&void 0!==u?u:[],p=i?i.raw.length:0;let f=function(e,t){let n={};const r=new Map,i=function(e){const t=new Map;return e.forEach((e=>{Object.keys(e).forEach((n=>{if(t.has(n)){const r=t.get(n),i=null==r?void 0:r.valueSet,a=null==r?void 0:r.maxLength;i&&!(null==i?void 0:i.has(e[n]))&&(null==i||i.add(e[n]),a&&e[n].length>a&&t.set(n,{maxLength:e[n].length,valueSet:i}))}else t.set(n,{maxLength:e[n].length,valueSet:new Set([e[n]])})}))})),t}(t),a=e?e.length:0;return(null==t?void 0:t.length)&&a&&(t.forEach((e=>{Object.keys(e).forEach((e=>{var t;const n=i.get(e);var a;const o=null!==(a=null==n||null===(t=n.valueSet)||void 0===t?void 0:t.size)&&void 0!==a?a:0;if(r.has(e)){const t=r.get(e);t&&((null==t?void 0:t.active)?r.set(e,{percentOfLinesWithLabel:t.percentOfLinesWithLabel+1,active:!0,index:t.index,cardinality:o,maxLength:null==n?void 0:n.maxLength}):r.set(e,{percentOfLinesWithLabel:t.percentOfLinesWithLabel+1,active:!1,index:void 0,cardinality:o,maxLength:null==n?void 0:n.maxLength}))}else r.set(e,{percentOfLinesWithLabel:1,active:!1,index:void 0,cardinality:o,maxLength:null==n?void 0:n.maxLength})}))})),n=Object.fromEntries(r),Object.keys(n).forEach((e=>{n[e].percentOfLinesWithLabel=Mk(n[e].percentOfLinesWithLabel,a)}))),n}(i.raw,d);const h={time:i.timeField,body:i.bodyField,extraFields:i.extraFields};if(h){!function(e,t,n){e.forEach((e=>{var r,i;if(!e)return;const a=null===(r=t[e.name])||void 0===r?void 0:r.active,o=null===(i=t[e.name])||void 0===i?void 0:i.index;t[e.name]=a&&void 0!==o?{percentOfLinesWithLabel:Mk(e.values.filter((e=>null!=e)).length,n),active:!0,index:o,cardinality:n}:{percentOfLinesWithLabel:Mk(e.values.filter((e=>null!=e)).length,n),active:!1,index:void 0,cardinality:n}}))}([h.time,h.body,...h.extraFields],f,p),f=c(f);const e=Object.keys(f).filter((e=>f[e].active));!function(e,t,n){var r,i,a,o,s,l,c,u,d,p;0===e.length&&((null===(a=t.body)||void 0===a?void 0:a.name)&&(n[null===(s=t.body)||void 0===s?void 0:s.name].active=!0,n[null===(l=t.body)||void 0===l?void 0:l.name].index=1),(null===(o=t.time)||void 0===o?void 0:o.name)&&(n[null===(c=t.time)||void 0===c?void 0:c.name].active=!0,n[null===(u=t.time)||void 0===u?void 0:u.name].index=0));(null===(r=t.time)||void 0===r?void 0:r.name)&&(null===(i=t.body)||void 0===i?void 0:i.name)&&(n[null===(d=t.body)||void 0===d?void 0:d.name].type="BODY_FIELD",n[null===(p=t.time)||void 0===p?void 0:p.name].type="TIME_FIELD");t.extraFields.length&&t.extraFields.forEach((e=>{var t;(null===(t=e.config.links)||void 0===t?void 0:t.length)&&(n[e.name].type="LINK_FIELD")}))}(e,h,f)}return r().createElement("section",{className:s.section},r().createElement(LS,{logsFrame:i,initialColumns:f,setUrlColumns:n.setUrlColumns,clearSelectedLine:n.clearSelectedLine},r().createElement(Ik,{logsFrame:i,timeZone:l,height:a.height-50,width:a.width-25,labels:d})))},Mk=(e,t)=>Math.ceil(100*e/t);function Vk(t){let n=(0,e.guessFieldTypeFromValue)(t);return"string"===n&&Fk.test(t)&&(n=e.FieldType.time),n}const Bk=({dataFrame:t,setUrlColumns:n,urlColumns:i,addFilter:a,selectedLine:o,timeRange:s,panelWrap:l,clearSelectedLine:c})=>{if(!t)return null;const u=(null===(p=(d=t).meta)||void 0===p?void 0:p.type)===e.DataFrameType.LogLines?function(t){const n=new e.FieldCache(t),r=_S(n,PS,e.FieldType.time),i=_S(n,ES,e.FieldType.string);if(void 0===r||void 0===i)return null;var a;const o=null!==(a=_S(n,"severity",e.FieldType.string))&&void 0!==a?a:null;var s;const l=null!==(s=_S(n,"id",e.FieldType.string))&&void 0!==s?s:null;var c;const u=null!==(c=_S(n,"labels",e.FieldType.other))&&void 0!==c?c:null,d=null===u?null:u.values,p=n.fields.filter(((e,t)=>t!==r.index&&t!==i.index&&t!==(null==o?void 0:o.index)&&t!==(null==l?void 0:l.index)&&t!==(null==u?void 0:u.index)));return{raw:t,timeField:r,bodyField:i,severityField:o,idField:l,getLogFrameLabels:()=>d,timeNanosecondField:null,getLogFrameLabelsAsLabels:()=>null!==d?d.map(CS):null,getLabelFieldName:()=>null!==u?u.name:null,extraFields:p}}(d):function(t){const n=new e.FieldCache(t),r=n.getFirstFieldOfType(e.FieldType.time),i=n.getFirstFieldOfType(e.FieldType.string);if(void 0===r||void 0===i)return null;var a;const o=null!==(a=n.getFieldByName("tsNs"))&&void 0!==a?a:null;var s;const l=null!==(s=n.getFieldByName("level"))&&void 0!==s?s:null;var c;const u=null!==(c=n.getFieldByName("id"))&&void 0!==c?c:null,[d,p]=function(t,n,r){const i=t.getFieldByName("labels");if(void 0!==i&&i.type===e.FieldType.other){const e=i.values.map(CS);return[i,()=>e]}return[null,()=>function(e,t){const n=e.labels;if(void 0!==n){const e=new Array(t);return e.fill(n),e}return null}(n,r.length)]}(n,i,t),f=n.fields.filter(((e,t)=>t!==r.index&&t!==i.index&&t!==(null==o?void 0:o.index)&&t!==(null==l?void 0:l.index)&&t!==(null==u?void 0:u.index)&&t!==(null==d?void 0:d.index)));return{timeField:r,bodyField:i,timeNanosecondField:o,severityField:l,idField:u,getLogFrameLabels:p,getLogFrameLabelsAsLabels:p,getLabelFieldName:()=>{var e;return null!==(e=null==d?void 0:d.name)&&void 0!==e?e:null},extraFields:f,raw:t}}(d);var d,p;return u?r().createElement(ok,{addFilter:a,selectedLine:o,timeRange:s,logsFrame:u},r().createElement(Nk,{setUrlColumns:n,urlColumns:i,panelWrap:l,clearSelectedLine:c})):null};function zk(e){return r().createElement("div",{className:Wk.visualisationType},r().createElement(Wt.RadioButtonGroup,{className:Wk.visualisationTypeRadio,options:[{label:"Logs",value:"logs",description:"Show results in logs visualisation"},{label:"Table",value:"table",description:"Show results in table visualisation"}],size:"sm",value:e.vizType,onChange:e.onChange}))}const Wk={visualisationType:(0,Ht.css)({display:"flex",flex:"1",justifyContent:"space-between",marginTop:"8px"}),visualisationTypeRadio:(0,Ht.css)({margin:"0 0 0 8px"})};class Qk extends Q{}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Qk,"Component",(({model:e})=>{const n=Uk(),i=kl.getAncestor(e,Jk),{data:a}=kl.getData(e).useState(),{selectedLine:o,urlColumns:s,visualizationType:l}=i.useState(),c=kl.getTimeRange(e),{value:u}=c.useState(),d=XD(a),p=(0,t.useRef)(null);return r().createElement("div",{className:n.panelWrapper,ref:p},r().createElement(Wt.PanelChrome,{loadingState:null==a?void 0:a.state,title:"Logs",actions:r().createElement(zk,{vizType:l,onChange:i.setVisualizationType})},d&&r().createElement(Bk,{panelWrap:p,addFilter:e=>{const{key:t,value:n}=e,r=Rw(d?Tw(t,d):Dw.Parsed,t,n);!function(e,t,n){const r="="===e.operator?"include":"exclude";my(e.key,e.value,r,t,n)}(e,i,r)},timeRange:u,selectedLine:o,urlColumns:null!=s?s:[],setUrlColumns:e=>{wy(e,i.state.urlColumns)||i.setState({urlColumns:e})},dataFrame:d,clearSelectedLine:()=>{i.state.selectedLine&&i.clearSelectedLine()}})))}));const Uk=()=>({panelWrapper:(0,Ht.css)({height:"100%"})});function qk(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Hk extends Q{constructor(e){var t,n;super((t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){qk(e,t,n[t])}))}return e}({},e),n=null!=(n={wrapLines:Boolean(gb("wrapLines"))})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t)),qk(this,"handleWrapLinesChange",(e=>{const t=e.target.checked;this.setState({wrapLines:t}),function(e,t){let n=t.toString();"boolean"!=typeof t||t||(n=""),localStorage.setItem(`${hb}.wrapLines`,n)}(0,t),this.getParentScene().setLogsVizOption({wrapLogMessage:t})})),qk(this,"getParentScene",(()=>kl.getAncestor(this,Jk))),qk(this,"clearDisplayedFields",(()=>{this.getParentScene().clearDisplayedFields(),qv(Gv,Xv.service_details.logs_clear_displayed_fields)}))}}qk(Hk,"Component",(function({model:e}){const{wrapLines:t}=e.useState(),{displayedFields:n}=e.getParentScene().useState();return r().createElement(r().Fragment,null,r().createElement(Wt.InlineField,{label:"Wrap lines",transparent:!0,htmlFor:"wrap-lines-switch"},r().createElement(Wt.InlineSwitch,{value:t,onChange:e.handleWrapLinesChange,className:Gk.horizontalInlineSwitch,transparent:!0,id:"wrap-lines-switch"})),n.length>0&&r().createElement(Wt.Tooltip,{content:`Clear displayed fields: ${n.join(", ")}`},r().createElement(Wt.Button,{variant:"secondary",fill:"outline",onClick:e.clearDisplayedFields},"Show original log line")))}));const Gk={input:(0,Ht.css)({width:"100%"}),field:(0,Ht.css)({label:"field",marginBottom:0}),horizontalInlineSwitch:(0,Ht.css)({padding:"0 4px 0 0"})};function Xk(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Yk extends Q{onActivate(){this.state.body||this.setState({body:this.getLogsPanel()})}setLogsVizOption(e={}){this.state.body&&this.state.body.onOptionsChange(e)}getParentScene(){return kl.getAncestor(this,Jk)}getLogsPanel(){const e=this.getParentScene(),t=e.state.visualizationType;return Ng().setTitle("Logs").setOption("showTime",!0).setOption("onClickFilterLabel",this.handleLabelFilterClick).setOption("onClickFilterOutLabel",this.handleLabelFilterOutClick).setOption("isFilterLabelActive",this.handleIsFilterLabelActive).setOption("onClickFilterString",this.handleFilterStringClick).setOption("onClickShowField",this.onClickShowField).setOption("onClickHideField",this.onClickHideField).setOption("displayedFields",e.state.displayedFields).setOption("wrapLogMessage",Boolean(gb("wrapLines"))).setOption("showLogContextToggle",!0).setHeaderActions(r().createElement(zk,{vizType:t,onChange:e.setVisualizationType})).build()}handleLabelFilter(e,t,n,r){if(e===xm)return;const i=Rw(n?Tw(e,n):Dw.Parsed,e,t);my(e,t,r,this,i),qv(Gv,Xv.service_details.logs_detail_filter_applied,{filterType:i,key:e,action:r})}constructor(e){super(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Xk(e,t,n[t])}))}return e}({},e)),Xk(this,"onClickShowField",(e=>{const t=this.getParentScene();if(-1===t.state.displayedFields.indexOf(e)&&this.state.body){const n=[...t.state.displayedFields,e];this.setLogsVizOption({displayedFields:n}),t.setState({displayedFields:n}),vb(this,t.state.displayedFields),qv(Gv,Xv.service_details.logs_toggle_displayed_field)}})),Xk(this,"onClickHideField",(e=>{const t=this.getParentScene();if(t.state.displayedFields.indexOf(e)>=0&&this.state.body){const n=t.state.displayedFields.filter((t=>e!==t));this.setLogsVizOption({displayedFields:n}),t.setState({displayedFields:n}),vb(this,t.state.displayedFields),qv(Gv,Xv.service_details.logs_toggle_displayed_field)}})),Xk(this,"clearDisplayedFields",(()=>{this.state.body&&(this.setLogsVizOption({displayedFields:[]}),vb(this,[]))})),Xk(this,"handleLabelFilterClick",((e,t,n)=>{this.handleLabelFilter(e,t,n,"toggle")})),Xk(this,"handleLabelFilterOutClick",((e,t,n)=>{this.handleLabelFilter(e,t,n,"exclude")})),Xk(this,"handleIsFilterLabelActive",((e,t)=>{const n=$m(Jg,this),r=$m(tm,this),i=$m(am,this),a=n=>n&&n.state.filters.findIndex((n=>"="===n.operator&&n.key===e&&n.value===t))>=0;return a(n)||a(r)||a(i)})),Xk(this,"handleFilterStringClick",(e=>{const t=kl.getAncestor(this,Jk).getLineFilterScene();t&&(t.updateFilter(e,!1),qv(Gv,Xv.service_details.logs_popover_line_filter,{selectionLength:e.length}))})),this.addActivationHandler(this.onActivate.bind(this))}}function Zk(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Xk(Yk,"Component",(({model:e})=>{const{body:t}=e.useState();return t?r().createElement(t.Component,{model:t}):r().createElement(Wt.LoadingPlaceholder,{text:"Loading..."})}));const Kk="grafana.explore.logs.visualisationType";class Jk extends Q{getUrlState(){var e;const t=null!==(e=this.state.urlColumns)&&void 0!==e?e:[],n=this.state.selectedLine,r=this.state.visualizationType;var i,a;const o=null!==(a=null!==(i=this.state.displayedFields)&&void 0!==i?i:bb(this))&&void 0!==a?a:[];return{urlColumns:JSON.stringify(t),selectedLine:JSON.stringify(n),visualizationType:JSON.stringify(r),displayedFields:JSON.stringify(o)}}updateFromUrl(e){const t={};try{if("string"==typeof e.urlColumns){const n=JSON.parse(e.urlColumns);n!==this.state.urlColumns&&(t.urlColumns=n)}if("string"==typeof e.selectedLine){const n=JSON.parse(e.selectedLine);n!==this.state.selectedLine&&(t.selectedLine=n)}if("string"==typeof e.visualizationType){const n=JSON.parse(e.visualizationType);n!==this.state.visualizationType&&(t.visualizationType=n)}if("string"==typeof e.displayedFields){const n=JSON.parse(e.displayedFields);n&&n.length&&(t.displayedFields=n)}}catch(e){Gg.error(e,{msg:"LogsListScene: updateFromUrl unexpected error"})}Object.keys(t).length&&this.setState(t)}clearSelectedLine(){this.setState({selectedLine:void 0})}onActivate(){const e=new URLSearchParams(a.locationService.getLocation().search);this.setStateFromUrl(e),this.state.panel||this.updateLogsPanel(),this._subs.add(this.subscribeToState(((e,t)=>{e.visualizationType!==t.visualizationType&&this.updateLogsPanel()})))}getLineFilterScene(){return this.lineFilterScene}setStateFromUrl(e){const t=e.get("selectedLine"),n=e.get("urlColumns"),r=e.get("visualizationType");var i;const a=null!==(i=e.get("displayedFields"))&&void 0!==i?i:JSON.stringify(bb(this));this.updateFromUrl({selectedLine:t,urlColumns:n,vizType:r,displayedFields:a})}getVizPanel(){return this.lineFilterScene=new SS,this.logsPanelScene=new Yk({}),new gh({direction:"column",children:"logs"===this.state.visualizationType?[new gh({children:[new mh({body:this.lineFilterScene,xSizing:"fill"}),new Hk]}),new mh({height:"calc(100vh - 220px)",body:this.logsPanelScene})]:[new mh({body:this.lineFilterScene,xSizing:"fill"}),new mh({height:"calc(100vh - 220px)",body:new Qk({})})]})}constructor(e){var t,n,r;super((n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Zk(e,t,n[t])}))}return e}({},e),r=null!=(r={visualizationType:null!==(t=localStorage.getItem(Kk))&&void 0!==t?t:"logs",displayedFields:[]})?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(r)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))})),n)),Zk(this,"_urlSync",new be(this,{keys:["urlColumns","selectedLine","visualizationType","displayedFields"]})),Zk(this,"lineFilterScene",void 0),Zk(this,"logsPanelScene",void 0),Zk(this,"clearDisplayedFields",(()=>{this.setState({displayedFields:[]}),this.logsPanelScene&&this.logsPanelScene.clearDisplayedFields()})),Zk(this,"setLogsVizOption",((e={})=>{this.logsPanelScene&&this.logsPanelScene.setLogsVizOption(e)})),Zk(this,"updateLogsPanel",(()=>{this.setState({panel:this.getVizPanel()})})),Zk(this,"setVisualizationType",(e=>{this.setState({visualizationType:e}),qv(Gv,Xv.service_details.logs_visualization_toggle,{visualisationType:e}),localStorage.setItem(Kk,e)})),this.addActivationHandler(this.onActivate.bind(this))}}Zk(Jk,"Component",(({model:e})=>{const{panel:t}=e.useState();if(t)return r().createElement("div",{className:eD.panelWrapper},r().createElement(t.Component,{model:t}))}));const eD={panelWrapper:(0,Ht.css)({".show-on-hover":{display:"none"},'section > div[class$="panel-content"]':(0,Ht.css)({contain:"none",overflow:"auto"})})};function tD(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nD(e){var t,n;const{indexScene:r,pattern:i,type:a}=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){tD(e,t,n[t])}))}return e}({},e),o=kl.getAncestor(r,FT);if(!o)return void Gg.warn("logs exploration scene not found");const{patterns:s=[]}=o.state,l=s.filter((e=>e.pattern!==i));var c;const u=null!==(c=null===(t=l.filter((e=>"include"===e.type)))||void 0===t?void 0:t.length)&&void 0!==c?c:0;var d;const p=null!==(d=null===(n=l.filter((e=>"exclude"===e.type)))||void 0===n?void 0:n.length)&&void 0!==d?d:0;qv(Gv,Xv.service_details.pattern_selected,{type:a,includePatternsLength:u+("include"===a?1:0),excludePatternsLength:p+("exclude"===a?1:0)}),"undo"===a?o.setState({patterns:l}):o.setState({patterns:[...l,{pattern:i,type:a}]})}const rD=e=>({logsStatsRow:(0,Ht.css)({margin:`${e.spacing(1.15)}px 0`}),logsStatsRowActive:(0,Ht.css)({color:e.colors.primary.text,position:"relative"}),logsStatsRowLabel:(0,Ht.css)({display:"flex",marginBottom:"1px"}),logsStatsRowValue:(0,Ht.css)({flex:1,textOverflow:"ellipsis",overflow:"hidden"}),logsStatsRowCount:(0,Ht.css)({textAlign:"right",marginLeft:e.spacing(.75)}),logsStatsRowPercent:(0,Ht.css)({textAlign:"right",marginLeft:e.spacing(.75),width:e.spacing(4.5)}),logsStatsRowBar:(0,Ht.css)({height:e.spacing(.5),overflow:"hidden",background:e.colors.text.disabled}),logsStatsRowInnerBar:(0,Ht.css)({height:e.spacing(.5),overflow:"hidden",background:e.colors.primary.main})}),iD=({active:e,count:t,proportion:n,value:i})=>{const a=(0,Wt.useStyles2)(rD),o=`${Math.round(100*n)}%`,s={width:o};return r().createElement("div",{className:e?`${a.logsStatsRow} ${a.logsStatsRowActive}`:a.logsStatsRow},r().createElement("div",{className:a.logsStatsRowLabel},r().createElement("div",{className:a.logsStatsRowValue,title:i},i),r().createElement("div",{className:a.logsStatsRowCount},t),r().createElement("div",{className:a.logsStatsRowPercent},o)),r().createElement("div",{className:a.logsStatsRowBar},r().createElement("div",{className:a.logsStatsRowInnerBar,style:s})))};function aD(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const oD=e=>({logsStats:(0,Ht.css)({background:"inherit",color:e.colors.text.primary,wordBreak:"break-all",width:"fit-content",maxHeight:"40vh",overflowY:"auto",marginTop:e.spacing(1)}),logsStatsHeader:(0,Ht.css)({borderBottom:`1px solid ${e.colors.border.medium}`,display:"flex"}),logsStatsTitle:(0,Ht.css)({fontWeight:e.typography.fontWeightMedium,paddingRight:e.spacing(2),display:"inline-block",whiteSpace:"nowrap",textOverflow:"ellipsis",flexGrow:1}),logsStatsClose:(0,Ht.css)({cursor:"pointer"}),logsStatsBody:(0,Ht.css)({padding:"5px 0px"})}),sD=e=>{const t=(0,Wt.useStyles2)(oD),{stats:n,value:i}=e,a=n.slice(0,10);let o=a.find((e=>e.value===i)),s=n.slice(10);!o&&(o=s.find((e=>e.value===i)),s=s.filter((e=>e.value!==i)));const l=s.reduce(((e,t)=>e+t.count),0),c=a.reduce(((e,t)=>e+t.count),0)+l;let u=[...a];return l>0&&u.push({value:"Other",count:l,proportion:l/c}),u.sort(((e,t)=>t.count-e.count)),r().createElement("div",{className:t.logsStats},r().createElement("div",{className:t.logsStatsHeader},r().createElement("div",{className:t.logsStatsTitle},"From a sample of ",c," rows found")),r().createElement("div",{className:t.logsStatsBody},u.map((e=>{return r().createElement(iD,(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){aD(e,t,n[t])}))}return e}({key:e.value},e),n=null!=(n={active:e.value===i})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t));var t,n}))))};function lD(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}const cD=({exploration:n,pattern:i})=>{const a=function(e){const t=[];let n=e.indexOf("<_>");for(;-1!==n;)t.push(n),n=e.indexOf("<_>",n+1);return t}(i),[o,s]=(0,t.useState)(void 0),[l,c]=(0,t.useState)(!1),u=(0,Wt.useStyles2)(uD),d=(0,t.useRef)(null),p=(0,t.useRef)(null),f=function(){var t,r=(t=function*(){qv(Gv,Xv.service_details.pattern_field_clicked);const t=function(e,t,n){let r=1;const i=e.replace(/<_>/g,(()=>`<field_${r++}>`)),a=n.state.filterExpression,o=t.map(((e,t)=>`field_${t+1}`)).join(" ,");return`{${a}} |> \`${e}\` | pattern \`${i}\` | keep ${o} | line_format ""`}(i,a,km(n)),r=yield function(e){return xb.apply(this,arguments)}(n),l=kl.getTimeRange(n).state.value;o&&t===d.current&&l===p.current||(d.current=t,p.current=l,null==r||r.query({requestId:"1",interval:"",intervalMs:0,scopedVars:{},range:l,targets:[jO(t,{maxLines:1e3})],timezone:"",app:"",startTime:0}).forEach((t=>{var n,r;t.state!==e.LoadingState.Done||(null===(n=t.errors)||void 0===n?void 0:n.length)?(t.state===e.LoadingState.Error||(null===(r=t.errors)||void 0===r?void 0:r.length))&&(s(void 0),c(!0)):(s(function(e,t){const n=new Map;e.data[0].fields[0].values.toArray().forEach((e=>{Object.keys(e).forEach((t=>{var r,i;n.has(t)||n.set(t,new Map),null===(i=n.get(t))||void 0===i||i.set(e[t],((null===(r=n.get(t))||void 0===r?void 0:r.get(e[t]))||0)+1)}))}));const r=[];for(let e=0;e<=t;e++){var i;const t=[];null===(i=n.get(`field_${e+1}`))||void 0===i||i.forEach(((e,n)=>{t.push({value:n,count:e,proportion:e/1e3})})),t.sort(((e,t)=>t.count-e.count)),r.push(t)}return r}(t,a.length)),c(!1))})))},function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(e){lD(a,r,i,o,s,"next",e)}function s(e){lD(a,r,i,o,s,"throw",e)}o(void 0)}))});return function(){return r.apply(this,arguments)}}(),h=(0,t.useMemo)((()=>i.split("<_>")),[i]);return r().createElement("div",null,h.map(((e,t)=>r().createElement("span",{key:t},e,t!==a.length&&r().createElement(Wt.Toggletip,{onOpen:f,content:r().createElement(r().Fragment,null,o&&o[t].length>0&&r().createElement(sD,{stats:o[t],value:""}),o&&0===o[t].length&&r().createElement("div",null,"No available stats for this field in the current timestamp."),!o&&l&&r().createElement("div",null,"Could not load stats for this pattern."),!o&&!l&&r().createElement("div",{style:{padding:"10px"}},r().createElement(Wt.Spinner,{size:"xl"})))},r().createElement("span",{className:u.pattern},"<_>"))))))};function uD(e){return{pattern:(0,Ht.css)({cursor:"pointer",backgroundColor:e.colors.emphasize(e.colors.background.primary,.1),margin:"0 2px","&:hover":{backgroundColor:e.colors.emphasize(e.colors.background.primary,.2)}})}}function dD(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class pD extends Q{onActivate(){if(this.state.body)return;const e=jO(vm);this.replacePatternsInQuery(e);const t=mS([e]);t.getResultsStream().subscribe((e=>{this.onQueryWithFiltersResult(e)})),this.setState({body:new gh({direction:"column",children:[new mh({body:void 0,width:"100%",height:0}),new mh({height:300,width:"100%",body:Ng().setHoverHeader(!0).setOption("showLogContextToggle",!0).setOption("showTime",!0).setData(t).build()})]})})}replacePatternsInQuery(e){const t=zO([{pattern:this.state.pattern,type:"include"}]);e.expr=e.expr.replace(im,t)}removePatternFromFilterExclusion(){const e=kl.getAncestor(this,gD);var t;const n=null!==(t=e.state.patternsNotMatchingFilters)&&void 0!==t?t:[],r=n.findIndex((e=>e===this.state.pattern));-1!==r&&(n.splice(r,1),e.setState({patternsNotMatchingFilters:n}))}setWarningMessage(e){const t=this.getNoticeFlexItem(),n=this.getVizFlexItem();return t instanceof mh&&t.setState({isHidden:!1,height:"auto",body:new Uh({reactNode:e})}),n}getNoticeFlexItem(){const e=this.getFlexItemChildren();return null==e?void 0:e[0]}getVizFlexItem(){const e=this.getFlexItemChildren();return null==e?void 0:e[1]}getFlexItemChildren(){var e;return null===(e=this.state.body)||void 0===e?void 0:e.state.children}excludeThisPatternFromFiltering(){const e=kl.getAncestor(this,gD);var t;const n=null!==(t=e.state.patternsNotMatchingFilters)&&void 0!==t?t:[];e.setState({patternsNotMatchingFilters:[...n,this.state.pattern]})}static Component({model:e}){const{body:t}=e.useState();return t?r().createElement(t.Component,{model:t}):null}constructor(t){super(t),dD(this,"clearFilters",(()=>{const e=Dm(this),t=Rm(this),n=Tm(this);if(e.setState({filters:[]}),n.setState({filters:[]}),t.state.value){t.changeValueTo("");const e=this.getNoticeFlexItem();null==e||e.setState({isHidden:!0}),this.removePatternFromFilterExclusion()}})),dD(this,"onQueryError",(t=>{if(t.data.state===e.LoadingState.Done&&(0===t.data.series.length||t.data.series.every((e=>0===e.length)))||t.data.state===e.LoadingState.Error){let e;try{e={pattern:this.state.pattern,traceIds:JSON.stringify(t.data.traceIds),request:JSON.stringify(t.data.request)}}catch(t){e={pattern:this.state.pattern,msg:"Failed to encode context"}}Gg.error(new Error("Pattern sample query returns no results"),e),this.setWarningMessage(r().createElement(Wt.Alert,{severity:"error",title:""},"This pattern returns no logs."));const n=this.getVizFlexItem();n instanceof mh&&n.setState({isHidden:!0})}})),dD(this,"onQueryWithFiltersResult",(t=>{const n=jO(ym);this.replacePatternsInQuery(n);const i=mS([n]);if(i.getResultsStream().subscribe(this.onQueryError),t.data.state===e.LoadingState.Done&&(0===t.data.series.length||t.data.series.every((e=>0===e.length)))){const e=this.getNoticeFlexItem(),t=this.getVizFlexItem();if(e instanceof mh&&e.setState({isHidden:!1,height:"auto",body:new Uh({reactNode:r().createElement(Wt.Alert,{severity:"warning",title:""},"The logs returned by this pattern do not match the current query filters.",r().createElement(Wt.Button,{className:Sw.button,onClick:()=>this.clearFilters()},"Clear filters"))})}),t instanceof mh){const e=t.state.body;e instanceof $c&&(null==e||e.setState({$data:i}))}this.excludeThisPatternFromFiltering()}t.data.state===e.LoadingState.Error&&this.onQueryError(t)})),this.addActivationHandler(this.onActivate.bind(this))}}function fD({tableViz:e,row:n}){const{expandedRows:i}=e.useState(),a=null==i?void 0:i.find((e=>e.state.key===n.pattern));return(0,t.useEffect)((()=>{if(!a){const i=(r=n.pattern,new pD({pattern:r,key:r}));var t;e.setState({expandedRows:[...null!==(t=e.state.expandedRows)&&void 0!==t?t:[],i]})}var r}),[n,e,a]),a?r().createElement(a.Component,{model:a}):null}const hD=[""," K"," Mil"," Bil"," Tri"," Quadr"," Quint"," Sext"," Sept"];class gD extends Q{buildColumns(t,n,i,a){const o=yD(i),s=kl.getTimeRange(this).state.value,l=[{id:"volume-samples",header:"",cell:t=>{const n={timeRange:s,series:[t.cell.row.original.dataFrame],state:e.LoadingState.Done},i=new ge({data:n}),a=Mg().setData(i).setHoverHeader(!0).setOption("tooltip",{mode:Wt.TooltipDisplayMode.None}).setCustomFieldConfig("hideFrom",{legend:!0,tooltip:!0}).setCustomFieldConfig("axisPlacement",Wt.AxisPlacement.Hidden).setDisplayMode("transparent").build();return r().createElement("div",{className:o.tableTimeSeriesWrap},r().createElement("div",{className:o.tableTimeSeries},r().createElement(a.Component,{model:a})))}},{id:"count",header:"Count",sortType:"number",cell:t=>{const n=(0,e.scaledUnits)(1e3,hD)(t.cell.row.original.sum);var i,a;return r().createElement("div",{className:o.countTextWrap},r().createElement("div",null,null!==(i=n.prefix)&&void 0!==i?i:"",n.text,null!==(a=n.suffix)&&void 0!==a?a:""))}},{id:"percent",header:"%",sortType:"number",cell:e=>r().createElement("div",{className:o.countTextWrap},r().createElement("div",null,(100*e.cell.row.original.sum/t).toFixed(0),"%"))},{id:"pattern",header:"Pattern",cell:e=>r().createElement("div",{className:(0,Ht.cx)(bD(),o.tablePatternTextDefault)},r().createElement(cD,{exploration:Ob(this),pattern:e.cell.row.original.pattern}))},{id:"include",header:void 0,disableGrow:!0,cell:e=>{if(null==a?void 0:a.includes(e.cell.row.original.pattern))return;const t=null==n?void 0:n.find((t=>t.pattern===e.cell.row.original.pattern)),i="include"===(null==t?void 0:t.type),o="exclude"===(null==t?void 0:t.type);return r().createElement(py,{isExcluded:o,isIncluded:i,onInclude:()=>e.cell.row.original.includeLink(),onExclude:()=>e.cell.row.original.excludeLink(),onClear:()=>e.cell.row.original.undoLink(),buttonFill:"outline"})}}];return l}buildTableData(e,t){const n=kl.getAncestor(this,FT);return e.filter((e=>!t.size||t.has(e.pattern))).map((e=>({dataFrame:e.dataFrame,pattern:e.pattern,sum:e.sum,includeLink:()=>nD({pattern:e.pattern,type:"include",indexScene:n}),excludeLink:()=>nD({pattern:e.pattern,type:"exclude",indexScene:n}),undoLink:()=>nD({pattern:e.pattern,type:"undo",indexScene:n})})))}constructor(e){super(e)}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(gD,"Component",(function({model:e}){const t=kl.getAncestor(e,FT),{patterns:n}=t.useState(),i=(0,Wt.useTheme2)(),a=vD(i),o=kl.getAncestor(e,_D),{legendSyncPatterns:s}=o.useState(),{patternFrames:l,patternsNotMatchingFilters:c}=e.useState(),u=null!=l?l:[],d=u.reduce(((e,t)=>e+t.sum),0),p=e.buildTableData(u,s),f=e.buildColumns(d,n,i,c);return r().createElement("div",{"data-testid":sy,className:a.tableWrap},r().createElement(Wt.InteractiveTable,{columns:f,data:p,getRowId:e=>e.pattern,renderExpandedRow:t=>r().createElement(fD,{tableViz:e,row:t})}))}));const mD=a.config.theme2,bD=()=>(0,Ht.css)({minWidth:"200px",fontFamily:mD.typography.fontFamilyMonospace,overflow:"hidden",overflowWrap:"break-word"}),vD=e=>({link:(0,Ht.css)({textDecoration:"underline"}),tableWrap:(0,Ht.css)({"> div":{height:"calc(100vh - 450px)",minHeight:"470px"},th:{top:0,position:"sticky",backgroundColor:e.colors.background.canvas,zIndex:e.zIndex.navbarFixed}})}),yD=e=>({tablePatternTextDefault:(0,Ht.css)({fontFamily:e.typography.fontFamilyMonospace,minWidth:"200px",maxWidth:"100%",overflow:"hidden",overflowWrap:"break-word",fontSize:e.typography.bodySmall.fontSize,wordBreak:"break-word"}),countTextWrap:(0,Ht.css)({textAlign:"right",fontSize:e.typography.bodySmall.fontSize}),tableTimeSeriesWrap:(0,Ht.css)({width:"230px",pointerEvents:"none"}),tableTimeSeries:(0,Ht.css)({height:"30px",overflow:"hidden"})});function OD(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function wD(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){OD(a,r,i,o,s,"next",e)}function s(e){OD(a,r,i,o,s,"throw",e)}o(void 0)}))}}function SD(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const xD=a.config.theme2.visualization.palette;class _D extends Q{onActivate(){this.updateBody(),this._subs.add(kl.getAncestor(this,eT).subscribeToState(((e,t)=>{var n,r,i,a,o,s;const l=null==e||null===(i=e.$patternsData)||void 0===i||null===(r=i.state)||void 0===r||null===(n=r.data)||void 0===n?void 0:n.series,c=null==t||null===(s=t.$patternsData)||void 0===s||null===(o=s.state)||void 0===o||null===(a=o.data)||void 0===a?void 0:a.series;if(!wy(l,c)){const e=kl.getAncestor(this,AD);this.updatePatterns(e.state.patternFrames),e.setState({filteredPatterns:void 0})}}))),this._subs.add(kl.getAncestor(this,AD).subscribeToState(((e,t)=>{const n=kl.getAncestor(this,AD);e.filteredPatterns&&!wy(e.filteredPatterns,t.filteredPatterns)?this.updatePatterns(n.state.filteredPatterns):n.state.patternFilter||this.updatePatterns(n.state.patternFrames)})))}updatePatterns(e=[]){var t=this;return wD((function*(){var n;null===(n=t.state.body)||void 0===n||n.forEachChild((n=>{n instanceof $c&&n.setState({$data:t.getTimeseriesDataNode(e)}),n instanceof gD&&n.setState({patternFrames:e})}))}))()}updateBody(){var e=this;return wD((function*(){var t,n;const r=kl.getAncestor(e,AD).state.patternFrames;(null===(n=kl.getAncestor(e,eT).state.$patternsData)||void 0===n||null===(t=n.state.data)||void 0===t?void 0:t.series)&&r?e.setState({body:e.getSingleViewLayout(),legendSyncPatterns:new Set,loading:!1}):Gg.warn("Failed to update PatternsFrameScene body")}))()}extendTimeSeriesLegendBus(e,t){const n=t.onToggleSeriesVisibility;t.onToggleSeriesVisibility=(t,r)=>{var i;null==n||n(t,r);const a=null===(i=e.state.fieldConfig.overrides)||void 0===i?void 0:i[0],o=null==a?void 0:a.matcher.options.names,s=new Set;o&&o.forEach(s.add,s),this.setState({legendSyncPatterns:s})}}getSingleViewLayout(){const e=kl.getAncestor(this,AD).state.patternFrames;if(!e)return void Gg.warn("Failed to set getSingleViewLayout");const t=this.getTimeSeries(e);return new xh({templateColumns:"100%",autoRows:"200px",isLazy:!0,children:[t,new gD({patternFrames:e})]})}getTimeSeries(e){const t=kl.getAncestor(this,FT),n=Mg().setData(this.getTimeseriesDataNode(e)).setOption("legend",{asTable:!0,showLegend:!0,displayMode:Wt.LegendDisplayMode.Table,placement:"right",width:200}).setHoverHeader(!0).setUnit("short").setLinks([{url:"#",targetBlank:!1,onClick:e=>{nD({pattern:e.origin.name,type:"include",indexScene:t})},title:"Include"},{url:"#",targetBlank:!1,onClick:e=>{nD({pattern:e.origin.name,type:"exclude",indexScene:t})},title:"Exclude"}]).build();return n.setState({extendPanelContext:(e,t)=>this.extendTimeSeriesLegendBus(e,t)}),n}getTimeseriesDataNode(t){const n=kl.getTimeRange(this).state.value;return new ge({data:{series:t.map(((e,t)=>{const n=e.dataFrame;return n.fields[1].config.color=function(e){return{mode:"fixed",fixedColor:xD[e]}}(t),n.fields[1].name="",n})),state:e.LoadingState.Done,timeRange:n}})}constructor(e){var t,n;super((t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){SD(e,t,n[t])}))}return e}({loading:!0},e),n=null!=(n={legendSyncPatterns:new Set})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t)),this.addActivationHandler(this.onActivate.bind(this))}}SD(_D,"Component",(({model:e})=>{var t;const{body:n,loading:i}=e.useState(),a=kl.getAncestor(e,eT),{$patternsData:o}=a.useState(),s=null==o||null===(t=o.state.data)||void 0===t?void 0:t.series;return r().createElement("div",{className:PD.container},!i&&s&&s.length>0&&r().createElement(r().Fragment,null,n&&r().createElement(n.Component,{model:n})))}));const PD={container:(0,Ht.css)({width:"100%",".show-on-hover":{display:"none"}})};function ED(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class CD extends Q{onActivate(){const e=kl.getAncestor(this,AD);this._subs.add(e.subscribeToState(((e,t)=>{if(e.patternFilter!==t.patternFilter){const e=kl.getAncestor(this,AD);e.state.patternFrames&&cO(e.state.patternFrames.map((e=>e.pattern)),e.state.patternFilter,this.onSearchResult)}}))),this._subs.add(e.subscribeToState(((e,t)=>{e.patternFilter&&!e.filteredPatterns&&e.patternFrames&&!wy(e.filteredPatterns,t.filteredPatterns)&&lO(e.patternFrames.map((e=>e.pattern)),e.patternFilter,this.onSearchResult)})))}setFilteredPatterns(e,t){const n=kl.getAncestor(this,AD),r=null!=t?t:n.state.patternFrames;if(r){const t=r.filter((t=>!(!n.state.patternFilter||!(null==r?void 0:r.length))&&e.find((e=>e===t.pattern))));n.setState({filteredPatterns:t})}}setEmptySearch(){kl.getAncestor(this,AD).setState({filteredPatterns:void 0})}constructor(e){super(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){ED(e,t,n[t])}))}return e}({},e)),ED(this,"clearSearch",(()=>{kl.getAncestor(this,AD).setState({patternFilter:""})})),ED(this,"handleSearchChange",(e=>{kl.getAncestor(this,AD).setState({patternFilter:e.target.value})})),ED(this,"onSearchResult",(e=>{const t=kl.getAncestor(this,AD);t.state.patternFilter?this.setFilteredPatterns(e[0]):t.state.filteredPatterns&&!t.state.patternFilter&&this.setEmptySearch()})),this.addActivationHandler(this.onActivate.bind(this))}}ED(CD,"Component",(function({model:e}){const t=kl.getAncestor(e,AD),{patternFilter:n}=t.useState();return r().createElement(Wt.Field,{className:kD.field},r().createElement(OO,{onChange:e.handleSearchChange,onClear:e.clearSearch,value:n,placeholder:"Search patterns"}))}));const kD={field:(0,Ht.css)({label:"field",marginBottom:0}),icon:(0,Ht.css)({cursor:"pointer"})};function DD(){return r().createElement(oO,null,r().createElement("div",null,r().createElement("p",null,r().createElement("strong",null,"Sorry, we could not detect any patterns.")),r().createElement("p",null,"Check back later or reach out to the team in the"," ",r().createElement(Wt.TextLink,{href:"https://slack.grafana.com/",external:!0},"Grafana Labs community Slack channel")),r().createElement("p",null,"Patterns let you detect similar log lines to include or exclude from your search.")))}function TD(){return r().createElement(oO,null,r().createElement("div",null,r().createElement("p",null,r().createElement("strong",null,"Patterns are only available for the most recent ",ID," hours of data.")),r().createElement("p",null,"See the"," ",r().createElement(Wt.TextLink,{href:"https://grafana.com/docs/grafana/latest/explore/simplified-exploration/logs/patterns/",external:!0},"patterns docs")," ","for more info.")))}function RD(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ID=3;class AD extends Q{onActivate(){var e,t,n;const r=kl.getAncestor(this,eT);this.setBody();const i=null===(t=r.state.$patternsData)||void 0===t||null===(e=t.state.data)||void 0===e?void 0:e.series;i&&this.updatePatternFrames(i),this._subs.add(null===(n=r.state.$patternsData)||void 0===n?void 0:n.subscribeToState(this.onDataChange))}setBody(){this.setState({body:new gh({direction:"column",children:[new mh({ySizing:"content",body:new CD}),new mh({body:new _D})]})})}updatePatternFrames(e){if(!e)return;const t=this.dataFrameToPatternFrame(e);this.setState({patternFrames:t,loading:!1})}dataFrameToPatternFrame(e){const t=kl.getAncestor(this,eT),n=kl.getAncestor(t,FT).state.patterns;return e.map((e=>{var t,r;const i=null==n?void 0:n.find((t=>t.pattern===e.name)),a=null===(r=e.meta)||void 0===r||null===(t=r.custom)||void 0===t?void 0:t.sum;var o;return{dataFrame:e,pattern:null!==(o=e.name)&&void 0!==o?o:"",sum:a,status:null==i?void 0:i.type}}))}constructor(e){var t;super(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){RD(e,t,n[t])}))}return e}({$variables:null!==(t=e.$variables)&&void 0!==t?t:new Wd({variables:[new Zd({name:lm,defaultToAll:!0,includeAll:!0})]}),loading:!0,patternFilter:""},e)),RD(this,"onDataChange",((e,t)=>{var n,r;const i=null===(n=e.data)||void 0===n?void 0:n.series,a=null===(r=t.data)||void 0===r?void 0:r.series;wy(i,a)&&!this.state.loading||this.updatePatternFrames(i)})),this.addActivationHandler(this.onActivate.bind(this))}}function jD(e){return{container:(0,Ht.css)({flexGrow:1,display:"flex",minHeight:"100%",flexDirection:"column"}),content:(0,Ht.css)({flexGrow:1,display:"flex",paddingTop:e.spacing(0)}),controls:(0,Ht.css)({flexGrow:0,display:"flex",alignItems:"top",gap:e.spacing(2)}),controlsRight:(0,Ht.css)({flexGrow:0,display:"flex",justifyContent:"flex-end"}),controlsLeft:(0,Ht.css)({display:"flex",justifyContent:"flex-left",justifyItems:"left",width:"100%",flexDirection:"column"}),patternMissingText:(0,Ht.css)({padding:e.spacing(2)})}}function LD(e,t,n=!0){const r=km(e),i=Dm(e);let a,o="";n&&(t!==Sm?a={key:t,operator:"!=",value:""}:o=`| ${Sm} != ""`);const s=$O([...r.state.filters,a].filter(_b)),l=i.state.filters,c=Iw(i);if(l.length){if("mixed"===c)return`sum(count_over_time({${s}} ${o} ${bm} ${im} ${pm} ${nm} [$__auto])) by (${t})`;if("json"===c)return`sum(count_over_time({${s}} ${o} ${bm} ${im} ${fm} ${nm} [$__auto])) by (${t})`;if("logfmt"===c)return`sum(count_over_time({${s}} ${o} ${bm} ${im} ${hm} ${nm} [$__auto])) by (${t})`}return`sum(count_over_time({${s}} ${o} ${bm} ${im} [$__auto])) by (${t})`}function $D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}RD(AD,"Component",(({model:t})=>{const{body:n,loading:i,blockingMessage:a,patternFrames:o}=t.useState(),{value:s}=kl.getTimeRange(t).useState(),l=(0,Wt.useStyles2)(jD),c=(0,e.dateTime)().diff(s.to,"hours")>=ID;return r().createElement("div",{className:l.container},r().createElement(EO,{isLoading:i,blockingMessage:a},!i&&!o&&r().createElement("div",{className:l.patternMissingText},r().createElement(Wt.Text,{textAlignment:"center",color:"primary"},r().createElement("p",null,"There are no pattern matches."),r().createElement("p",null,"Pattern matching has not been configured."),r().createElement("p",null,"Patterns let you detect similar log lines and add or exclude them from your search."),r().createElement("p",null,"To see them in action, add the following to your configuration"),r().createElement("p",null,r().createElement("code",null,"--pattern-ingester.enabled=true")))),!i&&0===(null==o?void 0:o.length)&&c&&r().createElement(TD,null),!i&&0===(null==o?void 0:o.length)&&!c&&r().createElement(DD,null),!i&&o&&o.length>0&&r().createElement("div",{className:l.content},n&&r().createElement(n.Component,{model:n}))))}));class FD extends Q{onActivate(){this.state.panel||this.setState({panel:this.getVizPanel()});const e=km(this),t=Dm(this);e.subscribeToState((()=>{this.setState({panel:this.getVizPanel()})})),t.subscribeToState((()=>{this.setState({panel:this.getVizPanel()})}))}getVizPanel(){var t;const n=Mg().setTitle("Log volume").setOption("legend",{showLegend:!0,calcs:["sum"],displayMode:Wt.LegendDisplayMode.List}).setUnit("short").setData(mS([jO(LD(this,Sm,!1),{legendFormat:`{{${Sm}}}`})]));dS(n);const r=n.build();return r.setState({extendPanelContext:(e,t)=>this.extendTimeSeriesLegendBus(t)}),this._subs.add(null===(t=r.state.$data)||void 0===t?void 0:t.subscribeToState((t=>{var n;(null===(n=t.data)||void 0===n?void 0:n.state)===e.LoadingState.Done&&fS(r,t.data.series,this)}))),r}constructor(e){super(e),$D(this,"extendTimeSeriesLegendBus",(e=>{const t=Tm(this);this._subs.add(null==t?void 0:t.subscribeToState((()=>{var e,t,n,r;const i=this.state.panel;(null==i||null===(t=i.state.$data)||void 0===t||null===(e=t.state.data)||void 0===e?void 0:e.series)&&fS(i,null==i||null===(r=i.state.$data)||void 0===r||null===(n=r.state.data)||void 0===n?void 0:n.series,this)}))),e.onToggleSeriesVisibility=(e,t)=>{if(t===Wt.SeriesVisibilityChangeMode.AppendToSelection)return;const n=function(e,t){const n=Tm(t),r=0===n.state.filters.length,i=n.state.filters.find((t=>t.value===e&&t.operator===Pb.Equal));let a;var o,s,l;return"logs"===e&&(e='""'),r||!i?(s=e,$m(by(o=Sm,vy(o,l=t)),l).setState({filters:[{key:o,operator:Pb.Equal,value:s}],hide:Uv.hideLabel}),a="add"):(my(Sm,e,"toggle",t),a="remove"),a}(e,this);qv(Gv,Xv.service_details.level_in_logs_volume_clicked,{level:e,action:n})}})),this.addActivationHandler(this.onActivate.bind(this))}}var ND;$D(FD,"Component",(({model:e})=>{const{panel:t}=e.useState();if(t)return r().createElement(t.Component,{model:t})})),function(e){e.logs="Logs",e.labels="Labels",e.fields="Fields",e.patterns="Patterns"}(ND||(ND={}));const MD=[{displayName:"Logs",value:Um.logs,getScene:()=>new gh({direction:"column",children:[new mh({minHeight:200,body:new FD({})}),new mh({minHeight:"470px",height:"calc(100vh - 500px)",body:new Jk({})})]}),testId:ty},{displayName:"Labels",value:Um.labels,getScene:()=>new gh({children:[new mh({body:new dw({})})]}),testId:ry},{displayName:"Fields",value:Um.fields,getScene:e=>new gh({children:[new mh({body:new ww({changeFieldCount:e})})]}),testId:ny},{displayName:"Patterns",value:Um.patterns,getScene:()=>new gh({children:[new mh({body:new AD({})})]}),testId:ey}],VD=[{displayName:"Label",value:qm.label,getScene:e=>function(e){return new gh({children:[new mh({body:new dw({value:e})})]})}(e),testId:ry},{displayName:"Field",value:qm.field,getScene:e=>function(e){return new gh({children:[new mh({body:new ww({value:e})})]})}(e),testId:ny}];function BD(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zD(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){BD(e,t,n[t])}))}return e}class WD extends Q{}BD(WD,"Component",(({model:e})=>{const t=(0,Wt.useStyles2)(UD),n=Ob(e);let i=tb(),a=!1;if(!Object.values(Um).includes(i)){const e=nb();a=!0,e===qm.field&&(i=Um.fields),e===qm.label&&(i=Um.labels)}const o=kl.getAncestor(e,eT).useState(),{loading:s,$data:l}=o,c=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(o,["loading","$data"]),u=c.loadingStates;return r().createElement(Wt.Box,{paddingY:0},r().createElement("div",{className:t.actions},r().createElement(Wt.Stack,{gap:1},r().createElement(vS,{exploration:n}))),r().createElement(Wt.TabsBar,null,MD.map(((t,n)=>{return r().createElement(Wt.Tab,{"data-testid":t.testId,key:n,label:t.displayName,active:i===t.value,counter:u[t.displayName]?void 0:QD(t,(o=zD({},c),s={$data:l},s=null!=s?s:{},Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(s)).forEach((function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(s,e))})),o)),icon:u[t.displayName]?"spinner":void 0,onChangeTab:()=>{if(t.value&&t.value!==i||a){qv(Gv,Xv.service_details.action_view_changed,{newActionView:t.value,previousActionView:i});const n=kl.getAncestor(e,eT),r=km(n).state.filters.find((e=>e.key===xm));(null==r?void 0:r.value)?ky(t.value,n):Dy()}}});var o,s}))))}));const QD=(e,t)=>{switch(e.value){case"fields":return t.fieldsCount;case"patterns":return t.patternsCount;case"labels":return t.labelsCount;default:return}};function UD(e){return{actions:(0,Ht.css)({[e.breakpoints.up(e.breakpoints.values.md)]:{position:"absolute",right:0,zIndex:2}})}}function qD(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function HD(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){qD(e,t,n[t])}))}return e}const GD="logsPanelQuery";function XD(e){return null==e?void 0:e.series.find((e=>e.refId===GD))}function YD(e){var t,n,r;return null===(r=kl.getAncestor(e,eT).state.$detectedLabelsData)||void 0===r||null===(n=r.state.data)||void 0===n||null===(t=n.series)||void 0===t?void 0:t[0]}function ZD(e){var t;const n=kl.getAncestor(e,eT);return KD(null===(t=n.state.$detectedFieldsData)||void 0===t?void 0:t.state)}const KD=e=>{var t,n;return null==e||null===(n=e.data)||void 0===n||null===(t=n.series)||void 0===t?void 0:t[0]},JD=e=>{var t,n,r,i;return null===(i=e.data)||void 0===i||null===(r=i.series)||void 0===r||null===(n=r[0])||void 0===n||null===(t=n.fields)||void 0===t?void 0:t[0]};class eT extends Q{setSubscribeToLabelsVariable(){const e=km(this);0!==e.state.filters.length?this._subs.add(e.subscribeToState(((e,t)=>{const n=Bm(e),r=Bm(t);0===e.filters.length&&this.redirectToStart(),e.filters.some((e=>e.key===xm))||this.redirectToStart(),r!==n&&Dm(this).setState({filters:[]})}))):this.redirectToStart()}redirectToStart(){this.setState({$data:void 0,body:void 0,$patternsData:void 0,$detectedLabelsData:void 0,$detectedFieldsData:void 0,patternsCount:void 0,labelsCount:void 0,fieldsCount:void 0}),_y().setServiceSceneState(this.state),this._subs.unsubscribe(),this.clearAdHocVariables(),Dy()}getMetadata(){const e=_y().getServiceSceneState();e&&this.setState(HD({},e))}onActivate(){this.getMetadata(),this.resetBodyAndData(),this.setBreakdownView(),this.setSubscribeToLabelsVariable(),this.runQueries(),this._subs.add(this.subscribeToPatternsQuery()),this._subs.add(this.subscribeToDetectedLabelsQuery()),tb()!==Um.fields&&this._subs.add(this.subscribeToDetectedFieldsQuery()),this._subs.add(this.subscribeToLogsQuery()),this._subs.add(this.subscribeToLabelsVariable()),this._subs.add(this.subscribeToFieldsVariable()),this._subs.add(this.subscribeToDataSourceVariable()),this._subs.add(this.subscribeToTimeRange())}subscribeToDataSourceVariable(){return Lm(this).subscribeToState((()=>{this.redirectToStart()}))}subscribeToLabelsVariable(){return km(this).subscribeToState(((e,t)=>{var n,r,i;wy(e.filters,t.filters)||(null===(n=this.state.$patternsData)||void 0===n||n.runQueries(),null===(r=this.state.$detectedLabelsData)||void 0===r||r.runQueries(),null===(i=this.state.$detectedFieldsData)||void 0===i||i.runQueries())}))}subscribeToFieldsVariable(){return Dm(this).subscribeToState(((e,t)=>{var n;wy(e.filters,t.filters)||null===(n=this.state.$detectedFieldsData)||void 0===n||n.runQueries()}))}runQueries(){const e=tb(),t=nb();var n,r,i;e!==Um.patterns&&void 0!==this.state.patternsCount||null===(n=this.state.$patternsData)||void 0===n||n.runQueries(),e!==Um.labels&&t!==qm.label&&void 0!==this.state.labelsCount||null===(r=this.state.$detectedLabelsData)||void 0===r||r.runQueries(),e!==Um.fields&&t!==qm.field&&void 0!==this.state.fieldsCount||null===(i=this.state.$detectedFieldsData)||void 0===i||i.runQueries()}subscribeToPatternsQuery(){var t;return null===(t=this.state.$patternsData)||void 0===t?void 0:t.subscribeToState((t=>{var n;if(this.updateLoadingState(t,ND.patterns),(null===(n=t.data)||void 0===n?void 0:n.state)===e.LoadingState.Done){const e=t.data.series;void 0!==(null==e?void 0:e.length)&&(this.setState({patternsCount:e.length}),_y().setPatternsCount(e.length))}}))}subscribeToDetectedLabelsQuery(){var t;return null===(t=this.state.$detectedLabelsData)||void 0===t?void 0:t.subscribeToState((t=>{var n;if(this.updateLoadingState(t,ND.labels),(null===(n=t.data)||void 0===n?void 0:n.state)===e.LoadingState.Done){const e=t.data,n=e.series[0].fields;if(void 0!==e.series.length&&void 0!==n.length){const t=e.series[0].fields.filter((e=>Sm!==e.name));this.setState({labelsCount:t.length+1}),_y().setLabelsCount(n.length)}}}))}updateLoadingState(t,n){var r;const i=this.state.loadingStates;i[n]=(null===(r=t.data)||void 0===r?void 0:r.state)===e.LoadingState.Loading;const a=Object.values(i).some((e=>e));this.setState({loading:a,loadingStates:i})}subscribeToLogsQuery(){var e;return null===(e=this.state.$data)||void 0===e?void 0:e.subscribeToState((e=>{this.updateLoadingState(e,ND.logs)}))}subscribeToDetectedFieldsQuery(){var t;return null===(t=this.state.$detectedFieldsData)||void 0===t?void 0:t.subscribeToState((t=>{var n;if(this.updateLoadingState(t,ND.fields),(null===(n=t.data)||void 0===n?void 0:n.state)===e.LoadingState.Done){const e=t.data.series[0];void 0!==e&&e.length!==this.state.fieldsCount&&(this.setState({fieldsCount:e.length}),_y().setFieldsCount(e.length))}}))}subscribeToTimeRange(){return kl.getTimeRange(this).subscribeToState((()=>{var e,t,n;null===(e=this.state.$patternsData)||void 0===e||e.runQueries(),null===(t=this.state.$detectedLabelsData)||void 0===t||t.runQueries(),null===(n=this.state.$detectedFieldsData)||void 0===n||n.runQueries()}))}resetBodyAndData(){let e={};this.state.$data||(e.$data=aT()),this.state.$patternsData||(e.$patternsData=nT()),this.state.$detectedLabelsData||(e.$detectedLabelsData=rT()),this.state.$detectedFieldsData||(e.$detectedFieldsData=iT()),this.state.body||(e.body=tT()),Object.keys(e).length&&this.setState(e)}setBreakdownView(){const{body:e}=this.state,t=tb(),n=MD.find((e=>e.value===t));if(!e){const e=new Error("body is not defined in setBreakdownView!");throw Gg.error(e,{msg:"ServiceScene setBreakdownView error"}),e}if(n)e.setState({children:[...e.state.children.slice(0,1),n.getScene((e=>{"fields"===n.value&&this.setState({fieldsCount:e})}))]});else{const t=nb(),n=VD.find((e=>e.value===t));n&&this.state.drillDownLabel?e.setState({children:[...e.state.children.slice(0,1),n.getScene(this.state.drillDownLabel)]}):Gg.error(new Error("not setting breakdown view"))}}constructor(e){var t;super(HD({loadingStates:{[ND.patterns]:!1,[ND.labels]:!1,[ND.fields]:!1,[ND.logs]:!1},loading:!0,body:null!==(t=e.body)&&void 0!==t?t:tT(),$data:aT(),$patternsData:nT(),$detectedLabelsData:rT(),$detectedFieldsData:iT()},e)),qD(this,"_variableDependency",new Js(this,{variableNames:[um,Jg,tm,rm,am]})),qD(this,"clearAdHocVariables",(()=>{[km(this),Dm(this),Tm(this)].forEach((e=>{e.setState({filters:[]})}))})),this.addActivationHandler(this.onActivate.bind(this))}}function tT(){return new gh({direction:"column",children:[new mh({ySizing:"content",body:new WD({})})]})}function nT(){return gS([AO(`{${em}}`,"patterns",{refId:"patterns"})])}function rT(){return gS([AO(`{${em}}`,"detected_labels",{refId:"detectedLabels"})])}function iT(){return gS([AO(vm,"detected_fields",{refId:"detectedFields"})])}function aT(){return mS([jO(vm,{refId:GD})])}qD(eT,"Component",(({model:e})=>{const{body:t}=e.useState();return t?r().createElement(t.Component,{model:t}):r().createElement(Wt.LoadingPlaceholder,{text:"Loading..."})}));const oT=({onRemove:e,pattern:n,size:i="lg"})=>{const a=(0,Wt.useStyles2)(cT),[o,s]=(0,t.useState)(!1);return r().createElement("div",{className:a.pattern,onClick:()=>s(!o),onMouseLeave:()=>s(!1)},r().createElement(Wt.Tag,{title:n,key:n,name:o?n:lT(n,i),className:a.tag}),r().createElement(Wt.Button,{"aria-label":"Remove pattern","data-testid":iy,variant:"secondary",size:"sm",className:a.removeButton,onClick:e},r().createElement(Wt.Icon,{name:"times"})))},sT={sm:50,lg:Math.round(window.innerWidth/8)};function lT(e,t){const n=e.length;if(n<sT[t])return e;const r=Math.round(.4*sT[t]);return`${e.substring(0,r)}  ${e.substring(n-r)}`}const cT=e=>({pattern:(0,Ht.css)({display:"flex",fontFamily:"monospace",gap:e.spacing(.25),cursor:"pointer",overflow:"hidden"}),tag:(0,Ht.css)({borderTopRightRadius:0,borderBottomRightRadius:0,backgroundColor:e.colors.secondary.main,border:`solid 1px ${e.colors.secondary.border}`,color:e.colors.secondary.text,boxSizing:"border-box",padding:e.spacing(.25,.75),overflow:"hidden",textOverflow:"ellipsis"}),removeButton:(0,Ht.css)({paddingLeft:2.5,paddingRight:2.5})}),uT=({patterns:e,onRemove:t})=>{const n=(0,Wt.useStyles2)(dT);if(!e||0===e.length)return null;const i=e.filter((e=>"include"===e.type)),a=e.filter((e=>"include"!==e.type)),o=n=>{t(e.filter((e=>e!==n))),qv(Gv,Xv.service_details.pattern_removed,{includePatternsLength:i.length-("include"===(null==n?void 0:n.type)?1:0),excludePatternsLength:a.length-("include"!==(null==n?void 0:n.type)?1:0),type:n.type})};return r().createElement("div",null,i.length>0&&r().createElement("div",{className:n.patternsContainer},r().createElement(Wt.Text,{variant:"bodySmall",weight:"bold","data-testid":ly},"Included pattern",e.length>1?"s":""),r().createElement("div",{className:n.patterns},i.map((e=>r().createElement(oT,{key:e.pattern,pattern:e.pattern,size:"lg",onRemove:()=>o(e)}))))),a.length>0&&r().createElement("div",{className:n.patternsContainer},r().createElement(Wt.Text,{variant:"bodySmall",weight:"bold","data-testid":cy},"Excluded pattern",a.length>1?"s":"",":"),r().createElement("div",{className:n.patterns},a.map((e=>r().createElement(oT,{key:e.pattern,pattern:e.pattern,size:a.length>1?"sm":"lg",onRemove:()=>o(e)}))))))};function dT(e){return{patternsContainer:(0,Ht.css)({paddingBottom:e.spacing(1),overflow:"hidden"}),patterns:(0,Ht.css)({display:"flex",gap:e.spacing(1),alignItems:"center",flexWrap:"wrap"})}}const pT=()=>{const e=(0,Wt.useStyles2)(fT);return r().createElement("div",{className:e.wrapper},r().createElement("a",{href:"https://forms.gle/1sYWCTPvD72T1dPH9",className:e.feedback,title:"Share your thoughts about Logs in Grafana.",target:"_blank",rel:"noreferrer noopener"},r().createElement(Wt.Icon,{name:"comment-alt-message"})," Give feedback"))},fT=e=>({wrapper:(0,Ht.css)({display:"flex",marginLeft:"auto",gap:e.spacing(1),position:"relative",top:e.spacing(-1)}),feedback:(0,Ht.css)({alignSelf:"center",color:e.colors.text.secondary,fontSize:e.typography.bodySmall.fontSize,"&:hover":{color:e.colors.text.link}})});function hT(e){return r().createElement(r().Fragment,null,r().createElement(Wt.Alert,{severity:"info",title:"Welcome to Explore Logs!",onRemove:e.onRemove},r().createElement("div",null,"Check out our"," ",r().createElement("a",{className:"external-link",target:"_blank",href:"https://grafana.com/docs/grafana-cloud/visualizations/simplified-exploration/logs/",rel:"noreferrer"},"Get started doc"),", or see"," ",r().createElement("a",{className:"external-link",target:"_blank",href:"https://github.com/grafana/explore-logs/releases",rel:"noreferrer"},"recent changes"),".",r().createElement("br",null),"Help us shape the future of the app."," ",r().createElement("a",{className:"external-link",target:"_blank",href:"https://forms.gle/1sYWCTPvD72T1dPH9",rel:"noreferrer"},"Send us feedback")," ","or engage with us on"," ",r().createElement("a",{className:"external-link",target:"_blank",href:"https://github.com/grafana/explore-logs/?tab=readme-ov-file#explore-logs",rel:"noreferrer"},"GitHub"),".")))}function gT(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const mT=`${Wm}.interceptBannerStorageKey`;class bT extends Q{dismiss(){this.setState({interceptDismissed:!0}),localStorage.setItem(mT,"true")}constructor(e){var t,n;super((t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){gT(e,t,n[t])}))}return e}({},e),n=null!=(n={interceptDismissed:!!localStorage.getItem(mT)})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t))}}function vT(e){return{bodyContainer:(0,Ht.css)({flexGrow:1,display:"flex",minHeight:"100%",flexDirection:"column"}),container:(0,Ht.css)({flexGrow:1,display:"flex",gap:e.spacing(1),minHeight:"100%",flexDirection:"column",padding:e.spacing(2),maxWidth:"100vw"}),body:(0,Ht.css)({flexGrow:1,display:"flex",flexDirection:"column",gap:e.spacing(1)}),controlsContainer:(0,Ht.css)({display:"flex",gap:e.spacing(2),justifyContent:"space-between",alignItems:"flex-start"}),filters:(0,Ht.css)({display:"flex",gap:e.spacing(2),width:"calc(100% - 450)",flexWrap:"wrap",alignItems:"flex-end",'& + div[data-testid="data-testid Dashboard template variables submenu Label Filters"]:empty':{visibility:"hidden"},"&:first-child":{"& > div":{"& > div":{flexWrap:"wrap","& > div":{maxWidth:"380px","& > div":{flex:"1 0 auto","&:nth-child(3)":{flex:"0 1 auto"}}}}}},'[data-testid="AdHocFilter-service_name"]':{'div[class*="input-wrapper"]:first-child':{display:"none"},'div[class*="input-wrapper"]:nth-child(2)':{marginLeft:0}},'div >[title="Add filter"]':{border:0,display:"none",width:0,padding:0,margin:0}}),controlsWrapper:(0,Ht.css)({display:"flex",flexDirection:"column"}),controls:(0,Ht.css)({display:"flex",gap:e.spacing(1)}),feedback:(0,Ht.css)({textAlign:"end"}),rotateIcon:(0,Ht.css)({svg:{transform:"rotate(180deg)"}})}}function yT(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function OT(e,t){const n=km(t);qv(Hv,Xv.service_selection.service_selected,{service:e}),n.setState({filters:[...n.state.filters.filter((e=>e.key!==xm)),{key:xm,operator:Pb.Equal,value:e}],hide:Uv.hideLabel}),function(e,t){if(!e||"string"!=typeof e)return;const n=ub(e);let r=[];try{r=JSON.parse(localStorage.getItem(n)||"[]")}catch(e){Gg.error(e,{msg:"Error parsing favorite services from local storage"})}Array.isArray(r)||(r=[]);const i=r.filter((e=>e!==t));i.unshift(t),localStorage.setItem(n,JSON.stringify(i))}(Lm(t).getValue(),e),function(e){const t=Ey(Gm.logs(e));a.locationService.push(t)}(e)}gT(bT,"Component",(({model:e})=>{if(!e.parent)return null;const{controls:t,contentScene:n,patterns:i}=e.parent.useState(),{interceptDismissed:a}=e.useState();if(!n)return null;const o=(0,Wt.useStyles2)(vT);return r().createElement("div",{className:o.bodyContainer},!a&&r().createElement(hT,{onRemove:()=>{e.dismiss()}}),r().createElement("div",{className:o.container},t&&r().createElement("div",{className:o.controlsContainer},r().createElement("div",{className:o.filters},t.map((e=>e instanceof Nd?r().createElement(e.Component,{key:e.state.key,model:e}):null))),r().createElement("div",{className:o.controlsWrapper},r().createElement(pT,null),r().createElement("div",{className:o.controls},t.map((e=>e instanceof Nd==0?r().createElement(e.Component,{key:e.state.key,model:e}):null))))),r().createElement(uT,{patterns:i,onRemove:t=>{var n;return null===(n=e.parent)||void 0===n?void 0:n.setState({patterns:t})}}),r().createElement("div",{className:o.body},n&&r().createElement(n.Component,{model:n}))))}));class wT extends Q{constructor(...e){super(...e),yT(this,"onClick",(()=>{this.state.service&&OT(this.state.service,this)}))}}yT(wT,"Component",(({model:e})=>r().createElement(Wt.Button,{variant:"secondary",size:"sm",onClick:e.onClick},"Select")));const ST=()=>r().createElement(oO,null,r().createElement("p",null,"Log volume has not been configured."),r().createElement("p",null,r().createElement(Wt.TextLink,{href:"https://grafana.com/docs/loki/latest/reference/api/#query-log-volume",external:!0},"Instructions to enable volume in the Loki config:")),r().createElement(Wt.Text,{textAlignment:"left"},r().createElement("pre",null,r().createElement("code",null,"limits_config:",r().createElement("br",null),"volume_enabled: true")))),xT=()=>r().createElement(oO,null,r().createElement("p",null,"No service matched your search."));function _T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const PT=`${zg.id}.serviceSelection.aggregatedMetrics`;class ET extends Q{constructor(e){const t=localStorage.getItem(PT);var n;super(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){_T(e,t,n[t])}))}return e}({isOpen:!1,options:{aggregatedMetrics:{active:a.config.featureToggles.exploreLogsAggregatedMetrics&&"false"!==t,userOverride:null!==(n="true"===t)&&void 0!==n&&n,disabled:!1}}},e)),_T(this,"toggleAggregatedMetricsOverride",(()=>{const e=!this.state.options.aggregatedMetrics.active;qv(Hv,Xv.service_selection.aggregated_metrics_toggled,{enabled:e}),localStorage.setItem(PT,e.toString()),this.setState({options:{aggregatedMetrics:{active:e,disabled:this.state.options.aggregatedMetrics.disabled,userOverride:e}}})})),_T(this,"onToggleOpen",(e=>{this.setState({isOpen:e})}))}}function CT(e){return{popover:(0,Ht.css)({display:"flex",padding:e.spacing(2),flexDirection:"column",background:e.colors.background.primary,boxShadow:e.shadows.z3,borderRadius:e.shape.radius.default,border:`1px solid ${e.colors.border.weak}`,zIndex:1,marginRight:e.spacing(2)}),heading:(0,Ht.css)({fontWeight:e.typography.fontWeightMedium,paddingBottom:e.spacing(2)}),options:(0,Ht.css)({display:"grid",gridTemplateColumns:"1fr 50px",rowGap:e.spacing(1),columnGap:e.spacing(2),alignItems:"center"})}}function kT(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){kT(e,t,n[t])}))}return e}function TT(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}_T(ET,"Component",(({model:e})=>{const{isOpen:t,options:n}=e.useState(),i=(0,Wt.useStyles2)(CT);return n.aggregatedMetrics?r().createElement(Wt.Dropdown,{overlay:()=>r().createElement("div",{className:i.popover,onClick:e=>e.stopPropagation()},r().createElement("div",{className:i.heading},"Query options"),r().createElement("div",{className:i.options},r().createElement("div",{title:"Aggregated metrics will return service queries results much more quickly, but with lower resolution"},"Aggregated metrics"),r().createElement("span",{title:n.aggregatedMetrics.disabled?`Aggregated metrics can only be enabled for queries starting after ${AT.toLocaleString()}`:""},r().createElement(Wt.Switch,{value:n.aggregatedMetrics.active,disabled:n.aggregatedMetrics.disabled,onChange:e.toggleAggregatedMetricsOverride})))),placement:"bottom",onVisibleChange:e.onToggleOpen},r().createElement(Wt.ToolbarButton,{icon:"cog",variant:"canvas",isOpen:t})):r().createElement(r().Fragment,null)}));const RT=a.config.featureToggles.exploreLogsAggregatedMetrics,IT="__aggregated_metric__",AT=(0,e.dateTime)("2024-08-30","YYYY-MM-DD");class jT extends Q{onActivate(){const t=km(this);var n,r,i;t.state.filters.length>0&&t.setState({filters:[]}),this._subs.add(this.state.$data.subscribeToState(((t,n)=>{var r,i,a;(null===(r=t.data)||void 0===r?void 0:r.state)!==e.LoadingState.Done||wy(null==n||null===(i=n.data)||void 0===i?void 0:i.series,null==t||null===(a=t.data)||void 0===a?void 0:a.series)||this.updateBody()}))),this.isTimeRangeTooEarlyForAggMetrics()?(this.onUnsupportedAggregatedMetricTimeRange(),(null===(n=this.state.$data.state.data)||void 0===n?void 0:n.state)!==e.LoadingState.Done&&this.runServiceQueries()):(this.onSupportedAggregatedMetricTimeRange(),(null===(r=this.state.$data.state.data)||void 0===r?void 0:r.state)!==e.LoadingState.Done&&this.runServiceQueries()),this._subs.add(kl.getTimeRange(this).subscribeToState((()=>{this.isTimeRangeTooEarlyForAggMetrics()?this.onUnsupportedAggregatedMetricTimeRange():this.onSupportedAggregatedMetricTimeRange(),this.runServiceQueries()}))),this._subs.add(Lm(this).subscribeToState((()=>{this.runServiceQueries()}))),RT&&(this._subs.add(null===(i=this.getQueryOptionsToolbar())||void 0===i?void 0:i.subscribeToState(((e,t)=>{e.options.aggregatedMetrics.userOverride!==t.options.aggregatedMetrics.userOverride&&this.runServiceQueries()}))),this._subs.add(Am(this).subscribeToState(((e,t)=>{e.value!==t.value&&(this.setState({body:new xh({children:[]})}),this.updateBody())}))))}isTimeRangeTooEarlyForAggMetrics(){return kl.getTimeRange(this).state.value.from.isBefore((0,e.dateTime)(AT))}onUnsupportedAggregatedMetricTimeRange(){const e=this.getQueryOptionsToolbar();null==e||e.setState({options:{aggregatedMetrics:TT(DT({},null==e?void 0:e.state.options.aggregatedMetrics),{disabled:!0})}})}getQueryOptionsToolbar(){return kl.getAncestor(this,FT).state.controls.find((e=>e instanceof ET))}onSupportedAggregatedMetricTimeRange(){const e=this.getQueryOptionsToolbar();null==e||e.setState({options:{aggregatedMetrics:TT(DT({},null==e?void 0:e.state.options.aggregatedMetrics),{disabled:!1})}})}runServiceQueries(){const e=this.getQueryOptionsToolbar(),t=!(null==e?void 0:e.state.options.aggregatedMetrics.disabled)&&(null==e?void 0:e.state.options.aggregatedMetrics.active),n=Am(this);this.isTimeRangeTooEarlyForAggMetrics()&&RT||!t?n.changeValueTo(xm):n.changeValueTo(IT),this.state.$data.runQueries()}updateBody(){var e;const{servicesToQuery:t}=this.getServices(null===(e=this.state.$data.state.data)||void 0===e?void 0:e.series);if(t&&0!==t.length){const e=[],n=this.state.body.state.children,r=kl.getTimeRange(this).state.value,i=Am(this);for(const a of t.slice(0,20)){const t=n.filter((e=>{const t=e.state.body;return(null==t?void 0:t.state.title)===a}));2===t.length?e.push(t[0],t[1]):e.push(this.buildServiceLayout(a,r,i),this.buildServiceLogsLayout(a))}this.state.body.setState({children:e,isLazy:!0,templateColumns:"repeat(auto-fit, minmax(500px, 1fr) minmax(300px, 70vw))",autoRows:"200px",md:{templateColumns:"1fr",rowGap:1,columnGap:1}})}else this.state.body.setState({children:[]})}updateServiceLogs(e){var t;if(!this.state.body)return void this.updateBody();const{servicesToQuery:n}=this.getServices(null===(t=this.state.$data.state.data)||void 0===t?void 0:t.series),r=null==n?void 0:n.indexOf(e);if(!(void 0===r||r<0)&&this.state.body){let t=[...this.state.body.state.children];t.splice(2*r+1,1,this.buildServiceLogsLayout(e)),this.state.body.setState({children:t})}}getLogExpression(e,t){return`{${xm}=\`${e}\`}${t}`}getMetricExpression(e,t){return t.state.value===IT?`sum by (${Sm}) (sum_over_time({${IT}=\`${e}\`} | logfmt | unwrap count [$__auto]))`:`sum by (${Sm}) (count_over_time({${xm}=\`${e}\`} [$__auto]))`}buildServiceLayout(t,n,r){let i;n.to.diff(n.from,"hours")>=4&&n.to.diff(n.from,"hours")<=26&&(i="2h");const a=Mg().setTitle(t).setData(mS([jO(this.getMetricExpression(t,r),{legendFormat:`{{${Sm}}}`,splitDuration:i,refId:`ts-${t}`})])).setCustomFieldConfig("stacking",{mode:Wt.StackingMode.Normal}).setCustomFieldConfig("fillOpacity",100).setCustomFieldConfig("lineWidth",0).setCustomFieldConfig("pointSize",0).setCustomFieldConfig("drawStyle",Wt.DrawStyle.Bars).setUnit("short").setOverrides(uS).setOption("legend",{showLegend:!0,calcs:["sum"],placement:"right",displayMode:Wt.LegendDisplayMode.Table}).setHeaderActions(new wT({service:t})).build();return a.setState({extendPanelContext:(e,n)=>this.extendTimeSeriesLegendBus(t,n,a)}),new _h({$behaviors:[new Ql({key:"serviceCrosshairSync",sync:e.DashboardCursorSync.Crosshair})],body:a})}getServices(e){var t,n,r,i,a;const o=null!==(a=null==e||null===(r=e[0])||void 0===r||null===(n=r.fields)||void 0===n||null===(t=n.find((e=>e.name===xm)))||void 0===t?void 0:t.values)&&void 0!==a?a:[],s=null===(i=Lm(this).getValue())||void 0===i?void 0:i.toString(),l=Fm(this).getValue(),c=function(e,t,n){if(!(null==e?void 0:e.length))return[];const r=e.filter((e=>e.toLowerCase().includes(n.toLowerCase()))),i=function(e){if(!e||"string"!=typeof e)return[];const t=ub(e);let n=[];try{n=JSON.parse(localStorage.getItem(t)||"[]")}catch(e){Gg.error(e,{msg:"Error parsing favorite services from local storage"})}return Array.isArray(n)||(n=[]),n}(t).filter((e=>e.toLowerCase().includes(n.toLowerCase())&&r.includes(e)));return Array.from(new Set([...i,...r]))}(o,s,String(l));return{servicesByVolume:o,servicesToQuery:c}}constructor(t){super(DT({body:new xh({children:[]}),$variables:new Wd({variables:[new Qg({name:cm,label:"Service",hide:Uv.hideVariable,value:"",skipUrlSync:!0}),new Qg({name:_m,label:"",hide:Uv.hideLabel,value:xm,skipUrlSync:!0,options:[{value:xm,label:xm},{value:IT,label:IT}]})]}),$data:bS({queries:[AO("{${service_label_var}=~`.*${service}.*`}","volume")],runQueriesMode:"manual"}),serviceLevel:new Map},t)),kT(this,"extendTimeSeriesLegendBus",((e,t,n)=>{const r=t.onToggleSeriesVisibility;t.onToggleSeriesVisibility=(t,i)=>{var a,o,s;null==r||r(t,i);const l=Ry(null!==(s=null===(o=n.state.$data)||void 0===o||null===(a=o.state.data)||void 0===a?void 0:a.series)&&void 0!==s?s:[]),c=function(e,t,n,r){if(n===Wt.SeriesVisibilityChangeMode.ToggleSelection){const n=null!=t?t:[];return 1===n.length&&n.includes(e)?[]:[e]}let i=(null==t?void 0:t.length)?t:r;return i.includes(e)?i.filter((t=>t!==e)):[...i,e]}(t,this.state.serviceLevel.get(e),i,l);this.state.serviceLevel.set(e,c),this.updateServiceLogs(e)}})),kT(this,"getLevelFilterForService",(e=>{let t=this.state.serviceLevel.get(e)||[];return 0===t.length?"":` | ${t.map((e=>("logs"===e&&(e=""),`${Sm}=\`${e}\``))).join(" or ")} `})),kT(this,"buildServiceLogsLayout",(t=>{const n=this.getLevelFilterForService(t);return new _h({$behaviors:[new Ql({sync:e.DashboardCursorSync.Off})],body:Ng().setHoverHeader(!0).setData(mS([jO(this.getLogExpression(t,n),{maxLines:100,refId:`logs-${t}`})])).setTitle(t).setOption("showTime",!0).setOption("enableLogDetails",!1).build()})})),kT(this,"onSearchServicesChange",(0,re.debounce)((e=>{Fm(this).changeValueTo(null!=e?e:""),this.state.$data.runQueries(),qv(Hv,Xv.service_selection.search_services_changed,{searchQuery:e})}),500)),this.addActivationHandler(this.onActivate.bind(this))}}function LT(e){return{container:(0,Ht.css)({display:"flex",flexDirection:"column",flexGrow:1,position:"relative"}),headingWrapper:(0,Ht.css)({marginTop:e.spacing(1)}),loadingText:(0,Ht.css)({margin:0}),header:(0,Ht.css)({position:"absolute",right:0,top:"4px",zIndex:2}),bodyWrapper:(0,Ht.css)({flexGrow:1,display:"flex",flexDirection:"column"}),body:(0,Ht.css)({flexGrow:1,display:"flex",flexDirection:"column"}),searchField:(0,Ht.css)({marginTop:e.spacing(1)})}}function $T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}kT(jT,"Component",(({model:t})=>{var n;const i=(0,Wt.useStyles2)(LT),{body:a,$data:o}=t.useState(),{data:s}=o.useState(),l=Fm(t),{value:c}=l.useState(),{servicesByVolume:u,servicesToQuery:d}=t.getServices(null==s?void 0:s.series),p=(null==s?void 0:s.state)===e.LoadingState.Loading||(null==s?void 0:s.state)===e.LoadingState.Streaming||void 0===s,f=(null===(n=o.state.data)||void 0===n?void 0:n.state)===e.LoadingState.Error;var h;const g=null!==(h=null==d?void 0:d.length)&&void 0!==h?h:0,m=a.state.children.length/2;var b;return r().createElement("div",{className:i.container},r().createElement("div",{className:i.bodyWrapper},r().createElement("div",null,p&&r().createElement(Wt.LoadingPlaceholder,{text:"Loading services",className:i.loadingText}),!p&&r().createElement(r().Fragment,null,"Showing ",m," of ",g," service",1!==g?"s":"")),r().createElement(Wt.Field,{className:i.searchField},r().createElement(_O,{initialFilter:{label:l.getValue().toString(),value:l.getValue().toString(),icon:"filter"},isLoading:p,value:String(c),onChange:e=>(e=>{t.onSearchServicesChange(e)})(null!=e?e:""),selectOption:e=>{OT(e,t)},label:"Service",options:null!==(b=null==d?void 0:d.map((e=>({value:e,label:e}))))&&void 0!==b?b:[]})),!p&&f&&r().createElement(ST,null),!p&&!f&&!(null==u?void 0:u.length)&&r().createElement(xT,null),d&&d.length>0&&r().createElement("div",{className:i.body},r().createElement(a.Component,{model:a}))))}));class FT extends Q{onActivate(){const e={};var t,n;this.state.contentScene||(e.contentScene=(n=null===(t=this.state.routeMatch)||void 0===t?void 0:t.params.label,tb()===Um.explore?new jT({}):new eT({drillDownLabel:n}))),this.setState(e),this.updatePatterns(this.state,Cm(this)),this.resetVariablesIfNotInUrl(Dm(this),Nm(tm)),this.resetVariablesIfNotInUrl(Tm(this),Nm(am)),this._subs.add(this.subscribeToState((e=>{this.updatePatterns(e,Cm(this))})))}resetVariablesIfNotInUrl(e,t){const n=a.locationService.getLocation();null===new URLSearchParams(n.search).get(t)&&e.setState({filters:[]})}updatePatterns(e,t){var n;const r=zO(null!==(n=e.patterns)&&void 0!==n?n:[]);t.changeValueTo(r)}getUrlState(){return{patterns:JSON.stringify(this.state.patterns)}}updateFromUrl(e){const t={};e.patterns&&"string"==typeof e.patterns&&(t.patterns=JSON.parse(e.patterns)),this.setState(t)}constructor(e){var t;const{variablesScene:n,unsub:r}=function(e,t){const n=[Pb.Equal,Pb.NotEqual].map((e=>({label:e,value:e}))),r=new vs({name:Jg,datasource:Om,layout:"vertical",label:"Service",filters:null!=t?t:[],expressionBuilder:$O,hide:Uv.hideLabel,key:"adhoc_service_filter"});r._getOperators=function(){return n};const i=new vs({name:tm,label:"Filters",applyMode:"manual",layout:"vertical",getTagKeysProvider:()=>Promise.resolve({replace:!0,values:[]}),getTagValuesProvider:()=>Promise.resolve({replace:!0,values:[]}),expressionBuilder:FO,hide:Uv.hideLabel});i._getOperators=()=>n;const a=new vs({name:am,label:"Filters",applyMode:"manual",layout:"vertical",getTagKeysProvider:()=>Promise.resolve({replace:!0,values:[]}),getTagValuesProvider:()=>Promise.resolve({replace:!0,values:[]}),expressionBuilder:NO,hide:Uv.hideLabel});a._getOperators=()=>n;const o=new rp({name:um,label:"Data source",value:e,pluginId:"loki"}),s=o.subscribeToState((e=>{const t=`${e.value}`;var n;e.value&&(n=t,localStorage.setItem(cb,n))}));return{variablesScene:new Wd({variables:[o,r,i,a,new Zd({name:rm,value:"",hide:Uv.hideVariable}),new Zd({name:mm,value:"",hide:Uv.hideVariable}),new Qg({name:"logsFormat",value:pm,skipUrlSync:!0,hide:Uv.hideVariable,options:[{value:pm,label:pm}]})]}),unsub:s}}(null!==(t=null!==(i=localStorage.getItem(cb))&&void 0!==i?i:void 0)&&void 0!==t?t:"grafanacloud-logs",e.initialFilters);var i;const o=[new Nd({layout:"vertical"}),new hh,new Nf({}),new Xf({})];var s,l,c,u,d;"explore"===tb()&&a.config.featureToggles.exploreLogsAggregatedMetrics&&o.push(new ET({isOpen:!1})),super((u=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){$T(e,t,n[t])}))}return e}({$timeRange:null!==(s=e.$timeRange)&&void 0!==s?s:new Ee({}),$variables:null!==(l=e.$variables)&&void 0!==l?l:n,controls:null!==(c=e.controls)&&void 0!==c?c:o,patterns:[]},e),d=null!=(d={body:new bT({})})?d:{},Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(d)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(d)).forEach((function(e){Object.defineProperty(u,e,Object.getOwnPropertyDescriptor(d,e))})),u)),$T(this,"_urlSync",new be(this,{keys:["patterns"]})),this._subs.add(r),this.addActivationHandler(this.onActivate.bind(this))}}function NT(e){return new jp({body:new FT({$timeRange:new Ee({from:"now-15m",to:"now"}),routeMatch:e})})}function MT(){return new tg({title:"",url:Qm,getScene:()=>new jp({body:new gh({direction:"column",children:[]})}),hideFromBreadcrumbs:!0,routePath:"*",$behaviors:[()=>{Dy()}]})}function VT(t,n,r){const{service:i}=rb(t);return new tg({title:zT(r),layout:e.PageLayoutType.Custom,url:Gm[r](i),preserveUrlKeys:eb,getParentPage:()=>n,getScene:e=>NT(e)})}function BT(t,n,r){const{service:i}=rb(t),{label:a}=function(e){return{label:e.params.label}}(t);return new tg({title:zT(a),layout:e.PageLayoutType.Custom,url:Xm[r](i,a),preserveUrlKeys:eb,getParentPage:()=>n,getScene:e=>NT(e)})}function zT(e){return e.charAt(0).toUpperCase()+e.slice(1)}$T(FT,"Component",(({model:e})=>{const{body:t}=e.useState();return t?r().createElement(t.Component,{model:t}):r().createElement(Wt.LoadingPlaceholder,{text:"Loading..."})}));const WT=()=>new Fh({pages:[new tg({title:"Logs",url:Km(Um.explore),layout:e.PageLayoutType.Custom,preserveUrlKeys:Jm,routePath:Km(Um.explore),getScene:e=>NT(e),drilldowns:[{routePath:Ym.logs,getPage:(e,t)=>VT(e,t,Um.logs),defaultRoute:!0},{routePath:Ym.labels,getPage:(e,t)=>VT(e,t,Um.labels)},{routePath:Ym.patterns,getPage:(e,t)=>VT(e,t,Um.patterns)},{routePath:Ym.fields,getPage:(e,t)=>VT(e,t,Um.fields)},{routePath:Zm.label,getPage:(e,t)=>BT(e,t,qm.label)},{routePath:Zm.field,getPage:(e,t)=>BT(e,t,qm.field)},{routePath:"*",getPage:()=>MT()}]}),MT()]});function QT(){const[e,n]=r().useState(!1);Sy||(Sy=new xy);const o=function(e){const t=Mh.get(e);if(t)return t;const n=e();return Mh.set(e,n),n}(WT);(0,t.useEffect)((()=>{e||n(!0)}),[o,e]);const s=a.config.bootData.user.permissions;return(null==s?void 0:s["grafana-lokiexplore-app:read"])||(null==s?void 0:s["datasources:explore"])?e?r().createElement(o.Component,{model:o}):null:r().createElement(i.Redirect,{to:"/"})}const UT=r().createContext(null);class qT extends r().PureComponent{render(){return r().createElement(UT.Provider,{value:this.props},r().createElement(QT,null))}}const HT="Open in Explore Logs",GT="Open current query in the Explore Logs view",XT="gf-logs",YT=[{extensionPointId:e.PluginExtensionPoints.DashboardPanelMenu,title:HT,description:GT,icon:XT,path:ib(),configure:ZT},{extensionPointId:e.PluginExtensionPoints.ExploreToolbarAction,title:HT,description:GT,icon:XT,path:ib(),configure:ZT}];function ZT(e){var t,n;if(!e)return;const r=e.targets.find((e=>{var t;return"loki"===(null===(t=e.datasource)||void 0===t?void 0:t.type)}));if(!r||!(null===(t=r.datasource)||void 0===t?void 0:t.uid))return;const i=function(e){const t=[],n=Mw(e,[40]);if(0===n.length)return t;const r=Nw.fromNode(n[0]),i=Mw(e,[42]);for(const n of i){const i=Nw.fromNode(n),a=Vw(n,43),o=Vw(n,45),s="="===e.substring(a[0].to,o[0].from)?Pb.Equal:Pb.NotEqual,l=a[0].getExpression(e),c=o.map((t=>e.substring(t.from+1,t.to-1)))[0];l&&c&&t.push({key:l,operator:s,value:c,type:r.contains(i)?Dw.Indexed:void 0})}return t}(r.expr),a=i.find((e=>e.key===xm));if(!a)return;const o=Hm(a.value);i.sort(((e,t)=>e.key===xm?-1:1));let s=ob(ab.DatasourceId,null===(n=r.datasource)||void 0===n?void 0:n.uid);s=ob(ab.TimeRangeFrom,e.timeRange.from.valueOf().toString(),s),s=ob(ab.TimeRangeTo,e.timeRange.to.valueOf().toString(),s);for(const e of i)e.type===Dw.Indexed&&(s=sb(ab.Labels,`${e.key}|${e.operator}|${e.value}`,s));return{path:ib(`/explore/service/${o}/logs`,s)}}By()&&(0,Ty.Ay)();const KT=(new e.AppPlugin).setRootPage(qT);for(const e of YT)KT.configureExtensionLink(e);Bg({dataSource:new class extends te{query(e){return new b.Observable((t=>{var n;if(!(null===(n=e.scopedVars)||void 0===n?void 0:n.__sceneObject))throw new Error("Scene object not found in request");var r=this;(0,a.getDataSourceSrv)().get(wb(e.scopedVars.__sceneObject.valueOf())).then(function(){var n=iS((function*(n){var i;if(!(n instanceof a.DataSourceWithBackend))throw new Error("Invalid datasource!");e.targets=null===(i=e.targets)||void 0===i?void 0:i.map((e=>(e.datasource=n,e)));const o=new Set;if(e.targets.forEach((e=>{var t;o.add(null!==(t=e.resource)&&void 0!==t?t:"")})),1!==o.size)throw new Error("A request cannot contain queries to multiple endpoints");switch(e.targets[0].resource){case"volume":yield r.getVolume(e,n,t);break;case"patterns":yield r.getPatterns(e,n,t);break;case"detected_labels":yield r.getDetectedLabels(e,n,t);break;case"detected_fields":yield r.getDetectedFields(e,n,t);break;case"labels":yield r.getLabels(e,n,t);break;default:r.getData(e,n,t)}}));return function(e){return n.apply(this,arguments)}}())}))}getData(e,t,n){const r=a.config.featureToggles.exploreLogsShardSplitting;return(!1!==function(e){if(function(e){return void 0!==e.targets.find((e=>Bw(e.expr)))}(e))return!1;for(let n=0;n<e.targets.length;n++){var t;if(null===(t=e.targets[n].expr)||void 0===t?void 0:t.includes("avg_over_time"))return!1}return!0}(e)&&r?nS(t,e):t.query(e)).subscribe(n),n}getPatterns(t,n,r){var i=this;return iS((function*(){const a=t.targets.filter((e=>"patterns"===e.resource));if(1!==a.length)throw new Error("Patterns query can only have a single target!");const{interpolatedTarget:o,expression:s}=i.interpolate(n,a,t);r.next({data:[],state:e.LoadingState.Loading});try{var l;const i=n.getResource("patterns",{query:s,start:t.range.from.utc().toISOString(),end:t.range.to.utc().toISOString()},{requestId:null!==(l=t.requestId)&&void 0!==l?l:"patterns",headers:{"X-Query-Tags":`Source=${Wm}`}}),a=yield i,u=null==a?void 0:a.data;let d=-1/0,p=0;var c;const f=null!==(c=null==u?void 0:u.map((t=>{const n=[],r=[];let i=0;return t.samples.forEach((([e,t])=>{n.push(1e3*e),r.push(t),t>d&&(d=t),t<p&&(p=t),t>d&&(d=t),t<p&&(p=t),i+=t})),(0,e.createDataFrame)({refId:o.refId,name:t.pattern,fields:[{name:"time",type:e.FieldType.time,values:n,config:{}},{name:t.pattern,type:e.FieldType.number,values:r,config:{}}],meta:{preferredVisualisationType:"graph",custom:{sum:i}}})})))&&void 0!==c?c:[];f.sort(((e,t)=>{var n,r,i,a;return(null===(r=t.meta)||void 0===r||null===(n=r.custom)||void 0===n?void 0:n.sum)-(null===(a=e.meta)||void 0===a||null===(i=a.custom)||void 0===i?void 0:i.sum)})),r.next({data:f,state:e.LoadingState.Done})}catch(t){r.next({data:[],state:e.LoadingState.Error})}return r}))()}interpolate(e,t,n){const r=e.interpolateVariablesInQueries(t,n.scopedVars);if(!r.length)throw new Error("Datasource failed to interpolate query!");const i=r[0];return{interpolatedTarget:i,expression:i.expr}}getDetectedLabels(t,n,r){var i=this;return iS((function*(){const a=t.targets.filter((e=>"detected_labels"===e.resource));if(1!==a.length)throw new Error("Detected labels query can only have a single target!");const{interpolatedTarget:o,expression:s}=i.interpolate(n,a,t);r.next({data:[],state:e.LoadingState.Loading});try{var l,c,u;const i=null===(c=(yield n.getResource("detected_labels",{query:s,start:t.range.from.utc().toISOString(),end:t.range.to.utc().toISOString()},{requestId:null!==(u=t.requestId)&&void 0!==u?u:"detected_labels",headers:{"X-Query-Tags":`Source=${Wm}`}})).detectedLabels)||void 0===c||null===(l=c.filter((e=>!Cb.includes(e.label))))||void 0===l?void 0:l.sort(((e,t)=>function(e,t){return 1===e.cardinality?1:1===t.cardinality?-1:e.cardinality-t.cardinality}(e,t))),a=null==i?void 0:i.map((e=>({name:e.label,values:[e.cardinality]}))),d=(0,e.createDataFrame)({refId:o.refId,fields:null!=a?a:[]});r.next({data:[d],state:e.LoadingState.Done})}catch(t){r.next({data:[],state:e.LoadingState.Error})}return r}))()}getDetectedFields(t,n,r){var i=this;return iS((function*(){const a=t.targets.filter((e=>"detected_fields"===e.resource));if(1!==a.length)throw new Error("Detected fields query can only have a single target!");r.next({data:[],state:e.LoadingState.Loading});const{interpolatedTarget:o,expression:s}=i.interpolate(n,a,t);try{var l,c;const i=yield n.getResource("detected_fields",{query:s,start:t.range.from.utc().toISOString(),end:t.range.to.utc().toISOString()},{requestId:null!==(c=t.requestId)&&void 0!==c?c:"detected_fields",headers:{"X-Query-Tags":`Source=${Wm}`}}),a={name:"name",type:e.FieldType.string,values:[],config:{}},u={name:"cardinality",type:e.FieldType.number,values:[],config:{}},d={name:"parser",type:e.FieldType.string,values:[],config:{}},p={name:"type",type:e.FieldType.string,values:[],config:{}};null===(l=i.fields)||void 0===l||l.forEach((e=>{var t;Eb.includes(e.label)||(a.values.push(e.label),u.values.push(e.cardinality),d.values.push((null===(t=e.parsers)||void 0===t?void 0:t.length)?e.parsers.join(", "):"structuredMetadata"),p.values.push(e.type))}));const f=(0,e.createDataFrame)({refId:o.refId,fields:[a,u,d,p]});r.next({data:[f],state:e.LoadingState.Done})}catch(t){Gg.error(t,{msg:"Detected fields error"}),r.next({data:[],state:e.LoadingState.Error})}return r}))()}getVolume(t,n,r){return iS((function*(){if(1!==t.targets.length)throw new Error("Volume query can only have a single target!");const i=n.interpolateVariablesInQueries(t.targets,t.scopedVars)[0].expr.replace(".*.*",".+");r.next({data:[],state:e.LoadingState.Loading});try{var a,o,s;const l=yield n.getResource("index/volume",{query:i,start:t.range.from.utc().toISOString(),end:t.range.to.utc().toISOString(),limit:5e3},{requestId:null!==(s=t.requestId)&&void 0!==s?s:"volume",headers:{"X-Query-Tags":`Source=${Wm}`}});null==l||l.data.result.sort(((e,t)=>{const n=e.value[1],r=t.value[1];return Number(r)-Number(n)}));const c=(0,e.createDataFrame)({fields:[{name:xm,values:null==l||null===(a=l.data.result)||void 0===a?void 0:a.map((e=>{var t;return null!==(t=e.metric.service_name)&&void 0!==t?t:e.metric.__aggregated_metric__}))},{name:"volume",values:null==l||null===(o=l.data.result)||void 0===o?void 0:o.map((e=>Number(e.value[1])))}]});r.next({data:[c]})}catch(t){r.next({data:[],state:e.LoadingState.Error})}return r.complete(),r}))()}getLabels(t,n,r){return iS((function*(){if(1!==t.targets.length)throw new Error("Volume query can only have a single target!");try{var i;const a=yield n.getResource("labels",{start:t.range.from.utc().toISOString(),end:t.range.to.utc().toISOString()},{requestId:null!==(i=t.requestId)&&void 0!==i?i:"labels",headers:{"X-Query-Tags":`Source=${Wm}`}}),o=(0,e.createDataFrame)({fields:[{name:"labels",values:null==a?void 0:a.data}]});r.next({data:[o],state:e.LoadingState.Done})}catch(t){r.next({data:[],state:e.LoadingState.Error})}return r.complete(),r}))()}testDatasource(){return Promise.resolve({status:"success",message:"Data source is working",title:"Success"})}constructor(e,t){super(e,t)}}("wrapped-loki-ds",aS)})})(),m})()));
//# sourceMappingURL=module.js.map